# Apache Cassandra:实时人工智能的数据基础

> 原文：<https://thenewstack.io/apache-cassandra-the-data-foundation-for-real-time-ai/>

围绕机器学习和人工智能的关注和媒体报道的激增，正在推动一种紧迫感，即企业如何才能最好地利用人工智能来提高影响力。我们看到的最强大的转变之一是向人工智能支持的应用程序的转移，这些应用程序使用实时数据来利用当前的事件，从积极参与企业的消费者到需要不断适应不断变化的变量的供应链运营。

当您的客户积极参与您的服务时，从数据中实时提取情报、提供应用、通知决策并推动行动，为每一次客户互动带来新的体验和增强的背景。但它也带来了新的挑战，并对底层基础设施提出了巨大的要求，以支持这种智能的实时模式。

谈到实时人工智能，我们可以从先驱组织的一致模式、蓝图和最佳实践中获得灵感，这些组织投入时间和资源来构建自己的实时人工智能解决方案。毫无例外，那些利用实时人工智能的领先组织——包括网飞、苹果、和联邦快递——都选择在 [Apache Cassandra](https://thenewstack.io/the-2020s-will-be-about-scale-out-data/) 上构建他们的解决方案。

有一系列理由在 Cassandra 上构建实时人工智能，从世界一流的延迟和速度到可扩展性、可用性和提高预测和行动的准确性。在这里，我们将了解 Cassandra 如何为实时人工智能的两个最重要的数据管理类别(功能和事件)提供基础，从而根据正确的时间的正确数据提供高度准确的见解，对您的业务产生最大的影响。

## 特征

今年 1 月，ChatGPT 比任何其他服务都更快地达到了 1 亿用户(包括 DataStax Astra DB，这让我很懊恼)。自那以后，人工智能素养出现了爆炸式增长，而且不仅仅是在技术专家中。已经成为主流的人工智能术语中比较突出的一点是*特性*。

虽然很诱人，但我不打算让 ChatGPT 写一段解释特性的文字。相反，让我们使用字典:

特征，名词:某物与众不同的属性或方面

在机器学习的背景下，我们有代表这些属性或方面的特定值的数据。我们称之为这些特征，它们用于训练机器学习模型来识别从数据中发现的模式。在推理时也使用特性来提供当前的上下文，模型应该基于当前的上下文进行推理。

当我们的目标是能够实现实时人工智能时——我们希望根据最新、最相关的信息做出推断——我们需要关心如何在事件(更多信息见下文)不断流经系统时保持所有实体的特征“新鲜”。

> 至关重要的是，我们需要更新的特性驻留在能够支持非常高的插入/更新率的数据库中，同时还能够提供低延迟查询，即使在写入处于峰值时也是如此。

为了实现这一点，通常有一个流处理器，如 [Apache Flink](https://flink.apache.org/) 或 [Spark Streaming](https://spark.apache.org/docs/latest/streaming-programming-guide.html) 持续处理事件以保持功能新鲜。我们也很高兴很快将来自 [Kaskada 的创新流处理技术开源，这是最近的 DataStax 收购](https://dtsx.io/3mTkYF3)。Kaskada 技术提供了与 Flink 和 Spark 类似的功能，并且具有丰富的功能工程特性集。

事件本身可能有也可能没有理由放在数据库中，但至关重要的是，我们需要保持新鲜的特性要放在能够支持非常高的插入/更新速率的数据库中，同时还要能够提供低延迟查询，即使是在写入处于峰值时。

为了完成一个实体的推理，我们需要查询该实体的特性，并在许多实时用例中在 200 毫秒内完成推理。Cassandra 可以同时并行检索几个特征；最近，我们在 Astra DB 上对与开源特性商店 [Feast](https://feast.dev/) 的集成进行了测试，三表查询的 p99 为 23 毫秒，剩下的大部分 200 毫秒用于其他处理。

## 事件

理解如何为实时人工智能设计最佳架构首先需要明确事件的角色。如果您的技术职业与“复杂事件处理”没有交集，您可能不会意识到“事件”是一个具有特定关联结构的数据记录。

事件通常捕获“实体”的唯一标识符(在大多数情况下是电子邮件地址或随机分配的字母数字标识符)，以及时间戳和与该时间相关的一组关键数据值。因此，一个事件捕获一个实体在特定时间的特定状态。

这很重要，因为连续处理数据有一个实际的现实:时间在不停地流逝。因此，我们对数据进行的任何实时计算都将始终在特定时间窗口的上下文中进行。

为了将数据放入适当的时间窗口，记录中必须有时间戳。因为这些记录现在移动得如此频繁，所以时间戳必须是数据的一部分。你不能依赖来自数据库`INSERT`事件的时间戳。

现在，我们并不总是需要在数据库中存储事件。有时，只通过流处理器运行事件就可以了，流处理器通常用于实时计算汇总数据，然后将记录存储在对象存储中。卡珊德拉与阿帕奇卡夫卡和阿帕奇脉冲星合作得特别好，既作为记录的*接收器*又作为记录的*来源*。

接收器处理流记录在数据库中的存储，通过变更数据捕获(CDC), Cassandra 也可以成为流源，从数据库记录填充流。数据库和流提供者的组合所代表的灵活性是在实时环境中处理数据的强大工具，在实时环境中，任何过度的体系结构复杂性稍后都会以延迟的形式出现。

虽然大多数事件数据可以安全地在流中处理，然后归档到文件中，但在某些情况下，应用程序需要在数据库中在线存储事件。事件通常不仅仅是对应用程序中发生的事情的审计跟踪，还用来表示用户交互的当前状态。

在这种情况下，Cassandra 是一个特别有效的解决方案，因为 Cassandra 分区非常清晰地映射到事件数据模型。分区键存储事件的实体键，时间戳(或“timeuuid”)存储为一个聚类列。

> 在 Cassandra 上构建实时基础设施可以自由地以非常高的速率捕捉用户活动中的信号，并以高吞吐量和低延迟查询新功能。

结果是 Cassandra 将每个实体的事件按排序顺序存储在分区中，静态列提供了一种节省空间的机制来存储分区中的任何公共数据。稍后，可以有效地检索每个实体的时间上连续的记录。

出于卫生考虑，如果您稍后要从事件数据中构建机器学习模型，请确保时间戳反映了当时捕获的数据的真实值。

非常谨慎地对这些记录进行更新或更正。如果为事件存储的数据实际上反映了仅在记录的时间戳之后为真的值，则模型在生产中的性能可能会很差，因为“来自未来”的数据会泄漏到模型中。

## 面向速度和规模的数据架构

机器学习最适合处理大量高信号数据。在 Cassandra 上构建实时基础设施可以自由地以非常高的速率捕捉用户活动中的信号，并以高吞吐量和低延迟查询新功能。

这使您能够了解哪些信号产生最佳模型，并禁用其他信号以优化存储成本。Cassandra 的线性扩展属性确保机器学习工程师可以轻松支持根据需要摄取尽可能多的事件，并以足够快的速度持续提供新功能，以支持实时交互。

这就是为什么网飞和优步将卡珊德拉作为驱动他们人工智能系统的数据架构的基础。

在正确的平台上构建实时的人工智能应用程序，让您拥有前所未有的能力来塑造您的业务、您的运营方式以及您与市场的关系，从实时提供高度个性化的观看建议，到即时调整路线以最有效地让司机到达目的地，到预测和消除制造和供应链中断。

所有这些机会远远超出了简单的预测。与依赖批处理和昂贵、耗时的转换将数据带到 ML 的旧方法不同，这些实时人工智能系统驱动近乎即时的动作。实现这一点的唯一方法是使用为速度和规模而构建的基础数据架构。卡珊德拉是传递这个的最佳选择。

*在这里* *了解 Cassandra* [*独特的速度、规模和可用性优势，并查看*](https://dtsx.io/3LnXiTt) [*这份新指南*](https://planetcassandra.org/post/practitioners-guide-for-using-cassandra-as-a-real-time-feature-store/) *用 Cassandra 构建实时人工智能应用。*

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>