<html>
<head>
<title>Off-The-Shelf Hacker: Repurpose Your DIY Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现成的黑客:重新利用你的DIY项目</h1>
<blockquote>原文：<a href="https://thenewstack.io/off-shelf-hacker-repurpose-projects/#0001-01-01">https://thenewstack.io/off-shelf-hacker-repurpose-projects/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">正如我在以前的<a href="/tag/off-the-shelf-hacker/" target="_blank">现成黑客</a>专栏中提到的，我非常喜欢将我的项目模块化，这样我就可以根据需要混合和匹配各个部分。去年圣诞节，我女儿给了我一个小小的<a href="https://www.adafruit.com/products/358" class="ext-link" rel="external "> 1.8英寸彩色TFT显示屏</a>。用了一个小时左右才让它和Arduino一起工作。从那时起，小屏幕已经在我的蒸汽朋克会议徽章原型系列中使用，使用简单的Arduino，Yun甚至Raspberry Pi。</p>
<p class="translated">前阵子，我从亚马逊收到了一个<a href="https://www.amazon.com/gp/offer-listing/B004U8TOE6/ref=sr_1_1_olp?ie=UTF8&amp;qid=1450978701&amp;sr=8-1&amp;keywords=ultrasonic+range+finder&amp;condition=new" class="ext-link" rel="external "> HRC-SR04超声波测距仪模块</a>。正如你所料，测距仪发现自己以某种便携式格式连接到1.8英寸Arduino/TFT屏幕组合只是时间问题。将快速的概念验证放在一起相当容易。我刚刚从蒸汽朋克徽章的<a href="https://thenewstack.io/wearable-computing-electro-matic-conference-personality-identification-device/" target="_blank" class="local-link">版本1中盗版了Arduino Pro-Mini、电池和纳米调节器模块，配置了软件，很快就可以用声音测量距离了。</a></p>
<p class="translated">让我们看看如何让HC-SR04读取距离并将这些值输出到TFT显示器。下周，我们将看看如何在项目中使用和包装这项技术。</p>
<h2 class="translated"><strong>重新规划您的项目</strong></h2>
<p class="translated">基本的Arduino Pro-Mini可以作为许多有趣项目的基础。</p>
<p class="translated">看看下面的示意图。我删除了DS18B20数字温度传感器和红色LED功能(从原理图)，然后用HC-SR04超声波测距仪取代它们。添加电线和传感器总共花了15分钟。</p>
<div id="attachment_901697" class="wp-caption aligncenter"><a href="https://thenewstack.io/wp-content/uploads/2015/12/pro-mini-lcd-ultrasonic.png" rel="attachment wp-att-901697" class="local-link"><img aria-describedby="caption-attachment-901697" decoding="async" loading="lazy" class="size-large wp-image-901697" src="../Images/70e902cfc4f118d601444fb1cdfdf989.png" alt="Arduion Pro-Mini/LCD/Ultrasonic Sensor Schematic" data-original-src="https://thenewstack.io/wp-content/uploads/2015/12/pro-mini-lcd-ultrasonic-1024x855.png"/></a><p id="caption-attachment-901697" class="wp-caption-text translated">arduino Pro-Mini/LCD/超声波传感器示意图</p></div>
<p class="translated">否则，原理图与<a href="https://thenewstack.io/hacking-hardware-the-never-ending-saga-of-steampunk-name-badge-development/" target="_blank" class="local-link">旧徽章项目</a>相同。</p>
<p class="translated">这就是模块设计和在项目中使用微控制器的美妙之处。在这种情况下，Arduino Pro-Mini和TFT显示器组合可以完成多项工作，只需连接不同的传感器和输出设备，然后修改代码。</p>
<p class="translated">说到代码，读取超声波传感器也不是太复杂。<br/></p>
<div id="crayon-642311d6d56ca671268060" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-c">// ------------------------------------------------------------</span>
<span class="crayon-c">// Example NewPing library sketch that does a ping about </span>
<span class="crayon-c">// 20 times per second.</span>
<span class="crayon-c">// ------------------------------------------------------------</span>
 
<span class="crayon-p">#include &amp;lt;NewPing.h&amp;gt;</span>
<span class="crayon-p">#include &amp;lt;SPI.h&amp;gt;</span>
<span class="crayon-p">#include &amp;lt;TFT.h&amp;gt;</span>
 
<span class="crayon-p">#define TRIGGER_PIN  6</span>
<span class="crayon-p">#define ECHO_PIN     5</span>
<span class="crayon-p">#define MAX_DISTANCE 450 // Maximum distance (in centimeters)</span>
<span class="crayon-p">#define sd_cs  4   // define tft display pins</span>
<span class="crayon-p">#define lcd_cs 10</span>
<span class="crayon-p">#define dc     8</span>
<span class="crayon-p">#define rst    9</span>
 
<span class="crayon-e">TFT </span><span class="crayon-i">TFTscreen</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">TFT</span>(<span class="crayon-i">lcd_cs</span>,<span class="crayon-h"> </span><span class="crayon-i">dc</span>,<span class="crayon-h"> </span><span class="crayon-i">rst</span>);<span class="crayon-h">  </span><span class="crayon-c">//init tft display</span>
 
<span class="crayon-e">char </span><span class="crayon-i">distanceVal</span>[<span class="crayon-cn">4</span>];<span class="crayon-h">  </span><span class="crayon-c">//char string - sonar-to-text conversion</span>
 
<span class="crayon-e">NewPing </span><span class="crayon-e">sonar</span>(<span class="crayon-i">TRIGGER_PIN</span>,<span class="crayon-h"> </span><span class="crayon-i">ECHO_PIN</span>,<span class="crayon-h"> </span><span class="crayon-i">MAX_DISTANCE</span>);<span class="crayon-h"> </span>
<span class="crayon-c">//initialize sonar sensor</span>
 
<span class="crayon-e">void </span><span class="crayon-e">setup</span>()<span class="crayon-h"> </span>{
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">begin</span>(<span class="crayon-cn">115200</span>);<span class="crayon-h"> </span><span class="crayon-c">// Open serial monitor at 115200 baud</span>
 
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">begin</span>();
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">background</span>(<span class="crayon-cn">0</span>,<span class="crayon-cn">0</span>,<span class="crayon-cn">0</span>);
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">setTextSize</span>(<span class="crayon-cn">2</span>);
}
 
<span class="crayon-e">void </span><span class="crayon-e">loop</span>()<span class="crayon-h"> </span>{
<span class="crayon-h"> </span>
<span class="crayon-h">  </span><span class="crayon-e">String </span><span class="crayon-i">distance</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">String</span>(<span class="crayon-i">sonar</span><span class="crayon-st">.</span><span class="crayon-e">ping_in</span>());<span class="crayon-h"> </span><span class="crayon-c">//send ping (in.)</span>
<span class="crayon-h">  </span><span class="crayon-i">distance</span><span class="crayon-st">.</span><span class="crayon-e">toCharArray</span>(<span class="crayon-i">distanceVal</span>,<span class="crayon-cn">4</span>);<span class="crayon-h">  </span><span class="crayon-c">//convert int to char</span>
 
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">print</span>(<span class="crayon-i">distance</span>);<span class="crayon-h">    </span><span class="crayon-c">//diagnostics to serial monitor</span>
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">" inches"</span>);
 
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">stroke</span>(<span class="crayon-cn">255</span>,<span class="crayon-cn">255</span>,<span class="crayon-cn">255</span>);<span class="crayon-h">       </span><span class="crayon-c">//set text to white</span>
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">text</span>(<span class="crayon-i">distanceVal</span>,<span class="crayon-cn">10</span>,<span class="crayon-cn">50</span>);<span class="crayon-h">   </span><span class="crayon-c">//print distance @ 10,50</span>
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">text</span>(<span class="crayon-s">"   inches"</span>,<span class="crayon-cn">10</span>,<span class="crayon-cn">50</span>);
<span class="crayon-h">  </span><span class="crayon-e">delay</span>(<span class="crayon-cn">200</span>);
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">stroke</span>(<span class="crayon-cn">0</span>,<span class="crayon-cn">0</span>,<span class="crayon-cn">0</span>);<span class="crayon-h">             </span><span class="crayon-c">//set text to black</span>
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">text</span>(<span class="crayon-i">distanceVal</span>,<span class="crayon-cn">10</span>,<span class="crayon-cn">50</span>);<span class="crayon-h">   </span><span class="crayon-c">//erase old text</span>
<span class="crayon-h">  </span><span class="crayon-i">TFTscreen</span><span class="crayon-st">.</span><span class="crayon-e">text</span>(<span class="crayon-s">"   inches"</span>,<span class="crayon-cn">10</span>,<span class="crayon-cn">50</span>);<span class="crayon-h">    </span>
}
</pre>
</div>
</div>

<p class="translated">为了这个项目，我使用了NewPing Arduino库。</p>
<p class="translated">首先，我们将经历定义引脚、设置变量以及初始化超声波传感器和串行通信的常见初始化步骤。出于诊断目的，我通常喜欢在开发代码时包含串行输出。在一切运行正常后，您可以随时删除println语句等。还要记住，大多数Arduinos都有大约32 KB的程序空间。自然，一种节省空间的技术是消除任何额外的、不必要的串行文本生成代码。</p>
<p class="translated">最后，主循环读取超声波传感器，将其整数输出转换为字符串，并将其发送到TFT显示器。使用黑色背景，距离和“英寸”打印在屏幕上的位置(10，50)。然后用黑色打印相同的字符串，擦除白色文本，之后重复该循环。有必要用黑色文本擦除文本，这样值就不会堆积在一起，最终导致屏幕上只有白色方块。这是一种蛮力，虽然它很有效。使用最少29毫秒的脉冲间隔，以确保获得良好的读数。我将延迟设置为200，因为当使用更小的值时，屏幕上的数字闪烁越来越快，这变得很烦人。</p>
<p class="translated">你会注意到，在上面的开始图片中，该设备使用4节AAA电池。这是蒸汽朋克徽章的延续，将在可穿戴项目中很好地工作。确保在连接USB转串行电缆进行编程时，开关处于关闭状态。我也喜欢把电池从支架里拿出来，以防不小心把开关留在了开的位置，或者把设备塞进我的电脑包里。</p>
<p class="translated">是的，我知道，达拉斯DS18B20仍然挂在图片上。随着我的截稿日期的临近，我选择在另一个时间搁置那个“特写”。现成的黑客总是梦想着接下来会发生什么，但是最好控制潜在的项目进展，以免对下游工作流产生不良影响。</p>
<h2 class="translated"><strong>总结</strong></h2>
<p class="translated">能够测量从1英寸到大约10英尺的距离在物理计算领域有着真正的应用。将它连接起来并把代码放在一起也非常简单。</p>
<p class="translated">下周，我将介绍我在网络上发现的一些有趣的应用，例如，如何使用反射器增加范围，以及如何使用声纳传感器找到车库门的位置。我们还将讨论将声纳融入可穿戴设备的方法。</p>
<p class="translated">在那之前，愿各种酷的物理计算硬件在你的圣诞袜中实现。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>