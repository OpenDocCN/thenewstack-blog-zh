# 为什么使用时序数据库可以提高安全性监控

> 原文：<https://thenewstack.io/why-using-a-time-series-database-improves-security-monitoring/>

[](https://www.linkedin.com/in/pealbert/)

 [彼得·艾伯特

Peter 是 InfluxData 的首席信息安全官。Peter 拥有 30 多年的行业经验，曾在 IOActive、iPass 和 Qualys 担任高级职位。](https://www.linkedin.com/in/pealbert/) [](https://www.linkedin.com/in/pealbert/)

安全监控很复杂。安全监控基础设施的成功实施涉及人员、流程、技术和数据，并且需要多个迭代阶段才能达到成熟。安全数据来自多个来源，撰写本文时流行的方法是通过使用每个可能资产的日志文件来获取安全数据，(无论是应用程序、数据库、虚拟机、容器、微服务、操作系统、服务器、网络组件、存储，甚至是[智能电源板](https://www.pcmag.com/picks/the-best-smart-plugs-and-power-strips))，然后将数据发送到 [SIEM](https://en.wikipedia.org/wiki/Security_information_and_event_management) 或[日志管理系统](https://en.wikipedia.org/wiki/Log_management)，如 Splunk、SumoLogic 或 Elastic。

更不用说 [**数字供应链**](https://supplychaingamechanger.com/what-is-the-digital-supply-chain/) 了。在过去十年中，您已经从主要的内部软件转向主要的基于云的服务和 SaaS 应用程序。其中也有很多——一项调查显示，一个典型的公司可以使用 100 到 300 个 SaaS 应用程序，这取决于公司的规模。当你看到过去十年中 SaaS 市场格局中的一部分(营销)的增长，从几百个供应商到几千个供应商，这种趋势没有放缓的迹象，这意味着安全监控必须覆盖大量的云服务和 SaaS 应用。

数字供应链的这种转变需要安全监控实践的转变。当软件在本地时，您几乎总是能够访问日志文件(通常免费提供)并将它们发送到您的 SIEM 或日志管理系统。

## 云和 SaaS 使安全监控变得困难

使用云服务和 SaaS 应用程序，您将无法直接访问日志信息，并且许多服务不提供间接访问。即使可以访问，也不容易，而且通常要额外付费。因此，您需要从分析本地日志转移到通过 API 从云服务收集安全相关事件——假设这样的 API 甚至是可用的。

无论您是在内部运行软件，作为云服务，还是两者的组合，一个至关重要的挑战是识别您所有的软件资产。这告知并描述了您试图监控和保护的[攻击面](https://www.avast.com/en-us/business/resources/what-is-attack-surface)。一旦您了解了您的资产组合，考虑到由云和相关技术支持的资产实例化的动态性质，支持新资产的持续发现的工具就成为一个需求。当您对范围内的资产有所了解时，检测阶段就开始了——包括向范围内的主要资产(应用程序)添加增强的日志记录功能。

## 应用程序事件日志记录至关重要

重要的是要记住，在日志文件和事件 API 中记录的跨多个资产的大量信息中，只有一部分事件与安全监控相关，因为它们比单独的基础架构日志记录提供了更大的洞察力。我说的是自定义应用程序事件。不幸的是，应用程序事件日志记录经常丢失、被禁用或配置不当，这意味着安全团队在最需要可见性的地方有一个盲点。

应用程序日志非常有价值的原因是它们有助于:

1.  识别安全事件
2.  监控违反策略的情况
3.  建立“正常”行为的基线
4.  协助不可否认控制，提供安全事件数据来源和完整性的证明
5.  提供有关攻击、违规和其他异常情况的信息
6.  促进其他日志来源中缺乏的事件调查
7.  识别安全漏洞
8.  通过攻击检测防范漏洞利用

[本指南](https://cheatsheetseries.owasp.org/cheatsheets/Logging_Cheat_Sheet.html)来自 [OWASP](https://owasp.org/) 进一步描述了如何设置应用程序事件日志。

一旦您开始收集大量日志文件，记录来自 API 的安全事件，并对应用程序安全事件进行适当的检测，真正的工作就可以开始了——挖掘潜在的安全事件和异常，以通知警报和事件响应流程。

## 时序数据库增强了安全监控

通过将所有日志数据和安全事件转换为时间序列的集合，时间序列数据库就成为了一个关键且自然的解决方案。这样做使您能够快速关联依赖或关联资产的时间序列事件，阐明指标并追踪危害的向量。反过来，这可以加快事件检测、响应、补救和取证工作流程。

传统日志管理驱动的安全监视器需要大规模存储子系统，其中包含大部分不必要的数据(日志数据中固有的噪声因素)，因此根本无法以有效监视和响应所需的规模和速度运行。

相比之下，时序数据库在数据接收时将安全事件数据标准化为高效的标准化格式，使您能够经济地存储安全数据，并根据多个属性建立索引以实现快速搜索。例如，一些时间序列数据库通常以几十毫秒来度量它们的查询响应时间。有了这种高效的数据格式，您可以用更少的预算支出存储更多的事件。

时间序列数据库非常适合跟踪安全指标。有许多这样的指标可以跟踪，例如:

*   一段时间内的身份验证尝试
*   一段时间内不成功的身份验证尝试
*   一段时间内成功的身份验证尝试
*   一段时间内的唯一帐户
*   一段时间内每个帐户的 IP 地址
*   一段时间内每个 IP 地址的帐户数
*   长期特权操作

人们可以使用机器学习来建立典型使用的行为模型，然后查看指示偏离该模型的实时事件。时间序列数据库能够应用高级算法进行异常检测，如中位数绝对偏差(MAD)、平衡迭代缩减和使用层次聚类(BIRCH)或朴素贝叶斯分类器。

尽管有这些优势，时间序列数据库通常不用于安全监控应用(如 SIEM 或入侵检测和预防系统)，尽管安全社区已经开始[探索这种方法](https://www.semanticscholar.org/paper/Intrusion-Detection-Forecasting-Using-Time-Series-Abdullah-Pillai/5b565b1269161c5a7291dc9a9411b1665c4386a7?p2df)。我相信使用时间序列数据库有好处。

明确地说，时序数据库应该*补充* SIEM 和其他基于日志的安全监控系统，而不是取代它们。最终，我希望看到 SIEM 供应商将时序数据库作为嵌入式组件应用到他们的产品中。

基于时间序列平台的轻量级安全监控应用程序的一个很好的例子是我们的合作伙伴 Bonitoo 最近提供的[社区模板](https://www.influxdata.com/influxdb-templates/fail2ban/?utm_source=vendor&utm_medium=referral&utm_campaign=2021-04_synd_tsdb-security-monitoring-blog_thenewstack)。这个应用程序执行对滥用 IP 地址的监控，因此如果您的应用程序需要为 SSH 访问开放端口 22，它们可以被暂时阻止。

在我们公司，我们正在实施这一概念。我们已经开始基于我们自己的时间序列平台构建安全监控应用，但我们仍处于旅程的早期。你可以在我的同事达林·费舍尔的博客中了解我们的进展。

通过 Pixabay 的特色图片。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>