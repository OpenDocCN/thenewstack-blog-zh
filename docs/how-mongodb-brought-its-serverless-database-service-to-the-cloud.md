# MongoDB 如何将其无服务器数据库服务引入云

> 原文：<https://thenewstack.io/how-mongodb-brought-its-serverless-database-service-to-the-cloud/>

上个月，MongoDB 为其 [MongoDB Atlas](https://www.mongodb.com/cloud/atlas/?utm_content=inline-mention) 数据库服务推出了一个新的“无服务器”选项。

该公司声称，现已全面上市的 Atlas Serverless 可以支持广泛的应用需求，“只需很少甚至不需要初始配置和持续的容量管理。”它可以部署在所有三个主要的云提供商之间——T2、亚马逊网络服务、微软 Azure 和谷歌云平台——采用分层定价，没有前期承诺。

[在六月于纽约举行的](https://www.linkedin.com/in/christophershum/) [MongoDB 世界大会](https://thenewstack.io/mongodb-6-0-brings-encrypted-queries-time-series-data-collection/)上，MongoDB 的首席产品经理 Chris Shum 与新堆栈坐下来讨论这个新的[无服务器特性](https://www.mongodb.com/use-cases/serverless)。

Shum 解释了无服务器模式，将其与按需拼车服务进行了比较。正如一些人喜欢汽车用于扩展用途一样，组织也倾向于购买或租赁专用服务器或虚拟服务器实例来运行需要始终运行的工作负载。但是有许多人只是偶尔需要汽车，所以没有必要购买和维护汽车。在这种情况下，从经济上来说，拼车服务可能更合适。同样，[无服务器服务](https://thenewstack.io/category/serverless/)对于需要按需访问资源的用户来说更有意义

工作用户和自由市场用户都可以决定哪个对他们更好。按需提供汽车服务是有好处的，但有一点要说的是，永远不要在曼哈顿找停车位或给挡风玻璃除冰。

## 谁在掉包？

Shum 解释说，每个类别的客户都对迁移到无服务器表现出兴趣；他详述了几个潜在的用例。无服务器解决方案特别适合金融和服装客户，他们的大部分工作负载可能发生在周末、月末或季末，这使得预先配置的不间断基础架构效率低下。

另一种适合无服务器开发的独特方式是开发应用程序，在这种情况下，开发人员白天工作，晚上回家，或者在功能开发之间有间隙。目前，这些应用程序的主要选项是专用集群或一种功能，当开发人员开始工作时它会旋转起来，而在一天结束时它会关闭。无服务器现在提供了一种新的可能性，用户无需考虑资源管理就可以轻松适应这些用例。

作为公司现代化努力的一部分，遗留应用程序也非常适合无服务器开发。“如果我要更新和建立一个全新的应用程序，那么我最好使用最新和最伟大的技术，”Shum 说。希望将无服务器作为其现代化工作的一部分的关键任务遗留应用程序包括全球知名的大型人力资源、薪资和税务系统。

## 新兴市场的新定价结构

Shum 说，MongoDB 看到了市场上的无服务器选项，并得出结论:“如果我们有一个无服务器产品仍然向您收取某种最低费用或要求您获得预配置的服务器，这将是不幸的，因为这类似于一个专用产品。”

他指的是其他无服务器数据库提供商，这些提供商要么需要最少量的计算来保存数据，要么需要高工作负载客户预先采购一定数量的调配分层无服务器单元。

MongoDB 没有模仿其他无服务器产品，而是回归到当前正在运行的东西——它们的专用集群。专用集群之后的研究和建模带来了一些启示，最值得注意的是，任何线性定价结构都会迫使客户在由于过高的成本而达到一定的使用量后转向专用集群。

MongoDB 并不热衷于向客户介绍他们喜欢的产品，但一旦他们的应用程序真正起飞，他们就会因定价过高而出局。“我们想要一个健康的业务，有良好的利润率，但从根本上来说，这是关于开发者的体验，因为我们都在那里，”Shum 说。

MongoDB 提出了一种分层定价结构，按单位读写计费，每月费用可以从 0 美元开始，但他解释说，“如果你在无服务器上产生足够的负载，作为一家公司，我们有必要对此进行激励，并努力使其在经济上更加可行。”因此，MongoDB 将读取处理单元的标题价格降低了 66%，从每百万 30 美分降至每百万 10 美分。有关无服务器定价的更多详情，请点击[这里](https://www.mongodb.com/pricing)。

就如何设计无服务器模型而言，定价模型不仅是最大的挑战，而且就如何让客户理解他们的账单而言，它也是一个增加了另一个级别的复杂性和粒度的挑战。计费不是月费，而是每单位读写的费用。

这也是该特性最大的技术挑战之一。该数据库没有被设置为跟踪这些单元，并通过云控制面板将它们传递到计费系统，因为它们从来不需要这样做。直到现在。这个新的挑战将团队带回了他们对数据库本身的基本理解。

Shum 认为，很少有人对数据库有如此深入的了解，以至于能够回答一些问题，如如何跟踪扫描的文档数量和回答查询时使用的索引键，以及如何实施、跟踪和将数据上传到云控制平面和计费系统。

在疫情期间，与 MongoDB 的所有资深人员举行了会议，包括核心数据库和云控制平台的 EVP 和 VP，以解决这一挑战和诸如此类的挑战。

Shum 说，“每个人都坐在一个缩放房间里，我们想我们该怎么做？我们去哪里？我们用什么工具？我们如何开始收集？”

无服务器对于 MongoDB 来说是一个非常大的创举。有四个全职工程团队致力于无服务器工作，但在任何给定时间，都有另外三到四个跨核心数据库、云、自动化流程编排和计费团队的工程团队也在从事无服务器项目。

对此肥肥说:“我很幸运，我受益于两件事。a)真正喜欢无服务器的开发人员蜂拥而至，b)许多人一致说服我的首席采购官和首席技术官，这是一场重要的开发人员运动。”

## 无服务器的下一步是什么？

Shum 确认无服务器的预览期非常有用。对于无服务器产品和机群的操作，有巨大的学习收获。MongoDB 团队对当前版本很有信心，并向寻求无服务器选项的客户推荐它。

目前，该团队正在努力使无服务器功能与专用集群的功能紧密匹配。“我们如何才能使无服务器产品的外观和感觉与功能齐全的专用产品一样，这样您就不必在两者之间做出选择，”Shum 说。工程团队目前正在应对这一挑战，以消除无服务器限制。

随着时间的推移，Shum 解释说，MongoDB 希望客户将无服务器视为一种消费模式，而不是一种独立的产品。如果用户最初不知道他们的工作负载，或者不知道它有多不稳定，他们可能会考虑从无服务器开始。但他们可能有其他要求，迫使他们选择专门的产品。对无服务器的投资不仅是 MongoDB 希望开发人员喜欢的产品，也是对正在发展的更广泛的无服务器开发人员的认可。

目前，无服务器项目有一个三到五年的路线图，其中大多数项目都是大规模的 R&D 投资。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>