# Istio 的复杂性导致一些用户使用 Linkerd

> 原文：<https://thenewstack.io/istios-complexity-leads-some-users-to-linkerd/>

[](https://cloudplatformonline.com/TNS-CI-CD-with-Kubernetes.html)

 [吐温泰勒

吐温是 Twistlock 的客座博主和 Fixate IO 撰稿人。他在谷歌开始了他的职业生涯，在那里，他参与了 AdWords 团队的技术支持。他的工作包括审查堆栈跟踪和解决影响客户和支持团队的问题，以及处理升级。如今，作为一名科技记者，他帮助 IT 杂志和初创公司改变团队构建和发布应用程序的方式。](https://cloudplatformonline.com/TNS-CI-CD-with-Kubernetes.html) [](https://cloudplatformonline.com/TNS-CI-CD-with-Kubernetes.html)

服务网格已经得到了相当多的关注，这是有充分理由的。通过在平台层提供可靠性、安全性和可观察性，服务网格可以在 Kubernetes 应用程序中扮演关键角色。但是关于采用的故事是混杂的:一些从业者报告说由于服务网格明显的复杂性而回避采用服务网格，而另一些人报告说使用服务网格很容易。那到底是哪个？服务网格是否太复杂而不值得努力，或者现在就可以采用？

在本文中，我想把重点放在 [Linkerd](https://linkerd.io/) 上，它是[Cloud Native Computing Foundation](https://cncf.io/?utm_content=inline-mention)服务网格(和类别先锋)，以强调简单性而闻名。在日益拥挤的服务网格环境中，Linkerd 在这种少即是多的方法以及在数据平面层使用基于 Rust 的专用“微代理”方面都是独一无二的。Linkerd 网站列出了很多在生产中运行它的组织，所以我开始和他们中的一些人交谈，听听他们的经历。为什么选择 Linkerd，它与更复杂的服务网格相比如何，例如该领域的当前市场领导者 [Istio](https://istio.io/) ？

在这篇文章中，我采访了来自两个不同组织的两位 DevOps 专家。我们讨论了他们在生产中运行 Linkerd 的过程，并在这个过程中收集了一些有趣的收获。[大卫·苏迪亚](https://www.linkedin.com/in/davidsudia/)是 [GoSpotCheck](https://www.gospotcheck.com/) 的高级开发工程师，这是一款面向现场服务团队的移动任务管理应用，他在那里领导着运营团队。David 在[kube con+CloudNativeCon](https://www.cncf.io/kubecon-cloudnativecon-events/?utm_content=inline-mention)NA 2020 上发表了颇有见地的主题演讲，“更多的能力，更少的痛苦:用 CNCF 工具构建内部平台”

弗雷迪·安德森是可视语音邮件和垃圾邮件拦截服务公司 YouMail 的首席信息官。在疫情之前，YouMail 团队就已经开始远程工作了。

我们讨论了到目前为止他们的服务网格之旅，他们很乐意分享他们的经验。虽然我们分开谈过，但他们的故事有一些惊人的相似之处。他们都:

1.  对服务网格有类似的要求
2.  首先尝试 Istio，但发现它过于复杂
3.  在 KubeCon 偶然发现了 Linkerd 摊位，并从此成为了皈依者。

现在，让我们深入了解他们的服务网格故事的细节。

## **林克尔德的简单**

作为最广为人知的服务网格，双方都首先尝试了 Istio。然而，他们很快发现在许多方面使用它过于复杂和具有挑战性。

Sudia 回忆起需要多次安装 Helm chart 和各种手动步骤才能将其部署到集群中的设置。这个过程花了一天时间——这对 Sudia 和他的小型运营团队来说是一个很大的缺点，他们支持更大的开发和质量保证团队。他们没有时间来“管理”服务网格工具。他确实指出，Istio 最近已经采取措施简化其架构，并使其更加专注。

Andersen 在测试 Kubernetes 集群上安装 Istio 的第一次尝试破坏了该集群。他不得不从头开始重建。最终安装 Istio 后，他对它提供的指标没有太多印象。UI 似乎也过时了，他几乎完全放弃了使用服务网格的想法。

巧合的是，两人都在 KubeCon+CloudNativeCon 2019 上，偶然发现了 Linkerd 展台。他们喜欢他们所看到的，并决定给林克尔德一个尝试。

就在那天晚上，安徒生回到他的旅馆房间——他急于给林克德一个机会。他在一个开发集群上安装了 Linkerd，令他惊讶的是，只用一个命令就启动并运行了第一个实例。他向 Kubernetes 名称空间添加了一个 Linkerd 代理，在几分钟之内，就能够看到服务之间的流量和通信。

苏迪亚的经历类似。Linkerd 可以在几分钟内用命令行安装的事实也给他留下了深刻的印象。与使用 Istio 的陡峭的学习曲线不同，Sudia 觉得他可以使用 Linkerd，并很容易地获得它的感觉。

一周之内，Sudia 的团队将 Linkerd 部署到一个开发集群中。一个临时集群在第二周内建立并运行。他们做好了应对突发事件的准备，这是一个平稳、平静的两周，让他们可以放心地部署到生产环境中。苏迪亚和他的团队发现 Linkerd 直观且易于上手。在采用服务网格时，获得服务网格的所有好处而不增加复杂性是一个关键决策。

## **Linkerd 用户界面**

Sudia 和 Andersen 采用服务网格的主要动机是获得服务间通信的可观察性。Linkerd 不仅提供了正确的度量标准，而且以一种容易理解的方式将它们可视化。

根据 Sudia 的说法，仪表盘是 Linkerd 最好的部分之一。不需要额外的设置。团队只需登录并查看关键指标，如请求率、错误率、请求持续时间和总响应。由于 UI 非常直观，他甚至不需要编写入职流程或安排培训课程；只需要快速浏览一下。从第二天开始，团队就能够准确地解决沟通问题。Sudia 声称，这是他们用任何工具进行的“最顺利的入职流程之一”。

对于 Andersen 来说，Linkerd 跟踪服务间请求的“Tap”功能尤为突出。对他来说，无需任何额外的设置就能实时看到正在发生的事情非常方便。

仅仅因为围绕一个工具的复杂性有很多讨论，并不意味着整个类别都是复杂的。说到服务网格，您有很多选择。Istio 的复杂性可能是由于它提供了额外的功能。另一方面，林克尔德采取了一种极简主义的方法，这种方法转化成了更多的简单。可能会有使用 Istio 更有意义的用例，我们知道有许多高兴的 Istio 用户。但我们也不能忽视所有关于其复杂性的抱怨。

你是哪个组的？什么对你的用例有意义？当采用基础设施工具时，做额外的研究是值得的。不要贸然行事。首先确定你的需求并研究你的选择。

## **开发和质量保证团队**

对于 Sudia 和 Andersen 来说，服务网格的最大需求是能够在他们的分布式应用程序中观察服务到服务的通信。这不仅让运营团队受益，也让他们的开发人员和 QA 同事的生活变得更加轻松。

Sudia 描述说，他们的开发团队现在可以简单地“从他们的应用程序中剥离代码”，而不必为最常见的指标设置工具这是因为默认情况下会提供关键的红色(比率、错误、持续时间)指标。这也解决了另一个问题:开发人员经常给同一个指标取稍微不同的名字(例如“收到的请求总数”和“收到的请求总数”)，将本应汇总的指标分开。所有这些都让他们能够更快地发布应用程序，并让团队能够说同一种语言。

Andersen 在运行 QA 任务时看到了服务网格的最大好处。部署后测量负载的能力特别有用，极大地改进了调试和故障排除。具体来说，Linkerd 的跟踪功能非常适合这一点。

## **MTL 和安全证书**

安全性是软件的一个关键方面，必须成为其他所有决策的基础。因此，这对苏迪亚和安德森来说都是头等大事。两者都试图采用服务网格来管理安全证书，通过相互 TLS 来加密集群内部的流量。

Sudia 的团队通常使用 cert-manager 来发布 Letsencrypt 证书，并且需要每 24 小时轮换一次这些证书。他希望避免像包括 Istio 在内的其他服务网格那样，在每个集装箱的基础上执行复杂的 RBAC 政策。对于一个小团队来说，使用 mTLS 快速创建高度安全的集群的能力至关重要。Sudia 的团队花了大约 30 分钟来设置 mTLS，其中大部分时间都花在了阅读文档上。Dave 说，这种设置 mTLS 的简单性和易用性非常强大，尤其是对于像他这样的小团队。

Andersen 的团队需要 MTL 在 Linkerd 网状集群之间安全地路由流量。Linkerd 提供自动证书生成，这是他们用于东西向流量的，这一事实非常方便。对于南北流量，他们使用 Nginx，这是他们的入口控制器。对于他的用例，Andersen 希望 Linkerd 有一个内置的入口控制器，但承认入口控制器“是一个与服务网格一样大的项目”，并理解为什么最好将两者分开。

## **社区和支持**

每当 Andersen 或 Sudia 遇到问题时，他们发现 Linkerd 社区非常有用，能够快速解决任何问题。

在某一点上，Andersen 在发布 HTTP 会话时遇到了与 Linkerd 不兼容的缓存服务问题。在 Linkerd Slack 频道上，在社区的帮助下，他找到了一个解决方案，并在一天内解决了这个问题。令他高兴的是，下一个 Linkerd 版本中包含了对这个问题的修复，这是项目维护者响应速度的一个很好的例子。

苏迪亚的团队在面临大使追踪服务的问题时需要帮助。一天之内，在 Linkerd Slack 社区的帮助下，他找到了一个解决方案。特别是，他欣赏精简的 Linkerd 文档，并将其归功于 Linkerd 是一个如此专注的产品，这是 Istio 一直在努力的。

## **超越链接者**

不足为奇的是，Sudia 和 Andersen 都非常重视甚至超越 Linkerd 的监控。他们从多个来源访问监控数据，包括 Prometheus、Grafana Cloud、Elasticsearch、Rancher、Datadog、Jaeger 和 SumoLogic。虽然他们的监控工具组合各不相同，但他们都在将所有监控指标整合到一个工具中，以获得所有指标、日志和跟踪的统一视图。

最后，我询问了他们对服务网格生态系统现状的看法，以及他们对 Istio 的想法。他们赞同 Istio 试图做很多事情的观点，虽然这可能适用于其他组织，但他们需要专注、灵活的东西，并为他们检查所有正确的框。这正是他们在林克尔德发现的。当谈到 Istio 时，他们并不特别受“FOMO”的困扰，他们与 Linkerd 分享经验的热情充分说明了他们对该项目的支持。

我希望 Sudia 和 Andersen 的观点很有见地，通过分享他们的经验，您可以在开始服务网格之旅时做好更充分的准备。要了解更多关于 Sudia 和他的团队用来构建 Kubernetes 平台的开源项目的信息，开发者们非常喜欢使用这个平台，请查看[在今年 KubeCon NA](https://www.youtube.com/watch?v=z3nFTi5-b3A) 上的主题演讲。

*披露:作者在管理 LinkerD 的浮力公司做过一些咨询工作。*

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>