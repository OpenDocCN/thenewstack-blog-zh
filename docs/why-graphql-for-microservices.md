# 为什么选择 GraphQL 做微服务？

> 原文：<https://thenewstack.io/why-graphql-for-microservices/>

2022 年，许多公司已经将微服务纳入其软件架构。通过将他们的服务分割成更小的部分，这些公司受益于模块化、可伸缩性和分布式开发。但是这些微服务如何相互通信或与外界通信往往是一个讨论点，也是一个挑战。

流行的模式包括 API 网关或数据网格来组合微服务。而 GraphQL 在微服务之间的通信层可以起到至关重要的作用。

## **为什么选择 GraphQL 做微服务？**

 [罗伊·德克斯

Roy 是一名来自荷兰的开发人员、作家和公共演说家。他的使命是通过培训和激励世界各地的开发者，用技术让世界变得更美好。目前，他正与 StepZen 合作，致力于使 GraphQL 的采用变得容易和可扩展。](https://www.linkedin.com/in/royderks1/) 

微服务通常覆盖组织的特定部分或所谓的领域。想象一个开发团队从事认证工作；该团队还将致力于认证微服务。

不同的团队在其他领域工作，例如，支付或库存。这些微服务相互独立，但仍需要通信。大多数微服务架构需要对不同内部微服务的多个请求来服务单个客户端请求。

如今，许多公司都使用 REST 进行微服务的内部和外部通信。对于那些希望自己的响应是静态的、定制可能性有限的 API 来说，REST 是一个很好的方法。但是当您希望数据是动态的时，REST 有它的限制。REST APIs 通常被视为一个契约，这意味着数据总是以相同的形式出现。

另一方面，有 GraphQL，它是高度可定制的，让消费者控制返回的数据。GraphQL APIs 以图形为中心，让用户可以在一个请求中混合和匹配来自不同图形的数据。

GraphQL 越来越受欢迎，自 2015 年推出以来，脸书、GitHub、Shopify 和网飞等公司都采用了 GraphQL。

## **围绕图形组织服务**

当使用 GraphQL 作为微服务的通信层时，团队的领域就变成了图形。该图包含微服务可以为一个域公开的所有可能的数据。

在 GraphQL 中，这个图由一个 GraphQL 模式表示，它通过一组类型和操作来描述什么数据可用以及以什么形式可用。负责一个领域的团队，比如说支付团队，负责保持这个模式是最新的。

当您的微服务公开一个 GraphQL 模式时，您可以使用 GraphQL 将该模式与来自其他微服务的模式相结合。组合模式可以在 API 网关或数据网格中完成。通过将这些微服务组合成单独的服务，您可以:

*   向消费者隐藏您的微服务架构。
*   减少客户端对单个微服务的请求数量。
*   简化微服务架构的使用。

但是为每个微服务构建一个 GraphQL 服务可能非常耗时，因为 GraphQL 和 REST 服务中的缓存和认证模式是不同的。此外，您需要构建一个额外的 GraphQL 服务，该服务组合了来自其他团队服务的所有模式，包括确定谁负责维护该服务。如果有一种方法既能利用 REST 投资，又能从 GraphQL 中获益，那会怎么样？

## **采用 GraphQL**

GraphQL 服务不依赖于特定的编程语言，因为它依赖于 GraphQL 模式定义语言(SDL)。因此，希望支持 GraphQL 的微服务可以构建在任何框架或库中，只要它们公开了基于 GraphQL SDL 的 GraphQL 模式。

当您的微服务已经公开 REST API 端点时，有一种方法可以通过 GraphQL SDL 将它们连接起来。

例如，使用 [StepZen](https://stepzen.com) 你可以用 GraphQL SDL 创建 GraphQL APIs，并直接在云中部署它们。您可以直接在 StepZen 中创建这些模式，而不是在每个微服务中构建一个 GraphQL 服务器来公开一个 GraphQL 模式。

StepZen 可以使用纯 GraphQL SDL 连接每个暴露 REST 或 GraphQL API 端点的微服务。您用 StepZen 创建的这个服务成为组合了您的微服务架构的所有模式的服务，并成为所有客户端请求的入口点。

## **开发人员和运营人员的工作效率提高**

微服务架构中的 GraphQL 有多种用途。为每个微服务采用 GraphQL 可以节省您的组织时间。您还可以获得一个数据层(或 API 网关)服务，它以一种高性能的方式将内部请求路由到您的所有微服务。

参见博客文章“ [GraphQL 是为联邦而构建的，但不要做错](https://stepzen.com/blog/graphql-is-built-for-federation)”，其中有一篇关于用 GraphQL 构建联邦图的精彩讨论。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>