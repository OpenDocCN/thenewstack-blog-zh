<html>
<head>
<title>Cortex: Stateful Prometheus Monitoring for Multiple Clients</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Cortex:多客户端的有状态Prometheus监控</h1>
<blockquote>原文：<a href="https://thenewstack.io/cortex-stateful-prometheus-monitoring-for-multiple-clients/#0001-01-01">https://thenewstack.io/cortex-stateful-prometheus-monitoring-for-multiple-clients/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">虽然云原生社区中的许多人称赞<a href="https://prometheus.io/" class="ext-link" rel="external "> Prometheus </a>监控工具易于使用，但它并不是为了永久存储运营数据而设计的，也不能用于多个客户端。现在，来自Weaveworks的一个名为<a href="https://github.com/weaveworks/cortex" class="ext-link" rel="external "> Cortex </a>的项目将Prometheus打包以解决这一问题，为数据提供长期分布式存储，并为希望提供Prometheus即服务的服务提供商提供多租户服务。</p>
<p class="translated">上周，云原生计算基金会(CNCF) <a href="https://www.cncf.io/blog/2018/09/20/cncf-to-host-cortex-in-the-sandbox/" class="ext-link" rel="external ">将Cortex </a>纳入CNCF沙盒，这是早期阶段和不断发展的云原生项目的家园。</p>
<p class="translated">Weaveworks最初开发Cortex是为了支持自己的商业云产品，<a href="https://cloud.weave.works/login?next=%2Flogin%3Fnext%3D%252Finstances" class="ext-link" rel="external "> Weave Cloud </a>。Prometheus是一个监控和警报工具包，用于<a href="https://thenewstack.io/prometheus-2-0-bulks-local-storage/" class="local-link">收集、显示和分析从it资源收集的</a>时间序列数据。</p>
<p class="translated"><img decoding="async" loading="lazy" class="aligncenter size-full wp-image-5718940" src="../Images/9791b84388ce195b59fa910b8315cafe.png" alt="" data-id="5718940" data-original-src="https://cdn.thenewstack.io/media/2018/09/1731daec-cortex-768x511.png"/></p>
<p> </p>
<p class="translated">最初，该公司通过Kubernetes ReplicaSets部署了多个Prometheus副本，尽管这种方法有许多局限性。“我们没有为长期储存做准备。如果普罗米修斯坠毁了，我们会丢失时间序列数据。如果我们升级普罗米修斯的版本，我们会丢失时间序列数据。如果我们改变我们的警报规则，我们将失去我们的时间序列数据，”Weaveworks工程副总裁乔纳森·兰格在一篇博客文章中解释道。</p>
<p class="translated">Weaveworks营销副总裁Sonja Schweigert 说，Cortex可以被视为提供“Prometheus即服务”的一种方式。</p>
<p class="translated">Cortex为Prometheus查询(使用<span> PromQL) </span>提供了完全兼容的API，可供多个客户或业务部门针对各自的工作负载使用。它可以横向扩展，这意味着单个部署能够管理来自许多系统的成千上万的指标。这种方法避免了为每个客户维护一个单独的Prometheus副本的管理麻烦。</p>
<p class="translated">此外，与Prometheus本身不同，Cortex通过定期捆绑性能样本并定期将它们写入分布式存储后端(如DynamoDB、BigTable或Cassandra)来提供数据的长期保留，使用的方法受<a href="https://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf" class="ext-link" rel="external ">亚马逊Dynamo架构</a>的启发。</p>
<p class="translated">除了Weaveworks本身，Grafana Labs、FreshTracks、EA也使用Cortex。</p>
<p class="translated"><iframe loading="lazy" title="Weave Cortex: Horizontally Scalable, Multitenant Prometheus as a Service by Tom Wilkie, Weaveworks" src="https://www.youtube.com/embed/9Uctgnazfwk?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">视频</iframe></p>
<p class="attribution translated">云计算原生计算基金会是新堆栈的赞助商。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>