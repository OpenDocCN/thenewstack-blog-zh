<html>
<head>
<title>Off-The-Shelf Hacker: 'I See a Machine Vision Sensor'</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现成的黑客:“我看到一个机器视觉传感器”</h1>
<blockquote>原文：<a href="https://thenewstack.io/off-the-shelf-hacker-i-see-a-machine-vision-sensor/#0001-01-01">https://thenewstack.io/off-the-shelf-hacker-i-see-a-machine-vision-sensor/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">上周我们讲述了用语音合成进行物体识别的基础知识。JeVois智能机器视觉传感器“看到”物体，<a href="http://espeak.sourceforge.net/" target="_blank" rel="noopener noreferrer external " class="ext-link"> eSpeak </a>命令行程序“说出”名称，<a href="http://guvcview.sourceforge.net/" target="_blank" rel="noopener noreferrer external " class="ext-link"> guvcview </a>程序与传感器接口，处理脚本管理整个工作。我在老式的华硕Linux笔记本上运行了它。</p>
<p class="translated">这一周，我已经成功地将所有东西移植到机器人头骨赫德利上运行，它有内置的树莓Pi和一堆Arduino板。JeVois传感器被重新安装在他的右眼窝，一个小型音频放大器让他通过树莓Pi音频端口和头骨安装的扬声器说话。</p>
<p class="translated">该设置被简化为仅使用一个<a href="https://processing.org/" target="_blank" rel="noopener noreferrer external " class="ext-link">处理语言脚本</a>，而不需要通过guvcview提供视频。我们也不再需要通过Arduino串行监视器向JeVois发送命令。它是这样工作的。</p>
<h2 class="translated">准备Pi</h2>
<p class="translated">赫德利用Raspbian GNU/Linux 9运行一个Raspberry Pi 3模型B+处理IDE的版本是3.5.3。我还使用Synaptic程序管理器加载了luvcview和guvcview。顺便说一句，在Pi 3上伸展跑得很好。</p>
<p class="translated">这两个程序在测试JeVois识别和发送数据方面非常有效。请注意，guvcview将处理器利用率锁定在100%，因为它非常占用资源。大约一分钟后，主桌面显示器上的高温CPU指示灯将亮起。对于长期测试，请使用luvcview。下面是一个测试命令行示例。用于退出。</p>
<p class="translated"><code>luvcview -f YUYV -s 640x498</code></p>
<p class="translated">我已经升级了上周的代码，以便在您每次点击处理IDE中的“run”时配置JeVois。它不再需要网络摄像头查看器或Arduino串行监视器来开始识别对象。</p>
<p class="translated">这是新的处理代码。<br/></p>
<div id="crayon-642311e660847720174433" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre>---------------------
<span class="crayon-c">// Example by Tom Igoe</span>
 
<span class="crayon-e">import </span><span class="crayon-i">processing</span><span class="crayon-st">.</span><span class="crayon-i">serial</span>.*;
 
<span class="crayon-e">int </span><span class="crayon-i">lf</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">10</span>;<span class="crayon-h"> </span><span class="crayon-c">// Linefeed in ASCII</span>
<span class="crayon-e">String </span><span class="crayon-i">myString</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">null</span>;
<span class="crayon-e">Serial </span><span class="crayon-i">myPort</span>;<span class="crayon-h"> </span><span class="crayon-c">// The serial port</span>
 
<span class="crayon-e">void </span><span class="crayon-e">setup</span>()<span class="crayon-h"> </span>{
<span class="crayon-c">// Open the port you are using at the rate you want:</span>
<span class="crayon-i">myPort</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">new </span><span class="crayon-e">Serial</span>(<span class="crayon-i">this</span>,<span class="crayon-h"> </span><span class="crayon-s">"/dev/ttyACM0"</span>,<span class="crayon-h"> </span><span class="crayon-cn">115200</span>);
 
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">write</span>(<span class="crayon-s">"streamoff\n"</span>);
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">write</span>(<span class="crayon-s">"setpar serout All\n"</span>);
<span class="crayon-c">// myPort.write("setmapping2 YUYV 320 240 15.0 JeVois TensorFlowEasy\n");</span>
<span class="crayon-c">// myPort.write("setmapping2 YUYV 640 480 15.0 JeVois DetectionDNN\n");</span>
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">write</span>(<span class="crayon-s">"setmapping2 YUYV 640 480 15.0 JeVois DarknetYOLO\n"</span>);
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">write</span>(<span class="crayon-s">"streamon\n"</span>);
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">write</span>(<span class="crayon-s">"setpar serstyle Normal\n"</span>);
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">clear</span>();
 
}
 
<span class="crayon-e">void </span><span class="crayon-e">draw</span>()<span class="crayon-h"> </span>{
<span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">available</span>()<span class="crayon-h"> </span><span class="crayon-sy">&amp;gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>)<span class="crayon-h"> </span>{
<span class="crayon-i">myString</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">readStringUntil</span>(<span class="crayon-i">lf</span>);
 
<span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">myString</span><span class="crayon-h"> </span>!=<span class="crayon-h"> </span><span class="crayon-i">null</span>)<span class="crayon-h"> </span>{
<span class="crayon-e">println</span>(<span class="crayon-i">myString</span>);
<span class="crayon-i">String</span>[]<span class="crayon-h"> </span><span class="crayon-i">q</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">splitTokens</span>(<span class="crayon-i">myString</span>,<span class="crayon-h"> </span><span class="crayon-s">" :"</span>);
<span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">q</span>[<span class="crayon-cn">0</span>].<span class="crayon-e">equals</span>(<span class="crayon-s">"N2"</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-i">true</span>)<span class="crayon-h"> </span>{
<span class="crayon-e">exec</span>(<span class="crayon-s">"espeak"</span>,<span class="crayon-h"> </span><span class="crayon-s">"I see a "</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">q</span>[<span class="crayon-cn">1</span>]);
}
}
<span class="crayon-e">delay</span>(<span class="crayon-cn">3000</span>);
<span class="crayon-i">myPort</span><span class="crayon-st">.</span><span class="crayon-e">clear</span>();
}
}
----------------------
</pre>
</div>
</div>

<p/>
<h2 class="translated">代码详情</h2>
<p class="translated">注意，在setup部分，我们有一堆myPort.write()语句。这些设置JeVois通过USB串行端口进行通信，将数据细节设置为“正常”并选择要使用的识别算法。DarknetYOLO one可以很好地识别人、椅子、键盘、遥控器等等。还要注意，所有行都以换行符结束。您必须在每个命令的末尾包含一个换行符，这样它才能在JeVois串行接口环境中执行。如果你把“\n”关了，你会数小时地转动轮子，想知道为什么算法不变，或者为什么数据从不流动。</p>
<p class="translated">当没有需要识别的内容时，我在整理各种响应文本、实际数据和空白行时遇到了一些问题。JeVois使用一种标准化的数据格式，这种格式根据所选择的详细程度而变化。典型的代码行可能如下所示。<br/></p>
<div id="crayon-642311e66084c652854525" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-e">N2 </span><span class="crayon-i">dog</span><span class="crayon-st">:</span><span class="crayon-cn">68</span><span class="crayon-h"> </span>-<span class="crayon-cn">629</span><span class="crayon-h"> </span>-<span class="crayon-cn">259</span><span class="crayon-h"> </span><span class="crayon-cn">581</span><span class="crayon-h"> </span><span class="crayon-cn">734</span>
</pre>
</div>
</div>

<p class="translated"><br/>我也偶尔得到“好的”，作为JeVois的回应。如果您只是得到一个“OK”，即使该行不为空，处理也会生成一个数组越界错误，因为我们试图索引一个不存在的行元素。没有其他代币了。我在其他处理项目中遇到过这种情况。简单的解决方案是处理数据行，如果它不为空，并且我们在第一个文本数据元素中找到一个细节级别指示符。n对应正常，T对应简洁等等。</p>
<p class="translated">同样，显然处理不能用简单的逻辑&amp;&amp;或||测试来比较字符串。您必须使用字符串比较函数。在使用splitTokens()函数分隔数据行元素之后，我们可以使用q[0]将第一个数据文本字符串与“N2”进行比较。等于(“N2”)函数。如果为真，我们继续说出第二个文本位置(q[1])中的对象名称，而没有数组越界错误。</p>
<p class="translated">代码中还有几个myPort.clear()调用。当我们从JeVois传感器读取新的数据行时，这些确保我们在串行端口馈送中没有任何残留的奇怪数据。delay(3000)调用在识别的对象之间给出了三秒钟的暂停。如果没有适当的延迟，当JeVois每隔250秒发送一次新的对象点击时，扬声器中就会出现非常恼人的对象名称回声。赫德利女士试图在三秒钟内考虑到社交方面的问题。</p>
<p class="translated"><iframe loading="lazy" title="i see a person2" src="https://www.youtube.com/embed/CZXkITzrKB8?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">视频</iframe></p>
<p class="translated">为了这个项目，我改变了赫德利的一些其他东西。一个是断开从JeVois到全景伺服Arduino的硬件串行线，在他的头骨顶部。弄清楚如何通过连接Raspberry Pi的USB电缆将跟踪数据路由到pan伺服子系统是现在要做的事情。我将不得不制定出一些协调方案来控制来自Pi的平移、颌和其他伺服系统，以及来自JeVois和其他传感器的输入。数据将通过USB串行线流动，而不是通过硬件串行端口。看起来我可能需要某种“显示”脚本程序。</p>
<p class="translated">我还暂时解开了下颚伺服系统。当前使用处理脚本基于预先记录来移动颌。WAV音频文件。我需要将新的对象识别和语音合成脚本与旧程序中真实驱动颌伺服的分析相集成。</p>
<h2 class="translated">后续步骤</h2>
<p class="translated">我正在寻找一种可靠的方法，通过Pi和子系统运行，将下巴运动与对象识别/语音合成同步。低延迟很重要，因为我们不希望实际声音输出和下巴上下摆动之间有任何延迟。即使200毫秒的延迟也会破坏“通话”效果。</p>
<p class="translated">我也在寻找动态调整JeVois识别算法的方法。例如，对于赫德利来说，长时间坐在那里可能是有用的，如果他面前有运动(比如说，使用<a href="http://jevois.org/moddoc/SurpriseRecorder/modinfo.html" target="_blank" rel="noopener noreferrer external " class="ext-link">惊喜记录器模块</a>，切换到<a href="http://jevois.org/moddoc/DarknetYOLO/modinfo.html" target="_blank" rel="noopener noreferrer external " class="ext-link">暗网YOLO算法</a>进行面部和物体识别。在更远的距离上探测到运动会让他醒来注意到面孔和物体，这在更远的地方是很难探测到的。</p>
<p class="translated">为特定的脸或物体生成我自己的自定义网络也可能很酷。另一个想法是将几个模块组合起来，扩展被识别的内容。也许说阿鲁科符号和物体。</p>
<p class="translated">赫德利认为我们在解释和记录现成项目的过程中做得非常好。他很想听到读者的反馈。嗯……我们正在研究语音识别。尽管如此，你也可以通过给doc@drtorq.com<a href="mailto:doc@drtorq.com">发一封短信来提出新的话题和新的探索。</a></p>
<p class="translated"><em>赶【Torq博士的 <a href="https://thenewstack.io/tag/off-the-shelf-hacker/" class="local-link">现成黑客专栏</a>，每周六，只上新栈！在<a href="mailto:doc@drtorq.com">doc@drtorq.com</a>或407-718-3274直接联系他咨询、演讲和委托项目。</em></p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>