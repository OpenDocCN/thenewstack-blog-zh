# HashiCorp 扩展了 Consul 以支持其他服务网格

> 原文：<https://thenewstack.io/hashicorp-extends-consul-to-support-other-service-meshes/>

自从该模式作为一种在基于云的微服务之间可靠地路由流量的方式出现以来，对服务网格的战争就一直在进行。虽然这个术语起源于像 [HAProxy](http://www.haproxy.org/) 这样的工具，但它已经扩展到一个更广泛的生态系统，包括来自 [Lyft](https://www.lyft.com/) 、 [Envoy](https://www.envoyproxy.io/) 的热门新人项目，以及可以实际路由和平衡任何涉及数据包的 Web 服务器 [NGINX](https://www.nginx.com/) 。

哈希公司的首席技术官艾蒙·达德加尔提供了一个更和谐的解决方案:为什么不全部使用它们？在该公司上周在阿姆斯特丹举行的开发者大会上，Dadgar 和 HashiCorp 的技术团队发布了他们的 Consul 注册表和服务发现产品的最新更新。

Consul 现在能够理解云环境中的服务网格层，同时维护它所跟踪的服务之间的安全网络。 [Consul Connect](https://www.consul.io/intro/getting-started/connect.html) 的新功能允许对单个服务进行分段，以便对其实施访问控制。这意味着服务可以被锁定，只有其他特定的、经过验证的服务可以访问。

“我们正在将 Consul 转变为一个成熟的服务网络。现在我们可以去找 consult 说，web 服务器可以和数据库对话，那个服务器也可以和数据库对话，consult 建立一个服务图并高效分发，在所有节点上缓存。Consul 提供了一个关于生成证书、签名和管理证书的工作流；整个生命周期，”达德加尔说。

Consul Connect 在该平台的早期版本基础上增加了许多功能。它现在包括基于证书的服务身份和服务之间的加密通信。

Dadgar 说，HashiCorp 的团队正在试图找到一种方法来保护公共云或多云环境等不可信网络上的服务间流量。最终，他们决定从世界上最大的不可信环境中获取线索，因此，他们启用了 [TLS](https://www.websecurity.symantec.com/security-topics/what-is-ssl-tls-https) 作为他们基于 Consul 的服务网格功能的加密层。

Consul 现在面临的另一个挑战是配置问题。虽然代理、负载平衡器和安全设备(如 Web 应用程序防火墙)都在服务网格和基于云的环境中执行重要的任务，但随着网络动态移动，从一个云转移到另一个云，保持它们的正确配置可能是一个挑战。

为了解决这个问题，Consul 接管了服务网格中每个工具节点的配置管理职责。Dadgar 将 Consul 比作服务网格的控制平面，而其他系统执行数据平面的职责，控制被传输信息的流动和路由。

“最后一块是一个可信的数据平面。我们的目标是让你开始。然后我可以带来[特使](https://www.envoyproxy.io/)、[哈普洛克西](http://www.haproxy.org/)、 [NGINX](https://www.nginx.com/) ，或者其他任何可能的东西，然后把它们插上。在数据平面层，我可以自由选择适合我的系统的内容，但是 Consul 是在此之上的控制平面。以任何现有的应用程序为例，从大型机到裸机，我们可以让它们适应这种现代服务网状模型，在这种模型中，我们正在进行细粒度的服务到服务模型。当我们构建多云环境时，我们不再有‘我如何将我的 VLAN 应用到所有这些环境中’的问题”达德加尔说。

Dadgar 指出，这种控制平面功能目前在服务网格世界中似乎是缺失的。“特使是一个了不起的数据平面。作为代理，它的功能非常丰富，但它没有内置控制面板。我们已经看到许多项目为它拼凑了一个控制平面，但我们的观点是，我们不能只用数据平面来解决分段。它变得支离破碎。您需要将这些不同的信息放在一起，以便我可以围绕它们进行服务发现。例如，控制平面必须知道数据库在哪里。对我们来说，这是天生的契合。它解决了发现部分和配置部分，”Dadgar 说。

他接着描述了当前企业正在探索的多云模式，这种模式类似于数据中心的旧环境，旧工具的新版本和端点针对云进行了重新设计。Dadgar 说，这些改变的工具之一是防火墙，他把它比作服务网格。

“我们期待的重要事情是，我们如何重新思考更广阔的网络前景？在 HashiCorp，作为一个整体，从 VMWare 的 ITIL 交付过渡到多云资源调配，我们认为网络层、资源调配层…它们都在经历同样的过渡。当我们想到网络时，它正在经历从集中式硬件设备驱动的方法到基于分散式软件的方法的快速转变。所有传统网络设备都将经历这一过程。领事连接是防火墙通过这一点。这些其他组件也将通过它，”达德加尔说。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>