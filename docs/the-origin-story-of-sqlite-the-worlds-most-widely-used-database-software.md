# 世界上使用最广泛的数据库 SQLite 的起源

> 原文：<https://thenewstack.io/the-origin-story-of-sqlite-the-worlds-most-widely-used-database-software/>

上周[亚当·戈登·贝尔](https://www.linkedin.com/in/adamgordonbell/?originalSubdomain=ca) [带来了一位特殊的客人到他的播客核心草写](https://corecursive.com/066-sqlite-with-richard-hipp/) : [理查德·希普](https://twitter.com/drichardhipp?lang=en)，SQLite 的主要作者。

根据 SQLite.org 的官方网页，在二十多年的时间里，它已经成为世界上部署最广泛的数据库——部分原因是它的简单性。因为它包含在 C 代码库中，所以 SQLite 可以很容易地嵌入到其他软件中，并且是完全独立的。“与大多数其他 SQL 数据库不同，SQLite 没有单独的服务器进程，”其官方页面解释道。" SQLite 直接读写普通磁盘文件."

![SQLite logo](img/054bfe85fc14dc1712ba93b8817eebd8.png)

但至关重要的是，它也是开源的，这将贝尔的播客引向一个有趣的问题:如果你有趣的项目最终为世界提供动力，会发生什么？主持人承诺，沿着这条路，采访将探索今天仍然困扰开源运动的困境:如何成为世界的核心基础设施。

贝尔指出，SQLite 现在安装在从网络浏览器到商用飞机的所有东西上，以及 iMessage 和 WhatsApp 等流行软件上。

但是这个软件诞生于 Hipp 对安装在战舰上的数据库的不满。

## '无法连接到服务器'

故事开始于缅因州巴斯的一个造船厂(人口:8329)。回到 2000 年，Hipp 为国防承包商[通用动力](https://www.gd.com/)的造船子公司[巴斯钢铁厂](https://www.gd.com/our-businesses/marine-systems/bath-iron-works)工作，为海军驱逐舰(USS Oscar Austin)开发软件。该软件将对关于船只阀门的关键数据进行操作(用于绕过管道破裂)，它们的堆栈包括 [Informix](https://www.ibm.com/products/informix) ，不幸的是，每当服务器停机时，Informix 就停止工作。

“那很尴尬，”希普对贝尔回忆道。“会弹出一个对话框，他们双击这个东西，会弹出一个对话框说，‘无法连接到数据库服务器。’这不是我们的错——我们无法控制数据库服务器。但是如果连不上服务器怎么办？所以我们还是受到了指责，因为我们在绘制对话框。"

正如希普所说，“这是一艘战舰。”因此，除了飞船持续使用之外，“这个想法是，如果你受到战斗伤害，它应该能够工作！所以不仅仅是一根管子破了。会有很多东西被打碎，人们会变得疯狂，会有硝烟、鲜血和混乱——在这种情况下，他们不想看到一个对话框，上面写着“无法连接到数据库服务器”"

![](img/9b3b783794b181d6e7d9d84a39089505.png)

Hipp 想知道他的团队是否有办法直接从数据库中提取数据，而不依赖外部。“我环顾四周，没有 SQL 数据库引擎可以做到这一点，我的一个同事说，Richard，你为什么不写一个呢？’“在政府合同暂时关闭期间(已经持续了几个月)，”我失业了几个月，我想，‘好吧，我现在就写那个数据库引擎。"

早在 2006 年，Hipp 试图在谷歌向观众解释 SQLite 的吸引力[。“大多数人听到 SQL 数据库引擎，他们会想到](https://youtu.be/giAMt8Tj-84) [Oracle](https://www.oracle.com/index.html) —运行整个企业的大型产品。SQLite 与此相反，它试图变得非常小，因此非常紧凑。”事实上，完全配置时，它还不到 250 千字节。它也是无服务器的——被设计成嵌入在更大的应用程序中。

[https://www.youtube.com/embed/giAMt8Tj-84?feature=oembed](https://www.youtube.com/embed/giAMt8Tj-84?feature=oembed)

视频

但是 SQLite 的故事也展示了主动性和奉献精神是如何得到回报的——以及没有什么能够阻止一个有决心的开发人员。后来，在 Corecursive.com 大学的采访中，Hipp 回忆起他曾寻找如何编写 SQL 数据库引擎的参考资料，但没有找到。

“所以我不得不自己发明它，”他说。"这是一项完全独立的发明。"

例如，Hipp 记得参考了 Donald Knuth 的《计算机编程的艺术》来实现一个搜索算法。虽然理论基础可能已经在[麻省理工](https://web.mit.edu/)、[哈佛](https://www.harvard.edu/)或[加州大学伯克利分校](https://www.berkeley.edu/)教授过，“如果你没有去过这三所学校中的任何一所，你甚至不知道这个理论体系的存在，也没有一个真正的好方法来找到它。”

几年后，他了解到，尽管如此，SQLite 和 Postgres 还是有相同的想法。

具有讽刺意味的是，回到造船厂，Hipp 的高层仍然坚持使用 Informix，Hipp 告诉 Bell(尽管他的团队在测试中使用了 SQLite)。但是除此之外，“我把它放在互联网上，其他人开始收集它。”很快，Hipp 对这种接受程度感到惊讶——包括一个用户，他吹嘘说他们现在在 Palm Pilot 上运行了一个 SQL 数据库引擎。“它真的吸引了很多关注，这鼓励我继续努力。”

## 电话铃声

Hipp 的[网站](http://www.hwaci.com/drh/)仍然自豪地指出 SQLite 获得了 2005 年的 Google O'Reilly 开源奖。但这是 SQLite 获得的唯一赞誉。早在 2006 年，Hipp 告诉他在谷歌的观众“这是公共领域，所以很多人在使用它，我不知道”——但确认的用户包括[苹果](https://www.apple.com/)和 [PHP](https://www.php.net/) 。(通用电气[和东芝](https://www.ge.com/)都曾联系过他，要求获得 SQLite 的美国出口控制编号——尽管他从未找到原因。)

但是很快 Hipp 遇到了困扰大多数开源开发者的另一个主题:货币化。Hipp 告诉 Corecurisve 播客，很早以前，他就接到了来自摩托罗拉 T21 的电话，他们希望将 SQLite 加入到手机操作系统中。“当然，在内心里，我想，‘什么？用开源软件可以赚钱？这是如何工作的？我如何给这个定价？”希普说我不知道该怎么做。"

但幸运的是，他带来了三个在最初的 SQLite 上工作的人，“这是一个开始。”

他接的下一个电话是来自美国在线的，该公司希望使用免费试用光盘上的 SQLite 数据库，并通过邮件发送给潜在用户。不久，塞班打来电话(塞班为 T2 诺基亚 T3 手机开发了操作系统)。该公司测试了 10 个不同的数据库系统——两个开源的，七个专有的。但是，即使给了其他供应商一个机会来微调他们的系统，SQLite 仍然赢得了竞争。希普回忆道，“我们签订了一份合同，为他们做一些开发工作。”

这导致了一个重要的发展，当 Symbian 要求他们增加他们的“[总线因子](https://en.wikipedia.org/wiki/Bus_factor)”时，Hipp 将其描述为“为了停止所有开发工作而不得不被总线撞击的人数……他们觉得 SQLite 的总线因子太低了。”Symbian 的解决方案？它帮助资助了 SQLite 财团，Hipp 称这是“一种资助项目并让更多人参与进来以保证它将长期可用的方式。”

但是他也给予了时任 Mozilla 基金会首席执行官(同时也是一名律师)的米切尔·贝克(如图)很多信任。据他回忆，她主动联系了他，坚持认为“开发商必须控制局面。他们的决定是最终的…使用的公司，他们得到了捐款的荣誉，但你做了所有的决定。她对此非常坚定，她把一切都摆了出来。”

最终，Mozilla 和 Adobe 联合 Symbian 资助了这个团队，直到今天，Hipp 对所有早期的支持表示感谢。“这是一次如此神奇的旅程……如果不是这些情况，我们不会处于这种境地。

## 当谷歌来电时

亚当解释说，很快所有主要的智能手机都在使用 SQLite——很快理查德接到了来自谷歌的电话，“在安卓出现之前。这是在 iPhone 出现之前。”

这使这个项目学到了另一个关于测试价值的关键的开源课程。Hipp 告诉 Bell:“当你的软件突然被安装在数百万台设备上时，会出现如此多的 bug，这真是令人吃惊。”。

他说，他花了整整一年的时间来生成测试，以覆盖生成的二进制代码中的每一个分支操作。他曾希望将测试套件出售给航空电子设备制造商——但尽管他们从未获得任何客户，但当涉及到 Android 漏洞的报告时，“它产生了巨大的影响。在接下来的八九年里，我们真的没有遇到任何问题。”

因此，他说，“这对我们来说确实很好，因为它使我们的产品非常稳定，并使我们能够非常快地推出新功能和新的错误修复。”

细节令人印象深刻。“我们将有一个测试用例，但它将被参数化，因此一个测试用例可能会运行 100、1，000、100，000 个测试，只需通过循环，通过更改其中一个参数。”对于一个典型的版本，Hipp 估计有 100，000 个不同的测试用例——以及数十亿个测试。“我们有一个清单，我们将在发布前至少进行三天的测试。”

core ruthus 的采访以 Hipp 自己给那些想要创建有影响力的开源软件的人的鼓舞人心的建议结束。“我有一个疯狂的想法，我要建立一个没有服务器的数据库引擎，直接与磁盘对话，忽略数据类型，”他说。“如果你问当时的任何一位专家，他们都会说，‘这不可能。那永远行不通。这是一个愚蠢的想法。

幸运的是，我不认识任何专家，所以我还是做了。"

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>