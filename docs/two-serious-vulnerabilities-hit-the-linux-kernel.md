# 两个严重的漏洞攻击了 Linux 内核

> 原文：<https://thenewstack.io/two-serious-vulnerabilities-hit-the-linux-kernel/>

安全研究人员公开披露了 Linux 内核中的两个严重漏洞，这两个漏洞可能允许本地攻击者获得 Linux 系统的 root 权限。

第一个漏洞是由安全公司 Qualys 的研究人员发现的，并被跟踪为 [CVE-2018-14634](https://access.redhat.com/security/cve/cve-2018-14634) 。该漏洞存在于 Linux 内核的 create_elf_tables()函数中，能够访问 SUID 二进制文件的本地用户可以在 64 位系统上利用该漏洞。

[根据 Qualys 的研究人员](https://www.qualys.com/2018/09/25/cve-2018-14634/mutagen-astronomy-integer-overflow-linux-create_elf_tables-cve-2018-14634.txt)的说法，他们将这个漏洞命名为诱变剂天文学，这个漏洞在 Linux 内核中存在了大约十年。它是在 2007 年 7 月 19 日与 commit b6a2fea39318 (mm:可变长度参数支持)一起引入的，并且碰巧在 2017 年 7 月 7 日通过另一个补丁得到缓解:da029c11e6b1 (exec:将 arg 堆栈限制为最多为 _STK_LIM 的 75%)。

然而，事实证明，并不是所有的 Linux 发行版都将 da029c11e6b1 提交回它们的内核，并且仍然容易受到攻击。本周披露的这一缺陷所影响的发行版包括红帽企业版 Linux (RHEL) 6、7 和红帽企业版 MRG 2，以及基于 RHEL 和 Debian 8 Jessie (oldstable)的 CentOS。

“这个问题不影响 32 位系统，因为它们没有足够大的地址空间来利用这个缺陷，”红帽在[的一个安全咨询](https://access.redhat.com/security/cve/cve-2018-14634)中说。“由于利用过程中的内存需求，内存小于 32GB 的系统不太可能受到此问题的影响。”

Red Hat 计划在未来的内核更新中解决这个问题，但在此之前，它的建议包含一个手动解决方法，可以保护系统免受利用。系统重新启动后，需要重新应用该变通方法。

第二个漏洞被追踪为 CVE-2018-17182，是由谷歌零计划的安全研究员 Jann Horn 发现的。该漏洞还可被利用来以根用户身份执行任意代码，并影响 3.16 以后的所有内核版本。

Horn 展示了该漏洞如何在没有配置为增强安全性的内核上被利用，但警告说，通过额外的努力，可以触发该漏洞的代码也可以从沙盒上下文中获得:seccomp，主 gVisor 主机组件的沙盒和 Docker 的 seccomp 策略。

“为了使事情变得简单，我的漏洞利用使用了各种其他内核接口，因此不仅仅是在这样的沙箱中工作；特别是，它使用/dev/kmsg 来读取 dmesg 日志，并使用 eBPF 数组通过用户控制的可变单页分配向内核的页面分配器发送垃圾邮件。但是，愿意在漏洞利用上投入更多时间的攻击者可能能够避免使用此类接口

9 月 12 日，该漏洞被报告给了 Linux 内核维护人员，两天后就为其创建了一个补丁，Horn 称其与其他软件供应商的修复时间相比“异常快速”。

然而，他也指出了 Linux 生态系统中一个众所周知的问题，这个问题也因诱变剂天文学缺陷而突显出来:当上游 Linux 内核中的漏洞被修补时，并不自动意味着用户的系统受到保护。

事实上，最终用户系统收到补丁可能需要很长时间。这是因为大多数用户使用特定的 Linux 发行版，并依赖通过它接收安全补丁。这些 Linux 发行版通常使用稳定的内核，包括较旧的内核，所以它们需要等到这些内核的维护者将补丁移植回来。

所有这些延迟为攻击者创造了一个机会，有时，就像在诱变剂天文学的情况下，一些看起来对导入发行版不是很重要的补丁可能在几年后变成安全隐患。

霍恩的 CVE-2018-17182 漏洞的补丁于 9 月 19 日被反向移植到稳定内核 4.18、4.14、4.9 和 4.4，这是在该漏洞通过上游补丁有效公开后的第四天。然而，当 Horn 在 9 月 26 日发表他的详细博客帖子和漏洞时，Debian stable 仍然使用自 8 月 21 日以来一直没有更新的 4.9 内核，而 Ubuntu 16.04 则发布了自 8 月 27 日以来一直没有更新的内核。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>