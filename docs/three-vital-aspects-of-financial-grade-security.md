# 金融级安全性的三个重要方面

> 原文：<https://thenewstack.io/three-vital-aspects-of-financial-grade-security/>

金融级安全是指一种处理高安全性要求的网络安全方法。这些要求通常是遵从数据法规的结果。现在，全球各地都有许多数据保护法规，如欧洲的《通用数据保护法规》(GDPR)、澳大利亚的《隐私原则》(APPs)、巴西的《通用个人数据保护法案》(LGPD)和韩国的《个人信息保护法案》(PIPA)。特定于行业的计划，如欧洲修订的支付服务指令(PSD2)或英国的开放银行实施实体(OBIE)可能会增加进一步的安全要求。

 [朱迪思·卡勒

Judith 是一名产品营销工程师，对安全性和身份非常感兴趣。在加入 curity 团队之前，她最初是一名开发人员，后来成为了一名安全工程师和顾问。](https://www.linkedin.com/in/judith-k-3269a6a9) 

金融级安全不仅限于金融服务。相反，它可以应用于任何具有高安全性要求的服务。该实践包括基于国际标准构建一个提升的安全模型—最好是来自 OAuth 和 OpenID Connect 规范家族。这些标准有广泛的使用案例，可以用于任何类型的客户端应用程序。因此，它们确保了简单的互操作性和集成。例如，金融级 API (FAPI)小组正在积极地将 OAuth 框架约束到几个概要文件中，这些概要文件为满足特定的法规要求提供指导。

在本文中，我将介绍构建金融级安全模型的三个基本方面。请务必注意，必须在系统的所有组件中管理所有这些向量，以确保您的用户、数据和应用得到有效保护。

## **保护身份**

金融级安全的第一个重要方面是防止身份被盗。攻击者可能试图使用通过网络钓鱼或密码泄露获得的真实用户的凭据登录。身份盗窃的风险可以通过建立强客户身份认证(SCA)来降低。此外，谨慎的令牌设计降低了用户身份意外泄露的风险。

**如何？**

1.  避免身份盗窃的最有效方法之一是提供[多因素认证](https://curity.io/resources/learn/introduction-to-mfa/)。换句话说，要求用户使用至少两个因素登录。这使得攻击者更难窃取凭证并接管用户的身份。
2.  第二种方法是借助基于上下文信息的身份验证策略来检测被盗令牌的使用。除了验证凭证之外，登录过程还应该评估身份验证的上下文细节。例如，身份验证工作流可以考虑用户的[当前地理位置](https://curity.io/resources/learn/geolocation-overview/)、先前登录尝试的次数或当前整体威胁状态。
3.  保护用户身份的第三步是使用[成对假名标识符](https://curity.io/resources/learn/ppid-intro/) (PPIDs)。PPIDs 限制个人用户信息的暴露。这样，应用程序(或一组相关应用程序)只能接收为用户生成的标识符，并根据该 ID 存储任何特定于应用程序的数据。因此，用户的身份得到了保护，因为一个用户无法通过几个应用程序轻松识别。

## 安全 OAuth 令牌

实施金融级安全性时，降低恶意客户端使用窃取的访问令牌访问数据的风险至关重要。由于访问令牌通常是不记名令牌，恶意客户端可以成功地将窃取的令牌发送到您的 API。为了防止这种情况，请将令牌绑定到特定的客户端。这可以通过受发送方约束的令牌来实现。

受发送方限制的令牌包含允许 API 的数据，以及客户端提供的拥有证明，以验证客户端是为其颁发令牌的一方。如果访问令牌被盗，恶意客户端将无法提供与令牌中的数据相匹配的所有权证明，并且如果他们试图将令牌发送到您的 API，将会收到拒绝访问的响应。

### **如何？**

1.  通过 [RFC8705](https://www.rfc-editor.org/info/rfc8705) 中描述的[证书绑定访问令牌](https://curity.io/resources/learn/oauth-certificate-bound-access-token/)，使用相互 TLS 和 X509 客户端证书可以实现发送方受限令牌方法。这种方法依赖于公钥基础设施(PKI ),适合机密的客户端场景，比如公司之间的 API 调用。

令牌通过相互 TLS 隧道发送，访问令牌声明包括一个包含证书指纹的确认声明。相互 TLS 隧道作为拥有的证明。只有当客户端拥有给定证书的相应私钥时，才能建立相互 TLS 隧道。然后，API 验证令牌中的声明是否对应于 TLS 握手中的证书。

1.  在公共客户端设置中，对于移动应用程序，使用客户端证书是不实际的。在这种情况下，实现受发送方限制的令牌是通过一种称为[证明拥有(DPoP)](https://curity.io/resources/learn/dpop-overview/) 的技术来完成的，如 [DPoP 草案标准](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-dpop)中所述。客户端必须证明拥有与令牌中的公钥相对应的私钥。当发送 API 请求时，它在 HTTP 头中添加这个证明。API 验证证据，并检查它是否与令牌中的数据匹配。
2.  使用反向代理或 API 网关并实现[幻影令牌模式](https://curity.io/resources/learn/phantom-token-pattern/)。将该模式与受发送方约束的令牌相结合。这最大限度地减少了因被盗访问令牌而导致的数据泄露，并避免了这些令牌被重复使用。

通过实现这种方法，反向代理验证双方 TLS 或 DPoP 客户端的所有权证明，然后将公钥转发给 API。API 还可以在需要时在集群内部安全地相互调用，对于每个 API 请求，访问令牌的范围和声明都将得到验证。对于金融级安全，这包括根据收到的公钥验证“cnf”(确认)声明。

## **解决浏览器漏洞**

金融级安全的最后一个方面涉及处理恶意软件利用潜在浏览器弱点的风险。传统上，公共客户端依靠系统浏览器来管理登录。浏览器中的漏洞可能导致攻击者拦截和篡改身份验证请求和响应消息。幸运的是，OAuth 和 OpenID Connect 规范家族有丰富的解决方案来降低风险。

### **如何？**

1.  一个有用的解决方案是使用 JWT 安全授权请求( [JAR](https://www.rfc-editor.org/info/rfc9101) )或 JWT 安全授权响应( [JARM](https://www.rfc-editor.org/info/rfc9126) )。当恶意软件拦截或篡改 OAuth 请求和响应消息时，这些规范对于降低浏览器中间人(MITB)攻击的风险特别有用。JAR 和 JARM 通过附加的 jwt 提供消息级安全性，并确保高度敏感的数据和操作是安全的。
2.  在处理移动应用程序时，遵循 OAuth 最佳实践并使用[验证密钥进行代码交换](https://curity.io/resources/learn/oauth-pkce/)和[动态客户端注册](https://curity.io/resources/learn/openid-connect-understanding-dcr/)非常重要。这样，您可以防止恶意应用程序拦截登录响应或使用应用程序的客户端 ID 来冒充正版应用程序。为了提高公共客户端身份验证的安全性，建议实施证明，以便在允许身份验证尝试之前对客户端应用程序进行额外检查。
3.  最后，考虑使用无浏览器身份验证方法，使 web 和移动应用的金融级实施更加无缝集成，并降低浏览器漏洞风险。[Curity Identity Server 中提供的超媒体认证 API 解决方案](https://curity.io/resources/learn/what-is-hypermedia-authentication-api/)提供了直接的 HTTP 认证调用，而不涉及浏览器。

## **总之**

总之，金融级安全的好的、基本的和最终的方面是:

*   多因素认证
*   成对假名标识符
*   受发送方限制的令牌(证书绑定的访问令牌，DPop)
*   使用 JAR 和 JARM 的消息级安全性
*   OAuth 最佳实践
*   超媒体认证 API

遵循这些建议将允许任何组织(无论是否是金融服务)保护用户数据，确保重要交易的安全，并实现非常高的安全级别。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>