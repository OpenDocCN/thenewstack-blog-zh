<html>
<head>
<title>Release 7 of NGINX Plus and the Implications for Microservices Architectures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NGINX Plus第7版及其对微服务架构的影响</h1>
<blockquote>原文：<a href="https://thenewstack.io/microservices-architectures-release-7-nginx-plus-googles-spdy-protocol/#0001-01-01">https://thenewstack.io/microservices-architectures-release-7-nginx-plus-googles-spdy-protocol/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">web服务网关NGINX Plus的第7版部署了一个组件，该组件可能对微服务架构和物联网的发展至关重要。</p>
<p class="translated">软件开发人员着迷于微服务架构的出现所带来的可能性。首席信息官们对物联网的理想深信不疑，物联网部分是幻想，部分是营销:通过更小、分布更广、支持IP的传感器和其他设备，应用数量可能会激增。这两种理想都需要一个更胖、更广、更熟练的网络，如果它们想要摆脱胚胎期的话。</p>
<h2 class="translated">微服务快车道</h2>
<p class="translated">R7的主要改进是增加了对HTTP/2的支持，这是互联网主要传输协议<a href="https://www.mnot.net/blog/2015/02/18/http2" class="ext-link" rel="external ">的一个姗姗来迟且有些争议的版本，去年2月由IETF正式采用</a>。它的初衷是从根本上改进网页组装的方法，但HTTP/2已经成为第一代真正的非实验性微服务的渠道。</p>
<p class="translated">在去年6月F5 Networks的<a href="https://devcentral.f5.com/s/articles/microservices-and-http2" class="ext-link" rel="external ">博客文章</a>中，前网络计算记者<a href="https://twitter.com/lmacvittie" class="ext-link" rel="external ">Lori MacVittie</a>——现在是F5的技术布道者——解释了在HTTP上实现微服务的一个关键问题，以及HTTP/2如何完全解决这些问题或成倍增加这些问题，这取决于应用架构师如何采用新方案。</p>
<p class="translated">MacVittie描述了web架构师如何创建域分片的实践——为分布式资源创建任意、独立的域——作为一种更好地促进对包含多个组件的网页的请求的方式。通过将这些组件分发到由单独的服务器处理的各个域，可以加快服务这些页面的总时间。<a href="https://www.maxcdn.com/one/visual-glossary/domain-sharding-2/" class="ext-link" rel="external ">一些供应商吹捧域分片</a>作为性能加速器的优点。</p>
<blockquote><p class="translated">Mobify工程师Peter McLachlan在2012年写道:“域名分片是可行的，因为网络浏览器将每个唯一的互联网名称识别为不同的服务器，即使实际上所有这些域名都解析为一个服务器。”</p></blockquote>
<p class="translated">HTTP/2旨在通过采用Google的SPDY方法来无阻塞地并行处理无限数量的请求，从而使分片实践过时。随着web浏览器同时连接到服务器的数量增加，超过了最初的两个限制，这种做法的废弃变得越来越有必要。</p>
<p class="translated">微服务就其本质而言，将服务类别划分为不同的领域。正如MacVittie指出的，这也可以被认为是一种域分片的形式。从表面上看，HTTP/2似乎也能解决这个问题，有效地一石二鸟(我不会把这称为“杀戮”，因为这会让人联想到不人道的残忍)。</p>
<p class="translated">但她警告说，如果任由微服务架构师自己使用，他们最终可能会将这些独立的域硬连接到他们的DNS模式中，将这些多个实体作为交换提供给客户，每个实体都需要自己独立的连接。</p>
<p class="translated">“我们能做的是在客户端和本地微服务负载平衡器之间插入一个第7层负载平衡器，”MacVittie写道。客户端上的连接以HTTP/2指定(并且优选)的方式维护单个连接，并且仅需要单次DNS查找、一次TCP会话启动，并且仅招致一次TCP缓慢启动的损失。在服务方面，第7层负载平衡器还保持与本地域负载平衡服务的持久连接，这也减少了会话管理对性能的影响。可以优化每个本地域负载平衡服务，以便为每个服务最佳地分发请求。每个服务都有自己的算法和监控配置，以确保最佳性能。”</p>
<p class="translated">她没有明确地说，但是通过“第7层负载平衡器”，她可以简单地插入“NGINX”</p>
<p class="translated">NGINX的公司网站上写道:“第7层负载平衡器终止网络流量并读取其中的信息”。它可以根据消息的内容(例如URL或cookie)做出负载平衡的决定。然后，它与选定的上游服务器建立新的TCP连接(或通过HTTP keep-alives重用现有的连接)，并将请求写入服务器。</p>
<h2 class="translated">HTTP/2的第一次真正测试</h2>
<p class="translated">最新版本的HTTP用一个二进制系统取代了蒂姆·伯纳斯·李最初设想的基于文本的协议，这个二进制系统本应要求使用TLS/SSL加密，但最终使其成为可选的。无论如何，互联网工程任务组最终还是正式采用了Google的SPDY并行请求处理提议的基础。</p>
<p class="translated">IETF工作组主席马克·诺丁汉去年二月宣布“HTTP/2已经完成”的第三段清楚地表明了并非所有人都对这个决定感到满意。</p>
<blockquote><p class="translated">“虽然有些人认为谷歌把协议强加给了我们，”诺丁汉写道，“但该团队中与迈克(贝尔舍)和罗伯托(佩昂，两名谷歌工程师)实际互动的任何人都知道，他们带着最好的意图来，耐心地解释他们设计背后的理由，接受批评，并与每个人合作改进协议。”</p></blockquote>
<p class="translated">web开发人员中剩下的反对意见，他们认为是对一个供应商技术的大规模“吞并”，去年一月由FreeBSD贡献者Poul-Henning Kamp做了最好的总结，他是<a href="https://www.varnish-cache.org/" class="ext-link" rel="external ">一个叫做Varnish </a>的HTTP加速器的主要开发者。</p>
<blockquote><p class="translated">Kamp写道:“IETF显然担心不相关，匆忙‘发现’HTTP/1.1协议需要更新，并指派一个工作组在不切实际的短时间内准备它。”</p></blockquote>
<p class="translated">“这排除了除SPDY协议之外的新HTTP/2.0的任何基础。随着SPDY最可怕的缺点被消除，所有其他改进的尝试都以“不在范围内”、“太晚了”或“没有达成共识”而被拒绝，IETF现在可以通过放弃几乎所有曾经珍视的原则来宣称相关性和胜利，以换取橡皮图章式批准谷歌倡议的特权。</p>
<p class="translated">坎普的恐惧已经反映在黑客新闻的回音室中。一位署名为克伦威尔的撰稿人写道:“我们现在已经深入‘越差越好’的领域了。”。</p>
<blockquote><p class="translated">“技术杰作是好的敌人。HTTP不太可能被彻底的重新设计所取代，就像TCP/IP不太可能被取代一样。”</p></blockquote>
<p class="translated">《黑客新闻》的成员讨论了对谷歌参与HTTP/2的普遍沉默是否会导致类似IPv6的情况，即整体采用缓慢。一名成员听起来更有希望，他说只有浏览器供应商和内容提供商需要采用HTTP/2才能使其普及，不像IPv6那样需要中间路由器的支持。</p>
<p class="translated">所有这些政治上的争论以下列方式影响微服务的发展:只要对HTTP/2的总体好处仍有怀疑，HTTP 1.1将继续作为任何广泛的、也许是联合的微服务计划的一个特征而存在。</p>
<p class="translated">这使得NGINX不得不同时跨两种协议，可能需要很长时间。去年8月，<a href="https://www.nginx.com/blog/early-alpha-patch-http2/" class="ext-link" rel="external "> NGINX背后的商业实体开始解决人们的担忧</a>，政治争端可能会迫使微服务工程师重新思考他们如何构建自己的应用程序。</p>
<p class="translated">NGINX的Faisal Memon写道:“有了NGINX，只需对应用架构做很小的改动，就可以支持HTTP/2。“NGINX充当‘HTTP/2网关’来简化向新协议的过渡。在前端，NGINX与支持它的客户端web浏览器进行HTTP/2对话，在后端，它像以前一样与HTTP/1.x(或FastCGI、uwsgi、SCGI)对话。介于两者之间，NGINX在HTTP/2和HTTP/1.x(或FastCGI等)之间进行翻译。这意味着NGINX代理的服务器和应用程序将不会受到迁移到HTTP/2的影响，甚至不需要知道他们的客户端正在使用HTTP/2。”</p>
<p class="translated">构建应用程序的一个大挑战是，在一个覆盖全球的基础设施上构建应用程序的栈，这一挑战是与某些其他玩家的大玩家共存的。</p>
<p class="attribution translated">专题图片:<a href="https://www.flickr.com/photos/andymag/" class="ext-link" rel="external ">安迪·马奎尔</a>的<a href="https://www.flickr.com/photos/andymag/11400006246/in/photolist-ino1FQ-5Lids7-bEkLiM-nXxuvM-34zmuy-KUKpG-KV9TK-qKqdy4-84ZrHQ-72hkn9-ohpEub-34zmJ9-qa2v5Q-61bj9f-K3Kye-6LdmFL-dYZT4D-pQBJaX-LJ3AA-K3Ywf-9xY4QL-KUQwL-jKGDwr-KUKoN-6177ii-rL9piG-KknkL-3LqJs7-bnPGcs-nfMHpm-o4yYXW-KUUah-mde1j-piBBim-UugST-Lv3EH-uUonZY-2uqNvz-ohAsyr-5QVdmS-x27fqy-7pr9JE-czGAAq-8RmLqa-xxNtM-f9o2rE-jb4VfJ-itxek2-oTFe5g-6FhjJd" class="ext-link" rel="external "> 7 </a>由<a href="https://creativecommons.org/licenses/by/2.0/" class="ext-link" rel="external ">CC 2.0</a>授权。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>