# GraphQL:从 PoC 到公司范围的标准化

> 原文：<https://thenewstack.io/graphql-from-poc-to-companywide-standardization/>

[](https://www.apollographql.com)

 [马特·德贝加利斯

马特·德贝加利斯是 Apollo GraphQL 的联合创始人兼首席技术官。在创办阿波罗之前，马特创办并运营了世界上最大的政治筹款平台 ActBlue，该平台为全国的候选人和政治团体筹集了超过 7 亿美元的资金。在此之前，Matt 是一名内核黑客。他的一些技术成就包括 NetBSD 的下一个端口，以及在 Network Appliance 时致力于 NFSv4 和 DAFS 规范。](https://www.apollographql.com) [](https://www.apollographql.com)

如今，人们对网络和移动应用的要求越来越高。他们希望体验到对他们是谁和他们需要什么的深刻理解，在所有设备上无缝工作，只需点击或滑动即可神奇地完成复杂任务。这种体验必须快速且不断地改善。

这种数字体验是公司竞争优势的定义，但大多数致力于提供这些体验的产品团队都因技术而处于不利地位，这些技术从未被设计为处理这些新的复杂性水平。在某些情况下，超过 80%的应用程序代码(和开发工作)集中在管理和加载使体验成为可能的数据上。这就是许多组织转向 GraphQL 的原因。

在过去的 20 多年里，REST APIs 一直是应用程序和服务之间共享数据的标准，但是它们不具备跟上当今不断增长的应用程序、平台和服务数量所需的灵活性和敏捷性。REST 是一种过程化的 API 技术，需要开发人员提前协调每个用例。前端团队必须不断向后端团队请求新的端点，通常是针对应用程序中的每个新屏幕，这大大减慢了开发过程。

GraphQL 通过使前端开发人员能够请求特定信息来解决这些问题，而后端开发人员不必提前预测和定义包。GraphQL 提供了对 API 中可用数据的描述，使客户能够准确地(并且仅仅)要求他们需要的东西

越来越多的开发人员正在这样做:JavaScript 的 State 调查了 20，000 多名 JavaScript 开发人员，发现 83%的人正在使用或打算学习 GraphQL。

事实上，评估和使用 GraphQL 的团队来自各种规模、行业和地域的公司。他们正在努力确定 GraphQL 的最佳实践，以及 GraphQL 如何适应该公司投资的其他系统——更不用说它如何适应其他优先事项，从基础设施到产品工程等等。

在本文中，我的目标是提供一些关于 GraphQL 的上下文和通用语言，以便您可以做出明智的决策——无论您已经开始使用 GraphQL 还是正在考虑使用它。

## 改变我们“做”应用程序开发的方式

两个相对较新的重大转变改变了发展模式。

首先，我们在构建应用程序时使用的数据和我们希望在屏幕上显示的数据来自不断增长的不同服务套件，这些套件包含不同的技术，并基于不同的考虑因素而构建。作为一名应用程序开发人员，你必须从该套件中提取不同的元素，并使所有东西协同工作，通常是针对每个产品或功能的新组合。

第二，应用开发者现在为很多新平台写东西。过去，为网络和移动设备开发一个应用程序是一件大事。这个概念在今天看起来几乎是古怪的，因为开发者通过构建跨网络和移动的应用来满足客户需求，当然，也包括聊天、物联网、可穿戴设备、虚拟现实、Alexa 等等。

所有这些都提出了一个真正的巨大挑战:我们如何以不断增长的速度将所有这些数据与我们需要构建的所有功能联系起来？

幸运的是，答案非常简单:GraphQL 的工作方式是让服务层描述它拥有的数据，让客户端描述它们需要的数据，而不是定义特定的 API 来为这些应用程序中的每一个服务提取数据——这意味着编写和维护大量代码。

这种模型有很多优点——尤其是，开发人员不必编写 REST 端点。但是最大的好处是 GraphQL 给你的工具和工作流程带来的改变——换句话说，它给你开发应用程序的方式带来的改变。

例如，GraphQL 基于“以模式为中心的开发”这个想法是，您的 GraphQL 模式(您组织中所有数据的菜单)是您的前端团队和后端团队在构建功能时如何会合的锚。有了这个“数据图”，开发人员可以无缝地利用统一的、总是最新的所有可用数据的目录，以及各种服务之间的连接。数据图的优势包括更快的开发、跨应用和平台的一致用户体验、对应用性能和行为的精细理解以及强大的集中式安全性。

## 采用 GraphQL 的阶段

对于大多数公司来说，GraphQL 的实现包括三个阶段——所有阶段都可以在现有 API 的基础上逐步展开，因此没有必要采用推倒重来的方法。这些阶段是:

### 1.用一个特征验证。

这是团队感受完整开发体验的地方。

对于一个产品团队来说，开发体验的核心是像 React 这样的组件框架、像 Apollo 这样的数据层和类型系统这三者。这个新的现代堆栈具有变革性，通过将 GraphQL 推广到一个特性，您可以开始体验为什么。

GraphQL 有潜力创造令人难以置信的开发者体验。由于它的强类型模式和查询语言，您可以使用 graph API 中丰富的元数据来增强其他工具，比如您的 IDE。想象一下，当您正在使用的字段在图中被标记为不推荐使用时，VS 代码会通知您，或者在您键入新查询时显示向新查询添加字段的预期性能成本。

### 2.支持整个产品。

下一个阶段是把一个关键产品放在图上——从几个人在一个 sprint 上，到几个产品/sprint 团队在你产品的一个关键部分上合作。在这个阶段，产品的开发速度飞速提高。您开始看到代码占用量的大幅减少。

在这个阶段，您希望保持模式较小，并关注产品及其用户的需求。你不应该对你的微服务做任何重大的改变。这些是您的核心能力——由不同的团队拥有——数据图采用策略的一个关键部分是将其他团队的需求与您的需求分离。

在这个阶段，使用图形管理器开始跟踪和管理模式变得很重要——包括验证更改。无论是添加字段、更改类型还是取消字段，开发人员都需要确保他们对模式所做的任何更改都将根据一组规则进行验证，并在堆栈的所有不同部分之间进行协调—不仅针对第一方客户端和第一方 API，还针对第三方、合作伙伴、外部客户端以及使用您的数据的任何其他实体。

### 3.在整个企业中利用数据。

随着团队变得越来越大，并将其对 GraphQL 的使用扩展到第一个概念验证应用程序或第一个功能之外，开发人员可以开发工具和平台来管理 GraphQL 在整个组织中的使用。组织应该寻找能够让多个团队聚集在 GraphQL 周围的解决方案，并实现一个允许他们以安全有效的方式协作的工作流。开发人员还应该评估工具是否能够无缝集成到整个开发过程中。

在这个阶段，你正在从基本上一个团队构建的东西变成整个组织可以共享的东西，作为堆栈的战略层。这就是一个数据图的好处——以及联合——发挥作用的地方，它提供了跨组织的一致性和可重用性，使得每个人都可以利用它——即使是对数据图或其所有底层服务了解不多的团队。

你从小处着手，然后扩大规模。例如，移动团队可能会注意到 web 应用团队正在做什么，并要求查询其图表。然后，可能相邻的工具团队决定利用这一点，并在图中添加一点来支持一个特定的用例。很快你就有了跨越整个组织的东西。

挑战在于，要做到这一点，不能构建一个庞大的整体或开发的中心阻塞点，因为我们要在你拥有的每一个 API 前面和你发布的每一个应用程序后面部署一个大型 GraphQL 服务器的想法不太合理。必须有一种安全、分布式的方法来实现这一点。

我们合作过的一个大型全球组织，包括超过 25 个品牌，500 多名在全球工作的开发人员，50 多种前端应用程序和客户端页面，以及 20 多个支持所有移动部分(航班、预订等)的 API 团队。)—实现了分布在多个 GraphQL 服务中的数据图，这些服务组合在一个图中。

这是通过将图形架构分成两个具有独立职责的层来实现的。一层是一组服务，每一层都实现了图的一部分。另一层是整个组织共享的基础设施:网关。网关将所有东西连接在一起，开发人员对它执行查询，就像它是一个图一样。

事实上，内置在 GraphQL 中的联邦和其他工具——以及围绕它成长起来的工具——真正使 GraphQL 在 PoC 上令人兴奋，并且对于公司范围的标准化是可行的。

使用正确的工具，这些在 REST 世界中没有模拟的事情在 GraphQL 中是可能的，无论您处于 GraphQL 实现周期的哪个阶段。GraphQL 和数据图模型可以改变产品团队在整个堆栈中的协作和创新方式。最后，通过 GraphQL，我们有了一种 API 技术，它为公司为了竞争而需要进行的不断迭代和创新提供了基础——现在，随着时间的推移，无论即将出现什么样的变化和挑战。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>