# 身份验证和授权有什么不同？

> 原文：<https://thenewstack.io/how-do-authentication-and-authorization-differ/>

身份验证和授权听起来很相似。它们经常一起被提及，它们通常都是用令牌实现的，并且这两个术语有时几乎可以互换使用——或者作为一个组合词，暗示它们是同一个东西。

通常，您只会听到“auth”这个术语，并且必须弄清楚这两个术语指的是哪一个:“现代 auth”指的是认证，但是 [OAuth 2](https://oauth.net/2) 是一个授权标准。还有 [OpenID Connect](https://openid.net/connect/) ，它扩展了 Oauth，在授权之上增加了一层认证。

它们总是相关的，但是身份验证和授权是两个不同的概念，需要在访问策略中成为独立的步骤，并且很可能由不同的团队使用不同的工具来管理。

**认证是验证用户是他们所说的那个人:授权是授予他们访问资源或执行特定功能的权限。**

微软身份安全主管亚历克斯·韦纳特建议说，这些原则看起来很熟悉。“如果你以顾客的身份走进我的商店，出示你的身份证，说明你 21 岁，可以买酒。如果你是经理，你可以去后面的仓库。“如果你来到 Azure 门户网站，声称你是一名普通用户，你将无法做很多事情，但如果你来到 Azure 门户网站，声称你是一名全球管理员，你可以做很多事情。”

GitHub 的首席安全官迈克·汉利说:“通常授权发生在认证之后，通过认证过程，你授权给一个你推测出他们是他们所说的那个人的用户。”

你被允许做什么是基于你是谁，但是不同的系统和(通常)不同的团队处理认证和授权这两个步骤。身份认证是身份提供者的来源，使用密码、生物特征识别、一次性 pin、硬件密钥或身份认证应用程序来验证这些凭据，因此系统知道它正在与获得身份的同一个人进行对话，然后将他们的姓名和角色等数据与他们相关联。

授权是由[安全](https://thenewstack.io/category/security/)或应用程序管理员处理的事情，它基于被访问系统的可用权限(直接或映射到用于身份验证的身份系统中的角色和属性)。

接受身份验证的用户可能是一台机器而不是人，使用秘密和其他凭证(通常是 X509 证书，需要安全地提供)而不是用户名、密码或令牌，经过身份验证的机器或工作负载被授权与另一台机器对话，或者在测试环境中读写数据，而不是在生产环境中。

正如您不希望用户将密码写在他们放在键盘上的便笺条上一样，策略、秘密扫描和凭证轮换对于避免将凭证签入回购协议等错误也很重要，因为在回购协议中，凭证可能会被发现和滥用。

## 加强认证

作为用户，您通常可以看到身份验证的发生(尽管它可能是持久的，就像即使您关闭浏览器选项卡也保持登录网站一样)，并且您通常可以做一些事情，如更改密码或选择您想要使用的第二个因素。用户不能更改他们的授权选项，也不会看到授权发生。

但是，如果您尝试做一些被认为非常重要的事情，在您被授权之前必须再次验证您的身份，您可能会看到另一个身份验证请求。有些银行会让你使用用户名和密码登录你的账户并进行支付，但会要求你使用 2FA 设置一个新的收款人。

相反，使用条件访问策略的身份验证系统可以识别出您正在使用相同的设备、IP 地址、位置和网络连接来访问您每天从该设备、位置和网络访问的相同文件共享，从而提高您的工作效率，而不会让您经历身份验证挑战。

汉利说:“我们有足够的数据来证明我们已经认证的用户，他们来自的设备，他们试图访问的工作负载或应用程序，他们加入的网络，我们可以有系统的理由，'我们非常确定这仍然是你，所以我们将允许这种情况发生，而不需要额外的步骤。'”。

> “你可能不在乎有人是否从家里访问工资系统，在他们的 [Windows 95](https://thenewstack.io/a-fan-of-vintage-computing-counts-down-to-a-windows-95-bug/) PC 上获取工资单，但你肯定会在乎有人是否从任何地方访问公司财务系统，而不是从你拥有和操作的、由公司管理的、打满补丁的最新机器。”

GitHub 首席安全官 Mike Hanley

这些是关于风险承受能力的决定，他说:“我们可能会说这个应用程序的风险或价值如此之高，以至于这个工作流程值得摩擦，我将只增加这个工作流程的摩擦，以确保不会发生任何糟糕的事情。”

认证和授权仍然是分开的步骤，但随着有条件访问和零信任身份认证方法的使用越来越多，它们经常会纠缠在一起。

“影响授权决定的因素之一是你对认证的信心有多强，”Hanley 说。“如果您只有用户名和密码身份验证，我可能会允许您进入最低风险层的应用程序，但我可能会让您接受多因素挑战，或者要求您[使用]多因素来应对任何类型的中间层敏感性。然后，如果你在最敏感的层次做任何事情，我会不断引入摩擦，以确保那仍然是你。”

Hanley 指出，这可能包括拒绝授权，即使认证成功，但会暴露出一些你不舒服的连接。“我已经对 Mike 进行了身份验证，Mike 使用了他的双因素身份验证，所以我非常确定他就是 Mike，但是他来自一个我不认识的网络和一台我不信任的电脑，因为它没有运行最新的安全更新，所以授权决定发生了变化。

“你可能不在乎有人从家里访问工资系统，在他们的 [Windows 95](https://thenewstack.io/a-fan-of-vintage-computing-counts-down-to-a-windows-95-bug/) 个人电脑上拿到工资条，但你肯定会在乎有人是否从任何地方访问公司财务系统，而不是从你拥有和操作的、由公司管理的、打满补丁的最新机器上。”

## 设置更高的护栏

管理员可以选择设置更丰富的策略来访问高价值系统，无论是公司财务还是重要的代码回购。 [GitHub 现在坚持](https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/)在认证 Git 操作时使用令牌而不是密码，并且这些令牌可以被设置为非常特定的访问。这类似于 PowerShell 管理的系统[的恰到好处的管理员授权选项，您可以限制允许哪些命令，甚至设置特定的时间段。](https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/jea/overview)

正如汉利解释的那样，“你可以给他们一把黄油刀，并说当你确实需要火箭筒时再来找我们，我们会出于特定的原因和特定的时间给你，而不是在他们不需要的时候用火箭筒打发他们。”

他建议，把这些方法想象成护栏。“这灌输了一种运营安全和保障的意识，因为你不太可能犯下因行使过度特权而导致糟糕情况的人为错误。但它也可以保护您免受以下情况的影响:即使您已经对某个用户进行了强有力的身份验证，他们的帐户仍有可能被劫持，或者有人窃取了他们的会话，或者有人从他们手中夺走了笔记本电脑。”

连续访问评估捕捉这样的情况，例如，一个用户经过身份验证并被授权使用一个特定的应用程序，因为他们在财务部门工作，但随后转到另一个组，甚至离开公司，只要他们的会话令牌有效，他们仍然可以访问。Weinert 指出，你想要立即并再次撤销访问，这需要认证和授权之间的协调。

您可能还需要考虑(并监控)应用程序的行为，尽管应用程序治理也是独立于身份验证和授权的。应用程序是否有太多的权限，允许访问它不需要的太多信息，从而可能被攻击者滥用？

## “钝器”

应用程序角色和权限是授权成为一个难题的原因，这个难题有时会被推给身份验证系统。安全团队不知道每个部门中每个应用程序的细节，也不知道不同角色需要被授权做什么的细微差别。

正如 Weinert 所问，“作为一名管理员，您真的能够管理您环境中所有可能应用程序的所有可能角色的交集吗？”

特别是当您使用单点登录来联合访问没有内置现代身份验证的旧系统时，您被授权使用的那些系统可能具有用户和管理员角色，甚至是非常具体的角色，如“电汇管理员”或“货架仓库管理员”与“结账专家”

但是他们通常也没有一个精确的权限方法，Weinert 指出。他说，在许多系统中，认证本质上是对某些角色的授权。规则是，如果你被允许介绍某样东西，你将被允许使用它:“如果你甚至到了这里，我将假设你在这里有一些业务。”

Weinert 建议将你被授权做的不同事情——从访问数据库到发送电子邮件或配置虚拟机的任何事情——想象成动词。“每个人都有不同的动词和不同的角色，以及暴露这些角色的不同方式，因此身份认证成为管理员用来进行监管的生硬工具，”他说。

> “在身份认证领域，如果我不为您生成访问令牌，我就是在执行某种形式的授权。”

—微软身份安全总监 Alex Weinert

开发人员可能没有这样计划，但是如果应用程序处理财务数据，安全管理员可能会决定仅在身份验证显示用户的设备符合最严格的访问策略时才允许授权。“在认证的世界里，如果我不为你生成一个访问令牌，我就是在执行一种形式的授权，”Weinert 说。

降低这一点的复杂性将需要提出一些应用程序授权用户执行的常见任务，如读取和写入敏感数据，Weinart 建议这些任务可以与 SCIM 等供应标准一起工作，该系统用于跨域身份管理，处理名称等常见属性。

“随着我们对这种体验的规范化，你会看到更多从认证步骤中的粗粒度访问控制向更细粒度授权的转变，”Weinert 说。

OAuth(和 OpenID Connect)和[复杂且更好的授权工具](https://developer.okta.com/blog/2019/01/23/nobody-cares-about-oauth-or-openid-connect)才慢慢出现。

[MSAL，微软的多平台认证库](https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-overview)，避免了直接与 OAuth 合作进行授权的需要，并扩展了 extends OpenID Connect 的选项，如条件访问。

谷歌的[桑给巴尔 API](https://storage.googleapis.com/pub-tools-public-publication-data/pdf/0749e1e54ded70f54e1f646cd440a5a523c69164.pdf) ( [开源为 Keto](https://github.com/ory/keto) 和[开源 Oso 库](https://www.osohq.com/what-is-oso)(处理用 policy 语言编写的规则)采取了不同的方法，旨在帮助将授权与认证分离，并使构建您需要的授权更加容易。

## 认证服务的优势

身份验证方面得到了更好的服务，这有助于摆脱密码。从历史上看，检查用户就是他们所说的那个人是一个简单的步骤:如果我有用户名和密码，我就一定是那个用户。

但是那些日子即将结束。

“随着网络钓鱼和凭据填充以及各种各样的攻击进入接管帐户，这通常是不够的，”汉利警告说。“密码有所有这些缺陷；它们往往是人们写下来的东西，往往是人们重复使用的东西。我们给人们提供复杂的密码规则，这使得他们很难将它们作为主要因素，这意味着他们最终会泄露或被滥用，或者在其他地方被发现，而这是不应该的。”

[FIDO2](https://fidoalliance.org/fido2/) 和 [WebAuthn](https://w3c.github.io/webauthn/) 标准使得使用生物识别、认证应用或硬件令牌的多因素认证更容易，因为它们内置于常见的操作系统和浏览器中。当应用程序和网站使用 Windows Hello cameras 和苹果设备上的触控 ID 进行强认证时，这些生物特征对用户来说更加方便。

在某些情况下，比如无线网络，你必须创建自己的身份和认证系统。但是，如果可以的话，选择一个云身份提供商服务(如 Auth0、Azure AD B2B 和 B2C、Google Workspace、Okta、Twilio 的 Authy 和其他服务)，可以为您提供更广泛的身份认证方法选择，以及他们在支持 SMS 2FA 等常见系统的系统方面的专业知识。

> “我们知道供应链安全如今正受到攻击，而且有各种各样有趣而奇特的攻击。我们需要保护从事这项工作的开发者和社区。”

GitHub 首席安全官 Mike Hanley

Twilio 账户安全业务部高级产品营销经理 [Catie Kolander](https://www.linkedin.com/in/catiekolander/) 说:“你必须处理好与电信公司的复杂关系。“您可能需要管理一个号码池才能发送一次性密码。如果递送失败，您是否有备用路线？

“当他们说‘我没有得到我的身份验证代码’时，你将开始看到支持成本的增加，他们将这条消息发送了七次。”

对于内部用户，组织可以强制要求身份验证方法；Kolander 指出，如果你与客户打交道，你可能必须更加灵活，记住谁将被认证，在什么设备上以及他们对什么感到舒服。“如果你只提供短信之类的东西，你是不是在排除一个没有手机的庞大用户群？你需要像语音电话或电子邮件这样的东西吗？”

对于身份验证来说，这不是最安全的选择，但对于某些受众来说可能是必要的。对于其他人来说，你可能需要一些夸张的方法，如 WhatsApp、语音通话、通过认证应用程序的基于时间的一次性密码(通常称为 TOTP)，或者在你的移动应用程序中推送认证——这需要更多的开发工作，但却是唯一让用户明确拒绝访问的选项。

身份服务还简化了获取有关连接的额外信息，而不仅仅是用于身份验证决策的 IP 和设备信息。正如 Kolander 告诉我们的，“如果一个电话号码来自一个你不应该看到是来自一个连接的国家，你有能力阻止它或提供额外的认证层。”

这些级别的检查和挑战对管理员和用户来说意味着更多的工作，但这很重要，尤其是对开发人员来说。汉利说:“我们不仅仅是有意推动，而是真正推动我们认为好看的东西。”。

“我们知道供应链安全如今正受到攻击，而且有各种各样有趣而奇特的攻击。我们需要保护从事这项工作的开发者和社区。

“我们必须成为一个安全的平台，但这也是将帐户安全推向边缘的一部分，这样我们就可以让他们更好地控制这些用户帐户，这些帐户被授权给一些最大和最重要的开源项目，这些项目为我们每天使用的所有设备和我们每天交互的软件提供支持。”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>