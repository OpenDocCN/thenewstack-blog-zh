# Python 的开发人员常驻探测器提取请求模式

> 原文：<https://thenewstack.io/pythons-developer-in-residence-probes-pull-request-patterns/>

作为 Python 编程语言 T1 的长期贡献者，T2 最近担任了 Python 3.8 和 3.9 版本的发布经理。但是这位波兰的开发人员也是第一个担任 CPython(Python 编程语言的参考实现)常驻开发人员职位的人。

根据[4 月](https://pyfound.blogspot.com/2021/04/the-psf-is-hiring-developer-in.html)Python 基金会的一篇博客文章，由非营利 Python 软件基金会设立的常驻开发者职位将“协助 CPython 志愿者维护者和指导委员会”。

该职位的职责包括“分析研究，以了解项目的志愿者时间和资金。”

这就是世界如何以[一篇引人入胜的博客文章](https://lukasz.langa.pl/f15a8851-af26-4e94-a4b1-c146c57c9d20/)结束的，这篇文章提供了关于 Python 来源的详细的、数据驱动的见解，从拉请求的分布到 Python 的核心开发人员如何花费他们的时间，都有统计数据。

在某种程度上，这是一个编程语言的故事——通过成千上万个小的拉请求，它如何继续进化。

但兰加自己的参与也是独一无二的，最终证明了故事背后的故事同样有趣。

## 赞助住院医师

兰加将自己的居住经历放在更大的历史范围内，回忆起 Python 仅由志愿者开发的日子——以及由在 Dropbox 拥有一个带薪职位的吉多·范·罗苏姆开发的日子，人们知道他也会利用自己的时间从事编程语言的工作。

“我们中的许多人都处于同样的情况，”兰加在八月下旬的“Python 对话”播客中回忆道。“在脸书，我作为 CPython 核心开发人员被接受了，其他一些人在他们各自的公司。

“我对此感到非常沮丧，因为我们给整个社区带来了巨大的价值，包括价值数十亿美元的公司。”

但是现在，他正在以一种新的形式完成 Python 的首次驻留——由谷歌赞助，但通过 Python 软件基金会运行。

“那太神奇了。我很高兴他们做到了，因为我真的相信这可能会改变我们对社区驱动的项目(如 Python)的维护的看法，”Langa 说，并补充说，“这是一种游戏规则的改变者。我们以前没有以这种方式赞助项目，我们实际上是在考虑 Python 软件基金会’中的‘软件’一词——我们直接赞助源代码工作。”

[https://www.youtube.com/embed/nZi74lGz47U?feature=oembed](https://www.youtube.com/embed/nZi74lGz47U?feature=oembed)

视频

Langa 认真对待他的责任，正如他在播客上的言论所表明的那样:“我确实相信我的特殊表现会决定未来是否应该将这种做法推广到更多人身上，对吗？”

他笑了，然后开玩笑地补充道:“或者干脆干脆关门大吉！因此，它不仅为项目提供了价值，还提供了证明这种开发模式可行的证据。所以，是的，围绕它有一定的责任，”

## 拉请求中的模式

Langa 的博客文章强调了常驻开发人员职位中透明度和可见性的重要性——对他来说，这包括[定期在博客上讲述自己的经历](https://lukasz.langa.pl/python/developer-in-residence/)，让社区的其他人参与到他的旅程中。

他写道，交给他的任务之一是在对图书馆的拉取请求中寻找模式(以及识别它们的主要贡献者)。因此，Langa 开始从 python/cpython Git 存储库及其 pull 请求中探索多年的历史数据——将这些数据转换为 python 对象(使用他的[在 GitHub](https://github.com/ambv/cpython-stats/) 上共享的脚本),然后将其转换为 SQLite 文件，使用数据探索/可视化工具[dataset](https://datasette.io/)探索这一切。

第一个有趣的发现？哪些日期合并最多？

“马上你就会看到，2019 年 9 月是我们数据库中记录的合并最活跃的一周，”兰加在他的博客上写道，“这并不奇怪，这是我们年度核心冲刺的一周，那一年发生在伦敦彭博。”

Langa 很快生成了一个条形图，其中冲刺日的条形图比其他条形图高出两到三倍。他称之为“这些事件是值得的切实证据。”

但很快，他得出了最终可以回答这个问题的统计数据:Python 的核心开发人员把时间花在哪里了？

CPython 由超过 629，000 行 Python 代码和超过 550，000 行 C 代码组成。但通过查询数据，Langa 能够确定一个文件，该文件包含自 2019 年初以来最多的更改(有 259 个合并的拉请求)*和*最多的代码行已被更改(12，972)。它是 Python/ceval . c——这个 7，080 行的文件实际上执行编译后的代码。

令 Langa 惊讶的是，合并请求最多的第二名是 Python/pylifecycle.c，它是顶级例程(包括 *init* 和 *exit* )的解释器，有 222 个合并请求。

"谁会认为最大的变化发生在翻译的最深处？"他问。

Langa 还能够梳理出关于谁在发出拉请求的有趣信息。有趣的是，最常见的贡献者是 GitHub 用户 miss-is lington——一个自动检查合并的 pull 请求是否有反向传输问题的机器人。(为了与 Python 的起源保持一致，这个机器人是以《巨蟒与圣杯》中的一个角色命名的*，这个角色必须向一群暴徒坚称自己不是女巫。)*

 *[https://www.youtube.com/embed/yp_l5ntikaU](https://www.youtube.com/embed/yp_l5ntikaU)

视频

“显然，做一个机器人(像 miss-islington、web-flow 或 blurb-it)是值得的，”Langa 写道，“或者做一个发布经理，因为这自然会导致你进行大量的提交。”

排名前两位的人类贡献者是 [Victor Stinner](https://github.com/vstinner) (由 [Red Hat](https://www.openshift.com/try?utm_content=inline-mention) 支付费用以维护 Python 的上游)和 [Serhiy Storchaka](https://twitter.com/serhiystorchaka?lang=en) (一位乌克兰的 Python 核心开发者)，Langa 承认这两个人“活动量惊人”。Stinner 以 3775 个合并的拉请求排在第二位，而 Storchaka 有 2582 个。

然后，Langa 尝试编写一个脚本，确定每个文件的前五名贡献者——尽管在将其分为 636 个类别后，他仍然发现，对于其中的 618 个类别，前五名贡献者中有两个是。…又是斯汀纳和斯托尔恰卡。“事实上，除了我们两个顶级巨头之外，有些文件完全没有贡献者，”Langa 写道。

但是，令人欣慰的是，Langa 还发现一些“专家”专注于 Python 的特定部分(如处理电子邮件或处理类型的代码)。这是 Python 软件基金会特别要求的信息，因此随着 Python 开发的继续，它可能会被证明是有用的。

## 路过和“转型潜力”

在 7 月份的一篇博客文章中，Langa 甚至认为他的角色对 Python 来说具有“变革潜力”。“简而言之，我认为常驻开发人员的使命是加速其他所有人的开发体验。这不仅包括核心开发团队，最重要的是，还包括提交“拉”请求并在跟踪器上制造问题的“路过”贡献者。”

Langa 在“Talk Python”播客上阐述了临时贡献者的重要性。“核心团队中有很多人，甚至核心团队周围有更多的人，他们有点——嗯，我们称他们为顺带贡献者，”他说。

“他们会发现一个问题，产生一堆拉请求，然后可能就消失了……显然，Python 的开发每年都在变化。我们将会有一群超级投入的人，他们将会花费大量的时间，包括周末等等，来开发 Python，甚至是免费的。我知道——我这样做了十年。

“所以那些贡献是超级有价值的。但通常，那些真的不会——嗯，那些人是会变的，对吧？就像，你不能真正以一致的方式，日复一日，长时间地这样做。你的生活状况改变了，你的工作改变了，或者诸如此类的，你知道，你停止了贡献。那么 Python 会发生什么呢？嗯，我们失去了一些价值。”

## 拉请求合并的平均等待时间

Langa 认为鼓励更多贡献的一个方法是合并更多已经提交的拉请求。“目前我们有超过 1，400 个未完成的拉动式请求。我一直在努力降低这个数字，”他写道。“目前我看到的是 1，421。”

因此，Langa 在他的 Python 相关的数据科学中探讨了另一个关键问题:合并一个拉请求需要多长时间？

他的第一个结果显示平均等待时间是 14.6 天，兰加写道。(尽管，“显然，在一个大项目中，答案是‘视情况而定’。”。平均值是谎言。")

更多的研究表明，事实上，特别是对于非核心开发人员，与平均值的偏差可能非常大。Langa 的计算将他们的标准偏差定位在 81.7 天上下。而对于核心开发人员，平均等待时间接近 9.5 天，他们的标准差也很高。(至少不到 42 天，上下浮动——但是如果核心开发人员不合并他们自己的拉请求，这个时间会跳到 77.4 天。)

与此同时，*没有被*合并——而是被关闭——的拉请求平均要等待 105 天以上，Langa 写道。“但正如我所说，平均水平是会说谎的。”

下一步仍有待确定。但是，就目前而言，对于 Python 开发的当前状态，有一些新的数据驱动的观点。

这是 Python 的第一个常驻开发人员如何让社区参与他的旅程的一部分——他现在甚至邀请他们帮助选择他下一步应该调查的内容。

“如果你对我可以看的东西有任何建议，”Langa 的博客帖子最后说，“让我知道！”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>*