<html>
<head>
<title>Off-The-Shelf Hacker: Automating Your Hack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现成的黑客:自动化你的黑客</h1>
<blockquote>原文：<a href="https://thenewstack.io/off-shelf-hacker-automating-start/#0001-01-01">https://thenewstack.io/off-shelf-hacker-automating-start/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">给Arduino微控制器加电，它将立即运行加载到其闪存中的任何专用程序，称为固件。</p>
<p class="translated">该程序可以读取连接到通用输入/输出引脚(GPIO)之一的按钮，并点亮连接到另一个GPIO引脚的LED。只要有电，它就会在程序中循环。这是一个单一任务的过程，这就是它所做的一切。关闭电源，过程停止。插上电源，程序就会自动启动，一遍又一遍地做同样的事情，就像以前一样。</p>
<p class="translated">Raspberry Pi、Pine64、CHIP和Artik等微控制器的工作方式与Arduino不同。他们引导进入一个多用户、多任务的操作系统，通常是Linux。程序驻留在闪存或可移动介质上，如微型SD卡。有了Linux，我们可以随时下载、创建、删除、修改和运行程序。</p>
<p class="translated">有了这些微控制器，在我们执行程序之前，Linux必须启动并运行。虽然我们可以使用Python这样的通用编程语言编写一个“读取Raspberry Pi按钮GPIO引脚并点亮LED”的程序，但它不会像Arduino那样在给Pi加电时自动运行。</p>
<p class="translated">今天，我们将学习一些有用的方法，让程序在Linux引导序列完成后自动运行。</p>
<h2 class="translated">编辑/etc/rc.local</h2>
<p class="translated">当你将显示器、键盘和鼠标插入主板时，Pi(和大多数其他nano-Linux设备)通常会引导到标准的<a href="https://www.x.org/wiki/" class="ext-link" rel="external "> X Windows </a>桌面。</p>
<p class="translated">但是我用一个<a href="https://en.wikipedia.org/wiki/Headless_software" class="ext-link" rel="external ">无头</a>(没有显示器、键盘或鼠标)树莓派给我的<a href="https://thenewstack.io/hacking-hardware-the-never-ending-saga-of-steampunk-name-badge-development/" class="local-link">蒸汽朋克会议个性识别仪</a>供电。大多数人都知道它是一个会议徽章:</p>
<p class="translated"><a href="https://thenewstack.io/hacking-hardware-the-never-ending-saga-of-steampunk-name-badge-development/" class="local-link"> <img decoding="async" loading="lazy" class="aligncenter size-full wp-image-2444741" src="../Images/6f39741b126038dd27bcccb6b3d58546.png" alt="" data-id="2444741" data-original-src="https://cdn.thenewstack.io/media/2017/06/3b3ed5d3-badge.png"/> </a></p>
<p class="translated">该徽章在正面集成了一个<a href="https://www.adafruit.com/product/358" class="ext-link" rel="external ">微型1.8英寸彩色TFT LCD显示屏</a>，没有普通的显示器、键盘或鼠标。它可以在小屏幕上自动播放宣传视频。LCD由一个面向内存的进程控制，称为帧缓冲区。</p>
<p class="translated">你不需要X Windows桌面(比如<a href="https://en.wikipedia.org/wiki/LXDE" class="ext-link" rel="external "> LXDE </a>)来运行带有帧缓冲区的视频。<a href="http://www.mplayerhq.hu/design7/news.html" class="ext-link" rel="external "> MPlayer viewer </a>支持使用帧缓冲区播放视频，所以这是我在蒸汽朋克徽章启动时自动启动的。</p>
<p class="translated">好的部分来了。通电后运行MPlayer只不过是在/etc/rc.local文件中添加一行。</p>
<p class="translated">/etc/rc.local在Linux成功引导到多用户模式后运行程序。只需将您的程序或脚本添加到文件的底部，保存它，下次重新启动时，您的程序将会执行。rc.local归root所有，所以您需要作为普通用户(例如pi)使用sudo编辑它。<br/></p>
<div id="crayon-642312547e90a873072515" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-h"> </span><span class="crayon-i">pi</span>-<span class="crayon-i">drtorq</span>%<span class="crayon-h">  </span><span class="crayon-e">sudo </span><span class="crayon-i">vi</span><span class="crayon-h"> </span>/<span class="crayon-i">etc</span>/<span class="crayon-i">rc</span><span class="crayon-st">.</span><span class="crayon-v">local</span>
</pre>
</div>
</div>

<p class="translated"><br/>这里有一个来自树莓派的蒸汽朋克会议徽章的例子:<br/></p>
<div id="crayon-642312547e911714133409" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-p">#!/bin/sh -e</span>
<span class="crayon-p">#</span>
<span class="crayon-p"># rc.local</span>
<span class="crayon-p">#</span>
<span class="crayon-p"># This script is executed at the end of each multi-user run-level.</span>
<span class="crayon-p"># Make sure that the script will "exit 0" on success or any other</span>
<span class="crayon-p"># value on error.</span>
<span class="crayon-p">#</span>
<span class="crayon-p"># In order to enable or disable this script just change the execution</span>
<span class="crayon-p"># bits.</span>
<span class="crayon-p">#</span>
<span class="crayon-p"># By default this script does nothing.</span>
 
<span class="crayon-i">mplayer</span><span class="crayon-h"> </span>-<span class="crayon-i">loop</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span>-<span class="crayon-e">vo </span><span class="crayon-i">fbdev2</span>:/<span class="crayon-i">dev</span>/<span class="crayon-i">fb1</span><span class="crayon-h"> </span>-<span class="crayon-st">x</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-h"> </span>-<span class="crayon-t">y</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span>-<span class="crayon-i">zoom</span><span class="crayon-h"> </span>-<span class="crayon-i">flip</span><span class="crayon-h"> </span>-<span class="crayon-e">vf </span><span class="crayon-i">rotate</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span>/<span class="crayon-i">home</span>/<span class="crayon-i">pi</span>/<span class="crayon-i">badge</span>-<span class="crayon-i">promo</span><span class="crayon-st">.</span><span class="crayon-i">mp4</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span>
 
<span class="crayon-i">exit</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>
</pre>
</div>
</div>

<p class="translated"><br/>在这种情况下，MPlayer从循环选项开始，因此视频连续运行。注意-vo选项指向帧缓冲设备。-x 160 -y 128设置屏幕尺寸以匹配1.8英寸LCD显示器的分辨率。您还需要在结尾处使用“&amp;”，以便MPlayer在后台运行。</p>
<p class="translated">如果我们使用nano-Linux微控制器作为笔记本电脑会怎么样？</p>
<h2 class="translated">使用X-Windows自动启动</h2>
<p class="translated">如果我们想在Pi引导到标准LXDE桌面屏幕后自动启动一个程序呢？也许我们不是作为一个会议徽章来运行，而是将Pi连接到一个显示器(或者一个很酷的7英寸彩色LCD显示器)、一个键盘和一个鼠标。</p>
<p class="translated">更多好消息。</p>
<p class="translated">让一个程序在标准的X-Windows桌面下自动运行也很简单。假设您以pi的身份登录，最简单的方法是编辑/home/pi/。配置/lxsession/LXDE-pi/autostart文件。</p>
<p class="translated">Autostart是LXDE桌面的标准会话管理器<a href="https://wiki.lxde.org/en/LXSession" class="ext-link" rel="external "> LXSession </a>的一部分。</p>
<p class="translated">将您想要运行的程序或脚本添加到自动启动文件中，以“@”开头。这里有一个例子。<br/></p>
<div id="crayon-642312547e913537538960" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre>@<span class="crayon-i">lxpanel</span><span class="crayon-h"> </span>--<span class="crayon-e">profile </span><span class="crayon-i">LXDE</span>-<span class="crayon-i">pi</span>
@<span class="crayon-i">pcmanfm</span><span class="crayon-h"> </span>--<span class="crayon-i">desktop</span><span class="crayon-h"> </span>--<span class="crayon-e">profile </span><span class="crayon-i">LXDE</span>-<span class="crayon-i">pi</span>
@<span class="crayon-i">xscreensaver</span><span class="crayon-h"> </span>-<span class="crayon-i">no</span>-<span class="crayon-i">splash</span>
@<span class="crayon-i">point</span>-<span class="crayon-i">rpi</span>
@/<span class="crayon-i">usr</span>/<span class="crayon-i">bin</span>/<span class="crayon-i">mplayer</span><span class="crayon-h"> </span>-<span class="crayon-i">loop</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span>-<span class="crayon-e">fs  </span><span class="crayon-i">drtorq</span>-<span class="crayon-i">promo</span><span class="crayon-st">.</span><span class="crayon-v">mp4</span>
</pre>
</div>
</div>

<p class="translated"><br/>一旦Pi引导进入LXDE桌面，MPlayer就会自动弹出并运行。“-loop 0”选项会永远循环播放视频。“-fs”选项打开全屏模式。点击“ESC ”,然后点击窗口顶部的“X”框，让视频消失。</p>
<h2 class="translated">后续步骤</h2>
<p class="translated">我们已经看到了一些在nano-Linux设备上自动启动程序的有用方法。我使用我的会议徽章上的能力来让事情进行下去。</p>
<p class="translated">这个概念很容易扩展。</p>
<p class="translated">Pi的自动停止就是一个很好的例子。每个人都知道你应该使用“关机”来正确地关闭你的Pi。如果你只是拔掉电源插头，你就有损坏micro-SD卡上数据的风险。在极少数情况下，如果卡损坏，Pi可能无法启动。不太好。</p>
<p class="translated">为什么不写一个小Python脚本，在按下GPIO连接的按钮时运行操作系统(OS)对“shutdown”命令的调用。启动后，脚本可能会启动并永远循环下去。</p>
<p class="translated">你可能会说这将是“自动化到底”</p>
<p class="attribution translated">特征图片:<a href="https://www.liberiangeek.net/2012/04/add-enable-screensavers-in-ubuntu-12-04-precise-pangolin/" class="ext-link" rel="external "> Gnome屏保</a>。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>