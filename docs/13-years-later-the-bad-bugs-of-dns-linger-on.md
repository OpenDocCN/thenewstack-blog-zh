# 13 年后，DNS 的坏毛病依然存在

> 原文：<https://thenewstack.io/13-years-later-the-bad-bugs-of-dns-linger-on/>

都 2023 年了，我们还在没有完全调试的情况下抄袭代码。我们没有从 2008 年的 DNS 大漏洞中吸取教训吗？不用担心，互联网教父保罗·维谢已经提供了如何做得更好的指导方针。

Vixie 是一位杰出的工程师，也是亚马逊网络服务[的安全副总裁](https://aws.amazon.com/?utm_content=inline-mention)(也是互联网成为“互联网”之前的[的贡献者)](https://thenewstack.io/paul-vixie-story-of-an-internet-hero/)[在都柏林举行的欧洲开源峰会上谈到了](https://aws.amazon.com/blogs/opensource/why-bad-bugs-in-dns-and-other-open-source-code-just-wont-go-away/)开源依赖的成本——他在最近的博客文章中再次提到了这个问题。都是强烈推荐观看和阅读的。

## **闪回 2008 年**

2008 年，安全专家[丹·卡明斯基](https://www.internethalloffame.org/inductee/dan-kaminsky/)发现了 DNS 代码中的一个基本设计缺陷，该缺陷允许任意的缓存中毒，影响了地球上几乎每一台 DNS 服务器。该补丁于 2008 年 7 月发布，随后于 2010 年发布了永久解决方案“域名安全扩展(DNSSEC)”。域名系统是互联网基本的基于名称的全球寻址系统，因此 DNS 中的漏洞可能会给互联网上的几乎每个人带来重大麻烦。

Vixie 和 Kaminsky“点燃了他们的头发”来建立安全漏洞解决方案，“13 年后，没有足够广泛地部署来解决这个问题，”Vixie 说。所有这些软件都是开源的和可检查的，但是 DNS 漏洞仍然引起了 Vixie 的注意。

“如果我们不开始写下人们在编写软件之前应该知道的教训，这将永远不会停止，”Vixie 说。

## **这到底是怎么回事？**

这是我们的错，“电话是从房子里面传来的。”在互联网商业化和家庭计算机房出现之前，UNIX 的 Berkley Software Distribution(BSD)发行商决定支持当时新的 DNS 协议。“制作一个新版本，制作磁带，并把它们都放进集装箱里是一项繁重的工作”,所以他们把 DNS 作为一个补丁发布到新闻组新闻组，通过 FTP 服务器和邮件列表提供给任何需要它的人。

当 Vixie 在伯克利开始研究 DNS 时，DNS 实际上已经被抛弃了，因为所有最初的创造者都已经离开了。由于没有导入代码和建立依赖关系的概念，嵌入式系统供应商复制了原始代码并更改了 API 名称以适应他们本地的工程需求… *这听起来很熟悉吧？*

然后 Linux 出现了。互联网 E-X-P-L-O-D-E-D。你有一个美国在线帐户。你会得到一个 AOL 帐户…

发行版必须构建他们的第一个 C 库，并复制一些旧的伯克利代码版本，不管他们是否知道这是什么。这是其他发行版正在使用的副本的副本，他们制作了一个永远脱离上游的本地版本。DSL 调制解调器就是一个早期的例子。现在，物联网无处不在，“数十亿台设备中的所有 DNS 代码都运行在伯克利在 1986 年发布的代码的某个分支上。”

这些有什么关系呢？最初的 DNS 错误是由 Vixie 编写和发布的。他接着在 90 年代对它们进行了修复，但有些至今仍在出现。“对于今天的嵌入式系统来说，仍然存在这个问题，任何这些问题，都意味着无论我做了什么来解决它都是不够的。我没有办法告诉人们。”

## **我们将何去何从？**

“如果我们在建造互联网的时候就已经有了互联网，那就太好了，”维谢说。但是，尽管我尽了最大努力，我们不能后退，只能前进。Vixie 说得很清楚，“如果你做不起这些事情[如下]，那么自由软件对你来说就太贵了。”

以下是 Vixie 给软件生产商的一些建议:

*   尽你所能利用你所拥有的工具，但是“试着预测你将要拥有的东西。”
*   假设所有的软件都有缺陷，“不仅仅是因为它总是有缺陷，而是因为这是安全的立场。”机器可读的更新是必要的，因为“你不能依靠人来监控邮件列表。”
*   版本号对于您的下游是必须的。“依赖你的人需要知道一些比你周二认为有用的东西更多的东西。”它是什么并不重要，只要它唯一地标识了软件的错误级别。
*   在源代码注释中引用自述文件中的代码源。它将帮助任何使用你的代码和追踪 bug 的人。
*   自动监控您的上游，审查所有更改，并集成补丁程序。“这不是可有可无的。”
*   让你的下游自动知道变化“否则这些 bug 会做 DNS bugs 正在做的事情。”

以下是给软件消费者的建议:

*   软件的依赖关系就是你的依赖关系。“作为消费者，当你导入某样东西时，记住你也在导入它所依赖的一切……所以当你检查你的依赖关系时，你必须递归地做，你必须一路向上。”
*   无契约依赖会使自由软件变得非常昂贵，但这是一个可以接受的操作风险，因为“我们需要其他人都在编写的软件。”孤立的依赖需要本地维护，这就存在风险，因为这比监控其他团队的开发成本要高得多。“要么是因为你雇佣了足够多的人，建立了足够多的自动化，要么是因为你没有，所以成本很高。”
*   (主要)自动化依赖项升级，因为有时“许可会从一个你可以忍受的许可变成一个你不能忍受的许可，或者在某个时候有人决定他们想要得到报酬”[在此插入冒险]。
*   指定可接受的版本号。如果版本 5+有你的软件需要的补丁，说出来以确保你不会意外地得到一个旧的。
*   监控你的供应链，每次放行都要开罚单。让一个工程师检查每一个更新，以确定它是否是“让我的头发着火，周末工作或者我们只是到时候再做”的优先级别。

他以“我们都在一起，但我认为我们可以把它组织得比现在更好”作为结束语。这的确是一种表达方式。

作为一个防止了潜在 DNS 崩溃的小团队的成员，一个在他们的领域中领先了一代人的人，必须有一定程度的谦逊和优雅，但仍然有他们早期职业生涯的错误(他们在 30 年前解决了)定期引起他们的注意，因为采纳者不会检查源代码。

[https://www.youtube.com/embed/hLq-y7GDkcM?feature=oembed](https://www.youtube.com/embed/hLq-y7GDkcM?feature=oembed)

视频

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>