# 设计如何影响云原生应用的安全性

> 原文：<https://thenewstack.io/how-design-impacts-the-security-of-cloud-native-applications/>

[Cloud Native Computing Foundation](http://cncf.io/)赞助了这篇文章，期待虚拟 [KubeCon + CloudNativeCon 北美 2020–虚拟](https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/)，11 月 17-20 日。

 [伊曼纽尔·德蒙皮翁

Emmanuelle 是法国云提供商 Scaleway 的 Kubernetes 产品经理。在几年前进入产品管理之前，她最初是一名 R&D 工程师，负责电信、广告和工业物联网等业务领域的数据相关产品。](https://www.linkedin.com/in/emmanuelle-demompion/) 

21 世纪的一切都是关于云原生应用，但设计容器化应用或微服务只是冰山一角。我们在设计中所做的事情需要把界限推得更远。

软件不仅仅是向客户提供服务，它还意味着高度可靠和可用。这只有通过严格限制开发过程，以及关注持续集成、交付和生产访问才能实现。

当然，作为开发人员，您不希望在创建软件、编写代码或定义 DockerFile 或等效文件时有太多限制。但是你必须认识到，你对自己和团队施加的约束越多，产出就越稳定。

然后当这些约束成为一种习惯，你甚至不会再注意到它们。与此同时，您将学到比预期更多的安全操作知识，改进您的入职流程，并使“投入生产”决策变得简单得多。

> Kubernetes 不是魔法。开始用的时候很失望，意识到自己生活的一部分已经被吸到 yaml 文件里了。也就是说，一旦你深入了解，你会发现它实际上可以成为各种生产环境的强大工具。

以前，当我们开发一个应用程序或产品时，我们通常遵循以下步骤(或多或少按照这个顺序):

1.  找到并确定你的市场需求。
2.  定义您的软件架构、数据库、模型等。
3.  编码。
4.  增加一些测试，CI/CD 流程。
5.  构建您的生产环境。
6.  投入生产。

这在以前是没问题的。至少，当您有一个好的系统管理员来保护您宝贵的服务器或实例的安全时。如果你幸运的话，作为一名开发人员，你实际上会讨厌他们——因为他们总是批评你做“你不应该做的”事情的方式。

取决于你这一代人，或者你所在的公司，你可能从未经历过这种情况。

但是现在，如果我们以稍微不同的方式做事，以确保我们提供给客户的东西确实是高度可靠的、可用的，并且是按照最佳实践构建的，会怎么样呢？

## 您的生产环境是关键

最后，我们知道工作负载的任何部分都可能崩溃——也就是说，除了生产环境之外的任何部分。客户在使用服务时永远不需要理解；他们终究要为此付出代价。他们是我们的第一批经销商，绝不能让他们失望。照顾他们是我们的主要责任。

你的生产系统和你的客户是相互依赖的。

我们的目标始终是避免停机时间，尽可能提供最好的服务。所以，与其把代码放在第一位，为什么不改变你的设计方式，从定义我们的产品架构开始呢？

你的数据库或者模型的选择可以等等，还有你的前端应用等等。

因此，让我们更新我们的产品创建流程:

1.  找到并确定你的市场需求。
2.  定义您的生产架构:您将需要的第三方类型、部署策略(CI/CD、工具等。)，容器技术。
3.  对于上面列出的每一项，定义与最大安全性的限制性方法相对应的准则。例如:
    *   为您的 docker 文件定义模板和指南
    *   列出并定义 webhooks 的配置，以检查文件修改(linter、模板、格式验证等)。).
    *   定义用户角色以及对每个项目和环境的访问权限。
4.  实现您定义的约束。
5.  现在，您可以自由地做出最后的架构决策(数据库或其他第三方)。
6.  在这种情况下，编码可能会有点受限，但这是最好的选择。
7.  投入生产。一切都准备好了，对吗？

对于每一个新的架构项目变更，遵循这一过程一开始可能会很耗时，但是如果我们着眼于全局，我们知道它将为您的团队构建一个坚如磐石的工作环境，并为您的客户构建可靠的软件。

## 确保 Kubernetes 炒作

开发人员选择使用 Kubernetes 有多种原因:好奇心、想要了解“新”技术、可伸缩性需求等等。

不幸的是，Kubernetes 不是魔术。开始用的时候很失望，意识到自己生活的一部分已经被吸到 yaml 文件里了。也就是说，一旦你深入了解，你会发现它实际上可以成为各种生产环境的强大工具。

我确信 Kubernetes 是一个值得发现和使用的工具，尽管它不像我们希望的那么简单。

此外，如果它是您的生产架构选择的一部分，那么它为您提供了一整套约束您的环境的可能性；以及其中部署的容器。

不幸的是，每个人都需要深入了解 Kubernetes 环境的配置才能发现这些可能性，因为它们在默认情况下没有嵌入到大多数托管的 Kubernetes 产品中。

此外，对于基于角色的访问控制(RBAC)，您可以在集群的所有层(从云到代码)上定义策略。

准入控制器将为您提供适用于部署到 Kubernetes 集群的所有对象的特定规则。这些允许您强制容器拉取策略、证书配置、pods 特权和访问等等。

这就是为什么定义 Kubernetes 对象、容器和 pod 之间的交互是至关重要的。在您的生产启动并运行之后，根据需要划定限制，以确保所有对象都重新部署并符合新策略，这可能是一个真正的挑战。

## 第三方和代码—安全影响

由你来选择你需要哪些工具或外部服务来创建你的产品或软件，但是证明这种选择及其相关风险的责任落在每个人身上。

作为一名开发人员，几年前我并没有真正考虑过我所使用的第三方存在的安全问题——比如 Cassandra、Redis、PostgreSQL、ElasticSearch、Kibana 等等。

我会举起我的手说，我真的从来没有调查过安全方面的事情。我使用这些工具完全是为了它们所服务的目的。

像所有软件一样，第三方也有一个缺点:它都是由人类编写的，而且，正如我们所知，我们并不完美…我们的代码也是如此。每次使用外部工具时，都应遵守安全评估流程。使用不完美的工具是可以的，只要我们了解它，并且能够集成必要的安全层。

代码安全问题也会影响我们自己的代码。例如，我们使用多个库(有时甚至是同一个库的不同版本),但是我们很少更新版本和相关的代码，删除不赞成使用的功能，在漏洞警报后应用补丁等等。

## 速度永远不能胜过安全

如今，我们需要加快速度。不幸的是，速度提升会直接影响我们产品的安全性和可靠性，使我们容易受到攻击，并影响我们服务的可用性。这反过来会影响我们的客户。

我们为我们的产品和客户而工作。然而，有时候，达到我们目的的最好方法是后退一步，看看我们的错误，并从中吸取教训。

对你的客户来说，可靠性就是一切，如果你问他们，他们肯定会告诉你，他们把可靠性看得比最后期限更重要。

*要了解更多关于 Kubernetes 和其他云原生技术的信息，请考虑参加于 11 月 17 日至 20 日在举行的 [KubeCon + CloudNativeCon 北美 2020 大会。](https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/)*

云计算原生计算基金会是新堆栈的赞助商。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>