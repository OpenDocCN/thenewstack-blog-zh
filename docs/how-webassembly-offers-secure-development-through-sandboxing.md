# WebAssembly 如何通过沙箱提供安全开发

> 原文：<https://thenewstack.io/how-webassembly-offers-secure-development-through-sandboxing/>

WebAssembly 越来越受欢迎——最近的云本地计算基金会[调查](https://www.cncf.io/reports/cncf-annual-survey-2022/)发现，37%的组织已经部署了利用该技术的应用。随着越来越多的组织发现它的用途，其核心的一些基本原则提供了关键级别的安全性。

Cosmonic 首席执行官 Liam Randall 告诉新堆栈，将 WebAssembly 视为世界上最小的虚拟机是有意义的。“把它想象成一个小 CPU，”他说。"它非常安全，因为它使用沙盒内存，并使用默认拒绝功能."

Randall 说，默认拒绝是一个重要的区别。“这是与容器相反的方法，在那里你开始完全打开，然后你需要返回并从那里关闭一切，”他说。"在这里，你从关闭所有应用程序开始."

想象一下，您被要求允许浏览器访问您的麦克风和摄像头进行视频通话。兰德尔说:“在没有明确获得许可的情况下，你的 WebAssembly 进程不能访问任何文件或文件夹或设备……所以在你运行一个应用程序之前，你可以了解它有什么功能，并了解运行它的影响。”

## 保持控制

InfinyOn 创始人兼首席技术官 Sehyo Chang 告诉 New Stack，他公司的 Fluvio 数据流平台依赖于这种沙盒级别来最大限度地提高安全性。“它的工作方式是它不进行任何系统调用…所以我们可以确保它不会造成任何损害，”他说。

Chang 说，即使 InfinyOn 在探索实现更多的功能，它也可以继续保持控制。他说:“与其进行任意的 HTTP 调用，也许我们可以用沙箱保护它，使它只允许特定的一组 HTTP 调用——不一定要像狂野西部那样。”

不过，Chang 说，重要的是要记住 WebAssembly 本身并不能保证安全性。“我们仍然必须确保代码是安全的，确保依赖性被锁定——这不会消失，”他说。"只是有了 WebAssembly，导致安全漏洞的机会就少了."

所以对于开发者来说，所有的标准预防措施仍然是有意义的。“只是因为你引入了一种新的工具，这并没有跳过你以前做过的所有清单…这只是意味着有了 WebAssembly，你有了一个良好的基础和更多的方法来利用它，”常说。

## 支持 API

Fermyon 首席执行官马特·布彻说，这就是 WebAssembly 系统界面 [WASI](https://thenewstack.io/webassembly-to-let-developers-combine-languages/) 的用武之地。“WASI 的提案诞生于为 WebAssembly 模块建立一种方式的愿望，这种方式可以说，‘我想做一些事情，比如访问看起来像文件的东西，访问看起来像环境变量的东西，访问看起来像系统时钟或随机数生成器的东西。’"

“WASI 的重点是在这方面给出很多指导，并说，‘这是它应该如何工作，这是你想要知道的，这是我们将要使用的 API，’”Butcher 说。

尽管如此，具体细节仍然取决于主机运行时。“运行时可以让它访问文件系统，或者让它有限地访问一组预先打开的文件，或者在内存中伪造一个文件系统，或者真正做它想做的任何事情——这只是说，‘我正在向你展示一个对你来说看起来像文件系统的东西，’”Butcher 说。

在大多数情况下，当功能增加时，系统仍然是安全的。“例如，Fermyon 实现文件系统接口的方式，你永远不会真正深入到文件系统中——你总是得到文件系统的内存克隆，”Butcher 说。

## 评估运行时间

虽然不同的 WebAssembly 运行时有不同的优势，但许多运行时都提供了额外的安全性增强。“字节码联盟的 [Wasmtime](https://thenewstack.io/webassemblys-wasmtime-1-0-revamps-security-performance/) 提供了一个沙箱，你得到了隔离的线性内存，你得到了缓冲区溢出预防，并且模块在运行时不能被修改，”Randall 说。"所以从安全的角度来看，运行时本身给了你大量的基本提升."

Butcher 认为，随着时间的推移，WebAssembly 运行时的范围可能会缩小，而那些最关注安全性的运行时将会存活下来。“这就是为什么 Fermyon 说 Wasmtime 由一个社区来管理的原因之一，这个社区有 Red Hat、微软、谷歌和亚马逊等大型参与者，他们都非常关心安全模型，对我们来说，这比编写我们自己的 WebAssembly 解释器更安全——我们本来可以在技术层面上完成，但所有这些都变成了我们的责任，”他说。

所有那些关注 Wasmtime 的人都有一个固有的好处。Butcher 提到了 Frank Denis 最近的一篇帖子，该帖子暗示 Wasmtime 披露了过去一年中[的几个漏洞](https://www.opencve.io/cve?vendor=bytecodealliance&product=wasmtime)，这实际上是一个好迹象，而不是一个令人担忧的原因。“正如弗兰克所表达的那样，当 WebAssembly 运行时不公布安全漏洞时，我们应该有理由持怀疑态度，因为一方面，它们可能真的真的很好，但另一方面，它们可能不太关心安全，”他说。

## 维护安全

Randall 说，最终，WebAssembly 为开发者提供了比以前技术更高的安全壁垒。他说:“这在某种程度上是对过去的突破，它始于像默认拒绝这样的首要原则。”"作为开发的起点，这些东西使得 WebAssembly 更加安全."

Butcher 说没有理由认为 WebAssembly 不能保持一个坚固的系统。“问题是，打破这种局面的首要方法是开始在沙盒上戳洞……这就是为什么我认为 WASI 标准进展非常缓慢，也是为什么支持 WASI 的人支持一个更慢、更谨慎的过程，”他说。

布彻说，这种谨慎是关键。“最初的那个非常非常安全，比 JavaScript 安全沙箱强得多，因为访客模块什么也做不了，”他说。“我们希望将它移动到足够的右侧，这样我们就可以做我们作为开发人员真正需要做的事情……但不能冒暴露太多攻击面的风险。”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>