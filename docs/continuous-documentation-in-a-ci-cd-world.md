# CI/CD 世界中的连续文档

> 原文：<https://thenewstack.io/continuous-documentation-in-a-ci-cd-world/>

我们不断整合。我们不断部署。我们不断测试和监控。然后我们在事后写文档。当涉及到文档时，我们为什么要暂停连续性——帮助用户实际使用我们产品的东西？

因为没有人愿意做，因为这似乎是我们正常工作流程中的一项辅助性工作。

正如数字海洋的开发者倡导者 T2 梅森·艾格所说:“本世纪的‘去喝咖啡’现在是‘去写文件’。”

这种拖延只会加大代码实现者和文档之间的距离，也就是说，虽然文档经常存在，但它们往往是不准确或过时的。

但是如果开发者要使用你的软件，文档实际上是成败的关键——因为没有有用的文档，他们就不知道如何使用它。

> “我们生活在一个需要进行大量自述文件工程的世界中，如果我不能在阅读您的自述文件的时间内启动并运行您的产品，我会选择另一个具有更好文档的产品。”— Mason Egger，数字海洋

因此，行业需要持续的文档，或者如 Egger 所称的，持续集成文档，或者简单地构建像代码一样的文档。

这篇文章旨在理解什么是连续文档，以及如何使它不仅成为你的 CI/CD 管道的一部分，而且成为你的公司文化的一部分。

## 什么是连续文档？

![](img/04ea23ae5d29bfceebf8860e92c30ee9.png)对于 Egger 来说，不仅仅是新的特性和代码需要记录，而是任何真正有用的东西，比如错误修复、如何使用代码以及如何开始。他说，作为一等公民，医生授权开发人员按照你希望的方式使用你的工具。毕竟，艾格说，人们可以创造性地使用产品。

“如果你没有明确地说‘这是我的工具做的事情’，那么他们可能会以你想象不到的方式使用它，而你可能会在很长一段时间内支持它，”他解释道。

持续记录被[视为核心敏捷实践](http://agilemodeling.com/essays/documentContinuously.htm)——尽管仍然只有一些人在实践。这是合乎逻辑的，因为敏捷性是关于快速地向您的利益相关者交付价值，并且文档是软件用户一致需要的。

有些人甚至称之为“可交付的文档”，因为在它被文档化之前，你不能交付代码。这意味着，如果你持续地交付，你需要持续地记录。

当然，还有像鲍勃·马歇尔这样的人，他们认为任何事后测试和文档记录的需求都意味着你无法构建出高质量的、简单的代码。

> “有了 agile，您的文档一发布就过时了——当您的产品更新时，您的文档也需要更新。”— Margaret Fero，技术作家

在 [CI/CD](https://thenewstack.io/category/ci-cd/) 和 [DevOps](https://thenewstack.io/category/devops/) 的世界里，以同样的方式我们已经自动化了我们的部署和构建，我们需要自动化我们的文档，所以它保持相关。

对于 Amalgam Insights 研究员 Tom Petrocelli 来说，许多公司都是从持续文档开始 CI/CD 的。如果他们已经有文档作为他们发布的一部分，当他们开始测试他们的管道时，他们接着继续，然后编码，向后工作来创建一个连续的交付管道。

他说 CI/CD 在逻辑上实现了连续文档的自动化。

> “当你进行确定性设计时，它变得不言自明。之前我不得不写一本手册告诉我我的系统做了什么。现在我把这个写成代码。”— Tom Petrocelli，汞合金洞察

这可以是 YAML 或 JSON 的纯文本，放在代码旁边。

对于 Petrocelli 来说，连续文件很难与 CI/CD 管道分开。由于连续文档通常是作为代码的文档，它被更多地视为自文档。这一过程也吸引了那些需要遵守大量法规的行业。他说，你只是简单地教合规人员阅读代码，而不是业务分析师在他们审查之前将其全部翻译成简单的英语。

出于本文的考虑，让我们将连续文档定义为，不令人吃惊的，连续的和至少有些自动化的。就像翻译一样，我们相信，在可预见的未来，科技作家将需要为这一人性化工具增添人情味。

## 连续文档也是一种文化变革

连续文档不仅仅是另一段代码，它需要文化和过程的改变。医生之间有一种传递烫手山芋的文化，你不想做，也许实习生会做？文档作者发现他们需要向技术团队的其他成员推销连续文档的价值。

![](img/78285d4d93d5110c4e39eea5cca0d154.png)

> “我发现一个问题是，许多开发人员/产品负责人不知道文档团队做什么或能做什么——他们模糊地认为这与篡改文字或写一本没有人真正阅读的书有关。”—玛丽亚·德沃托，阿普纽斯

[AppNexus](https://www.linkedin.com/in/marya-devoto-1a4b45/)的高级技术作家玛丽亚·德沃托在 Slack 上评论道:“我发现午餐时间的谈话有助于开发人员理解文档的工作很像代码——规划、测试交互、维护，旧的劣质东西随着时间的推移会妨碍新的内容——以及我们如何实际上使产品体验更好是富有成效的——也是有趣的。”

做了 15 年的技术作家后， [Margaret Fero](https://twitter.com/maggiefero) 不认为连续文档可以在一夜之间打开。如果你没有对文档进行优先排序，你就不会有团队来支持它。首先，你需要养成为文档多做贡献的习惯。

一旦你有了一个正常运行的文档系统，你就可以向更短的交付窗口迈进。

Fero 说:“如果你已经有了一个工作文档流程和一个 CI 流程，那么将这两者结合起来并进行合并会容易得多。

大多数应用程序团队将不得不逐步建立连续的文档。

Fero 说要寻找技术博士最接近的团队。如果文档更接近产品团队，那么他们会说完成文档更容易。如果文档更接近开发团队，那么当与问题通知集成时，连续文档会工作得更好。

Fero 说，通过这种方式，你可以达到记录-相等-完成。

Egger 同意:“如果你把文档作为一个故事建立到你的 sprint 中，这很好，你有时间写好文档。当你在吉拉创作一个故事时，代码就是一项任务——没有单元测试和必要的文档更新，你就不能结束一个故事。”

他继续说，即使是内部文档也应该是“完成”的考虑因素，至少在处理底层基础设施变更时是如此。

不足为奇的是，他还主张你的文档应该成为你的 CI/CD 管道的一部分，使文档成为你的代码可交付物的一部分，同时发布。

## 开始使用连续文档

Fero 提供了一种简单而广泛的解决方案——棉绒，因为团队可能已经在使用棉绒了。linter 是一种自动分析源代码的工具，可以标记和修复编程错误、bug 和任何可疑之处，但也可以像拼写检查器一样使用，还可以标记风格错误。Linters 不仅引入了连续的文档，而且将内部风格和一致的格式引入到您的自动化连续集成管道中。他们说，linter 会检查任何客观错误，这些错误可能会在文档与常规代码一起提交之前偷偷通过。

他们说，“每次我解决一个重复出现的或重大的问题，我就实施了一个”换人行动。

Egger 说，你可以做到这一点的一个方法是让文档靠近你的用户，使用一些简单的东西，如 WYSIWYG 编辑器或 markdown。他提供了 MkDocs，这是一个简单的基于 Python 的工具，用于为 markdown 生成静态站点。他说，MkDocs 插件允许你做很多事情，包括将代码片段与你的库进行对比，以查看代码是否正确，有时还能发现单元测试没有发现的东西。

您还需要确保您有一个允许您的开发人员将文档编写成代码的工具。Egger 提供了用于 Python 的[DocSphinx](https://www.sphinx-doc.org/en/master/usage/extensions/graphviz.html)，用于从 Java 源代码生成 HTML 文档的[Javadoc](https://en.wikipedia.org/wiki/Javadoc)，以及用于 Ruby 文档的[Ruby doc](https://ruby-doc.org/)以方便使用。

Linters 有助于防止重复错误，但是开发人员也必须成为任何连续文档过程的一部分。Fero 说，特别是当一个开发人员同时也是特性所有者的时候，开发人员有责任在能够点击 Done 之前跟进文档。

“开发人员应该负责确保提交内容中出现的任何单词都被标记为风格和正确性——确保代码的功能应该以某种形式记录下来，无论你的 lInter 要求它是什么形式，”他们解释道。

Fero 继续说，这应该会触发一个通知，通知技术作者或发布代码的团队变更已经实现。然后他们会问:现在需要改变文档吗？

他们解释说，“有一个特别的技术作家的价值是确保软件和软件的功能将被交流。”

Fero 说，这不仅仅是正确的英语，而是通用语——它也是非英语母语者之间的一个交流点。尤其是对于开源社区来说，英语是一个持续的障碍。Egger 认为 Django 在语言本地化方面做得很好。

技术作家还负责确保[的文件仍然可以访问](/accessibility-as-an-essential-part-of-the-inclusive-developer-experience/)。Fero 说，这里也可以使用 linter，比如确保每个图像都有 alt 文本，或者标记任何没有标签的按钮。因为 linter 是避免重复错误的最好方法，所以他们总是用普通的标签标记链接，比如“这里”,这对阅读器和屏幕阅读器来说没有什么价值。

### 连续文档生活在哪里？

如果连续文档最重要的部分是以某种形式记录代码功能，那么文档需要尽可能地接近代码。

对于 Fero，如果您使用 Github 流，文档应该在您的提交消息中。您的拉式请求概述注释应该包括一般功能是什么。

他们说如果你没有使用那个流程或者工具，那么你可能想在你的 bug 追踪器或者 wiki 页面中做它。他们说这个决定完全取决于你的组织在列举和分解功能方面做得有多好。

“你不希望注释中有太多应该在代码中显而易见的东西。

Fero 解释说:“如果参数发生了复杂的变化或者进行了精确的调整，你并不总能一眼看出这与什么相互作用。

特别是在 CI/CD 中，您需要经常确保您没有阻碍发布过程。Fero 建议团队专注于按需问题自动化，比如在每天结束时计划 20 分钟的文档分类期。

有很多工具试图帮助文档的持续集成，包括 OpenAPI(以前的 Swagger)和 Javadoc comments，但 Fero 警告说，这些工具通常会自动化参考文档——这有所帮助，但还不够。

更丰富的文档也需要以任务和概念为中心。

Fero 解释说:“对于文字处理软件来说，没有概念性的文档是可以的，但是对于 Docker 来说，你需要关于容器化的材料，把它的用途放在上下文中。”

“你需要基于任务的文档，这样人们就可以弄清楚他们想要工作的一般流程。”

关于连续文档的其他资源:

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>