# Kinsing 恶意软件针对 Kubernetes

> 原文：<https://thenewstack.io/kinsing-malware-targets-kubernetes/>

总是有事！Linux 管理员早就知道这种近亲恶意软件了，现在，令人惊讶的是！—它也在追逐 Kubernetes。

[Kinsing](https://www.cyberark.com/resources/threat-research-blog/kinsing-the-malware-with-two-faces) 是一个老派的 Linux/Unix 可执行和链接格式(ELF)恶意程序，用 Go 编写。只要有机会，它就会运行一个密码挖掘器，并试图将自己传播到其他容器和主机。多年来，它已经被用于攻击[码头](https://blog.aquasec.com/threat-alert-kinsing-malware-container-vulnerability)、[雷迪斯](https://blog.trendmicro.com/trendlabs-security-intelligence/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining/)和[盐栈](https://redcanary.com/blog/kinsing-malware-citrix-saltstack/)。而且，现在，现在，Kinsing 黑客们正在追杀 Kubernetes。我很震惊，很震惊地发现库伯内特斯正在进行密码开采！

不是。

微软云安全研究人员 Sunders Bruskin 正在报告如何使用两种不同的初始访问向量技术来针对 Kubernetes 集群。这些攻击利用了配置不完善的 [PostgreSQL](https://www.postgresql.org/) 容器和易受攻击的映像。

换句话说，这就是你所期望的。锁定您的 PostgreSQL 设置，并检查您的图像的安全弱点。没那么难。

Microsoft 发现了许多易受远程代码执行攻击的图像。这使得具有网络访问权限的攻击者能够利用该容器并运行他们的恶意负载。特别是，

发现以下应用程序映像具有易受攻击的版本:

*   PHPUnit
*   救生筏
*   中间件
*   wordpress 软件

微软选择了 Oracle WebLogic 作为最好的例子。尽管我很喜欢挑甲骨文的毛病，但这不是他们的错。2020 年，甲骨文披露了三个允许远程代码执行的严重漏洞: [CVE-2020-14882](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-14882) 、 [CVE-2020-14750](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-14750) 和 [CVE-2020-14883](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-14883) 。但是，是否每个人都采用了修复版本并构建了安全映像？不，不，他们没有。

白痴。

最近，微软发现了一个广泛的亲缘关系运动，它针对易受攻击的 WebLogic 服务器。攻击从扫描 IP 地址并寻找与 WebLogic 默认端口(7001)匹配的开放端口开始。一旦发现潜在的受害者，它就使用 curl 和 Bash 在系统中加载亲缘关系。

微软提到，当然，微软云卫士，可以识别这种行为。

此类警报的示例包括:

*   文件已被下载并执行–文件已被下载到容器，被赋予执行权限，然后被执行。
*   检测到与常见 Linux 僵尸程序类似的行为–执行与常见 Linux 僵尸网络相关的进程。
*   检测到可疑文件下载–可以识别可能对主机构成风险的可疑二进制文件下载。
*   可疑下载，然后运行活动–查找已下载并执行的可疑文件。

其他云安全程序也可以做到这一点。你在用一个，对吗？对！？

除此之外，通过使用已知的、可信的注册表中的映像，并确保将它修补到最新版本，从一开始就阻止感染的发生。顺便说一下，那就是 Oracle WebLogic Server 14.1.x。

另一种流行的隐藏亲缘关系的方法是利用弱配置的 PostgreSQL 实例。这些错误配置包括:

使用“信任身份验证”设置。这不是个好主意。正如 PostgreSQL 所述:“当指定了信任认证时， [PostgreSQL 假定任何可以连接到服务器的人都被授权使用他们指定的任何数据库用户名(甚至是超级用户名)访问数据库](https://www.postgresql.org/docs/current/auth-trust.html)。”拜托，为了你的云和小猫的爱，不要使用信任认证。这是一个伪装成功能的安全漏洞。

此外，在某些配置中，PostgreSQL 将接受来自任何 IP 地址的连接。我说的“任何”就是任何。例如，它可以接受 0.0.0.0/0 作为好地址。哦，在这样的配置中，攻击者可以自由地连接到 PostgreSQL 服务器，而无需认证。就我个人而言，我会对任何在生产机器上使用 PostgreSQL 实例的人做出非常非常糟糕的事情。见鬼，甚至是一个测试实例！

最后，一些 Kubernetes 网络配置容易出现 [ARP 中毒](https://www.varonis.com/blog/arp-poisoning)。这使得攻击者能够模拟群集中的应用程序。因此，即使在“信任”配置中指定私有 IP 地址，也可能会带来安全风险。

让我为你使它变得简单。使用 [PostgreSQL 的最佳安全实践](https://www.enterprisedb.com/blog/how-to-secure-postgresql-security-hardening-best-practices-checklist-tips-encryption-authentication-vulnerabilities)。将此设置为所有 PostgreSQL 实例的默认设置，您将会更加安全，不仅不会受到亲缘关系攻击，还会受到其他攻击。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>