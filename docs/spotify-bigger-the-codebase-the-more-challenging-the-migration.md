# Spotify:代码库越大，迁移的挑战就越大

> 原文：<https://thenewstack.io/spotify-bigger-the-codebase-the-more-challenging-the-migration/>

这是另一篇关于平台迁移的文章。但这一个是不同的，童子军荣誉(充分披露，虽然它确实包括每个人最喜欢的话题——[技术债务](https://thenewstack.io/cloud-native-softwares-technical-debt-is-growing/))。这些信息来自 [Spotify](https://newsroom.spotify.com/company-info/) ，这是一个很好的来源，因为他们的移动代码基数在不断增长，2019 年增长 29%，2020 年增长 49%，2021 年增长 23%。更多功能，更多体验，更多工程师。网站还在继续工作。

一年半前，平台团队开始了平台迁移计划，移动工程战略计划致力于多次迁移，以允许在隔离环境中开发客户端功能，类似于后端微服务。

Spotify 员工工程师 Mariana ardo ino[和 Spotify 工程经理 Raul Herbster](https://www.linkedin.com/in/mariana-ardoino-16171334/) 撰写的一篇[博客文章](https://engineering.atspotify.com/2022/11/strategies-and-tools-for-performing-migrations-on-platform/)断言:“这些平台产品中的一些本质上需要迁移，并且可能是大规模的，我们应该将它们与测试和设计一起视为开发生命周期的一部分。

这篇文章描述了管理平台迁移的样子，而不是代码库的样子。

Spotify 认为代码库越大，迁移的挑战就越大。由于组织只会变得越来越大，工程师们会发现，具有挑战性的迁移将成为大规模交付高效平台解决方案的新常态。经历过这些之后，Spotify 的团队有一些关于它的智慧可以分享。

## **定义范围**

之前的画面看起来很不可收拾。在考虑技术债务之前，需要对必须解决的几个用例进行大量的更改。增加压力的是利益相关者/上层管理人员…

Spotify 建议从小处着手，通过寻找可管理性来扩大规模。定义产品的目标和价值，并以此创建产品简介。一旦解决了“是什么”、“为什么”和“如何”,就很容易与其他人交流并分享想法、计划和预测。

该开始的时候就从小事做起。创建概念证明，与利益相关者/高层管理人员一起验证，并通过 alpha、beta 和 GA 产品生命周期完成迁移。当用例被发现时，一个接一个地添加进去。寻找渴望尝试您的解决方案、协作、获得反馈的早期采用者。

## **向上扩展**

你如何解决交通堵塞？大量的团队受到变更的影响，有许多工作要做，包括手动变更，工作进展缓慢，管理层再一次对变更感到困惑和沮丧…

解决交通堵塞的办法是想办法让事情重新运转起来。这里有几种方法可以做到这一点。  一种选择，如果有大量工作就考虑自动化。转向自动化程度更高的系统是否值得？如果许多手动平台迁移可以用脚本来更改，那么答案可能是肯定的。

另一个选择是增加努力。Spotify 建议为高峰周留出时间。与其他工程团队合作，共同投入时间进行迁移。

教育和培训也是一个可靠的方法。尽早并正确地采用这项技术也将推动事情向前发展。对于手动或自动迁移，有关新技术、最佳实践和新概念的培训非常重要。

## **确定优先事项**

这绝对不是平台工程迁移问题。可以写一整篇文章来讨论长期待办事项列表(即技术债务)和不断增加的永无止境的新任务之间的平衡。

Spotify 提供的解决方案也不是特定于平台工程迁移的解决方案，而是一个非常通用的解决方案。持续进行评估。一个建议是每季度检查点，以查看当前形式的迁移与下一步目标和理想时间表的积极方面。管理风险，决定迁移是有原因的。目标应该简化吗？雇佣承包商会改变吗？一切都是一成不变的，包括新的项目优先级、迁移优先级和目标。

## **负责**

正在进行的大型基础架构变更可能会让一些团队失去兴趣，这可能会导致教育和采用方面的问题，其长期影响可能是更长的迁移时间，这是任何人都不希望看到的。

基础设施的改变并不一定是编码中最令人兴奋的部分，尽管平台工程在这些日子里正获得它的光辉时刻。让其他人参与迁移类似于让人们参与其他任何事情。包括并通知他们。

合作和通知他人的技巧从平台工程团队的可靠路线图开始。一旦内部目标和任务被组织和明确，就更容易与其他人形成统一战线。用图表和模型展示流程；仪表板也是一个很好的工具。共享关于迁移何时进行、何时不进行的清晰信息。尽可能包括任何具体的开始和结束日期。

## **结论**

大型复杂的迁徙。没有他们，某些改变可能是不可能的。这就是技术社区生活或将要生活的世界的现实。新技术和不断发展的生态系统无疑将有助于推动这些迁移。它们需要很长的时间、大量的耐心和监督，除了代码之外，还包括人员管理、期望和理解。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>