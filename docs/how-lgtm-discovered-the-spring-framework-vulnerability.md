# lgtm 是如何发现 Spring 框架漏洞的

> 原文：<https://thenewstack.io/how-lgtm-discovered-the-spring-framework-vulnerability/>

由于一个严重的远程代码执行漏洞，lgtm.com 的安全研究人员敦促 Pivotal Spring 框架的用户升级到最新版本。

该漏洞允许攻击者在任何运行使用 [Spring Data REST](https://projects.spring.io/spring-data/) 构建的应用程序的机器上执行任意命令。该公司将升级描述为“当务之急”Spring Data REST 组件作为各种其他 Spring 项目的一部分分发，包括 [Spring Boot](https://projects.spring.io/spring-boot/) 框架。

根据[分析公司 RedMonk](http://redmonk.com/fryan/2017/06/22/language-framework-popularity-a-look-at-java-june-2017/) 的说法，Spring Framework 是[最流行的构建 web 应用](http://redmonk.com/fryan/2017/06/22/language-framework-popularity-a-look-at-java-june-2017/)的平台。

“不幸的是，Spring Data REST 中的这个漏洞非常容易被利用。母公司 Semmle 的研究员 Man Yue Mo 说:“由于 RESTful APIs 被公开访问是很常见的，这可能会让坏人很容易地控制生产服务器并获取敏感的用户数据。

莫去年秋天也发现了 Apache Struts 的漏洞。

在一篇关于他如何使用 lgtm 工具发现 Spring 漏洞的博客文章中，Mo 解释说，它使攻击者能够发送带有恶意制作的 JSON 数据的补丁请求，以在服务器上运行任意代码。他说，当报告给 Pivotal 时，它迅速做出反应，提供了一种阻止远程输入的方法。

Semmle CEO [Oege de Moor](https://www.linkedin.com/in/oegedemoor/) 称 Pivotal Spring 漏洞的发现使用了变体分析，这是 lgtm 应该如何使用的一个例子。

基于牛津大学在编译器和数据分析方面的研究， [Semmle](https://semmle.com/) 提供软件工程生产率分析及其代码探索工具 lgtm，它的名字来自代码评审署名“看起来不错”

它的技术将一个代码库转化为文本，可以通过查询来发现漏洞和错误。

“每当你使用来自未经检查的来源的数据时，你必须非常小心地保护自己免受各种漏洞的攻击。一个例子是数据从不可信用户流向 Java 中的反序列化方法。产品经理 Bas van Schalk 说:“因此，我们从数据进入应用程序的地方一直跟踪数据，直到数据以危险的方式被使用，我们标记出哪里存在问题。

虽然安全性是许多客户关注的焦点，但它还有其他用途。数据科学家 [Albert Ziegler](https://www.linkedin.com/in/albert-ziegler-6b3b24138/) 写了它在减少测试警报方面的用途。

“您可能已经知道一个存在的 bug，但是您希望找到所有发生相同逻辑错误的地方。我们的技术允许你在你的代码库中写一个查询并找到它们；然后，它会不断地寻找，以确保同样的错误不会再次发生，”de Moor 说。

一家投资公司在更新一个有 30 年历史的代码库时使用它来跟踪库中的依赖项，并在假期员工人数较少时让新员工承担实际工作。

总部设在旧金山，在牛津、纽约和哥本哈根也设有办事处。客户包括[花旗](https://en.wikipedia.org/wiki/Citigroup)、[瑞士瑞信银行](https://en.wikipedia.org/wiki/Credit_Suisse)、 [NASA](https://en.wikipedia.org/wiki/NASA) 和[戴尔](https://en.wikipedia.org/wiki/Dell_Computer)。

它将代码视为数据库。

“如果你有像 Java 或 C++这样的编译语言，我们可以准确观察编译器正在处理什么样的图块，并将源代码中的信息以关系形式存储在文本文件中。所以你得到一个函数表，一个表达式表，一个变量表。因此，分析[涉及]对关系数据库的查询，”de Moor 谈到其定制技术时说。

它还开发了 QL 查询语言，语法类似于 SQL，但 QL 的语义基于 [Datalog](https://en.wikipedia.org/wiki/Datalog) ，这是一种在学术界有着悠久历史的声明式逻辑编程语言。QL 的所有操作都是逻辑操作。它从 Datalog 继承了递归谓词，并增加了对聚合的支持，简化了复杂的查询。

代码分析领域的竞争者包括 [Coverity](https://www.synopsys.com/software-integrity/security-testing/static-analysis-sast.html) ，现在是 Synopsis 的一部分；[设防](https://software.microfocus.com/en-us/products/static-code-analysis-sast/overview)，现在部分微聚焦；还有 [Checkmarx](https://www.checkmarx.com/) ，尽管 Semmle 吹捧 lgtm 使得创建新的分析变得极其容易。

美国宇航局喷气推进实验室报告称，一项代码审查竞争对手在其火星探测器好奇号的关键进入、下降和着陆软件中遗漏了一个缺陷。对其他潜在漏洞的担忧促使 lgtm 进行了审查。在 20 分钟内，它定义了一个新的规则来查询缺陷的其他实例，并在代码的其他地方找到了 30 个相关案例。美国宇航局的工程师能够及时修复它们，以确保在火星上安全着陆。

除了企业客户之外，lgtm 还与开源项目合作来改进他们的代码。它处理存储在 GitHub 或 Bitbucket Cloud 上的公共 Git 存储库中的代码。

它支持 C 和 C++(目前正在测试)、Java、JavaScript/TypeScript 和 Python 中的项目，并分析提交到默认分支的项目的每个修订。它对问题发出警报，并将它们与新的或固定的警报列表进行比较。

在代码分析方面，以色列安全初创公司 [Intezer](http://www.intezer.com/) 以其所谓的“软件的 DNA 映射”来看待人体的免疫系统，并通过为世界上所有代码提供搜索引擎来实现其成为“二进制代码的谷歌”的目标。

另一家有趣的初创公司建立了一个源代码数据库，尽管不是专门与安全相关的，source{d}挖掘了一个基于 5700 万公共 Git 存储库的数据集——数百万亿字节的源代码——以训练机器学习模型理解自然语言、意图和相似性。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>