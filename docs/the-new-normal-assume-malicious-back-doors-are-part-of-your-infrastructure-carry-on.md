# 新常态:假设恶意后门是你的基础设施的一部分，继续下去

> 原文：<https://thenewstack.io/the-new-normal-assume-malicious-back-doors-are-part-of-your-infrastructure-carry-on/>

[](https://www.linkedin.com/in/talmklein/)

 [塔尔·克莱因

Tal 是行业领先的自主云工作负载保护平台 Rezilion 的 CMO。他在 IT 和信息安全行业拥有 20 多年的经验，与云安全、客户端虚拟化、网络和数据通信领域的领导者和令人兴奋的新兴供应商合作。](https://www.linkedin.com/in/talmklein/) [](https://www.linkedin.com/in/talmklein/)

如果我让你闭上眼睛，想象你的基础设施中现在有一个太阳风式的后门，会怎么样？你会恐慌吗？你应该吗？

我相信这里的一些读者还记得 2013 年的 Bit9(现在是 VMware 炭黑的一部分)[漏洞，其中恶意行为者破坏了 Bit9 的白名单软件，使他们能够推出合法签名的恶意软件。每隔几年，就会发现一个关键的基础设施被入侵，每个安全供应商都会说，“如果他们使用了我们的安全小工具，他们就不会被入侵了！”不用说，那不是很有帮助。](https://krebsonsecurity.com/2013/02/security-firm-bit9-hacked-used-to-spread-malware/)

这些违规事件提醒我们，没有人能够避免风险或受到威胁。这没关系。

> “每件事都会失败。”
> 
> 亚马逊网络服务首席技术官沃纳·威格尔

DevOps 的核心原则之一是:[为失败而设计](https://docs.aws.amazon.com/whitepapers/latest/running-containerized-microservices/design-for-failure.html)。我们如何将同样的原则应用于安全？

要回答这个问题，我认为在健康检查的背景下，重新审视“理想状态”[的概念很重要。使用健康检查使 DevOps 工程师能够了解服务的健康状况。“健康”在这里意味着某种程度上偏离了“期望的状态”——即开发者定义的任何健康或正常的状态。根据运行状况检查的类型和服务的构成，运行状况检查的结果可能简单到二进制的“up”或“down”，或者更复杂一些，如“在健康范围内”但是我们真正要问的是:服务是否在其期望的状态下运行？](https://thenewstack.io/little-friendly-competition-mesos-swarm-race-improve-health-checks/)

为了解决与期望状态的偏差，我们基于这些健康检查的输出构建了一些自动化。这将我们从必须照看生产中的每个服务中解放出来。这些自动化可以从发送一个 Slack 消息说“嘿，出问题了”，到创建一个 JIRA 票证，或者(如果服务受到不利影响)将它恢复到期望的状态。这个工作流越自动化，我们就越接近 DevOps 的天堂:不变性。

[https://www.youtube.com/embed/-RUu1fchTeU?feature=oembed](https://www.youtube.com/embed/-RUu1fchTeU?feature=oembed)

视频

## **将 DevOps 不变性原则应用于具有期望状态执行的安全性**

让我们回到之前的思考练习:像 Sunburst 这样的后门就在我们的基础设施中。后门进程或二进制本身并不会对性能或安全性造成实际威胁，因为它本身不会对我们的基础设施造成损害。如果我们不解决这个问题，伤害我们的是泪滴滴管旭日东升下载，但我们将在下一个。我现在的观点是:

> 如果我们可以容忍有内存泄漏和错误的服务仍然在我们期望的状态阈值内运行，那么我们也应该能够容忍有漏洞但没有被破坏的服务。

与健康检查一样，理想状态强制解决方案通过插入生产工作负载和 CI/CD 管道，对每个服务执行工作负载组合分析。

你可能已经熟悉了软件组合分析工具。这些产品通常在开发过程中分析应用程序，以识别它们的组件和其中任何已知的漏洞。工作负载组合分析工具应用了类似的原理，但是适用于整个云工作负载。工作负载组合分析检查构成整个云工作负载的各种服务和应用程序之间的来源、关系、依赖性和特权。

工作负载组合分析使期望的状态强制成为可能，因为通过解决“这是从哪里来的？”问题，更容易做出基于信任的决定，决定什么应该和不应该在生产中运行。这是手动策略创建的整体替代方案，手动策略创建需要安全从业者尝试逆向工程或读心术开发人员的意图，或者尝试建立启发式分析，该分析在建立基线后立即失效。

回到 Sunburst-Teardrop 场景:后门 Sunburst 来自一个表面上可信的来源(Solarwinds)，但滴管(Teardrop)却不是。为了成功实施有针对性的入侵，攻击者需要利用后门来运行更多的恶意代码和命令。问题就变成了:我们如何确保来自不可信来源的代码不在生产中运行？

零信任是一个安全概念，其核心理念是组织不应该自动信任其边界内外的任何内容，而是必须在授予访问权限之前验证试图连接到其系统的任何内容。然而，在期望的状态强制出现之前，零信任一直是一个难以实现的目标，因为需要大量的人工工作来确定是否信任试图访问特权资源的用户、API 或网络。

工作负载组合分析利用 CI/CD 管道，将代码和工件转换为策略，从而绝对确定地提供*应该在生产中运行的一切的来源。因此，如果生产中运行的内容与我们的工作负载组成分析的输出不匹配，那么它就不是我们不可变基础架构的一部分，并代表着风险。*

在没有人工干预的情况下，所需状态强制将在泪珠滴管执行时发生，并将我们的服务标记为超出所需状态的阈值。

## **坏人要变坏了**

简单地说，如果我们希望国家强制执行，那么后门就变成了另一种形式的技术债务——姑且称之为*安全债务*。当一个后门程序试图下载并执行 droppers 时，受影响的服务会可靠地发出警报，因为我们知道我们的服务想要执行的新代码不是我们想要的状态的一部分。该警报可以绑定到健康检查自动化，该自动化通知适当的方正在发生什么，或者在不变的环境中使服务回到其期望的状态——“健康”

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>