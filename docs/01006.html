<html>
<head>
<title>Off-The-Shelf Hacker: Virtual to Physical with Alexa Using 3 Internet Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现成的黑客:虚拟到物理与Alexa使用3互联网服务</h1>
<blockquote>原文：<a href="https://thenewstack.io/off-shelf-hacker-virtual-physical-alexa-using-3-internet-services/#0001-01-01">https://thenewstack.io/off-shelf-hacker-virtual-physical-alexa-using-3-internet-services/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">几周前，我买了一个亚马逊回声点。只需询问Echo Dot内置的虚拟助手Alexa，就可以获得时间、天气预报或收听网络电台。虽然这一切都很有趣，但我私下里想知道Alexa是如何控制身体的。</p>
<p class="translated">本月早些时候，<a href="https://thenewstack.io/add-basic-visual-interface-data-hub/" class="local-link">写了关于通过数据中心</a>连接Alexa的文章，我称之为MuG，<a href="https://mosquitto.org/" class="ext-link" rel="external "> Mosquitto MQTT broker </a>应用程序在glass下作为服务器运行。玻璃？它比任何东西都更具装饰性，是我对蒸汽朋克运动兴趣的颂歌。似乎是看待世界的新旧方式。它将虚拟空间与现实世界联系起来。语音命令充当连接桥梁。</p>
<p class="translated">MuG是一台芯片计算机，配置为独立的WiFi接入点，Mosquitto MQTT broker应用程序作为服务器运行。一个装饰性的玻璃纸带风格的圆顶容纳了该设备，而一个铰接的铜管支架支撑着一个三色led，它极大地照亮了芯片电路板的前面。Mosquitto订阅客户端和Python中的<a href="https://www.youtube.com/user/adafruit" class="ext-link" rel="external "> Adafruit </a>通用输入/输出(GPIO)库调用，驱动连接到LED的芯片引脚。坐在我的桌子上，这个杯子是我的物理计算堆栈的无线可视接口。</p>
<p class="translated">让Alexa闪烁杯子的LED是今天的主题。你可能会说这是Alexa的“Hello，World”练习，体现了C和Unix的优良传统。</p>
<h2 class="translated">将零件拉在一起</h2>
<p class="translated">成功地让Alexa改变马克杯的LED颜色有很多活动部件。有些是虚拟的，有些是本地的，有些发生在软件中。毫无疑问，是物理计算堆栈。</p>
<p class="translated">除了圆点和马克杯，我们还将使用三种互联网服务来完成这项工作。我们需要一个亚马逊账户、一个If-This-Then-than(If TTT)账户和一个Adafruit IO账户。亚马逊处理Alexa。Adafruit IO被用作MQTT代理。IFTTT充当中介。这是第一轮原型过程，实际上是可行的。这个过程将随着时间的推移而成熟。</p>
<p class="translated">如果你的Dot是可操作的，你就已经创建了一个亚马逊账户，并与Alexa进行了对话。如果你需要的话，这里有三个账户设置页面。</p>

<p class="translated">先说Adafruit IO配置。</p>
<h2 class="translated">连接到Adafruit MQTT代理</h2>
<p class="translated">Adafruit友好地提供REST和MQTT API来帮助客户开发他们的项目。我们将使用MQTT API，它是基于云的MQTT代理的前端。它目前处于测试阶段，所以您可以自行决定使用它。对于Alexa到MuG的原型过程来说，它看起来相当稳定和响应迅速。</p>
<p class="translated">请务必在项目笔记本中记录您的Adafruit IO值、用户名、AIO键等等，以供将来参考和方便访问。</p>
<p class="translated">登录你的Adafruit IO账户，点击“Feeds”菜单项。单击“操作”下拉菜单列表中的“创建新订阅源”项目。输入提要名称和描述，然后单击“创建”按钮。我的信息叫做“alexadata”</p>
<div id="attachment_2686187" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-2686187" decoding="async" loading="lazy" class="size-large wp-image-2686187" src="../Images/af6a96e327cc3d84b13bfc462bf85806.png" alt="Adafruit IO Feed Page" data-original-src="https://cdn.thenewstack.io/media/2017/07/334b28dc-screenshot_2017-07-13_10-09-16-1024x621.png"/><p id="caption-attachment-2686187" class="wp-caption-text translated">Adafruit IO馈送页面</p></div>
<p class="translated">切换到Linux终端，使用Mosquitto pub命令来测试Adafruit IO“Alexa data”提要。下面是我使用的命令行。根据需要代入您的值。</p>
<p class="translated">我在我的Linux笔记本上的一个终端中使用了下面的命令行，看看是否可以更新Adafruit IO“Alexa data”提要。<br/></p>
<div id="crayon-6422464d23592874475991" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-i">mosquitto_pub</span><span class="crayon-h"> </span>-<span class="crayon-t">p</span><span class="crayon-h"> </span><span class="crayon-cn">1883</span><span class="crayon-h"> </span>-<span class="crayon-i">h</span><span class="crayon-h"> </span><span class="crayon-i">io</span><span class="crayon-st">.</span><span class="crayon-i">adafruit</span><span class="crayon-st">.</span><span class="crayon-i">com</span><span class="crayon-h"> </span>-<span class="crayon-i">u</span><span class="crayon-h"> </span>[<span class="crayon-e">your </span><span class="crayon-e">Adafruit </span><span class="crayon-e">IO </span><span class="crayon-e">user </span><span class="crayon-i">name</span>]<span class="crayon-h"> </span>-<span class="crayon-t">P</span><span class="crayon-h"> </span>[<span class="crayon-e">your </span><span class="crayon-e">Adafruit </span><span class="crayon-e">IO </span><span class="crayon-i">password</span>]<span class="crayon-h"> </span>-<span class="crayon-st">t</span><span class="crayon-h"> </span>[<span class="crayon-e">your </span><span class="crayon-e">Adafruit </span><span class="crayon-e">IO </span><span class="crayon-e">user </span><span class="crayon-i">name</span>]/<span class="crayon-m">f</span>/[<span class="crayon-e">your </span><span class="crayon-e">feed </span><span class="crayon-i">name</span>]<span class="crayon-h"> </span>-<span class="crayon-st">m</span><span class="crayon-h"> </span>[<span class="crayon-e">your </span><span class="crayon-e">data </span><span class="crayon-i">value</span>]
</pre>
</div>
</div>

<p class="translated"><br/>点击“Feeds”页面上的“reload”时，feed值应该会改变。</p>
<p class="translated">Adafruit IO概述页面解释了该网站的许多细节。</p>
<h2 class="translated">连接Alexa和IFTTT</h2>
<p class="translated">接下来，仍然在Adafruit IO站点上，转到“设置”页面。点按“已连接的帐户”设置下的“已连接到IFTTT.com”。该操作将您带到Adafruit IFTTT连接页面，在这里我们可以设置更改Adafruit数据提要值的触发器。使用您的IFTTT登录信息登录网站。</p>
<div id="attachment_2686188" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-2686188" decoding="async" loading="lazy" class="size-large wp-image-2686188" src="../Images/fd65cc8705602a855c70b4f29653014d.png" alt="Adafruit IO - IFTTT Connection Page" data-original-src="https://cdn.thenewstack.io/media/2017/07/cd5f141c-screenshot_2017-07-13_10-17-09-1024x621.png"/><p id="caption-attachment-2686188" class="wp-caption-text translated">Adafruit IO — IFTTT连接页面</p></div>
<p class="translated">进入后，点击页面顶部的“我的小程序”按钮。单击右侧的“新建小程序”按钮。</p>
<div id="attachment_2686190" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-2686190" decoding="async" loading="lazy" class="size-large wp-image-2686190" src="../Images/7a21032744618d37835780d0bff9a4a6.png" alt="" data-original-src="https://cdn.thenewstack.io/media/2017/07/ed504aeb-screenshot_2017-07-13_10-20-22-1024x621.png"/><p id="caption-attachment-2686190" class="wp-caption-text translated">IFTTT新建子视图页面</p></div>
<p class="translated">在applet创建页面上，点击页面中间的蓝色“+ this”文本。搜索并选择“亚马逊Alexa”。在“选择触发器”页面上，选择“说出特定短语”框。填写“什么短语”文本。我的是“蓝色的”。“Alexa，触发蓝色”，然后将启动Alexa到MuG过程中的动作链。您将返回到IFTTT主页，现在应该会看到蓝色的“+ that”文本。</p>
<p class="translated">单击“+ that”文本。搜索并单击Adafruit IO框。点击“向Adafruit IO发送数据”框。将您之前创建的提要名称添加到“提要名称”位置。现在输入一个馈送值，MuG的Python程序将识别该值，这样它就可以对芯片的GPIO引脚采取适当的行动。我用的值是“b-on”确保最后点击“创建操作”按钮。下一页将在一个小框中总结这个小程序。</p>
<p class="translated">所有这些工作的方式是，每次我对Dot点按“Alexa trigger blue on”时，它都会启动一个IFTTT作业，将值“b-on”发送到Adafruit IO MQTT代理，然后它会发布该值。MuG上的Python程序将通过订阅Adafruit IO broker来获取代码中的值。当然，在Alexa命令生效之前，Python程序需要在MuG上运行。</p>
<p class="translated">MuG上的Python脚本(名为subalexa2.py)从下面的命令行开始。<br/></p>
<div id="crayon-6422464d23597188711566" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-i">chip</span>%<span class="crayon-h">  </span><span class="crayon-e">sudo </span><span class="crayon-e">Python </span><span class="crayon-i">subalexa2</span><span class="crayon-st">.</span><span class="crayon-v">py</span>
</pre>
</div>
</div>

<p class="translated"><br/>我在techtutorialsx.com<a href="https://techtutorialsx.com/2017/04/23/python-subscribing-to-mqtt-topic/" class="ext-link" rel="external ">网站</a>的MQTT订阅脚本中添加了一些GPIO代码，用来读取消息和控制杯子的三色LED。<br/></p>
<div id="crayon-6422464d23598101634387" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-p">#!/usr/bin/python</span>
<span class="crayon-e">import </span><span class="crayon-i">CHIP_IO</span><span class="crayon-st">.</span><span class="crayon-e">GPIO </span><span class="crayon-e">as </span><span class="crayon-e">GPIO</span>
<span class="crayon-e">import </span><span class="crayon-i">paho</span><span class="crayon-st">.</span><span class="crayon-i">mqtt</span><span class="crayon-st">.</span><span class="crayon-e">client </span><span class="crayon-e">as </span><span class="crayon-e">mqttClient</span>
<span class="crayon-e">import </span><span class="crayon-e">time</span>
 
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">cleanup</span>()
 
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">setup</span>(<span class="crayon-s">"XIO-P0"</span>,<span class="crayon-h"> </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">OUT</span>)
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">setup</span>(<span class="crayon-s">"XIO-P2"</span>,<span class="crayon-h"> </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">OUT</span>)
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">setup</span>(<span class="crayon-s">"XIO-P4"</span>,<span class="crayon-h"> </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">OUT</span>)
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P0"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)<span class="crayon-h"> </span><span class="crayon-p">#HIGH actually turns LED off since operating as current sink</span>
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P2"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P4"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h"> </span>
<span class="crayon-e">def </span><span class="crayon-e">on_connect</span>(<span class="crayon-i">client</span>,<span class="crayon-h"> </span><span class="crayon-i">userdata</span>,<span class="crayon-h"> </span><span class="crayon-i">flags</span>,<span class="crayon-h"> </span><span class="crayon-i">rc</span>):
<span class="crayon-h"> </span>
<span class="crayon-h">    </span><span class="crayon-e">if </span><span class="crayon-i">rc</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">0</span>:
<span class="crayon-h"> </span>
<span class="crayon-h">        </span><span class="crayon-e">print</span>(<span class="crayon-s">"Connected to broker"</span>)
<span class="crayon-h"> </span>
<span class="crayon-h">        </span><span class="crayon-e">global </span><span class="crayon-i">Connected</span><span class="crayon-h">                </span><span class="crayon-p">#Use global variable</span>
<span class="crayon-h">        </span><span class="crayon-i">Connected</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">True</span><span class="crayon-h">                </span><span class="crayon-p">#Signal connection </span>
<span class="crayon-h"> </span>
<span class="crayon-h">    </span><span class="crayon-i">else</span>:
<span class="crayon-h"> </span>
<span class="crayon-h">        </span><span class="crayon-e">print</span>(<span class="crayon-s">"Connection failed"</span>)
<span class="crayon-h"> </span>
<span class="crayon-e">def </span><span class="crayon-e">on_message</span>(<span class="crayon-i">client</span>,<span class="crayon-h"> </span><span class="crayon-i">userdata</span>,<span class="crayon-h"> </span><span class="crayon-i">message</span>):
<span class="crayon-h">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"Message received: "</span><span class="crayon-h">  </span>+<span class="crayon-h"> </span><span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>
<span class="crayon-h">    </span><span class="crayon-p"># print(msg.topic+" "+str(msg.payload))</span>
<span class="crayon-h">    </span><span class="crayon-e">if </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"b-on"</span>:
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P0"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">LOW</span>)
<span class="crayon-h">    </span><span class="crayon-e">elif </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"b-off"</span>:
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P0"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h">    </span><span class="crayon-e">elif </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"r-on"</span>:
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P2"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">LOW</span>)
<span class="crayon-h">    </span><span class="crayon-e">elif </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"r-off"</span>:
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P2"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h">    </span><span class="crayon-e">elif </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"g-on"</span>:
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P4"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">LOW</span>)
<span class="crayon-h">    </span><span class="crayon-e">elif </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"g-off"</span>:
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P4"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h">    </span><span class="crayon-e">elif </span><span class="crayon-e">str</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)<span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">"wow"</span>:
<span class="crayon-h">         </span><span class="crayon-e">wow</span>()
<span class="crayon-h">    </span><span class="crayon-i">else</span>:
<span class="crayon-h">         </span><span class="crayon-e">print</span>(<span class="crayon-i">message</span><span class="crayon-st">.</span><span class="crayon-i">payload</span>)
<span class="crayon-e">def </span><span class="crayon-e">wow</span>():
<span class="crayon-h">    </span><span class="crayon-st">x</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span>
<span class="crayon-h">    </span><span class="crayon-e">while</span><span class="crayon-h"> </span>(<span class="crayon-st">x</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;lt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span>):
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P0"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">LOW</span>)
<span class="crayon-h">         </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(.<span class="crayon-cn">2</span>)
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P0"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h">         </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(.<span class="crayon-cn">2</span>)
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P2"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">LOW</span>)
<span class="crayon-h">         </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(.<span class="crayon-cn">2</span>)
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P2"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h">         </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(.<span class="crayon-cn">2</span>)
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P4"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">LOW</span>)
<span class="crayon-h">         </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(.<span class="crayon-cn">2</span>)
<span class="crayon-h">         </span><span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-e">output</span>(<span class="crayon-s">"XIO-P4"</span>,<span class="crayon-i">GPIO</span><span class="crayon-st">.</span><span class="crayon-i">HIGH</span>)
<span class="crayon-h">         </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(.<span class="crayon-cn">2</span>)
<span class="crayon-h">         </span><span class="crayon-st">x</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-st">x</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span>
<span class="crayon-h"> </span>
<span class="crayon-i">Connected</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">False</span><span class="crayon-h">   </span><span class="crayon-p">#global variable for the state of the connection</span>
<span class="crayon-h"> </span>
<span class="crayon-i">broker_address</span>=<span class="crayon-h"> </span><span class="crayon-s">"io.adafruit.com"</span><span class="crayon-h">  </span><span class="crayon-p">#Broker address</span>
<span class="crayon-i">port</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">1883</span><span class="crayon-h">                        </span><span class="crayon-p">#Broker port</span>
<span class="crayon-i">user</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"[my user name]"</span><span class="crayon-h">            </span><span class="crayon-p">#Connection username</span>
<span class="crayon-i">password</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"[my password (aka: AIO key)]"</span><span class="crayon-h">          </span><span class="crayon-p">#Connection password</span>
<span class="crayon-h"> </span>
<span class="crayon-i">client</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">mqttClient</span><span class="crayon-st">.</span><span class="crayon-e">Client</span>(<span class="crayon-s">"Python"</span>)<span class="crayon-h">               </span><span class="crayon-p">#create new instance</span>
<span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-e">username_pw_set</span>(<span class="crayon-i">user</span>,<span class="crayon-h"> </span><span class="crayon-i">password</span>=<span class="crayon-i">password</span>)<span class="crayon-h">    </span><span class="crayon-p">#set username and password</span>
<span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-i">on_connect</span>=<span class="crayon-h"> </span><span class="crayon-i">on_connect</span><span class="crayon-h">                      </span><span class="crayon-p">#attach function to callback</span>
<span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-i">on_message</span>=<span class="crayon-h"> </span><span class="crayon-i">on_message</span><span class="crayon-h">                      </span><span class="crayon-p">#attach function to callback</span>
<span class="crayon-h"> </span>
<span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-e">connect</span>(<span class="crayon-i">broker_address</span>,<span class="crayon-h"> </span><span class="crayon-i">port</span>=<span class="crayon-i">port</span>)<span class="crayon-h">          </span><span class="crayon-p">#connect to broker</span>
<span class="crayon-h"> </span>
<span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-e">loop_start</span>()<span class="crayon-h">        </span><span class="crayon-p">#start the loop</span>
<span class="crayon-h"> </span>
<span class="crayon-e">while </span><span class="crayon-i">Connected</span><span class="crayon-h"> </span>!=<span class="crayon-h"> </span><span class="crayon-i">True</span>:<span class="crayon-h">    </span><span class="crayon-p">#Wait for connection</span>
<span class="crayon-h">    </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(<span class="crayon-cn">0.1</span>)
<span class="crayon-h"> </span>
<span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-e">subscribe</span>(<span class="crayon-s">"[my user name]/f/alexadata"</span>)
<span class="crayon-h"> </span>
<span class="crayon-i">try</span>:
<span class="crayon-h">    </span><span class="crayon-e">while </span><span class="crayon-i">True</span>:
<span class="crayon-h">        </span><span class="crayon-i">time</span><span class="crayon-st">.</span><span class="crayon-e">sleep</span>(<span class="crayon-cn">1</span>)
<span class="crayon-h"> </span>
<span class="crayon-e">except </span><span class="crayon-i">KeyboardInterrupt</span>:
<span class="crayon-h">    </span><span class="crayon-i">print</span><span class="crayon-h"> </span><span class="crayon-s">"exiting"</span>
<span class="crayon-h">    </span><span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-e">disconnect</span>()
<span class="crayon-h">    </span><span class="crayon-i">client</span><span class="crayon-st">.</span><span class="crayon-e">loop_stop</span>()
</pre>
</div>
</div>

<p class="translated"><br/>注意“wow”功能。这是我做的一点小把戏。当我们收到来自Adafruit IO代理的“wow”消息时，它会以0.2秒的延迟时间连续闪烁10次，循环显示蓝色、红色和绿色。</p>
<p class="translated">我承认这个过程有点笨拙，因为每个动作短语都需要一个单独的IFTTT触发器，比如“blue on”或“show wow”。</p>
<p class="translated">当我说“Alexa trigger show wow”时，我妻子认为这很酷，杯子闪烁着10个蓝、红、绿周期。</p>
<h2 class="translated">更进一步</h2>
<p class="translated">我刚刚谈到了Alexa语音命令的基本原理。我们可以很容易地发送不同的值来移动伺服系统或启动马达。</p>
<p class="translated">Amazon Web Services可能是另一个值得探索的领域，因为他们似乎有某种MQTT代理。走这条路线可能会消除IFTTT步骤。互联网上还有其他免费和付费的MQTT服务，可以满足我们的数据消息传递需求。</p>
<p class="translated">语音命令是未来的潮流吗？谁知道呢。</p>
<p class="translated">我要去把Alexa安装在我的第五代蒸汽朋克会议徽章上。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>