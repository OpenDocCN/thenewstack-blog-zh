# 应用基本与高级监控技术

> 原文：<https://thenewstack.io/applying-basic-vs-advanced-monitoring-techniques/>

复杂的体系结构、加快部署的压力以及对最佳性能的需求给监控团队带来了更大的压力。因此，越来越多的人希望实施更先进的监控技术。围绕这一点的部分初始挑战是理解什么是高级监控技术。在本文中，我通过区分基本监控和高级监控来帮助澄清这一点，并举例说明如何将它们应用于 Postgres 监控。我还将分享一些从基础监控升级到高级监控时您将获得的奖励。

## **基本监控与高级监控**

 [西奥·施洛斯纳格勒

西奥于 2010 年创建了 Circonus，并继续担任其首席架构师。20 年来，他一直在设计、编码、构建和操作可扩展系统。作为一名连续创业者，他已经创建了四家公司，并帮助发展了无数的工程组织。西奥是《T2》可扩展互联网架构(T3)的作者，是《T4》网络运营(T5)和《寻找 SRE》(T7)的撰稿人，也是全球 IT 会议的常客。他是 IEEE 会员和 ACM 杰出会员。](https://www.linkedin.com/in/postwait/) 

基本监控是红灯/绿灯监控:你的系统是开着还是关着？你的系统有故障吗？基本监控的重要性不亚于高级监控，但它涉及到解决更容易回答的问题。例如，知道您的系统是否出现故障是一个比更高级的监控问题更容易回答的问题，比如您是否满足服务质量保证。基本监控应优先考虑最接近实际产生价值的地方(通常是最终用户)的系统和服务。

当您已经应用了基本的监控，但还不了解您的系统如何以足以驱动您的组织的方式运行时，就需要高级监控技术。

与红灯/绿灯基本监控相反，高级监控包括观察系统，以了解它是否按照应有的方式运行。这个问题很容易问，但很难回答。事实上，回答这个问题通常是一个非常漫长的过程，围绕你认为系统应该如何运行不断形成良好的假设，并确定观察系统的最佳方式，以了解它实际上是如何运行的。一旦达到这一点，高级监控就包括自动观察和诊断与预期的偏差。

## **基本监控与高级监控:Postgres**

为了更好地说明高级监控技术涉及的内容以及它们与基本监控的不同之处，让我们以 Postgres 为例。

### **连接与服务质量**

如果您使用基本的监控技术来监控 Postgres，您会监控以下内容:

*   Postgres 在运行吗？
*   系统空间不足吗？
*   系统可以服务查询吗？
*   一个简单的查询会返回预期的结果吗？

这些是容易开/关、健康/不健康、对/错的问题。当你开始应用先进的监控技术时，事情就不那么简单了，也更加模糊了。你现在在问你期望它如何表现。例如，Postgres 的工作是接受连接并回答应用程序的问题。借助高级监控，您可以观察、监控以下内容:

*   正在运行或应用程序询问的所有查询是什么？
*   查询的延迟特征是什么？它有变化吗？
*   我们预计什么时候用完空间？
*   服务的饱和程度如何？

高级监控的第一部分是能够观察正在发生的事情，并将其与您预期应该发生的事情进行比较。例如，您可能期望在 Postgres 上运行的工作负载看起来像某种方式，而您的监控系统告诉您工作负载实际上看起来并不像您所期望的那样。这不一定是坏事；这只是意味着有些事情可能需要你的注意。如果您只应用了基本的监控，并且只是简单地检查了工作负载连接的开/关，那么这些信息可能不足以诊断问题。应用于 Postgres 的基本监控是关于正确的功能，而高级监控是关于服务质量、性能和行为。

### **合成作品与真实作品**

基本的监控往往是综合的，这意味着您在内部测试系统的某个部分，比如有多少可用的磁盘空间。然而，仅仅依靠合成工作并不能提供真实、准确的见解。

高级监控有时包括合成工作，但它往往是更真实的观察到的行为，这意味着您实际上正在观察该系统中发生的真实事情，并对它们进行测量。例如，当用户登录一个应用程序时，可能会运行多个查询。为确保满足性能要求，使用高级监控的工程师将观察以下测量结果:

*   每个查询需要多长时间？
*   结果集的大小是多少？
*   有任何查询有错误吗？

虽然合成工作有其价值，但大多数高级监控都依赖于对实际工作的观察来指导分析和决策。

### **瞬间观察对比历史分析**

虽然知道 Postgres 上是否还有剩余空间可能会有所帮助，但拥有可以用来建模的空间的历史记录更有价值。这给了你洞察力，比如空间消失得有多快，增长得有多快。考虑 Postgres 的并发连接或连接的用户数量。这通常仅限于相对较小的数量，其中一个经典问题是知道自己是否有足够的人脉。对于基本的监控，这个问题的答案不幸是非黑即白的:你有足够的连接，直到你停机，没有任何工作。但是当您应用高级监控时，您可以随着时间的推移记录每几秒钟有多少并发用户，这使您可以更好地了解空间不足的程度，并根据需要进行调整。

这些历史数据使您能够识别趋势并了解系统的行为，以便您能够准确地规划容量:

*   您的连接用户数量曾经接近极限吗？
*   您的联网用户数量是否在稳步增长？

如果两周前你有 100 个用户，上周 110 个，本周 120 个，那么下周很可能会更多。历史数据使您能够了解这些趋势，因此您可以准确规划未来的容量。

## 应用高级监控的好处

### **获得关于您系统的惊人见解**

应用高级监控的一些最大优势并不来自于实际拥有高级监控，而是来自于让您获得高级监控的过程。工程师对系统应该如何工作有期望，但这通常是不准确的。并不是预期不好；相反，你可能会假设有人在系统中做了一些事情，或者一些事情以某种方式联系在一起，结果却不是这样。将你的期望与一组测量值协调起来的练习通常是非常令人大开眼界的。你对你的系统有所了解，或者你对它的破损有所了解，这两种了解都是有价值的。事实上，了解系统的一些新东西通常比找到一个坏的部分更有价值。

### **提高效率，加快修复速度**

应用高级监控技术通常可以帮助您诊断系统中的效率低下问题，例如，它们是以页面加载缓慢的形式呈现给用户的效率低下问题，还是物流方面的效率低下问题。无论是什么，你都将对你的系统有更深入的了解，了解那些挑战你的期望的关于你的系统的事情，并注意到你以前从未有过的问题。您还将更有准备地快速补救问题，甚至从一开始就防止问题发生。

### **对了解您的系统充满信心**

系统越复杂，解决问题就越困难。当今的 IT 环境如此复杂，而且有如此多的活动部件，以至于当一个系统出现故障时，故障可能会在其他地方出现。高级监控让工程师有信心了解他们操作的复杂系统。这在故障排除、容量规划和故障预测方面非常有用。如果您对系统的行为有深刻的理解，那么您就可以预测下一次故障将在何时何地发生。

如果您没有良好的监控，那么您将所有的时间都花在救火上，这最终会耗尽您的员工，并影响产品路线图。高级监控不会消除所有的麻烦，但您的问题将不再那么紧急，并且当您解决它们时会更有信心。

## **监控是一个旅程**

许多组织意识到如果他们实现更高级的监控技术，他们可以获得的好处，但是许多组织不改变他们的过程和工具，因为它看起来势不可挡。关键是要记住，这不一定要一蹴而就。转向更高级的监控是一个旅程，您可以设定速度。当你开始这一旅程时，你会立即开始意识到一些预期的好处，并获得意想不到的好处。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>