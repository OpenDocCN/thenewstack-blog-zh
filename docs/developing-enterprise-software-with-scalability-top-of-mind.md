# 开发具有可伸缩性的企业软件

> 原文：<https://thenewstack.io/developing-enterprise-software-with-scalability-top-of-mind/>

[](https://www.linkedin.com/in/ganjisaffar/)

 [亚西尔·甘吉萨法尔

亚西尔·甘吉萨法尔是 Forward Networks 的工程副总裁，负责监督公司的所有工程工作。他于 2014 年作为早期员工加入 Forward Networks，并带领团队在五年内将 Forward Enterprise 产品的计算核心扩展了 1000 倍。在此之前，他在脸书和微软建立了大规模的搜索基础设施。他拥有信息检索领域的计算机科学博士学位。](https://www.linkedin.com/in/ganjisaffar/) [](https://www.linkedin.com/in/ganjisaffar/)

开发企业软件远非易事。设计一个平台来服务成千上万的用户、设备或数据流(有时是同时)是一项艰巨的任务。但这并不意味着不可能以一种鼓励未来可伸缩性的方式接近设计方法。

在制定新的软件解决方案时，可伸缩性是最重要的考虑因素之一。没有它，软件就不能在不损害用户体验的情况下支持用户增长，同样也会抑制销售。制作一个可扩展的软件平台很有挑战性，因为几乎不可能事先知道供应商需要考虑哪些因素、选项和问题，这需要公司一路迭代。

这就是 Forward Networks[在开发网络管理解决方案时不得不面对的问题。该平台创建了企业网络的数字孪生模型，以协助网络管理、验证和操作。但是，这些网络包含数以千计的设备，跨越数百种设备类型，来自几十个不同的供应商，跨越多个位置，有数百万种不同的配置。构建一种能够准确识别和模拟这些网络行为的算法是一项挑战。](https://forwardnetworks.com/)

虽然该平台最初只有 16 个设备样本，但如今已经扩展到模拟多达 45，000 个设备，并处理多达 10 亿个流量。但是团队的扩展努力不会就此停止，因为企业网络的复杂性在未来只会增加。Enterprise Strategy Group 的研究数据显示，66%的组织认为其 IT 环境比两年前更加复杂，46%的组织计划继续升级和扩展其网络基础设施。

随着这些平台需要应对不断增长的网络，软件可伸缩性自然只会变得更加重要。现在让我们进入一些步骤来解决如何从头开始构建软件以支持快速扩展。

## 不要总是相信开源

起初，利用现成的平台和工具，如 Elasticsearch 和 Apache Spark，似乎是节省金钱和时间的好方法。但是，当尝试扩展软件时，很快就会发现，虽然这些平台是通用的，适用于广泛的应用程序，但当需要针对特定平台或用例进行大规模定制时，它们并不是最合适的。

这是 Forward Networks 团队早年遇到的一个问题。最初，该团队严重依赖 Elasticsearch 来计算、索引和存储该平台的所有端到端网络行为计算。慢慢地，很明显这不是一个长期的解决方案。预计算 Elasticsearch 中的所有数据在计算上变得不可行，存储成本也越来越高。对这些开源工具的依赖开始成为一个问题，因此该团队决定创建一个本土的分布式计算和搜索平台。

当在内部设计平台时，在可能的情况下，采用懒惰计算方法是明智的。通过预先计算执行快速处理所需的足够数据，并在用户输入查询时进行特定于用户查询的其余计算，将会带来重大改进。计算能力和所需存储空间的大幅减少，可以立即提高性能，并在未来更好地扩展平台。

## 极简主义的设计理念

始终计划软件平台必须在最少的本地硬件上运行。虽然在 AWS、Azure 或其他云提供商中提供 1TB 以上 RAM 的实例非常容易，但大多数客户将在可用的最小 RAM 上运行供应商的平台。尤其是当潜在客户正在测试软件时，他们不希望为他们不确定的平台提供大量资源。不得不使用仅有 128GB 或 256GB 内存的情况并不少见。

一个简单的事实是，当软件需要大量内部计算资源时，可能会有大量官僚主义的磁带需要通过。另一方面，潜在客户迅速开始使用该软件以完成概念验证阶段也很重要，因为否则他们还没有看到在他们的环境中运行该平台的价值，而这是转化销售的绝对关键。

即使需要扩展到 1，000 倍，也不能简单地使用具有 1，000 个节点的集群。即使在极少数情况下，这在技术上是可行的，但对于客户来说，这并不是一种现实的方法。软件供应商必须做艰苦的工程工作，以最少的资源完成同样的扩展工作。以下是一些具体的方法，可以帮助团队在设计软件平台时考虑到极简主义:

*   避免重复计算。
*   对内存和磁盘上的数据结构进行重复数据删除。
*   惰性计算:将处理延迟到真正需要的时候。
*   使核心数据结构尽可能紧凑，并且具有非常低的序列化和访问开销。
*   使用 [fastutil](http://fastutil.di.unimi.it/) 在 Java 中实现快速和高效的内存收集。
*   配置文件来检测和优化实际瓶颈的性能。

如果可能的话，一个平台的资源需求应该非常低，以至于开发人员可以在他们的笔记本电脑上运行整个堆栈。这对于实现快速调试和快速迭代至关重要。以这种方式构建在最小硬件上运行的软件平台可以加快采用速度，最终还会为客户节省资金并提高利润。

## 总是收集数据

即使是设计最好的软件，也可能存在无法预料的环境因素或数据模式。随着时间的推移，软件的计算核心可能需要多次重写或重大更改，以适应无法预见的新问题、限制或低效率。可用于测试平台的数据集越大，团队就能越快发现这些瓶颈和限制。

但这对一家新的创业公司来说并不容易。为什么大型企业要花时间安装新供应商的平台，配置他们的安全策略以允许软件连接到他们的整个网络来获取他们的配置，并将数据发送给一家还没有成熟产品的小公司呢？这很难推销。相反，大多数开发人员需要绕远路。这意味着收集任何可能从客户和试点项目获得的相关数据，以不断构建和扩展内部数据集，用于规模测试和改进。即使软件试用没有带来新的客户，也可以提供新的数据，为改进平台提供宝贵的见解。然后，随着软件变得更好、更快和更具可扩展性，供应商可以前进到更大的客户环境，获得更大的数据集，并找到下一组平台瓶颈进行工作。

另一个复杂因素是许多企业有严格的安全和隐私政策。他们不会直接与软件供应商分享他们的数据和信息。这些类型的公司需要花费时间在平台中构建数据混淆功能，在不共享客户实际数据的情况下分析性能瓶颈。

## 投资内部测试

自然，没有供应商希望他们的平台“崩溃”这对公司来说不是一个好消息，可能会让客户花费数百万美元的时间来寻找解决方案，甚至更糟的是，寻找替代品。对于希望快速行动而不破坏事物的软件平台供应商来说，投资复杂的测试是至关重要的。

作为参考，Forward Networks 每个月都会发布一次软件平台的重大更新。这些版本中的每一个都是由 git 注释中的 900 多处变化编译而成的——随着平台的进一步扩展，这个数字只会增加。团队还实现了许多定期测试，每隔几个小时就对最新的合并变更运行更昂贵的测试，以确保一切都按计划运行。这种级别的测试是确保产品发布中没有任何重大错误或倒退所必需的。虽然对每一个变化都进行广泛的测试是不可行的，但是供应商应该尽可能地投资于内部质量保险。

在这个过程中，工程师和开发人员也可以使用各种工具。Git 注释可以由运行数千个单元和集成测试的 [Jenkins](https://jenkins.io/) 作业来验证，以确保没有回归。来自验证的测试失败将阻止有问题的变更被合并。此外，[容易出错的](https://errorprone.info/)可以用来检测和避免常见的错误，而 [Checkstyle](https://checkstyle.sourceforge.io/) 将在整个过程中强制执行一致的编码风格。在 [SignalFx](https://www.signalfx.com/) 上检查每个测试性能也可以展示随时间的变化，因此开发团队可以看到何时引入了有问题的问题。

通过雇佣足够多的工程师来运行一致和彻底的测试，以检查正确性和性能退化，供应商可以使他们的软件平台尽可能可靠和有弹性。

## 冲过终点线？

诚实的事实是，这些过程是一个不断的循环。没有哪家供应商真正“完成”了软件平台的改进。总是需要进一步开发软件，以更好、更快、更有效地工作，并且与市场上出现的新技术和平台兼容。所有这些都适用于构建可伸缩的企业软件。

随着越来越多的设备变得智能和互联，对可扩展解决方案的需求将呈指数级增长。从头开始设计软件以实现可扩展性，还可以提高性能、计算和存储效率以及客户体验。这是一个明智的选择，可以让供应商领先于竞争对手，并为他们在日益互联的世界中取得长期成功做好准备。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>