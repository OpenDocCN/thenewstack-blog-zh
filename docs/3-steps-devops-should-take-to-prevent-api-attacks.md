# 开发人员应该采取 3 个步骤来防止 API 攻击

> 原文：<https://thenewstack.io/3-steps-devops-should-take-to-prevent-api-attacks/>

价值在哪里，黑客就去哪里，现在，价值正在通过 API 传播。问题是没有一个角色负责保护 API。

根据 TechStrong 行业分析师和顾问 Dan Kirsch 的说法，当本周在 [TechStrong Con](https://www.techstrongevents.com/techstrongcon22/1823221) 的观众被问及谁为您的企业选择 API 安全产品时，64%的人选择安全，36%的人选择开发。

Kirsch 说:“行业开始认识到这是一个非常重要的领域——跨 API 的数据和服务是至关重要的。“我们看到的是，API 安全性正在下降。”

一个 API 安全程序应该包含一个 API 的新定义，Noname Labs 安全工程师 [Matt Tesauro](https://www.linkedin.com/in/matttesauro/) 在 TechStrong 大会演讲“剥洋葱:理解 API 安全的层次”中争辩道

“我们需要一个更好的 API 定义，特别是从安全的角度，对吗？”特索罗告诉观众。“这就像说亚马逊是一个网站，顺便说一下，我写的那 40 行 HTML 也是一个网站。网站变得毫无意义。”

他认为，从安全的角度来看，一个更好的定义是 API 是以下内容的组合:

*   方法—例如，GET、POST、PUT
*   主机名，例如 example.com；还有
*   路径，如/v2/users/all

关于 API 安全性，DevOps 应该从三个角度理解安全性，他补充道:

1.  API 安全态势
2.  API 运行时安全性
3.  API 安全测试，连续进行时效果最好

他展示了如何使用这三个视角来识别和阻止 [OWASP API 十大风险](https://owasp.org/www-project-api-security/)，其中包括破坏对象级授权、过度数据暴露、破坏用户认证和注入攻击。

## **1。API 安全态势**

Kirsch 询问与会者他们是否有所有使用过的原料药的清单:大多数人(55%)说没有，16%的人不确定。

“我们说的是超过四分之一的人在其环境中拥有 API 清单，这非常令人担忧，因为你应该如何更新它们？”他问。“如果您甚至不知道您的环境中有哪些 API，您如何知道某个 API 是否不再受支持？”

Kirsh 的观点有助于解释为什么 Tesauro 的第一个 API 安全观点是 API 安全状态，它需要每个 API 的清单——关于方法、主机名和路径的细节。

例如，要清楚哪些 API 正在通过 API 网关，API 调用是来自北/南(外部)还是东/西(内部)。他说，从本质上讲，开发人员应该对 API 调用的对象、内容和位置进行分类，尤其是涉及到的数据。

“我有什么 API，它们消耗什么数据？”特索洛问道。"然后，更重要的是，映射进出这些 API 的数据."

通过监控 API 安全状态，可以识别以下 OWASP API 风险:

*   过多的数据暴露
*   缺乏资源和速率限制
*   安全错误配置
*   资产管理不当
*   记录和监控不足

## **2。API 运行时安全性**

第二个视角是 API 运行时安全性，这意味着理解 normal 在网络级别和与 API 的通信级别是什么样子，Tesauro 解释道。这使得识别越线流量成为可能——例如，当有人对 API 发起分布式拒绝服务(DDoS)攻击时。

他指出，并不是所有的工具都会监控所有的 API，所以这其中的一部分就是了解你正在使用什么类型的 API。他说，例如，如果你的工具只理解 GraphQL，但 API 也在 REST 和 GPC 中完成，那么三分之二的流量会被错过。运行时安全是部署利用机器学习或人工智能来执行异常检测的工具的好地方。

“一旦你有了它，如果它在不断学习，你就可以为异常流量设置阈值并采取行动，”特索罗说。“如果我看到一个来自公共 IP 的请求击中了这个仅供内部使用的 API，我想伸出手与 API 网关或我的防火墙或任何可以关闭该 API 公共访问的网络设备进行对话。”

他说，运行时安全系统应该包括触发警报，并在达到异常流量阈值时创建手动、半自动或自动响应。他补充说，DevOps 还应该能够根据需要阻止、地理围栏和直接拒绝外部流量。

根据 Tesauro 的说法，API 运行时安全性可以帮助检测 OWASP API 的 10 大风险。

## **3。API 测试**

Tesauro 说，测试 API 的安全状态很重要，而且测试应该是连续的。他说，API 测试程序应该使用 DAST(动态应用程序安全测试)而不是 SAST(静态应用程序安全测试)，后者不是特定于 API 的。

他说:“工具需要理解 API 如何编写或与其他 API 对话——这不像一个可以有爬虫的 web 应用程序。“你不浏览一个 API，所以你必须有一些方法通知工具——嘿，这就是你如何与我的 API 交谈。”

一般来说，会有一个 Swagger 或者 OpenAPI spec 文件，说这些是方法，以及 API 如何与它们对话。他说，也可以使用 HTTP 档案中记录的流量。

此外，API 测试应该包括问题跟踪器与吉拉等工具的集成，查看易受攻击的请求/响应的能力以及重新测试特定问题的能力，他补充道。

测试可用于检测大多数 OWASP API 十大风险，除了不适当的资产管理和不充分的日志记录和监控。

## **齐心协力**

Tesauro 分享了这三种观点如何协同工作来识别和阻止针对 API 的 DDoS 攻击。

了解 API 状态可以帮助开发人员了解在攻击过程中需要保护哪些资源和服务——因为使用 API 状态，已经确定了最关键的服务。他说，Runtime 可以帮助识别 HTTP 洪水、流量的突然增加或突然出现的 32 兆请求。生产前的测试应该包含拒绝服务类型的测试，以提前确定当 API 受到这种方法的攻击时会发生什么。

他说:“我需要了解这些 API 拥有什么，它们接收到什么数据，以便做出适当的安全决策，但我还需要观察它们在运行时在做什么，并能够测试它们。”。"理想情况下，如果测试工作正常，我不会引入任何更多的安全性."

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>