# NASA 程序员记得在深空调试 Lisp

> 原文：<https://thenewstack.io/nasa-programmer-remembers-debugging-lisp-in-deep-space/>

谢天谢地，调试运行在 1.5 亿英里之外的软件是我们大多数人永远都不必做的事情。但是一位前美国宇航局程序员，软件工程师罗恩·加勒特在亚当·戈登·贝尔的[播客中分享了他在一次深空飞船任务中诊断错误 LISP 软件的经历。](https://corecursive.com/)

Garret 分享了一个关于在外太空调试的[非凡故事](https://corecursive.com/lisp-in-space-with-ron-garret/)——以及一些早期编程的记忆。一路走来，Garret 提供了一个令人耳目一新的视角，来审视编程世界中的变化和不变化。Garret 还探索了为航天器编写代码的独特挑战。

他还记得自己在 Lisp 历史上一个真正辉煌的时刻中扮演的主角。

## 超能力用户

加勒特从 1988 年到 2000 年在美国国家航空航天局喷气推进实验室担任研究科学家，2001 年到 2004 年再次任职。Garret 的专长:自主移动机器人。他帮助开创了今天事实上的标准自主移动机器人控制架构。

加勒特的团队致力于机器人火星漫游车[旅居者](https://en.wikipedia.org/wiki/Sojourner_(rover))的原型。

在播客上，Garret 描述了 1988 年非常有限的编程选择——在 Java、Python、JavaScript 甚至 C++出现之前的世界。“还有 Pascal、C、Basic 和机器码。就流行语言而言，差不多就是这样。用这些语言中的任何一种做任何事情都是非常非常困难的。”大多数航天器的代码最终都是用汇编语言编写的。

但是后来出现了 Lisp——一种基于将问题清晰地抽象成列表和函数的语言。虽然 C 程序员担心悬空指针之类的问题，但 Lisp 也有自动内存管理。Garret 在播客中回忆道:“当你使用的语言为你提供了一些高层次的抽象概念时，完成事情会更快更容易。”“在一个只有 Lisp 语言的世界里，知道 Lisp 就像是一种超能力。

> 使用 Lisp，“每个问题都变成了编译器问题”

"在那些日子里，它让所有其他东西都相形见绌."

不过，在过去，Lisp 在 NASA 并不常用。

“对 Lisp 有相当多的偏见，因为它很奇怪，很陌生，而且它有这种奇怪的垃圾收集技术，你永远不知道它什么时候会让你的进程停滞不前，”Garrett 回忆道。

Garret 的小组发现它对内存受限的硬件很有用。Lisp 可以用来为手头的问题专门定制一种语言，然后为机器人的硬件进行编译。或者，正如贝尔所说，“每个问题都变成了编译器的问题。”Garret 的团队煞费苦心地在机器人模拟器(在 Macintosh 电脑上)上编写并测试了他们的代码，然后将其安装在实际的火星车上，并在 Arroyo 上进行了耗时的试驾。

尽管该小组开发了代码库，但当旅居者号火星车到达火星时，它是用 C 代码驱动的。

然而在 1998 年，一位新的美国宇航局局长启动了美国宇航局的新千年项目，这是一个通过一系列深空探测任务展示不同(且更便宜)技术的试点项目。

Garret 在播客中回忆道，这意味着他们的 Lisp 代码获得了第二次生命。该团队开始为火星车开发的自主技术被重新调整了用途。它的新任务？飞行控制器。

Garret 的团队开发了一种创新的决策软件——使用 Lisp 编写的定制语言，专门用于避免可怕的“竞争条件”(两个并发运行的线程争夺相同的内存空间)的可能性。“它被测试了很多天”——在进入太空的完全相同的硬件上。“所以我们非常有信心它会成功。

“但没有成功…”

## 深空失败

加勒特解释说，在他们三天的飞行控制中，“有一段时间，它应该做一些事情，但时间来了又去，它没有做它应该做的事情。警钟响起…

“现在这段被证明是无死锁的代码似乎被冻结在离家 1.5 亿英里的地方。”

这是一个紧张的局势。“我们不知道发生了什么…当我们决定做某件事时，我们会去做，然后坐在那里等一个小时，等待结果。”在会议室中的团队达成共识后，他们的命令“经过了一个由许多管理层组成的审查过程，所有人都必须签字同意。”

在获得批准后，命令通过专用的硬连线网络发送到深空网络的一个 70 米宽的天线，该天线以光速在太空中飞行……”

首先，他们请求一个回溯——一个常见的编程操作，生成所有当前活动进程的列表(正如 Garret 所描述的，“它们在等待什么。”)

“实际上，几乎可以立即看出哪里出了问题，因为有一个进程在等待本应已经发生的事情…

“问题在于，事实上存在一个竞争条件。这本来是不可能的。”不幸的是，Garret 的一个程序员调用了一个低级 Lisp 函数——这无意中为他们精心定制的语言创造了“一个绕过安全保证的终点”。(Garret 责怪自己没有向编码者更清楚地解释这一点。)

该团队决定“手动”触发该事件——这使得软件再次运行。

“我们没有失去航天器，我们确实完成了所有的任务目标——所以从技术上来说，这是成功的，”加勒特在播客上说。“但发展过程是如此痛苦和充满困难——而且，还有政治因素。因此，尽管我们确实设法让它工作了，但 autonomy 项目在那之后被取消了，它再也没有飞行过。”

加勒特个人网站上一篇 2002 年的文章认为“Lisp 在 JPL 的消亡是一场悲剧。这种语言特别适合这里经常做的那种软件开发:独一无二的、高度动态的应用程序，必须在极其紧张的预算和时间表下开发。”

但是 Lisp 被 C++忽略了，然后是 Java，给出的理由是试图遵循“最佳实践”。加勒特的回应？“我们混淆了最佳实践和*标准*实践。这两者是不一样的。”甚至除此之外，什么是最终最好的并不是一个不变的标准，而是应该取决于当前项目的细节。

但是在黑客新闻的一次讨论中，一位评论者自称是美国宇航局的工程师，曾是 2009 年探索月球南极任务的有效载荷软件工程师——[说他们已经使用 Lisp 为仪器命令序列(以及模拟计算机)编写了自己的定制语言](https://news.ycombinator.com/item?id=31253704)。“Lisp 的简单、灵活的语法和宏使得[表达命令和定时模式](https://blogs.nasa.gov/lcrossfdblog/)变得容易。”

所以他们带着一个令人安心的想法离开了加勒特:“我认为 Lisp 仍然在 NASA 的各个角落和缝隙中使用。”

* * *

# WebReduce

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>