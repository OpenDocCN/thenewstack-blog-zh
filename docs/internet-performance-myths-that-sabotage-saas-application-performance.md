# 破坏 SaaS 应用程序性能的互联网性能神话

> 原文：<https://thenewstack.io/internet-performance-myths-that-sabotage-saas-application-performance/>

[](https://www.teridion.com/)

[Pej Roshan](https://www.teridion.com/)

[Pej Roshan 是 Teridion 的产品副总裁，拥有 20 多年的市场营销和产品管理经验。在加入 Teridion 之前，Pej 负责 Aruba Networks 业务部门的产品管理，负责交付基于云的网络管理。此前，他在 ShoreTel 担任产品管理副总裁，在收购阿基多网络公司时，他是首席营销官和联合创始人。Pej 的成就包括参与了负责安全性(802.11i)和 QoS (802.11e)的 IEEE 802.11 任务组，并参与撰写了由思科出版社于 2004 年出版的 *802.11 无线局域网基础知识*。他是多项无线网络专利的作者。](https://www.teridion.com/)

[](https://www.teridion.com/)[](https://www.teridion.com/)

如今，软件即服务已经成为核心业务应用程序事实上的交付模型。最终用户和应用程序之间最关键的业务网络是公共互联网。

我们倾向于认为互联网相当快。我们将大量带宽等同于速度和性能，但事实并非如此。带宽只是潜在速度，而实际速度是通过吞吐量来衡量的。有限的吞吐量是互联网性能问题的明显证据。如果你曾经在你的 200 兆家庭互联网连接上进行过速度测试，并且只达到了上传速度的一小部分，你就经历过这种情况。

> BGP 对拥塞的反应不是很好。如果两点之间存在 BGP 路由，并且该路由拥塞，则没有 BGP 的反馈机制。

互联网不是为高性能网络而设计的。事实上，它根本不是一个单一的网络，而是许多网络的集合，旨在对故障点具有弹性。在许多情况下，互联网确实表现良好——但高水平的性能并不能得到保证，特别是当流量在世界各地传输并进入基础设施可疑的地理区域时。

SaaS 提供商高度依赖于他们的最终用户在互联网性能和响应时间方面的持续良好体验。随着越来越多的应用程序通过 SaaS 模型交付，开发人员需要了解互联网的一些基本特征，这些特征可能会对他们的应用程序交付产生重大影响。两个最常见的误解是，互联网是为最佳性能而设计的，BGP(边界网关协议)路由有助于流量在互联网上找到最快的路由。

## 互联网是为最佳性能而设计的

如果互联网路由有一个宏伟的设计，那就是最小化成本和优化利润。

公共互联网由世界各地数百个不同的网络提供商组成，称为自治系统(as)。这些系统保存并交换路由信息，这些信息基本上是一张地图，告诉每个 AS 向哪里发送数据包。由于 as 并不总是彼此直接相连，因此它们需要通过其他 as 来路由它们的流量。因此，数据分组很可能要经过许多许多 as，从分组始发的地方到它的最终目的地。

现在，假设网络 A 有必须发送到网络 Z 的数据包，该流量必须沿途经过各种 as。每次发生切换时，路由决策并不是基于如何以最快的方式将数据包传送到网络 Z。相反，它是基于哪条路由将花费发送网络最少的钱。

认为我们的公共互联网根据最低成本而不是最佳性能来决定如何发送流量是疯狂的，但事实就是如此。"互联网是为最佳性能而设计的."这个流言被终结了。

## 互联网使用 BGP 路由来寻找最快的路径

BGP 通过在边缘路由器之间交换路由和可达性信息来管理数据包在互联网上的路由。BGP 在自治系统(AS)之间定向数据包，有时在单个网络 AS 内，但更多情况下是将一个 AS 连接到另一个 AS。有一种误解认为 BGP 寻找最快的路径，但事实并非总是如此。

BGP 是在近三十年前相当仓促地创建的，目的是为了适应迅速发展的公共互联网系统中的路由。不幸的是，BGP 有一些非常严重的缺陷，这些缺陷随着时间的推移越来越大。

例如，BGP 不能很好地应对拥塞。如果两点之间存在 BGP 路由，并且该路由变得拥塞，则没有反馈机制让 BGP 认识到它正在沿着拥塞的路由发送流量，并且它应该选择另一条路由。

现在，在先前讨论互联网提供商如何基于最低成本相互移交的背景下考虑这一点。提供商 A 使用最初基于最低成本路由选择的路由切换到提供商 B。一旦那条路由开始拥塞，正在使用的协议没有任何机制来后退并建立另一条路由；提供商 A 只是不停地往拥挤的车道上塞流量。实际上，拥堵的车道往往会变得更加拥堵，而不是通过路由智能来缓解。

BGP 协议确实会对中断做出响应，尽管速度很慢。如果有一条主要链路离线，则整个互联网上的所有 BGP 路由表需要相当长的时间来同步并识别该链路不再服务。在此期间，网站无法访问，数据丢失，人们无法在互联网上找到他们想去的地方。

除了性能问题，BGP 还有一些严重的安全缺陷。有很多 BGP 劫持的案例，在这些案例中，到 AS 的合法通告路由被恶意参与者劫持，只是宣布他们有到目的地的最佳路径。真的就这么简单——有了 BGP，你只要说你是正确的道路，其他 as 就相信你。

2018 年 4 月，通过向俄亥俄州哥伦布市的一家 ISP 注入虚假路由广告，专用于云 DNS 的[亚马逊网络服务](https://en.wikipedia.org/wiki/Amazon_Web_Services)空间内大约 1300 个 IP 地址被劫持。几个 AS 对等伙伴盲目地传播错误的重新路由公告。通过破坏亚马逊的域名解析服务，攻击者伪装成加密货币网站 MyEtherWallet.com，从不知情的最终用户那里窃取了约 15 万美元的数字硬币。

随着 BGP 协议在互联网的基础上根深蒂固，整个互联网路由系统本质上是基于荣誉系统的。我们又一次打破了另一个神话，“互联网使用 BGP 路由来寻找最快的路径。”

## SaaS 提供商不必受公共互联网的支配

依靠公共互联网进行 SaaS 流量路由有点像玩俄罗斯轮盘赌；流量可能会顺利交付，也可能不会。玩这个游戏的风险太大了。

有一些解决方案可以让 SaaS 提供商更好地控制如何向客户发送和接收特定流量。例如，一个突出的解决方案是在互联网上一些最大的公共云提供商之上部署覆盖网络，包括 AWS、谷歌云、阿里云等。这些提供商网络结构中的传感器实时收集关于提供商可用的各种路由性能的数据。然后，基于云的协调器可以决定如何在特定 SaaS 提供商及其客户之间最有效地路由流量。

orchestrator 还控制着部署在这些公共云提供商架构中的虚拟化路由引擎。该路由基础设施在任何给定时间在用户和 SaaS 提供商之间建立最快的路径，例如，以增强基于云的存储应用的数据上传性能。如果不同路线上的性能更好，则会实时进行路线调整。目标是在用户和提供商之间获得最佳吞吐量、最佳延迟和最严格的丢包控制。

这种解决方案具有接近无限的可扩展性。当流量上升时，更多的虚拟云路由器可以旋转起来，当流量下降时，这些容器就会被丢弃，直到再次需要它们。这是处理容量需求的一种优雅方式。总的来说，这种解决方案为 SaaS 提供商提供了他们从公共互联网上永远得不到的性能控制，这有助于提高用户满意度和降低客户流失率。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>