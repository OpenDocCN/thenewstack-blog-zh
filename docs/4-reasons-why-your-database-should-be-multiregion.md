# 为什么您的数据库应该是多区域的 4 个原因

> 原文：<https://thenewstack.io/4-reasons-why-your-database-should-be-multiregion/>

[](https://www.linkedin.com/in/krithikakb/)

 [克里蒂卡巴拉古鲁纳坦

克里蒂卡是 DataStax 的产品管理总监。几年来，她一直从事数据运营方面的工作，包括事件处理、流和数据管理。她拥有卡内基梅隆大学的电子工程学士学位和信息系统管理硕士学位。](https://www.linkedin.com/in/krithikakb/) [](https://www.linkedin.com/in/krithikakb/)

在今天的市场中成功竞争已经足够困难，而不必担心一个关键应用程序(如果你是零售商或银行，或者跟踪包裹和车辆的运输提供商，你的移动应用程序)是否会宕机。人们期望应用程序随时随地可用且响应迅速。

冗余是解决这些苛刻要求的一个重要方法。您可以构建一个无状态应用程序的多个实例来确保可用性，但是如果它们与单个数据库实例相结合，那么这样做不会有太大的区别。更好的方法是跨多个数据中心部署您的应用程序和数据库，然后同步数据库实例以在数据中心停机时幸存下来。

但这并不能解决你所有的潜在问题。连接到发生故障的地区或数据中心的用户无法访问您的服务或购买您的商品。您可以将应用程序重新路由到工作区域中的数据库，但是这会抑制购买，因为它们不能进行记录购买所需的写操作；他们所能做的就是阅读你的目录。写入可用性最终会得到恢复，但由于这种糟糕的体验，用户将会流失或找到另一家供应商，这是一个巨大的风险。

## 进入多区域数据库

在全球多个地区复制数据是解决全球分布式应用程序的许多潜在问题的一个重要方法。它不仅减少了本地最终用户的延迟，而且如果出现问题，您还可以获得提高可用性、确保业务连续性和支持灾难恢复计划所需的冗余。

完成这种数据复制需要跨多个区域或数据中心部署主动/主动数据库。大多数分布式数据库是主动/被动的，其中有一个主数据库同时提供读取和写入服务，其余的数据库实例是只读的。在主动/主动数据库中，所有实例都可以接受读写请求。有一个数据库，但它分布在多个区域，数据复制，通常部署在云提供商。地区可以跨洲，也可以在一个国家内。

Apache Cassandra 是一个比较流行的、经过验证的主动/主动分布式数据库。借助 Cassandra，企业可以获得可靠的可靠性、个位数毫秒级延迟和高吞吐量，并且不存在“主/副本”关系。当出现故障时，关系数据库和一些 NoSQL 数据库需要费力的手动过程来在主区域和辅助区域之间进行故障转移。另一方面，Cassandra 是一个“AP”(可用和分区容忍)数据库，因此如果网络连接中断或数据中心宕机，Cassandra 会“自我修复”

现在我们对多区域数据库有了一个更清晰的了解，让我们来看看受益于这种架构的用例。

## 灾难恢复

云提供商区域或数据中心一直在下降。这是一个不可避免的事实，经常成为头条新闻，并可能导致重大业务中断。

对于拥有大型电子商务业务的零售商来说，这可能会导致数百万美元的收入损失，因为用户无法将您目录中的商品放入他们的购物车。对于大多数企业来说，跨多个区域并支持即时故障转移的数据库远比在一个区域出现故障时从云提供商那里获得“不便之处，敬请原谅”和积分更为可取。跨区域复制数据库可让应用程序立即与正在运行的区域连接，从而在发生灾难时保持业务连续性。

## 数据主权

许多国家要求数据位于特定的地理区域内。例如，运输供应商可能需要在某个地区(如欧盟)保存客户档案数据，以满足通用数据保护法规(GDPR)的要求。其他数据，如运输状态或位置数据，可以在全球范围内复制，因为这些数据不受当地政府的监管。越来越多的国家/地区正在实施数据治理规则，规定写入必须在本地进行，并要求所有用户数据都保存在国内。例如，中国要求所有客户数据首先写入本地数据中心；读取操作可以跨越其他地理位置。使用 Cassandra，可以指定哪些数据可以留在国内，哪些数据可以复制到其他地方。以这种方式，例如，企业可以将所有客户简档数据保存在特定区域，但是跨其所有区域复制装运状态数据，以便多个地理位置的用户可以跟踪包裹。

## 延迟减少

当你的应用程序的用户分布在多个地区时，在每个地区都有一个接入点是减少延迟的重要方法。假设您的数据中心在爱尔兰，而您的数据工作负载和终端用户在中国。您的数据可能要经过几个路由器才能到达数据库，这可能会在用户发出请求和响应被发送回来之间的时间上引入很大的延迟。

为了减少延迟并提供最佳用户体验，您希望让这些数据尽可能靠近最终用户。如果您的用户是全球性的，这意味着在他们居住的地理位置复制数据。

## 主动/主动应用架构支持

一些分布式数据库是主动/被动的，因此当主区域关闭时，您将失去写入事务的能力，直到选择新的主数据库。主动/主动体系结构的一个好处是，您可以写入任何节点。当您组合应用程序的多个实例和多个 Cassandra 区域时，当一个区域关闭时，您的应用程序可以继续为用户提供服务。此外，企业可以轻松扩展应用程序实例的数量和区域的数量，而无需修改应用程序代码。

## 无服务器架构如何让多区域经济实惠

尽管使用多区域数据库有很多好处，但大多数企业还没有采用这样的架构。为什么？跨多个地区运营的相关成本是一个巨大的障碍，因为在每个地区维护硬件的相关成本是固定的，与硬件的使用量无关。如果大多数用户在一个地区，那么必须在另一个地区维护一个同等大小的数据库。此外，随着每个区域的增加，还有线性扩展的成本。换句话说，你必须扩展到你可能在你最大的地区看到的预期峰值，但是在所有地区都要这样做。

然而，数据库技术的最新创新可以解决这一挑战。无服务器数据库结合现收现付的定价模式可以打破这一障碍。无服务器组件使企业无需调整基础架构，因为数据库将按需实例化，并根据工作负载的大小自动调整。现收现付组件使成本随使用情况而变化，并提供了显著的节约，因为对于每个地区，企业将支付复制数据的写入次数和数据传输费用。

市场上有几个无服务器的数据库，甚至有些采用现收现付的定价模式。但是，大多数都与特定的云提供商相关联。因此，数据的可移植性受到限制。 [DataStax Astra DB](https://www.datastax.com/products/datastax-astra?utm_source=TheNewStack&utm_medium=article&utm_campaign=4+Reasons+Why+Your+Database+Should+be+Multi-region) 是一个多区域、[无服务器](https://thenewstack.io/the-serverless-database-you-really-want/)数据库即服务的例子，构建于 Cassandra 之上，也是多云的。它可以在 AWS、Azure 和 Google 上运行。它支持数据库的旋转，能够在多个区域自动扩展和缩小，只需点击几下鼠标，以支持灾难恢复、数据主权和延迟要求。

无服务器、多区域数据库是确保组织能够满足应用程序用户期望的关键方法，无论他们在世界的哪个角落，都不会对性能问题失去耐心。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>