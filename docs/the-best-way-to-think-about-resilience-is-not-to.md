# 思考弹性的最好方法是不要

> 原文：<https://thenewstack.io/the-best-way-to-think-about-resilience-is-not-to/>

如果你长时间使用文字处理工具，你会记得按下“保存”键盘快捷键的反射动作——害怕失去工作，大声咒骂，哀叹刚刚失去的惊人工作。

有了现代工具(想想谷歌文档)，这种担心甚至不会出现。说到一半就没电了？没问题。一切都保存在您离开时的状态，您可以继续前进。

Samar Abbas 和他在工作流程编排引擎 Temporal 的团队希望将这个概念引入到您的企业工作流程中。您提供业务逻辑，他们处理所有需要专业知识的部分，如持久性和弹性。

2019 年，Abbas 和他的同事 Maxim Fateev 在优步创立了 Temporal 。他们为叫车应用公司创建了一个名为“Cadence”的开发平台这是 2000 年代中期两人在亚马逊共事时帮助开发的 [AWS 简单工作流服务平台](https://docs.aws.amazon.com/amazonswf/latest/developerguide/swf-welcome.html)的演变。数十种优步服务和应用采用了[的节奏](https://cadenceworkflow.io/)。

Abbas 和 Fateev 离开后共同创建了 Temporal，并建立了 Cadence 的容错工作流引擎后续项目。在此后的三年里，该公司取得了稳固的成功，网飞、Instacart 等公司都使用了 Temporal 的开源软件代码。今年早些时候，该公司获得了 1.03 亿美元的 B 轮融资，估值为 15 亿美元。

我最近和阿巴斯(你可以在这里观看整个过程)谈了一次关于他和 Fateev 是如何建立他们非常成功的企业的。(下面他的话是为了清晰和篇幅而编辑的)。

## 从优步到时间

2015 年，优步在西雅图开设了办公室，我加入了他们的工程团队。我和马克斯(Temporal 联合创始人马克西姆·法提夫)在不到一个月的时间里先后来到了优步。我们一起工作的关键项目是 Cadence。

在优步，工程师们花了大量时间将底层队列、数据库和持久计时器拼接在一起，以增强应用程序的弹性。

这就是我们试图用 Cadence 这样的系统来解决的问题，在 Cadence 中，我们提供了仍然基于代码的高级抽象，但我们将某些类别的故障从工程师手中拿走，并在平台下解决它们，以允许工程师专注于应用程序的业务逻辑，而不是构建弹性。

这在优步取得了成功，由于它是开源的，我们开始看到该技术在外部被大量采用。所以在 2019 年，我和 Max 都决定迈出这一步，开始了 Temporal，因为我们真的想专注于技术的外部采用。

## 暂时的开发者体验

人们有时会将 Temporal 描述为工作流引擎，或者描述其功能，但对我们来说，关键的价值主张是开发人员的工作效率:开发人员可以多快地构建应用程序，并让它们在生产中运行，而无需花费数周或数月时间来测试云原生环境中可能发生的各种故障情况。

所以我们思考开发者体验的方式不仅仅是技术必须提供的核心方面；我们从一开始就涵盖了整个软件开发生命周期，包括开发人员如何构建他们的应用程序。例如，许多工作流引擎通常采用特定领域语言(DSL)路线。我们都是基于代码的。我们知道开发人员喜欢编写代码，我们也希望他们编写代码，但是不要担心某一类问题，比如如果一些底层基础设施出现故障，如何使代码具有弹性，或者当网络故障发生时，如何使代码具有弹性。

## 时间因素何时以及如何发挥作用？

资金转移是时态使用非常频繁的关键用例之一。如果您将资金从一个帐户转移到另一个帐户，通常从用户的角度来看，是的，我从帐户 A 借记，然后贷记到帐户 b。但是大部分软件开发时间都花在这两次调用之间的系统故障上。这基本上是工程师们花费各种时间的地方。

这是一个像 Temporal 这样的系统可以帮助大时代的例子，甚至感觉很神奇。我们经常听到这样的问题:如果我的应用程序在这一点上失败了，会发生什么？

我们对这个问题的回答是:工作流永远不会失败(在时间上，我们称我们正在构建的原语为“工作流”)然后就是电灯开关打开的那种时刻。我们已经开始称之为“持久执行”，在高层次上，我们提供的是:你的执行是完全持久的。他们从不失败。

## “忽略故障”状态工作流的业务影响

早在 90 年代，当我还在上学的时候，我们曾经用微软 Word 打所有的作业。你已经习惯了每次编辑完一些内容就保存你的文档。然而，有一类特定的故障，比如硬盘故障，你会丢失所有的工作。

现在，有了谷歌文档，孩子们甚至无法理解这个。甚至连“保存”按钮都没有了。我们认为，有一类有状态应用程序仍然处于 20 世纪 90 年代，其中 80%以上的代码是关于处理基础设施故障，以建立有状态应用程序的弹性。每当一个事件发生，你加载那个状态，应用那个事件，做一堆动作，然后把那个状态存回来。这是大多数工程的方向:如何使其可靠、快速、高效，并保护其免受各种故障和损坏。

开发人员甚至不应该认为他们会丢失状态。只有这些持久的执行永远不会失败。我认为这将彻底改变工程师对云原生系统的看法。

## 为什么要管理 Apache Cassandra？

我和我的联合创始人 Max 有着构建消息传递系统和中间件的背景。运行存储系统不是我们的强项。因此，当我们只有两个人创办公司时，我们的一个主要目标是利用我们的优势，为临时用户提供最好的开发人员体验。Temporal 有一个服务器组件和客户端 SDK，大多数开发人员用它们来构建应用程序。但是，人们如何以最小的操作开销运行这些服务器呢？这是运行时态的大部分开销所在。

我们有一个可插入的持久模型；我们支持 Apache Cassandra、MySQL 和 Postgres 作为可插拔适配器。Cassandra 是具有非常好的可伸缩性特征的适配器之一。对我们的用户来说，一个关键的价值主张是，他们正在运行[任务关键型应用](https://thenewstack.io/an-apache-cassandra-breakthrough-acid-transactions-at-scale/)，可靠性是他们寻求的关键。因此，当我们把一个新的依赖带入时间折叠时，我们不能掉以轻心。我们对各种持久性选项进行了一个多月的评估。这是 [DataStax Astra DB](https://dtsx.io/3yvKSSb) 手到擒来的。

有些数据库在某些特性上胜出，有些则在其他特性上胜出。但在这种情况下，它甚至与技术无关；是关于人民的。我们相信错误和失败是生活的一部分。这完全是关于当停电发生时你如何应对。这就是我们认为 Astra DB 获胜的地方。DataStax 对待客户的方式和他们在运营数据库时建立的关系有很多相似之处。这给了我们信心，这是我们想要为系统的核心部分投资的依赖。

我不认为如果没有像 Astra 这样的技术，我们就不会有今天的成就。像运作 Cassandra 和单独“完成”事情这样的事情至少需要一年的时间，这甚至不是我们核心优势的一部分。对于像我们这样的公司，关键价值主张是可靠性，如果我们不能找到一种可靠的方式来运行和操作您的存储，我们就没有业务。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>