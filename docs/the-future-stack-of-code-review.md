# 未来的代码审查栈

> 原文：<https://thenewstack.io/the-future-stack-of-code-review/>

在今天的传统代码审查过程中，人是如何审查代码并最终提交给产品的重要部分。一个人阅读并评论代码，以确保它经过同行评审，并与工程过程和最佳实践保持一致。

当代码质量成为业务的一个关键方面时，代码评审开始成为软件交付的一个组成部分。启动同行代码评审是为了对代码、改进进行额外的“观察”和输入，并可能在交付生产之前及早发现错误和修复。

然而，像软件工程的所有方面一样，甚至代码审查也有了很大的发展，今天的[代码审查](https://thenewstack.io/linkedin-code-review/)需要在代码交付生产之前确保各方面的多样性，包括:

*   与干净的代码实践保持一致
*   确保可读性
*   验证质量并防止潜在的错误
*   检查性能
*   验证安全性

其中每一个都需要自己独特的领域专业知识。不是每个工程师都能成为所有领域的专家。现实情况是，有如此多的代码和经验可用，以至于我们的许多代码都是样板和重复的——以至于我们正在目睹像 [GitHub 的人工智能程序员 CoPilot](https://github.com/features/copilot) 这样的工具。虽然他们如何训练他们的模型和他们使用的代码是有争议的，但从编码的角度来看，这是非常令人难以置信的，并且完全改变了游戏。如果一台机器可以编写工作代码，那么审查它应该是一件容易的事。

## 为机器和人类优化流程

像许多其他已经经历了自动化的工程学科和实践一样，我们相信未来的代码审查也可以被优化，从创建混合过程中受益，该混合过程将在过程中发挥人和机器的不同优势。

同样，我们的 CI/CD 流程和架构受益于工具，在将我们的代码交付和部署到产品之前，自动化许多审查和关口，[代码审查也可以经历类似的发展](https://thenewstack.io/how-good-is-your-code-review-process/)和转变。

人类与机器的本质凸显了另一个好处。人是主观的，工具是客观的。有感觉的人会做出完全不同的决定和判断，这些决定和判断甚至可能没有数据或常见模式的支持，而是主观的，基于最近的经验(回忆或锚定偏见，有人吗？).

代码审查的未来，就像 CI/CD 和工程中的许多其他自动化过程一样，应该努力扭转大约 80%由工具和机器执行，20%由人工验证和干预的范式。

## 理想的代码评审过程

今天的代码审查在很大程度上仍然是手工的，等待一个人拾取一个拉请求(PR)，审查它，然后将它合并到代码库中，以便与下一个版本一起部署。随着开发人员现在需要负责越来越多的任务和规程，这个过程的大部分已经过时，可以针对速度进行优化。

我们相信，像其他工程领域一样，已经发展并实现了速度和效率方面的许多好处，我们的代码审查过程也可以随着新的和优秀的机器和工具的出现而被重新考虑。如果我们考虑理想的(未来的)代码审查，它应该是这样的:

这种理想的代码审查从手工开始。对于我们想要应用的任何自动化来说，一个好的实践是:开始手动，验证过程，然后自动化。对于每个代码评审，人类评审员识别每个 PR 的可以自动化的注释，并致力于实现或训练一个工具，该工具可以在下一个代码评审中自动化这个特定的验证或检查。

通过这种方式，人类领域的专业知识被封装在我们应用的自动化中，而不是简单地由不基于人类经验的简单机器驱动的测试组成。

当然，像 linters，scanners 等好的工具已经存在，以确保重复和常见的错误，错误配置和其他糟糕的编码实践不会达到 PR 或 production 代码。最佳实践是将这些作为其他自动化检查的一部分，甚至在它们到达代码审查之前。

## 最小化自动化代码评审中的噪音

我们知道你在想什么:更多的自动化=更多的噪音。像所有自动化和基于机器的工具一样，这也可能为每个 PR 产生太多的噪音，导致人类忽略它们。那么，我们如何在保持速度的同时，防止自动化代码审查给已经饱受警觉疲劳之苦的工程师制造太多噪音呢？

降低噪音的关键在于补救措施。信息很重要，但是如果我不知道如何解决问题，它也帮不了我。这就是智能自动修复的用武之地。(当然，不会危及安全)。

在这里，我们将通过更多的对话式交互(如机器人)来应用以前的评审者嵌入到系统中的知识，这些对话式交互充当自动化代码评审者，而无需绕过人工干预和最终推向生产。这是为了“硬技能”的角度，质量，造型，错误和错误配置。

但是还有代码评审为工程组织带来的“软技能”价值，它不能也不应该被忽视，甚至可能在代码评审中提供最大的价值。我最近在 Twitter 上问，代码审查的目的是什么，我对一些反馈感到惊讶，包括这个特别的回复:

虽然我们总是可以利用工具、机器人和机器来完成重复和简单的任务，但这些工具缺乏向一些工程经理提供真正的学习和指导的能力，而这是代码评审中最重要的方面之一。

我们可以在流程中同时使用人类和机器人来获得最大价值的一个例子是，将“吹毛求疵”和次要的修复(从错别字到缺少重要标题的 API)留给机器和自动扫描来执行。

流程中的人员可以提供基于人员专业知识的输入和见解，旨在实现更大的改进、技能提升和指导。他们可以提供注释来帮助创建更高性能的代码或优雅、简洁的代码，而不仅仅是确保代码正常运行，没有打字错误或配置错误。

当我们添加工具，为我们提供关于这段代码对我们系统的重要性的更大的上下文，让机器提供重复的修复，并让人类提供关于这些修复如何影响我们的系统作为一个整体的额外洞察力层时，我们可以成长和学习，并从审查中获得更大的视角。

想象一下，这对其代码正在被评审的工程师来说是多么有用，当他们收到这样一个对代码及其在系统中的上下文的整体概述时，他们对评审过程会有更大的信任。

## Jit 和下一代代码评审

代码安全(SaC)最终实现的核心之一是自动化，这是 Jit 努力积极推动的工程思想。通过将安全计划公开为代码，现在作为代码审查过程的一部分的安全门变得更加容易自动化，并最终以最少的人工干预来解决。这将人类从审查真正复杂的问题中解放出来，并将重复性的人工检查留给了机器。

另一个正在形成势头的领域是重新审查公共关系的一般过程，并重新思考是否所有的公共关系都应得到同样的人的关注。今天有许多工具在寻求简化公关管理，像 [LinearB 的 gitStream](https://linearb.io/dev/gitstream/) 或 [MergeQueue](https://mergequeue.com/) 。

这些工具使您能够创建智能规则来跳过对 PRs 的人工审查，这些 PRs 不需要相同级别的审查—配置和版本更新、文档编辑等等。这些也应该成为未来代码审查的组成部分。

手动代码审查过程也可以自动化，以处理机器比人类更适合修复的部分。

随着软件交付越来越复杂，让我们把人类的时间留给人类可以提供最大价值的地方，并利用机器完成他们擅长的重复性任务。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>