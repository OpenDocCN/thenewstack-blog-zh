# 初级读本:什么是容器安全？

> 原文：<https://thenewstack.io/primer-what-is-container-security/>

这篇文章是一个多部分的系列文章，探讨了保护容器的挑战。检查整个月的额外分期付款。

软件容器背后的技术至少在 21 世纪初就已经存在于[。然而，软件容器只是在最近几年才成为软件开发中的一个热门话题——在像](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-190.pdf) [Kubernetes](https://kubernetes.io/) 和 [Docker](https://www.docker.com/) 这样的容器开发平台推出之后。

根据 [RightScale 2019 年云状态报告](https://info.flexera.com/SLO-CM-WP-State-of-the-Cloud-2019)，软件容器和容器即服务是最受欢迎的云新用途之一，它们的受欢迎程度逐年增长。

虽然软件容器并不是什么新鲜事，但对它们需求的突然增加才是。因此，并不是所有的开发人员都知道如何构建和使用容器来确保容器和平台的安全性。

如果您或您的团队对使用软件容器感兴趣，您将需要了解您应该用来保持这些容器及其运行平台安全的最佳安全实践。

## 什么是软件容器？

软件容器[与虚拟机](https://blog.netapp.com/blogs/containers-vs-vms/)相似，但又不同。

“通过容器，复杂的应用程序可以部署在一台主机上，利用该主机上容器中的许多不同的微服务主机，”总部位于加利福尼亚州山景城的云安全解决方案提供商 [Lacework](https://www.lacework.net/) 的系统工程师 [Brian Bernstein](https://www.linkedin.com/in/brian-bernstein-1432b2b3/) 说。

“在过去，”Bernstein 说，“在以主机为中心的应用网络或基于主机的安全环境中，当服务在机器之间移动时，你可以看到服务之间的交互。对于容器，您可能只能看到入站和出站连接，不要忘记这些连接可能是加密的。这些容器之间的所有内部联系将是一个完全的谜。通过将安全性转移到容器，您可以重新获得视图，就像我们以前在每主机天数服务中所做的那样。”

“此外，”他说，“容器不像虚拟机那样是纯粹的沙箱。如果有人能够接近集装箱，就有可能发生集装箱逃逸。如果他们可以访问基本主机，那么他们就可以访问该主机上的所有容器。这也是为什么控制应该总是部署在风险载体上的另一个原因，在这种情况下，就是容器本身。”

几乎总是，容器比虚拟机更轻。与 VM 不同，容器在运行时共享主机操作系统的内核，并且不需要完全模拟操作系统来工作。因此，一台运行四个或五个容器化软件的物理服务器只需要运行一个操作系统。相比之下，一台虚拟机需要同时运行该操作系统的四个或五个副本。

“容器化在灵活性和更快的应用程序开发方面提供了许多好处，”总部位于加州山景城的专门从事容器和 Kubernetes 安全的公司 [StackRox](http://www.stackrox.com/) 的产品和企业营销副总裁 [Michelle McLean](https://www.linkedin.com/in/michellemclean/) 说。她预测，这些优势推动了广泛采用，并指出，根据 Gartner 的数据，到 2020 年，超过 50%的全球组织将在生产中运行容器化的应用程序。

“容器以及 Kubernetes 等编排器开创了应用程序开发方法的新时代，实现了微服务架构以及持续开发和交付，”她说，并补充说，Docker 是迄今为止最主导的容器运行时引擎，根据该公司最新的[容器状态和 Kubernetes 安全报告](https://security.stackrox.com/the-state-of-container-and-kubernetes-security-report-2019.html?Source=Website&LSource=Website)，其渗透率为 91%。

除了占用更少的资源之外，容器也很有用，因为容器化的软件甚至可以在从一个环境移动到另一个环境时可靠地运行——从公共云到私有数据中心，再到开发人员的笔记本电脑。

许多变量可能因环境而异。容器通过捆绑一个软件需要运行的所有东西——它的库、依赖项、配置文件等等——来避免这个问题，因此即使在具有不同操作系统或网络基础设施的系统上运行，软件也能正常工作。

捆绑的组件称为映像。这些图像的层构成了一个软件容器。

## 集装箱的常见安全风险

然而，这种使容器对开发人员有用的灵活性也带来了安全挑战。在每个容器中，自然会有许多不同且各自复杂的组件，这些组件都可能带来安全风险和漏洞。

“容器已经彻底改变了应用程序开发——特别是它们的构建和扩展方式, [SaltStack](http://www.saltstack.com/) 的首席技术官兼联合创始人 Thomas Hatch 说。

“这反过来又导致了安全、存储和网络方面的挑战，以及部署到公共云或本地服务器所面临的复杂性，”Hatch 说。。容器用户面临的最大的云安全威胁是容器等同于安全的错误假设。"

Hatch 说:“容器的安全性取决于在其中运行的代码以及它所运行的基础设施。”。“如果您重新部署过时或带有漏洞的容器映像，那么您可能会加大风险或导致重复违规。请记住，目前在 Docker Hub 上发现的很大一部分容器都有已知的漏洞，但人们仍然将它们作为他们的主容器或容器的基础。”

> “等到进入生产阶段才引入容器和 Kubernetes 安全解决方案会限制从 DevOps 流程中获得的优势，因为只有在开发管道的末端才发现安全问题时，部署才会延迟。”——Michelle McLean，StackRox。

Hatch 说:“Docker 社区中有一种虚假但普遍的情绪，认为操作系统无关紧要，操作系统是一个商品化层。”“这个问题凸显了这种假设是多么惊人地错误。安全有效的交付是企业操作系统的基础。它运行的软件应该总是来自可信的来源，但是不安全的 Docker 图像的泛滥是一个严重的问题。”

“组织真正需要考虑的是相对于所述软件的复杂性，软件来源的信任度，”他说。“简单的、新的和小的软件项目很容易验证和发现问题。随着时间的推移，他们也会建立信任。Docker 绕过了开源软件内置的这种自然防御，因为可信软件是从不可信来源分发的。Docker 还代表了一个非常大的森林，这些威胁可以隐藏在其中。在分发操作系统映像时，有数百个二进制文件可以被操纵来秘密隐藏当前安全和 DevSecOps 工具不会发现的问题。”

通常，如果一个软件有风险，开发人员只需要担心软件本身的安全性。与标准软件或虚拟机相比，容器化软件需要考虑更多的组件。

根据该公司最近的调查，尽管三分之二的组织将超过 10%的应用程序容器化，但 40%的组织仍然担心他们的容器策略没有充分投资于安全。另有 34%的人表示他们的策略缺乏足够的细节。

“这些数据表明，公司正在迅速接受容器和 Kubernetes，但还没有运行这些系统的安全计划或其他细节。”

使用软件容器有一些安全上的好处。一般来说，容器比虚拟机更容易打补丁，你不用担心操作系统。软件开发人员通常在构建容器时假设软件可能会逃逸——然而，对于大多数虚拟机，存在特定安全级别的假设。

网络安全和威胁检测[是软件开发的两个基本组成部分](https://www.blackstratus.com/cybersecurity-threat-detection/)——不管你的软件是否容器化。如果你想确保你的集装箱是安全的，你需要采取一定的预防措施。

## 保护软件容器

“太多的公司都在等待，直到他们准备投入生产，以引进安全，”麦克林说。“这些环境大多非常复杂，部署了多种安全、监控、日志记录和事件管理解决方案。等到进入生产阶段才引入容器和 Kubernetes 安全解决方案会限制从 DevOps 流程中获得的优势，因为只有在开发管道的末端才发现安全问题时，部署才会延迟。”

“应该尽早将安全纳入其中，”她说。“它必须成为容器基础设施构建和部署周期以及生产运行时的核心组件。”

当开发容器化软件并确定容器可以访问哪些资源时，遵循与任何软件相同的安全编码最佳实践。

安全性始于操作系统级别。许多流行的容器平台的现代版本默认启用 OS 安全特性，并使使用任何可用的内核安全特性变得容易。例如，在 Docker 的早期版本中，容器唯一可用的权限设置是 root 访问或无。现在，在使用容器可以拥有的权限时，您有了更多的灵活性。大多数流行的容器开发平台也是如此。

在开发软件和使用容器时，您或您的团队将需要回答某些问题，如您希望容器如何相互通信，您将如何管理容器更新(尤其是当您需要一次更新多个容器时)，以及您将如何管理共享资源(如存储和网络访问)的可用性。

[Aqua Security](http://www.aquasec.com/) 副总裁[安迪·费特](https://www.linkedin.com/in/andyfeit/)说:“今天的数字化转型举措都是为了快速前进。“了解业务需求，快速创建或调整在线体验，为公司的成功做出最佳定位。其中的一个关键部分是在尽可能短的时间内将代码从开发阶段投入生产。”

“一种方法是消除重构代码以在选定的 IT 操作平台上运行的传统障碍，而是以容器化映像的形式部署来自开发的应用程序，”他说。“这通常是在云原生模型中完成的，无论是在内部还是在公共云基础架构上。但是，这些新模式改变了安全模式，因为传统的外围安全解决方案很难保证这些部署的动态性，而且通过自动化 CI/CD 管道持续更新应用程序几乎没有时间进行独立的安全测试。”

“容器安全解决方案通过整合到开发周期中来解决这些需求，在代码创建时标记任何漏洞，”Feit 说。“随着容器走向部署—无论它们最终将在哪里运行—容器安全部门确保已批准的映像未被修改。最后，对容器的运行时监控会寻找任何恶意行为的迹象，并允许对只允许授权活动的策略进行精细实施。”

理想情况下，您将使用一个容器平台，该平台旨在自动和定期地扫描和修补容器，确保这些容器始终使用其依赖项和库的最新版本。这样做将减少容器所依赖的其他代码带来的安全风险。

使用像 Docker 或 Kubernetes 这样的知名容器平台，您可以获得安全协议，帮助您或您的团队确保您的容器是安全的。然而，您不需要使用容器平台来安全地使用容器。

如果您或您的组织愿意在安全性上花费一些钱，企业容器安全性解决方案是存在的。这些解决方案可以审计容器映像和策略，提醒您容器带来的过时资源和潜在安全风险。

然而，在许多方面，软件容器安全性仍然有点像西部荒野——软件开发人员还没有得出任何可靠的结论，即开发人员应该如何最好地处理容器开发以降低安全风险。一些组织，如国家标准和技术研究所，已经发布了安全标准，可以帮助开发者安全地构建和使用软件容器。如果您的组织缺乏可以帮助您指导容器安全方法的机构知识，像这样的指南可能会有所帮助。

## 开发人员如何保证容器的安全

“随着新的开发和操作技术的采用，”伯恩斯坦说，“集装箱的速度和动态特性也在增长。将容器视为主机并扫描易受攻击的包是不够的。您必须在整个生命周期中采取全面的方法。”

“安全工具现在正在寻找解决从构建时、左移到运行时的问题，”他说。“通过解决整个生命周期中的安全性问题，您提高了防患于未然的可能性。例如，您如何知道今天构建的容器在一周后没有漏洞？您如何知道 web 界面中的错误不会导致数据泄露？诸如此类的例子表明，安全工具需要解决整个问题，而不仅仅是沿途的一些点。”

“现代 DevOps 的运作方式，”他说，“没有自动化就不可能实现成功的控制。规模和动态性质太大，无法通过使用静态或手动更新的工具来尝试和跟上。如果您的安全工具跟不上您的开发运维团队的运营方式，那么它就不太可能被采用或有效。”

来自 Pixabay 的 Volker Glä tsch 的特写图片。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>