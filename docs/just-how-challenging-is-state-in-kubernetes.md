# Kubernetes 州的挑战性有多大？

> 原文：<https://thenewstack.io/just-how-challenging-is-state-in-kubernetes/>

“国家是硬的。这是底线，” [CloudBees](https://www.cloudbees.com/) 的首席执行官 Sacha laboury 解释道。"我不认为在 Kubernetes 中管理状态一定比在其他环境中更难."

在 Kubernetes 处理状态真的很难吗？或者，正如我们在开发者经验和 Kubernetes 中已经看到的那样，这与其说是一个技术问题，不如说是一个技能差距？

“Kubernetes 是一个非常工程化的平台，”Red Hat 的 OpenShift 集装箱存储首席产品营销经理 [Karena Angell](https://www.linkedin.com/mynetwork/invite-sent/karenaangell/?isSendInvite=true) 说。“从外面看起来很难，因为它技术性很强。因此，在 Kubernetes，存储真的很难，这是一个认知差距。”

## 这一切都是新的

“企业 IT 在过去 50 年中或多或少以其现代形式存在，”波特沃斯营销副总裁迈克尔·费兰蒂说。"其中有 48 年，我们没有在 Kubernetes 上运行数据库."

在传统世界中，数据库管理员需要花费数年甚至数十年的时间才能成为某个特定数据库的专家。他们每年都会飞去参加甲骨文或微软的会议。高级数据库管理员可能有 15 年或更长的经验。Kubernetes 于 2014 年 6 月首次发布。没有人有 15 年在 Kubernetes 上运行数据库的经验，尤其是在具有面向客户的应用程序的企业环境中，这些应用程序具有安全性、合规性和 SLA 要求。

从组织上来说，遗留系统也使得个人或组织更难转换技术。Oracle 数据库管理员有一大堆只对 Oracle 数据库有效的认证——虽然迁移到 MongoDB 或 PostgreSQL 时显然会有一些技能转移，但成为数据库管理员专家所需的大部分知识不会在供应商之间转移。

尽管如此，Ferranti 说，Kubernetes 还是有办法让事情变得更简单。你不需要在 MongoDB、Postrgres、Kafka 和其他数据库中建立深厚的专业知识，你只需要学习如何使用 Kubernetes，它将允许你管理各种数据库平台。

“Kubernetes 旨在提供一个抽象的金发女孩层次，”Kubernetes 的最初创造者之一，现任 [VMware](https://www.vmware.com/) 现代应用平台业务部门产品和战略副总裁的 Craig McLuckie 说。“我们的目标是拥有足够低的级别，让您可以运行任何东西，而不是足够高的级别，让它隐藏您基础架构的具体细节。”

这并不意味着企业数据库平台的所有工具都已准备就绪。“整个生态系统正在成长和成熟，”安吉尔说。“因此，如果你来自一个企业平台，你可能看不到你期望看到的东西。”

## 挑战

除了经验差距，在 Kubernetes 中处理状态还有一些真正的挑战。首先，如果一个有状态的应用程序从一开始就没有以正确的方式构建，那么成功是难以捉摸的——负责堆栈每一层的每个人都必须做出正确的选择，以确保状态持久。

还有一个事实是，国家在某些方面违背了 Kubernetes 看待世界的方式。“Kubernetes 背后的意图是能够将大量的商用机器缝合在一起，并将它们作为分布式应用程序的目的地，在那里你不再局限于特定的实例，”McLuckie 说。"如果你有局部持久的状态，那就代表了对隐喻的挑战."

还有手术要担心。“许多有状态的工作负载具有非常具有挑战性的操作行为，”McLuckie 说。如果您正在升级可能处于多个实例中的数据库，您必须在升级过程中管理协调，以确保不会中断服务

另一个问题是扩展，这在多云或混合云环境中极具挑战性。

## 避免陷阱

有一件事每个受访者都同意:在 Kubernetes 中成功处理状态是完全可能的，但巧妙地做到这一点需要理解 Kubernetes 如何看待世界，并与之合作，而不是反对它。根据 Angell 的说法，关键是要确保在一开始就正确地考虑架构——并意识到 Kubernetes 上有状态应用程序的最佳架构与运行传统的有状态应用程序并不相同。

“很多人在 Kubernetes 上提供服务时，会试图尽可能少地改变一些东西，”Ferranti 表示同意。“我认为这是人们犯的最大错误之一，把在 Kubernetes 之外有效的东西拿来，并假设它在 Kubernetes 中也会有效。”

“我看到很多客户在 Kubernetes 上运行 NoSQL 和 MySQL 数据库取得了成功；我很有信心推荐客户使用 Kubernetes 处理各种各样的有状态工作负载。“我恳请组织开始考虑的是，‘我应该引入哪些额外的存储资产？我如何让我的开发人员以一种自然的方式访问它们？随着时间的推移，这样做是否会降低我的存储解决方案的成本和复杂性？"

对 Kubernetes 能做什么和不能做什么保持现实也很重要。仅仅因为 Kubernetes 是一个非常强大的平台，非常适合多种类型的有状态工作负载，并不意味着它适合每种情况。如果公司将开发人员的奖金与将他们所有的工作负载放入 Kubernetes 捆绑在一起，开发人员可能会将本应单独放置的服务容器化——导致不愉快的后果。

## 库伯内特人的技能差距

也许不是国家难，而是 Kubernetes 难。“一旦你学会了 Kubernetes，如果你有合适的工具，运行有状态服务的增量跳跃是非常小的，”Ferranti 说。“可能是百分之五到百分之二十。但前 80%的人开始适应 Kubernetes，需要团队花 12 到 18 个月的时间。”

在 Kubernetes，州并不是唯一的挑战。首先，它通常伴随着组织的转变。其次，你必须弄清楚如何以新的方式做各种事情，通常没有一套清晰的最佳实践。如何设置入口控制器？如何管理负载平衡？

“弹吉他真的很复杂，”费兰蒂说。“一旦你学会了如何做，你就能做出优美的音乐，但要做到这一点比大多数人意识到的更具挑战性。”

在 Kubernetes 上管理状态是一样的，只是它更像是在管弦乐队中演奏，因为它要求每个人都在栈的所有层上工作才能把事情做好。对于刚开始库伯内特之旅的人来说，这似乎是不可能的，就像对于第一次拿起乐器的人来说，管弦乐队就像变魔术一样。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>