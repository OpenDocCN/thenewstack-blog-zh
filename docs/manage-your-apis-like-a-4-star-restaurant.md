# 像四星级餐厅一样管理您的 API

> 原文：<https://thenewstack.io/manage-your-apis-like-a-4-star-restaurant/>

[](https://www.linkedin.com/in/kkrishnaswamy/)

[kart hik Krishnaswamy](https://www.linkedin.com/in/kkrishnaswamy/)

[kart hik 是 F5 旗下 NGINX 的产品营销主管。他拥有芝加哥大学布斯商学院的 MBA 学位和伊利诺伊理工学院的计算机科学学位。他来自印度南部的钦奈，现在住在加州圣何塞。](https://www.linkedin.com/in/kkrishnaswamy/)

[](https://www.linkedin.com/in/kkrishnaswamy/)[](https://www.linkedin.com/in/kkrishnaswamy/)

这篇博客是由四部分组成的系列文章的一部分。

1.  [*创造 API 至上的文化和公司* *(第一部分)*](https://thenewstack.io/creating-an-api-first-culture-and-company-part-1/)
2.  [*创造 API 至上的文化和公司(第二部分* *)*](https://thenewstack.io/creating-an-api-first-culture-and-company-part-2/)
3.  *像管理四星级餐厅一样管理你的 API(本文)*
4.  *[平台运营团队应该如何思考 API 策略(第四部分)](https://thenewstack.io/how-platform-ops-teams-should-think-about-api-strategy/)*

著名的目的地餐厅，如旧金山的 Benu 或巴黎的 Guy Savoy，确实是一个值得一看的景观和味道。服务是无可挑剔的，每一盘食物的结构都带来了一波又一波的风味。每顿饭都有严格的顺序和间隔。走进厨房，你可能会看到一个干净的空间，厨师和厨师和谐地移动，好像他们在跳秘密舞蹈。当蜂拥而至的食客进来时，前厅工作人员知道他们可以把这些顾客引向酒吧，品尝美味的食物和美酒。最重要的是，整个用餐体验受到严格控制、管理和优化。

你可能不希望你的 API 团队做巧克力蛋奶酥或者刷盘子，但是一个好餐馆的运营和 API 生命周期管理有着不可思议的相似之处。从测试厨房到流水线烹饪，从供应商管理到确保没有预订的顾客不能溜进来或信用卡付款不是欺诈性的，多步骤、多模式的业务使一家餐厅像一部演奏良好的交响乐一样忙碌，需要规划、协作、协调和一套交付和展示的高标准。

## 测试厨房:API 协作和设计

测试厨房是魔法开始的地方。在这个合作空间里，餐厅厨师和团队聚集在一起尝试新的食谱，调整现有的食谱，并找出如何让食客惊叹的方法。

在并行技术世界中，首席 API 可能有不同的头衔，比如“API 工程总监”*或“产品、API 和集成副总裁”。他们与[平台运营](https://www.nginx.com/blog/why-every-company-needs-platform-ops/)或 DevOps 团队合作，首先为组织的 API 创建一个高级架构。然后，他们设计更具体的规则和惯例，比如食谱。API 工作空间是一个协作。在 SwaggerHub 或 Postman 等 API 发布套件上，存储了 API 配方库，团队成员可以挖掘现有的、经过审查和记录的 API，如 GIS、块存储或支付处理，以用作复合和复杂应用程序的一部分。*

 *## 生产厨房:应用程序汇集的地方

在生产线上，测试配方由配料和基础配方(原料、釉料等)组合而成。).在某些情况下，原料是生的，需要准备——想想水果和蔬菜。有些食材部分是由其他人准备的，比如送三文鱼片的鱼贩，或者完全是由另一个组织创造的，比如瓶装葡萄酒。

这些元素可以与第一方代码(从头开始)、微服务和内部 API(部分准备)以及外部第三方 API(在其他地方创建)相比较。如果没有复合应用程序(整个膳食)，每个小应用程序只是一个课程。一起吃，菜和饮料的结合创造了餐厅体验——用户体验。

厨房工作人员就像一个应用程序开发团队一样，将批准的食谱中列出的各种配料组合起来，制作出精美的菜肴。在数字世界中，我们通过消费图像和视频，或者通过使用 CRM 和视频会议工具来“吃掉”应用程序的输出。

## 驱动程序和运行程序:API 网关

催货员站在厨房的最前面。他们确保外来用餐者的要求及时得到满足，外带餐盘保持一流水平。expediter 相当于 API 网关——应用策略、监控流量并确保所有规则都得到遵守。在厨房外面，跑步者把食物带给服务员，然后送到餐桌上。这些运行器类似于负载平衡器和入口控制器，它们与 API 网关密切合作，以确保客户请求以正确的顺序被满足，并最终到达正确的位置。

## 前台和服务员:餐厅负载平衡器

有经验的餐厅的前台员工有一套应付顾客并让他们开心的诀窍。前厅部也是看门人，确保任何试图在繁忙的星期五晚上订到桌子的人确实有预定。前台团队也知道哪些顾客是常客——那些无论如何都能找到座位并受到白手套服务的顾客。

在 API 管理中，前台将是负载平衡器，防止餐厅被流量淹没，并确保只有经过验证的流量才能进入。

服务员管理顾客的体验，包括餐厅的面子和个性。这些人建议哪些食材是最新鲜的，确保盘子在正确的时间到达，并退回顾客拒绝的任何食物，并解释哪里出了问题。它们就像一个 API 可观察层，帮助厨房了解用户发生了什么，同时识别任何故障点和不良性能。如果顾客要求更换或者盘子看起来很脏，服务员会处理顾客的问题。

## 送货服务和包装产品:餐厅厨房的外部 API

随着来自 Omikase 的寿司或来自 Papalote 的玉米煎饼不断被送往饥饿的旧金山，餐馆显然正在寻求餐厅以外的收入来源。新冠肺炎危机突显出对配送收入的需求，以及创造保质期更长的零售产品在商店和网上销售的好处。

配送和零售产品是外部 API，打包后供合作伙伴或餐厅可能无法控制的其他渠道消费。事实上，近年来增长最快的餐馆类型之一是幽灵厨房，它只出售给送货服务。这就是餐饮业的 Twilios，对外服务就是整个生意。我们前面提到的催货员还负责验证这些外部需求是预期的、计划的和满足的。

当递送服务在没有任何协议或通知的情况下将餐馆添加到其稳定状态时，餐馆甚至可能处理对其外部 API 的恶意攻击。这可能会导致意外的需求高峰，也可能会影响客户体验，例如，如果饭菜没有小心交付或没有放在正确类型的保温外壳中。

## 配方和配料的生命周期:管理 API 生命周期

正如技术和公司提供应用程序一样，餐馆为了生存并最终繁荣发展而不断发展变化。顾客的口味随着时代而变化——今年西班牙白葡萄酒很受欢迎，明年则是奥地利雷司令。

API 架构负责人也有类似的工作:确保 API 符合现代需求，根据需要对其进行升级，有时还会添加全新形式的 API，如 GraphQL。与此同时，餐馆必须保留常客喜爱的珍贵食谱——这些食谱永远不会过时。最好的厨房能够为常客准备几乎任何经典的食谱。这就像 API 关键的向后兼容性。重要的是能够优雅地弃用旧版本，而不完全清除或消除它们的服务。

## 通过学习像一个伟大的厨师老板一样思考来改进你的 API 游戏

对于大多数复杂的技术来说，很难知道从哪里开始使用 API，以及如何建立一种文化和操作设施来创建一个伟大的 API 驱动的业务。思考的内容:伟大的厨师老板在他们花时间在测试厨房之前，对审美和口味有一个宏伟的愿景。首先，他们创建架构。接下来，他们为他们的食物创造建立语法和规则。他们与侍酒师、糕点师和所有美味食材的供应商密切合作，精心挑选最受欢迎、最美味的元素，打造一顿大餐。厨师-老板测试然后完善-从测试环境转移到生产 *FoodOps* 。厨师老板总是与他们机构中发生的一切保持密切联系，这种可观察性方法反映了现场可靠性工程师、AppDev 团队和其他任何负责性能的人的需求。

厨师老板制定外部 API 消耗的规则，与内部团队保持协商，以确保没有闲置生产能力。然后，当他们感觉到客户需要新的东西时，厨师老板会查看他们业务的 API，并决定需要升级什么——原料或第一方代码(蔬菜、水果)、微服务和内部 API(股票、釉料、ganaches、三文鱼片)或第三方 API(葡萄酒)。厨师老板也在不断寻找方法，将餐厅的潜在产品重新包装成其他渠道可以消费的东西，以换取急需的边际收入。

最后，伟大的厨师老板让团队能够通过接管上述所有责任，慢慢地、优雅地让厨师老板失业，让厨师老板有时间思考食物的未来。当一个厨师老板转向另一家企业时，最好的餐馆也能生存下来并繁荣发展。如果 API 程序建立在坚实的基础上，并把客户需求放在首位，那么它们也是如此。就像一个伟大的餐厅必须从伟大的原料开始，一个有弹性的，适应性强的企业必须从伟大的应用程序开始。今天，这意味着伟大的 API。 *Bon API appétit* ！

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>*