# 谷歌代码:Sourcegraph 如何简化开发

> 原文：<https://thenewstack.io/google-that-code-how-sourcegraph-simplifies-development/>

我们经常认为现代计算分为代码和数据。从功能上来说，这对于任何给定的应用程序都是有意义的。但是，当我们看一个标准的微服务架构时，代码本身的广度和深度不仅仅是几个文本文件，它成为了自己的数据集。我们管理[代码库](https://thenewstack.io/guido-van-rossum-on-types-speed-and-the-future-of-python/)的能力受到我们对它们的理解的限制，现在是我们使用为大数据构建的工具并将它们应用到大代码时代的时候了。

最著名的大数据工具是搜索。搜索的力量节省了宝贵的时间。Sourcegraph 联合创始人兼首席技术官 Beyang Liu 在着手将其引入开发人员世界时就明白了这一点。他知道进入新公司和学习新代码库的痛苦。

理解不同人的观点和代码风格可能会让人不知所措，代码库会随着时间的推移以不可预测和令人困惑的方式增长。因此，刘开发了 source graph T3，这是一个帮助开发者提高工作效率的工具。它本质上是一个代码搜索引擎。

认识到大代码就是大数据，我们可以使用知识图的力量来帮助我们搜索和理解世界上的任何代码库。

我最近与刘谈论了他的 Sourcegraph 之旅和他的长期目标(要听完整的对话，请听开源数据播客)。

## 什么是 Sourcegraph？

Sourcegraph 是一项免费的开源技术，可以让你搜索整个代码库。它的主要目标是帮助解决软件工程师工作中最重要的部分:理解现有代码。

它通过以下方式做到这一点:

*   一次搜索所有内容，无需克隆和本地搜索。
*   轻松共享重要的代码行。
*   使用集成开发环境(IDE)启发的功能进行管理。

“对于大多数软件工程师来说，你工作的最大部分不是写新代码。这是有意义的，理解所有已经存在的代码，”刘说。

Sourcegraph 有两个基本组件:搜索组件和[全局参考图](https://thenewstack.io/how-code-analytics-could-help-github-decipher-its-semantic-code-graph-of-open-source/)。

## 搜索组件

像大多数搜索引擎一样，Sourcegraph 的搜索组件接受一个查询并呈现最佳结果。假设一个开发人员正在一个特定的存储库中寻找待办事项。开发者可以输入这样的搜索查询`repo:facebook/react content:TODO`，它将在指定的目录中搜索任何待办事项。你可以在这里看到一个搜索脸书 React-native 库[的真实例子。实现这一点的关键技术之一是为搜索代码而优化的索引格式。](https://sourcegraph.com/search?q=context%3Aglobal+repo%3Afacebook%2Freact+content%3ATODO)

2010 年，当刘还是谷歌应用套件后端团队的一名工程实习生时，他从使用[谷歌代码搜索](https://developers.google.com/code-search)中获得了灵感——这也是他采用索引格式的原因。另一件引起他注意的事情是 Russ Cox 对谷歌内部代码搜索的初步实现所做的工作，以及 Han-Wen Nienhuys 以一个名为 [Zoekt](https://github.com/google/zoekt) 的开源库的形式对其进行的重新实现。

“这种体验的核心是这个代码搜索引擎，它可以索引谷歌的所有代码，并让每个开发人员都可以访问它，无论你是实习生还是非常资深的杰夫·迪恩级别的工程师，”刘说。

## 全局参考图

全局引用图帮助您理解代码库并执行诸如“转到定义”和查找引用之类的功能，这需要映射整个代码库以将您带到正确的位置。

Sourcegraph 使用一系列编译器库和开放协议来实现这一点，并有自己的协议，如 Source Lib 和 [SCIP](https://about.sourcegraph.com/blog/announcing-scip) ，更适合 Sourcegraph 的要求。

“这一切都是为了向这些语言特定的索引器提供这种语言无关的接口，这些索引器使用编译器知识来构建全球参考图，”刘说。

## 从混乱到行动

Sourcegraph 始于刘毕业后在 Palantir Technologies 的第一份工作。作为一名软件工程师，他面临着每个人在开始新工作时都会遇到的问题之一:

刘回忆道:“这个庞大复杂的代码库已经经历了多个所有者，我只能直接进入其中。”。“当时有点乱，我记得，在第一个月左右的月底，回头看并问自己，‘我在这里完成了什么？我花了所有的时间试图弄清楚这段代码中发生了什么，并弄清楚为什么它是这样写的。看起来我更多的工作只是探索现有的代码，并找出我试图添加的相对较小的部分如何适应更广阔的图景。"

刘在谷歌的日子让他接触到了一套内部开发工具，其中之一是谷歌代码搜索，这使得谷歌的所有代码都可以访问。这段经历，以及在 Palantir 的痛苦经历，促使刘创造了一些东西，帮助其他软件工程师避免同样的问题。

与刘在 Palantir 的同事 Quinn Slack 的对话，关于创建一个通用代码搜索工具，变成了行动，由此产生了 SourceGraph。

## Sourcegraph 的未来

2011 年，马克·安德森写了一篇关于[软件如何吞噬世界的文章](https://a16z.com/2011/08/20/why-software-is-eating-the-world/)。这种迹象无处不在:从你点的食物，到预定的行程，再到控制你家的暖气。

但刘认为，我们只是看到了冰山一角。他说，理解代码将成为日常的事情。

他将其与读写能力相提并论，称“我们曾经生活在一个只有极少数社会精英才能读写的世界，这限制了人类文明的发展。”

刘说，当代码为我们生活中的几乎一切提供动力时，理解代码将成为一项普遍要求。正是这种想法激发了刘创建 Sourcegraph 的热情。创建一个代码搜索引擎将允许人们访问庞大的开源生态系统——只需简单的搜索查询。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>