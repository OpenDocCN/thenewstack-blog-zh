# 如何将阴影带入光明

> 原文：<https://thenewstack.io/how-to-bring-shadow-kubernetes-it-into-the-light/>

[](https://www.linkedin.com/in/kylehunter/)

 [凯尔·亨特

凯尔·亨特是 Kubernetes 平台提供商 Rafay Systems 的产品营销主管。Kyle 是一位创意产品领导者，在信息传递和定位、竞争差异化、上市战略和思想领导力方面有着出色的表现。](https://www.linkedin.com/in/kylehunter/) [](https://www.linkedin.com/in/kylehunter/)

影子 IT 仍然是 IT 领导者面临的一个挑战，但可能不是公司过去看到的那种挑战。传统上，影子 IT 发生在应用程序堆栈中，这就产生了问题，因为 IT 系统的使用是在没有公司 IT 部门的批准，甚至不知情的情况下发生的。

DevOps 实践的出现有助于解决这些挑战，并为现代软件交付团队释放创造力和机会。然而，对云的访问使得自治团队更容易建立他们自己的工具集。结果，影子 IT 问题现在以一种新的方式表现出来:在工具架构中。

基于容器的应用程序的激增使得 Kubernetes 成为 DevOps 团队的重要资源。但是它的广泛采用导致了 Kubernetes 集群的快速创建，很少考虑安全性和成本，要么是因为用户不了解复杂的 Kubernetes 生态系统，要么是为了满足最后期限而行动过快。

本文探讨了与影子 Kubernetes 管理员相关的挑战以及 IT 部门集中化的好处。

## 什么是影子 Kubernetes 管理员？

影子 Kubernetes 管理员是一个用户，他不会等待其 it 部门来配置 Kubernetes 集群，而是转向云服务提供商来随意启动 Kubernetes 集群。事实上，云的自由和灵活性带来了一些 IT 领导者不能忽视的重大业务风险。

一个无人管理的影子 Kubernetes 管理员帐户可能会在创建新角色时导致意外的权限授予。发生这种情况是因为如果使用相同的角色名称，角色绑定可以引用不再存在的角色。对于每个新用户、组、角色和权限，缺乏适当的可见性和控制会增加人为错误、用户权限管理不当和恶意攻击的风险。

## 统治在阴影中 Kubernetes 管理员

为了控制影子 Kubernetes 管理员，我们首先必须了解 IT 团队面临的挑战。

### 有限的资源

首先，为 Kubernetes 设置基于角色的访问控制(RBAC)可能非常困难。它本身支持许多不同的角色类型和分配选项，但是这些很难管理和跟踪。因此，Kubernetes 管理员必须逐个集群地手动设置一切，并有效地提供集群中每个用户所需的适当访问级别。

由于 Kubernetes 仍然是一项相对较新的技术，因此在寻找具备必要技能和经验的员工来正确管理这些环境方面存在固有的人才缺口。现在想象一下，在这种水平的人工开销下，尝试扩展和运营一个分布式、多集群、多云环境是多么复杂。这一过程不仅劳动强度大，而且容易出错。

### 云灵活性和按需服务

在生产中运行基于容器的应用程序远远超出了 Kubernetes 的范围。例如，IT 运营团队通常需要跟踪、日志、存储、安全和网络方面的额外服务。他们还可能需要不同的管理工具来管理 Kubernetes 跨公共云、内部、混合架构或边缘的分发和计算实例。

为特定的 Kubernetes 集群集成这些工具和服务需要根据集群的用例配置每个工具或服务。每个群集的要求和预算可能会有很大差异，这意味着更新或创建新的群集配置会因群集和环境而异。随着 Kubernetes 采用的成熟和扩展，管理员和应用程序团队之间将会产生直接的冲突，前者希望降低集群管理日益增长的复杂性，而后者希望定制 Kubernetes 基础设施以满足其特定需求。

让这些挑战变得更加严峻的是满足内部项目期限的压力，以及对使用更多基于云的服务以在预算内按时完成工作的需求。如果工作岌岌可危，人们将不可避免地做他们认为必须做的事情来完成工作，即使这意味着使用集中 it 系统之外的工具和方法。

## 平台团队集中化的优势

虽然 shadow Kubernetes 指出 IT 必须控制的挑战越来越大，但阻碍开发和运营团队的工作效率是不可能的。然而，通过一个集中的平台团队模型，IT 可以管理和执行自己的 Kubernetes 环境标准和策略，并完全防止影子管理员。它允许多个团队在由企业平台团队管理、保护和治理的公共共享基础设施上运行应用程序。这样做可以提供以下好处:

### 标准化

定义和维护预先批准的集群和应用程序配置，这些配置可以跨基础设施和工具架构重用。这样做不仅降低了手动集群管理的复杂性，而且通过集中标准化这些配置，使开发和运营团队能够自动化工作流并加快交付。

### 可重复性

跨 Kubernetes 集群和应用程序部署创建和提供具有预定义工作流和批准的多个管道，以在整个组织内通过自助服务模式创建一致性。定义明确且可重复的流程有助于扩展 Kubernetes 环境并优化项目交付资源。

### 安全性

支持对集群和工作负载的下游可配置访问控制，以便开发人员和运营人员可以适当地连接用户或组。将预先存在的安全实践和其他集中式系统与集群和应用程序生命周期管理操作相集成已成为常态。跨集群和环境的 RBAC 技术和基于用户的审计日志有助于管理授权并防止导致攻击的错误。

### 管理

定义和维护预先批准的群集以及备份和恢复策略，并在组织的其他部门强制实施。实施最佳实践并拒绝对您的 Kubernetes 基础架构和应用程序的请求，以遵守企业政策和行业法规，如 HIPAA 和 PCI。

### 其他注意事项

实现跨任何环境(包括内部和公共云环境，如 AWS、Azure、GCP 和 OCI)的所有集群的集中视图，也有助于更快地解决问题。通过从一个统一的事实来源收集问题，个人和团队可以共同查明导致与集群相关的任何健康或性能问题的信息。获得对集群运行状况和性能的实时洞察有助于团队优化 Kubernetes 并保持在预算范围内。

由于 Kubernetes 的开放性，在集群上很容易出错，从而导致安全风险和部署问题。此外，随着时间的推移，安全漏洞很可能会发生。任何类型的环境都需要维护、应用补丁和升级。最近， [Apiiro 发现了一个严重的漏洞](https://apiiro.com/blog/malicious-kubernetes-helm-charts-can-be-used-to-steal-sensitive-information-from-argo-cd-deployments/)，该漏洞给攻击者提供了访问敏感信息的机会，如机密、密码和 API 密钥。集中式平台可以通过在整个组织内保持高水平的控制、安全态势、策略合规性和可闻性，帮助组织主动为事件做好准备。

Kubernetes 虽然是一项强大的技术，但可以给企业平台团队带来许多运营挑战。随着 shadow Kubernetes IT 威胁的增长，平台团队面临着一条充满挑战的道路，要交付一个能够提高开发人员工作效率、集中治理和策略管理并降低运营开销的解决方案。

值得庆幸的是，现在已经有了 SaaS 平台解决方案，平台团队可以将主要精力放在交付现代应用上，而不是管理和运营 Kubernetes。

[例如，Rafay 的 Kubernetes 运营平台](https://rafay.co/platform/kubernetes-operations-platform/)可与任何基础设施配合使用，并提供与 Kubernetes 发行版的深度集成，以加快平台团队的运营就绪性，从而在数小时内大规模管理、保护和治理 Kubernetes。借助 Rafay，企业可以利用众多平台服务，如多集群管理、GitOps、零信任访问服务、Kubernetes 策略管理、备份和恢复以及可见性和监控。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>