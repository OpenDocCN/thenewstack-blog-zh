# 立即打补丁:Glibc 漏洞比以前认为的更严重

> 原文：<https://thenewstack.io/patch-now-glibc-vulnerability-worse-previously-thought/>

修补 Glibc 漏洞。现在！

上周，谷歌和 Red Hat 的安全专家分别在 glibc 库中发现了一个缺陷，几乎所有的 Linux 系统都使用这个库。Qualys 首席技术官沃尔夫冈·坎德克在他的[博客](https://blog.qualys.com/laws-of-vulnerabilities/2016/02/22/new-critical-glibc-vulnerability#more-22813)上表示，漏洞 [CVE-2015-7547](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7547) 存在于 **getaddrinfo()** 函数中，可用于获得远程代码执行。

Kandek 在电话采访中表示，当漏洞公布时，利用漏洞的能力似乎需要控制 DNS 服务器，这通常需要拥有高级系统访问权限的人。这一威胁被认为是可信的，但微乎其微。

但是卡明斯基、谷歌和红帽的安全团队以及其他人所做的研究表明，这个漏洞可以在不控制 DNS 服务器的情况下被利用，这使得这个漏洞更加危险。

著名网络安全专家丹·卡明斯基称这一缺陷“异常糟糕”，是“未知强度的万能钥匙”。

通俗地说，漏洞 [CVE-2015-7547](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-7547) 描述了连接域名和 IP 地址的协议底层代码中的一个 bug。所以当你输入 google.com，你会想到谷歌。glibc 包[包含系统上多个程序使用的标准库。](https://access.redhat.com/articles/2161461)

“本质上，通过这个缺陷，攻击者可以在最终用户不知情的情况下远程崩溃甚至强制执行机器上的恶意代码，”Red Hat 的安全博客[由 Red Hat 产品管理总监 Gunnar Hellekson 和 Red Hat 安全高级产品经理 Josh Bressers 撰写。Red Hat 将潜在影响评定为](https://www.redhat.com/en/about/blog/container-scanning-thinnest-paper-tigers)[严重](https://access.redhat.com/security/updates/classification/#critical)影响。

一个好的系统管理员应该做些什么？

Kandek 说，简短的建议是“尽快修补正在使用的 glibc 库。这一点至关重要，未来几周只会变得更糟。”

他进一步建议安装您的 Linux 提供商提供的修复程序，而不是互联网上提供的补丁或变通办法，它们可能更容易安装(并且不需要重新启动系统)。这些都不能解决根本问题。

Red Hat 已经[提供了受影响产品的列表和每个](https://access.redhat.com/articles/2161461)的修复程序。如果你是红帽客户，这是个好消息。如果您不是 Red Hat 的客户，Kandek 建议您尽快联系您的 Linux 供应商。glib 维护者提供的详细技术分析和正在进行的更新可在[这里](https://sourceware.org/ml/libc-alpha/2016-02/msg00416.html)获得。

## 这个问题到底有多严重？

在这个漏洞中，“一个恶意的 DNS 服务器对一个正常的地址查询提供了一个超长的、特殊格式的答案，这使得一个静态分配的内部 2K 缓冲区溢出数据，”坎德克[进一步解释了](https://blog.qualys.com/laws-of-vulnerabilities/2016/02/22/new-critical-glibc-vulnerability#more-22813)。"然后数据在函数 **getaddrinfo()** 中执行."

许多 Linux 程序和实用程序都包含 glibc 的 **getaddrinfo()** 函数来解析 DNS 名称。

“信封背面的分析表明，应该有可能用攻击者控制的有效载荷编写正确格式的 DNS 响应，这些有效载荷将渗透 DNS 缓存层次结构，因此，允许攻击者利用这些缓存后面的机器，”Red Hat 在一份公告中说。

“很可能所有的 Linux 服务器和 web 框架，如 Rails、PHP 和 Python，以及运行 glibc 的 Android 应用程序都会受到影响。”

Kaminski 称这个漏洞为“尽管它在我非常熟悉的领域中，但很容易是我工作过的最难确定范围的漏洞”，他深入研究了 DNS 的历史和结构，并讨论了他对这个漏洞的实验。“这就是 JavaScript、Python、Java，甚至 Haskell。仅仅因为*它们是*“内存安全的”并不意味着它们的运行时库是安全的，glibc 是它们都依赖的 Linux 下的大运行时库。”

Red hat 的 Hellekson 和 Bressers 在他们的[FAQ](https://access.redhat.com/articles/2161461)中揭露了漏洞的程度:

1.  SELinux 屏蔽了这个安全漏洞吗？
2.  受信任的递归 DNS 解析器可以防止这个问题吗？
3.  升级面向互联网的 DNS 服务器和递归解析器是否足够？
4.  在 **/etc/resolv.conf** 中没有启用 TCP 模式。系统还受这个缺陷影响吗？
5.  有可能避免组合 A/AAAA DNS 查找吗？
6.  有没有可能通过 **/etc/nsswitch.conf** 来缓解这种攻击？
7.  是否可以通过让系统仅联系受信任的 DNS 服务器来缓解此漏洞？
8.  静态链接的二进制文件会受到这个缺陷的影响吗？"

所有这些问题的简短答案都是否定的。

根据 Hellekson 和 Bressers 的说法，公开托管或在云中托管的容器可能包含额外的问题。尽管 Linux 容器供应商急于提供扫描工具来寻找漏洞之类的问题，但“当涉及实际修复时，他们可能没有专业知识、能力或*所有权*来实际修复问题。”

他们建议联系您的容器提供商以获取更多信息。

Kendek 对那些应用补丁的人有额外的建议:“为了跟踪你的补丁进程，频繁的扫描是至关重要的。在云环境中使用虚拟机的快速移动环境，比如 Amazon EC2，应该考虑使用我们的[云代理](https://www.qualys.com/docs/qualys-cloud-agent-brief.pdf)。新机器启动后，它会自动提供漏洞数据，让您随时掌握最新变化。”

为什么现在才发现这个漏洞？Kendek 在一次电话采访中解释说，尽管代码本身很旧并且非常稳定，但 IP 标准用法的变化暴露了这一漏洞。

Google 和 Red Hat 的安全团队在某些机器上使用 Linux 时发现了一个随机内存错误。事实证明，当您执行特定类型的并发 IPv4 查找和 IPv6 查找时，代码中的漏洞就会暴露出来。这种情况非常罕见，只有在特定条件下才会发生溢出。然而，随着 IPV6 采用的增加，该漏洞的实例也在增加。

你们去修补吧。

红帽是新堆栈的赞助商。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>