# 适合工作的工具:选择合适的监控软件

> 原文：<https://thenewstack.io/right-tool-job-picking-monitoring-solution/>

监控是容器基础设施中隐藏的英雄。就像开车一样，我们不会去想引擎盖下发生了什么，直到出了问题。我们希望摆脱对基础架构和容器问题的被动反应，转而采用更加主动的运营状态，利用监控洞察力保持正常运行。

仅仅监控物理服务器及其资源的日子已经一去不复返了。我们现在需要知道哪些容器正在运行，它们在哪里运行，监控应用程序和容器，并向运营团队提供警报和指标信息。本文将帮助您做出商业决策，为工作找到合适的监控工具。

## 构建与购买

在考虑新软件时，决定是构建还是购买监控系统应该是重中之重。这种观点非常类似于从零开始建造一栋房子，还是购买一栋已经完工的房子。建造一所房子允许你在建造的过程中做出改变和改进，相比之下，购买一所房子的决定大部分是为你做出的。构建是资源密集型的，因为它需要测试不同的组件、试错经验以及学习如何使用新工具。

 [布莱恩·克里斯特纳

Brian Christner 来自亚利桑那州，但现在居住在瑞士的阿尔卑斯山。Brian 职业生涯的大部分时间都在赌场行业度过，他确保赌场总是赢。Brian 是 Docker Captain 计划的提名成员，也是一名经验丰富的云架构师。他还是 Docker、Cloud Foundry、IaaS、PaaS、DevOps、CI/CD 以及容器监控等领域的云主题专家。Brian 热衷于倡导云和容器。当 Brian 不忙着把所有东西打包的时候，他会骑着他的山地车或者在瑞士阿尔卑斯山滑雪。](https://www.brianchristner.io/) 

购买一个监控包就提供了一个可以运行的成品。这种方法可以节省时间和金钱，但也有缺点。您需要考虑组织的预期增长。随着许多新服务的加入，快速变化的环境可能需要大量额外的时间和精力来校准监控解决方案。如果预计会有更多的人需要访问监控解决方案，那么如果供应商对座位许可证收费，身份管理的困难可能会造成巨大的损失。

许多监控解决方案按代理收费。根据您当前或未来部署的规模，解决方案的定价模式可能会成为决定性因素。例如，一些系统按代理收费，而我们看到的一些系统实际上是按监控的每个集装箱收费。其他是基于使用定价的；例如，基于代理的数据接收速率。

无论你是建设还是购买，审查是必需的。虽然成熟的产品会降低风险，但快速变化的产品通常具有最新的功能。一个活跃的用户社区是很重要的，无论你是走供应商路线还是基于开源项目构建东西。社区通常负责保持文档和代码的更新。

购买现成的解决方案可以缓解很多此类问题，但是应该对解决方案进行比较，以了解支持到底提供了什么，有哪些服务级别协议(SLA ),以及专业服务是否可以帮助安装和定制。

### 支持和服务级别协议

支持是任何监控系统的关键组成部分。自托管解决方案需要维护，但您可能不具备自行构建和管理监控系统的内部运营能力。但更重要的是:谁负责支持监控解决方案？在审查监控解决方案时，确保遵守您公司的 SLA 和 It 治理也很重要。

### 灵活性和定制

能够根据您的需求定制监控堆栈是一个巨大的优势，但这是有代价的，而这个代价就是进行这些定制所需的时间。构建方法提供了更多的灵活性和定制性，因为您正在使用允许您进行自己的更改的开源软件(OSS)。购买提供了一定的灵活性和定制性，这取决于供应商的产品，但与 OSS 替代品相比，相对来说限制更多。

## 基于云与内部托管

许多监控解决方案既可以在云中运行，也可以在内部托管。每种方法都有各自的优缺点，以及基于您的工作负载的一些考虑因素。云通常意味着对工作负载的控制更少，而内部部署提供了更细粒度的控制。您还应该考虑您的监控需求是否必须符合法规或数据存储要求。一般来说，由于运行数据中心的运营和支持成本较高，内部成本会更高，而基于云的提供商会在您决定采用云解决方案时为您处理这些问题。

### 云

从内部迁移到云本身就是一个[业务案例](https://en.wikipedia.org/wiki/Operating_expense)。云产品通过与其他云客户共享资源来降低成本。快速扩展需求的能力和对更少专业员工的需求都是与基于云的服务相关的优势。像[亚马逊网络服务](https://aws.amazon.com/)(AWS)[谷歌云平台](https://cloud.google.com/)(GCP)[IBM Bluemix](https://www.ibm.com/cloud-computing/bluemix/)和[微软 Azure](https://azure.microsoft.com) 这样的云供应商让你的基础设施的集中管理(包括监控)变得更加容易。

一些云供应商还提供监控解决方案的一键式部署，允许您快速启动并运行软件即服务(SaaS)或开源解决方案。但是，您必须考虑与您的工作负载相比，云位于何处。一些用户希望他们的监控堆栈尽可能靠近他们的容器工作负载。

### 内部托管

由于各种原因，包括数据隐私、许可、互联网连接和性能，并非所有东西都可以在云中运行。内部解决方案让您能够完全控制您的环境。您可以增加更多带宽并使用定制的硬件配置。内部部署有时会与云服务相结合，以提供混合解决方案，从而实现两全其美。此外，并非所有 SaaS 监控解决方案都提供内部解决方案，因此在审查不同的供应商时，请询问相关信息。

[cyclone slider id = " ebook-5-赞助商"]

考虑托管您自己的监控解决方案还有其他合理的原因。走自托管路线的黄金法则是，如果您依赖来自监控解决方案的警报来通知您关键事件，那么永远不要将其托管在与您的应用程序相同的基础架构中。这似乎是显而易见的，但是你会惊讶于它发生的次数。如果您选择云路线，那么这应该不成问题。

内部部署路线提供了很大的灵活性和配置可能性，但安装和配置将更具挑战性。与可以立即部署的 SaaS 解决方案相比，启动和运行监控解决方案所需的时间要长得多。这些都是在考虑内部解决方案时应该考虑的事项。

### 合规性和数据保护

在考虑监控解决方案时，经常会忽略数据处理的法规影响。数据能否存储在您的数据中心、城市、地区或国家之外？在某些情况下，根据您所在的行业，政府可能还会对如何处理数据做出规定。

如果您在主机上安装一个云监控代理，该主机同时提供关于正在运行的进程的指标和信息，那么数据所有权可能会成为一个问题。如果您的指标包括客户数据，请确保您的云提供商可以从其捕获的交易中删除用户数据。

## 综合

充分了解您的环境中当前正在运行什么非常重要。基于您正在运行的内容，您可以开始回答一些问题，比如哪些编程语言、应用程序和工具正在或计划在您的容器中运行。这些信息将帮助您建立一个需求列表。这个列表将帮助您选择哪些客户端库和集成对您的公司现在和将来都很重要。

### 管弦乐队

考虑如何监控编排器以及监控到什么程度是很重要的。考虑在新服务上线时发现它们，以及监控这些新服务需要什么配置。一些监控工具会在新服务或 orchestrator 节点联机或脱机时自动发现它们，而其他工具则需要对每个服务或节点进行配置或集成。监控系统中可用的自动发现功能越多，所需的操作支持就越少。

### 客户端库和集成

客户端库允许开发人员在应用程序中编写内部指标，并将它们直接暴露给监控解决方案。监控系统还可以直接集成到更常见的应用程序中，如数据库和代理。这些集成使您能够轻松实施监控解决方案，并收集特定于应用的信息。例如，可以集成 [HAProxy](http://www.haproxy.org/) 来获取所有 HTTP 流量统计信息，并在监控仪表板中显示这些信息。然而，一些集成需要额外的代理、容器或传感器来从不同的集成收集指标。根据集成的不同，这可能从简单到非常复杂，并且可能需要额外的配置和测试。

### 度量合并

如果您目前正在使用云提供商或平台即服务(PaaS ),那么他们很可能已经公开了监控指标。找出您当前可以利用的容器即服务(CaaS)、平台即服务(PaaS)或基础设施即服务(IaaS)堆栈中的可用内容。您能否将云服务堆栈中的指标集成到您的监控解决方案中，以创建基础架构和容器的单一视图？您可能希望将指标集中到一个解决方案中，而不是使用许多没有集成的不同工具。请务必找出您当前的哪些服务可以重新用于您的新监控解决方案。

## 结论

我们解释了针对监控解决方案的构建与购买、云与内部部署、集成和本机功能的用例。基于这些信息，您可以开始构建信息矩阵，并对目前市场上可用的不同监控解决方案进行比较，包括开源和 SaaS 解决方案。先做好功课，在内部搜集信息，了解自己的需求。这个需求列表将是您为工作选择正确监控工具的关键。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>