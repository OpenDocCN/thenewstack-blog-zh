# 借助全栈柱状数据存储，Interana 可以快速回答您的问题

> 原文：<https://thenewstack.io/interana-answers-questions/>

这一切都始于好奇心，首席技术官兼 Interana 联合创始人 Bobby Johnson 说。好奇心和一种信念，即当更多的人可以访问数据时，公司会运行得更好。

![](img/abb141fb5cba569b2faadf2a6abecf3a.png)“我们的使命是让每个人都能访问这些数据，”约翰逊上周在三藩市接受采访时说。“你每天都要做上千个小决定，如果你了解得更多，这些决定会更好。约翰逊帮助脸书运营了六年的后端业务，他编写了 Scribe，是创建 Hive 和 Cassandra 的团队成员，并于 2012 年与妻子安·约翰逊(Ann Johnson)一起创办了 Interana。

他记得，当他 2006 年开始在脸书工作时，那不是一家数据驱动的公司。他与其他 30 名开发人员争论哪些特性最重要。他在脸书建立了一个名为 [Scribe](https://github.com/facebookarchive/scribe) 的日志数据聚合工具，这样他们就可以看到哪些功能正在被使用，从而可以基于实际数据做出决策。

“这改变了文化，”他说。"人们从争论事实转到争论更有意义的事情。"

当他们组建 Interana 时，他带走了那段经历。该公司背后的想法是让每个人都能访问所有数据(当然，安全是允许的)，通过一个基于全栈柱状数据存储的分析和可视化软件。让每个人都能够查看数据和运行查询会让一切变得更有效率。

“我从来不相信有数据牧师这种想法，”他说。“少数几个掌握权力的人和其余的人都是哑巴，必须把权力打包，放在盘子里交给他们。”

![](img/dc044b92d06d124845c179c5162047db.png)“他在脸书的那几年，我在 Splunk 处理详尽的日志数据。”Interana 首席产品官 Christina Noren 说道。那是在开发人员不关心他们如何登录的时候。

她说，Scribe 是第一个开发者有目的地登录的例子。他们会说“我想写这封邮件，因为我知道机器将来会使用它。这是革命性的。”

在决定从零开始建立自己的系统之前，约翰逊和他的联合创始人艾米·约翰逊看了几个选项。为什么不用 Hadoop 呢？

Noren 说，该产品并不针对任何特定的问题集进行优化，并且假设您想要询问可以作为批处理作业运行并且可以运行一段时间的大问题。

## 问另一个问题

“我们问了一个不同的问题，既基于时间，也基于有演员在表演的事实，”她说。“我们希望回答问题；核心问题围绕着回答“发生了什么？”"

![](img/f2676e0cb9a55fc421e58545d67e6278.png)

Interana 的可视化浏览器页面

约翰逊解释说，用户对如何将数据整合起来以满足他们的需求有了更深入的了解。例如，最强大的是，提问的人直到开始提问并得到回应时，才知道该问什么问题。

这是所有开发人员都熟悉的，他们设计系统来回答业务人员说他们想要的问题，只是为了让他们在看到结果时要求更多的数据或不同的角度。

“这是关于快速问大量不精确的问题，以获得越来越好的问题，”他说，“这就是 Interana 提供的。”

例如，音乐系统提供商和 Interana 客户 [Sonos](http://www.sonos.com/en-us/home) 从其扬声器和 iPhone 应用程序中收集数据，让公司了解从扬声器插入到播放第一首歌曲的客户体验。该公司在每一次活动中都捕捉数据，允许分析师提问:是否存在故障？如果有，发生在哪里？是在应用程序中，还是在硬件或令人困惑的指令中？

“任何时候有人点击鼠标或触摸屏幕，或触摸数据库或得到反弹，你都想捕捉这些数据，”约翰逊说。

他说，总体而言，Interana 的客户会问:我的客户在做什么，他们什么时候做？

Noren 解释说:“我们在一个为一类新问题预先优化的数据存储中消费数据。“人们想问的不精确、不完美、反复、快速的问题是关于行为的问题。”

像这样的问题:有多少从安装到播放第一首歌的时间超过五分钟的设备是一个月内就出现的家庭的一部分，而不是那些被保留下来的？这是推动业务决策的数据。

## 从头开始

约翰逊曾在脸书回答过类似的问题，他意识到现有的工具从未真正用于分析。“我们花了几年时间试图让它们发挥作用，”他说。它们适合做批处理、提取-转换-加载(ETLs 作业]、构建索引，但不适合分析。“Hadoop 很繁琐，而 SQL 并不是为了回答人们关心的问题而设立的。”

“25 年后，商业用户仍然不想写 SQL 代码，”Noren 说。“去琢磨吧。”

因此，Interana 建立了自己的横向扩展柱状数据库，目的是让每个人都可以方便地提出推动业务发展的问题。

“我们已经编写了一个系统，它是日志最终的最佳位置，因此开发人员不必成为其他所有人的数据管家或分析管家，”Johnson 说。“我们正在为你们公司的所有其他人设置它。”

## 令人讨厌的细节

约翰逊展示了堆栈:该系统运行在商用 Linux 机器上。实际读写磁盘并一次处理数十亿行数据的代码是 C++。他解释说，这样做的目的是让代码对于数字运算来说非常简单和直接。

接下来是 Python 层，用于分布式系统的管理、查询的管理以及许多关于采样的逻辑。数据库系统采用 REST 接口、 [JavaScript](/tag/javascript/) 和 React 作为前端。

Interana 列数据库系统的基准测试为每内核每秒 1 亿行，这一速度来自直接对原始数据执行查询，以及无锁运行查询。查询中未引用的列被忽略，从而节省了浪费的缓存、CPU 周期和 RAM。

“我们的客户拥有 1000 列数据。宽阔、平坦、稀疏，”诺伦说。

系统没有约束，假设你想问演员和时间的问题。此外，不用考虑驱动大多数仪表板的传统商业智能概念，如维度和度量，也节省了时间。

但她澄清说，该公司并不像其他地方报道的那样，在市场上提供内存数据库。相反，该技术存储原始数据，并针对扫描进行优化。

Interana 是静态数据，而不是实时流数据。通常，客户端会将日志事件放入 S3 桶中。Interana 监控存储桶并提取数据，使其可供查询。一旦写入日志，就会拾取数据，但不是实时的。

“一分钟对于人类做决定来说通常是‘足够实时’的，”约翰逊说。

该公司还非常关注界面的动作，并使其有用(但不一定漂亮)。Noren 说，仪表板是询问其他问题的发射台。每天都有新的事情发生，每天都有新的问题得到解答，所有这些都不需要等待开发人员编写特定的数据检索代码。

## 接下来:社区

建设社区是公司今年的首要项目之一。它已经摆在桌面上，但其不断增长的客户群让工程师们忙得不可开交。它计划为开发者和产品经理提供免费版本，让他们看看它是如何工作的。

“但我们是自己成功的受害者，”Noren 说。它的首批客户之一是必应搜索服务，该服务每小时运行数十亿个事件，需要大量精力来微调产品。

虽然该公司只有不到 50 个客户，但每个客户都是数据密集型文化。Noren 说，我们的目标是从顶级客户开始，一路向下，成为事实上的行业标准。

因此，它一直在努力为这些大客户服务，这些客户正在改变内部文化，将数据视为可以立即访问。相对较小的公司，如 Reddit 和 Imgur，是其最活跃的用户。超过 12%的 Reddit 员工每天都会多次登录 Interana。例如，在上个月的[骄傲周](https://www.nycpride.org/)期间，LGBT 子主题被超额订阅，因此 Reddit 的广告销售人员正在进行查询，以寻找与 LGBT 社区有密切关系的其他子主题，以推荐广告商不一定会想到的东西，如餐馆或酒吧。

“这是关于个人的，”她俯身说。尽管他们的薪水来自公司，但仍有成千上万的人在工作日的一部分时间里致力于在工作中有效地使用 Interana。这个社区对于这些用户建立关系网和寻找其他职业机会非常重要。

“我对这些用户比对开支票的公司更忠诚，”她说。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>