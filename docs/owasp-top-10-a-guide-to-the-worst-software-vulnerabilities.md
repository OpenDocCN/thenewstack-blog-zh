# OWASP 十大漏洞:最坏软件漏洞指南

> 原文：<https://thenewstack.io/owasp-top-10-a-guide-to-the-worst-software-vulnerabilities/>

人生本身就是有风险的。在你大限到来之前，受伤、生病或死亡的方式似乎数不胜数。然而，避免最危险的风险会给你一个很好的机会过上平均或更好的寿命。

网络世界也是如此。软件漏洞数以万计，还有同样多甚至更多的网络罪犯试图利用它们来攻击从智能手机应用到关键基础设施的一切——你好[殖民管道](https://www.politico.com/news/2021/05/08/colonial-pipeline-cyber-attack-485984)和肉类供应商 [JBS](https://www.nbcnews.com/tech/security/meat-supplier-jbs-paid-ransomware-hackers-11-million-n1270271) 。

## OWASP 前十名的历史

 [泰勒·阿梅尔丁

泰勒是一名屡获殊荣的记者，他在 2011 年离开了主流报纸的衰落领域，前往爆炸式扩张的信息安全领域写作。Taylor 目前是 Synopsys 软件完整性小组的高级信息安全作家，之前曾为 CSO Online 和 Sophos 博客 Naked Security 写过文章。在 Twitter @tarmerding2 上关注他。](https://www.linkedin.com/in/taylor-armerding-b6b2b03b/) 

套用乔治·奥威尔(George Orwell)的话，有些漏洞比其他漏洞更“平等”，更危险，更容易被利用。[开放网络应用安全项目](https://owasp.org/about/) (OWASP)的主要任务之一就是帮助组织避免最严重的威胁。

非营利基金会即将迎来其 20 周年纪念日，拥有数百个地方分会和数以万计的全球成员，它通过多种方式做到这一点，包括教育项目和会议。其中最引人注目的是其标志性的 OWASP 十大 web 应用最关键风险列表，最近四年来首次更新。它包括三个新的类别，加上一些职位的变化，其余的。

OWASP 网站提供了关于每个漏洞的大量详细信息，包括描述、为什么它会排名、可能的攻击场景以及如何修复或缓解这些漏洞。以下是该清单的摘要。除非另有说明，所有引文均来自 OWASP 网站。

## 1.中断的访问控制

该漏洞从第五位上升到第一位，在应用程序中的出现次数超过了贡献数据集中的任何其他类别，超过 318，000 次。

顾名思义，它指的是未能实现最小特权原则——将访问数据的权限仅限于那些获得授权的人和那些需要它来完成工作的人。它可能“导致未经授权的信息泄露、修改或销毁所有数据，或者执行超出用户权限的业务功能。”

防止这种情况的方法有:默认拒绝、实现一次访问控制机制并在整个应用程序中重用它们，以及强制实施记录所有权，而不是接受用户可以创建、读取、更新或删除任何记录。最后，记录访问失败，并在重复失败时提醒管理员。

## 2.加密失败

这以前被称为“敏感数据泄露”，在列表中从第三位移动到第二位，这意味着组织仍然(可能越来越多地)因未能加密数据而面临数据泄露的风险。一般来说，数据在静态和传输过程中都需要加密，尤其是密码、信用卡号、健康记录、个人信息和商业秘密，这些都受隐私法或金融数据保护法规的管辖。

在可能的攻击场景中，加密安全弱点是管理员和开发人员应该注意的潜在利用机会。一个在数据库中加密信用卡号码的应用程序，但是在检索时自动解密数据，这使得 [SQL 注入](https://www.synopsys.com/glossary/what-is-sql-injection.html)攻击者能够以明文检索信用卡号码。

解决方案应该是显而易见的:对所有有风险的数据使用严格的加密。不要用明文传输任何内容。首先根据隐私法、监管要求或业务需求对敏感信息进行分类。

要加密静态的敏感数据，请确保拥有最新且强大的标准算法、协议和密钥，并使用适当的密钥管理。所有传输中的数据都应使用安全协议进行加密，例如带有前向保密密码的传输层安全性(TLS)、由服务器确定的密码优先级以及安全参数。使用 HTTP 严格传输安全之类的指令强制加密。

检查以确保您在默认情况下或在较旧的代码中没有使用旧的或较弱的加密算法或协议。

实施您的加密策略。也许最重要的是，不要存储不必要的敏感数据。尽快丢弃它或者使用符合 [PCI DSS](https://www.synopsys.com/glossary/what-is-pci-dss-compliance.html) 的令牌化甚至截断。未保留的数据不会被窃取。

## 3.注射

这个从第二掉到第三。它指的是允许攻击者将恶意代码注入网络的漏洞，然后由解释器作为命令或查询的一部分处理这些代码，导致信息从数据库发送给攻击者。

例如，用户提供的数据未经应用程序验证、过滤或清理，这可能导致数据失窃、数据丢失、数据完整性受损、拒绝服务和整个系统受损。

防止注入的方法之一是将数据与命令和查询分开。首选是使用安全的 API，这样可以避免完全使用解释器，提供参数化的接口或者迁移到对象关系映射工具。

## 4.不安全的设计

这是 2021 年的一个新类别，相当于设计一座有建筑缺陷的建筑的数字版本，这些缺陷可能导致从屋顶渗漏到灾难性地基坍塌的一切。有些应用程序不是根据安全最佳实践设计的。

OWASP 说:“作为一个社区，我们需要超越编码空间中的‘左移’,对设计安全原则至关重要的活动进行预编码。”他还指出，重要的是不要将设计缺陷与实现缺陷混为一谈。

“安全设计仍可能存在实施缺陷，从而导致可能被利用的漏洞。不安全的设计无法通过完美的实现来修复，因为根据定义，所需的安全控制从未被创建来防御特定的攻击。”

安全设计是一种“不断评估威胁并确保代码得到可靠设计和测试以防止已知攻击方法”的方法

在防止不安全设计的多种方法中，列表中的第一种可能是最重要的:“在 AppSec 专业人员的帮助下，建立和使用安全的开发生命周期，以评估和设计安全和隐私相关的控制。”

## 5.安全错误配置

这从第六位上升到第五位，出现了超过 208，000 次的常见弱点枚举，这些弱点是在软件中产生漏洞的编码缺陷。"随着越来越多的产品转向高度可配置的软件，看到这一类别上升也就不足为奇了."

此漏洞的示例包括:

*   启用或安装不必要的功能，如端口、服务、页面、帐户或权限。
*   密码仍然启用且不变的默认帐户。
*   过时或易受攻击的软件。

预防措施包括使用自动化来确保开发、QA 和生产环境的配置完全相同，在每个环境中使用不同的凭据。没有不必要的特性、组件、文档和示例的最小平台也很有帮助。本质上，删除或不安装不用的特性和框架。罪犯不能攻击你没有的东西。

## 6.易损坏和过时的组件

这个类别，以前称为“使用具有已知漏洞的组件”，从第九位上升到第六位，在 OWASP 十大社区调查中排名第二。

显而易见，如果组织不了解他们使用的所有软件组件的所有信息，包括版本、已知漏洞以及它们是否不受支持或过期，那么他们就容易受到攻击。这包括运行操作系统的软件、web/应用程序服务器、数据库管理系统、应用程序、API 和所有组件、运行时环境和库。它不仅包括您直接使用的组件，还包括嵌套的依赖项。

Synopsys 网络安全研究中心的首席安全策略师 Tim Mackey 指出，当您“剥”软件供应链的洋葱时，应用程序中的单个组件可以轻松地拥有超过 100 个依赖项。

开始消除这个漏洞的最有效的方法是维护一个软件清单，或者被称为[软件材料清单](https://www.synopsys.com/blogs/software-security/software-bill-of-materials-bom/) (SBOM)。安全会议上一个常见的口号是，“你不能保护你不知道你有什么。”鉴于软件项目中的大多数组件都是开源的，维护该清单的最佳方式之一是使用自动化的[软件组合分析](https://www.synopsys.com/software-integrity/security-testing/software-composition-analysis.html) (SCA)工具，该工具有助于找到开源组件，并让您知道是否存在已知的漏洞或许可冲突。

为了避免这些漏洞，至少要维护一个 SBOM，并有一个补丁程序管理流程来删除未使用的依赖项、不必要的功能、组件、文件和文档。

## 7.识别和认证失败

这一类别，以前被称为“被破坏的认证”，在列表中从第二位下降到第七位。它指的是软件缺陷:

*   允许自动攻击，例如凭据填充，攻击者拥有一系列有效的用户名和密码。
*   允许默认、弱密码或众所周知的密码，如“password1”或“admin/admin”
*   允许使用弱的或无效的凭据恢复和忘记密码过程，如“基于知识的答案”
*   缺少多因素身份验证或多因素身份验证无效。

预防措施包括要求多因素身份验证，不使用默认凭据运送产品，以及对弱密码进行检查。

## 8.软件和数据完整性故障

此漏洞是 OWASP 十大漏洞列表中的新漏洞，它是由于在没有验证软件更新或关键数据的完整性的情况下做出与软件更新或关键数据相关的假设而导致的。

最近的一个例子是许多应用程序中的自动更新功能，其中“在没有充分的完整性验证的情况下下载更新并将其应用于先前信任的应用程序。攻击者可能会上传他们自己的更新，以便在所有安装上分发和运行。”

最近利用该漏洞的一次是今年早些时候针对得克萨斯州网络安全管理软件产品的攻击。据信来自俄罗斯情报部门的攻击者能够将恶意软件植入该公司网络管理系统的更新中，这是一个名为 Orion 的软件程序，因此当客户安装更新时，他们也安装了恶意软件。

这意味着更新和补丁必须经过审查。OWASP 建议使用数字签名或类似的机制来验证软件或数据来自预期的来源并且没有被更改。还可以使用软件供应链安全工具，如 OWASP 依赖性检查或 OWASP CycloneDX 来验证组件不包含已知的漏洞。

## 9.安全日志记录和监控失败

这上升了一个等级，从第十位上升到第九位，虽然 OWASP 表示它在已知的漏洞数据中没有得到很好的体现，但“它对问责制、可见性、事件警报和取证非常有影响。”这增加了风险，因为“如果没有日志记录和监控，就无法检测到违规行为。”

根据应用程序的风险，控制措施应至少包括确保“所有登录、访问控制和服务器端输入验证失败都可以用足够的用户上下文来记录，以识别可疑或恶意帐户，并保留足够的时间以允许延迟的取证分析。”

当然， [DevSecOps 团队](https://www.synopsys.com/software-integrity/solutions/dev-devops.html)需要进行有效的监控，以便他们能够发现任何可疑活动并迅速做出反应。

## 10.服务器端请求伪造(SSRF)

根据 OWASP 数据收集，这不会使 OWASP 进入前 10 名，因为 OWASP 数据收集显示发生率相对较低。然而，“安全社区成员告诉我们这很重要，尽管目前数据中没有说明。”

这个缺陷意味着 web 应用程序“在没有验证用户提供的 URL 的情况下获取远程资源”。它允许攻击者诱使应用程序向意外的目的地发送精心编制的请求，即使受到防火墙、VPN 或其他类型的网络访问控制列表的保护。”

OWASP 表示，“由于云服务和架构的复杂性”，SSRF 攻击的发生率和严重性都在增加

有很多方法可以预防 SSRF。在网络层，OWASP 建议将远程资源访问功能划分到不同的网络中，并实施“默认拒绝”防火墙策略或网络访问控制规则，以阻止除基本内部网流量之外的所有流量。

在应用程序级别，“清理和验证所有客户端提供的输入数据，并使用肯定的允许列表强制执行 URL 模式、端口和目的地。只是不要试图用拒绝列表或正则表达式来阻止攻击者，因为“攻击者有有效载荷列表、工具和技能来绕过拒绝列表。"

## 避免成为容易攻击的目标

解决清单上的所有问题不会让一个组织刀枪不入。什么都不会。OWASP 并没有声称它会。尽管这将使那些这样做的人成为更难对付的目标。大多数攻击者都在寻找容易攻击的目标。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>