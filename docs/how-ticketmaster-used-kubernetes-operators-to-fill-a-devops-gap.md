# Ticketmaster 如何使用 Kubernetes 运营商来填补 DevOps 缺口

> 原文：<https://thenewstack.io/how-ticketmaster-used-kubernetes-operators-to-fill-a-devops-gap/>

[](https://www.openshift.com/)

 [亚历克斯·汉迪

亚历克斯是红帽公司的技术营销经理。在此之前，他报道了第一台 iMac 的发布，然后开始了 20 多年的科技记者生涯。他的作品出现在《连线》、《亚特兰大宪法日报》和《奥斯汀美国政治家》上。他也是艺术和数字娱乐博物馆(themade.org)的创始人和主管，这是一家位于奥克兰的非营利性视频游戏博物馆。](https://www.openshift.com/) [](https://www.openshift.com/)

Kubernetes 景观的主要新发展之一是 Kubernetes 运营商的崛起。

运营商为管理员和运营商提供了一种方式，允许开发人员获得他们想要的自由，同时仍然针对他们的自助服务系统部署实施策略和最佳实践。

Kubernetes 运营商的出现可以追溯到云计算革命对开发者的影响。开发人员想要动态供应的系统，即使它们在某些方面受到限制。他们通过构建在更短的时间内满足业务目标的新应用程序，将企业吸引到云环境中，迫使 IT 部门尝试在防火墙后镜像公共云按需模式。这也许就是为什么 Kubernetes 是公共云之后的创新，而不是之前。

运营商允许在 Kubernetes 中以服务为基础制定政策和规则。这是出于在一个基于无状态容器的生态系统中管理有状态应用程序的需要。目前已经为其构建了操作符的开源项目包括 MongoDB、Couchbase、PostgreSQL (Crunchy Data)、etcd、Prometheus 和 Redis。虽然最初的这组操作符非常关注数据库，但是没有理由其他系统不能采用这种模式，比如 Prometheus monitoring。

Ticketmaster 的技术平台副总裁 Tim Nichols 表示，作为成功实施最佳实践的一个例子，Kubernetes 运营商已经让领先的现场娱乐公司 Ticketmaster 的每个项目团队运行自己的 Prometheus 实例。

“我们正全速前进，与库本内特和普罗米修斯。这些是我们正在采用的最大的云计算原生计算基金会(CNCF)项目。至于运营商，我们今天主要使用 Prometheus 运营商，”Nichols 说，他负责 Ticketmaster 的开发工具和平台。“它为我们实现自助消费做了很多工作。我们以前(在没有 Prometheus 运营商的情况下)也这样做过，但没有从 Prometheus 获得非常一致的服务，导致了不必要的支持开销，而这些开销本来可以通过更好的标准来避免。”

当解释为什么 Ticketmaster 从使用 Prometheus 的单独版本转向使用 Prometheus Kubernetes 运营商时，他说:“这实际上归结于为开发团队的自我消费定义更清晰模式的能力。

Ticketmaster 以前依赖舵图进行部署，“这给团队留下了太多的灵活性来构建有点像雪花一样的普罗米修斯模型，”尼科尔斯说。

尼科尔斯说:“使用运营商将这一点拉了回来，并给了我们一个更加固执己见的模型，如何以标准的方式为 Ticketmaster 全面构建 Prometheus。”“这对开发者来说更容易。”

Nichols 说，Ticketmaster 采用 Prometheus 运营商是 IT 部门治理和政策的胜利。

“我们从旧模型中获得的结构的缺乏给了团队太多的灵活性，这意味着我们需要为我们的集群运营团队提供更多的支持，以支持那些遇到问题和挑战的开发团队，”Nichols 说。“通过使用运算符，我们能够进行更标准的调整。对我们来说，这是一个治理问题:它让我们有能力推动这些标准。”

这有助于提高每个开发项目的速度。每个团队现在可以从第一天开始收集他们的度量标准，而不用担心他们与组织的其他部分相比的特定需求，而不用为度量标准的收集而烦恼。

尽早收集这些度量标准可以确保提高速度所需的开发人员反馈循环在开发过程的开始就已经到位。这意味着开发团队可以获得他们需要的自助式 IT 支持，以在适当的时间框架内实现业务目标。

“我之前谈过 Ticketmaster 的 DevOps 之旅。几年前，我们努力让我们的开发团队能够在很多地方做他们自己的事情，这在 Kubernetes 世界中是真实的，在那里我们非常灵活。我们学到的是，很多时候，团队想要比我们给他们的更多的结构，”尼科尔斯说。“他们希望我们对事情更有主见，关注商业价值，而不是监控等基本问题。并非我们过去采用的所有开发工具都详细说明了我们如何允许这样做，运营商在这方面向前迈进了一步。”

Ticketmaster 通过其平均每 20 分钟 发生一次 [的票务产品为难忘的时刻提供动力。Ticketmaster 的团队在高流量和高交易量的情况下没有太多固定的时间表。Ticketmaster 所有人都在甲板上的重要时刻发生在大型演出开始后的几分钟内。此时，Ticketmaster 技术团队特别关注观察他们的 Prometheus 结果，密切关注近乎实时的指标，以便及早发现问题。](https://www.youtube.com/watch?v=_Olwfb93Prw)

今天，尼科尔斯说，当你“登陆网站买票时，很大一部分是在运行库本内特和普罗米修斯。”他说，这些系统也用于控制“活动中引擎进入的部分”。

这意味着，即使是 Ticketmaster 内部的传统系统现在也与基于云的服务和基于 Kubernetes 的服务捆绑在一起。“我们的票务系统有一部分来自这种传统模式。尼科尔斯说:“我们正在对其中一些进行现代化改造。“在公司内部，有人在努力思考这在今天的 CNCF 模式中会是什么样子。这只是我们票务系统后端的很小一部分。”

旧的系统有允许分布式系统建模和保护它们的接口。尼科尔斯说:“这是我们的系统正在建设的核心部分:保护公司中的其他遗留系统。”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>