# 混沌工程现在是 AWS 良好架构框架的一部分

> 原文：<https://thenewstack.io/chaos-engineering-now-part-of-aws-well-architected-framework/>

[](https://www.linkedin.com/in/taylorbsmith/)

 [泰勒史密斯

泰勒是 Gremlin 的技术产品营销经理，帮助客户开发更可靠的系统。他对现代应用和基础设施充满热情。此前，他为思科和 NetApp 制定了有机和无机战略。](https://www.linkedin.com/in/taylorbsmith/) [](https://www.linkedin.com/in/taylorbsmith/)

今年夏天，[亚马逊网络服务](https://aws.amazon.com/)宣布了自 2012 年推出以来对架构良好的框架 (WAF)的第八次更新[。WAF 最初只在内部提供给 AWS 自己的架构和开发团队，作为构建和审查以 AWS 品牌发布的应用程序的基础设施的最佳实践指南。自 2015 年公开发布以来，WAF 一直在根据客户的意见进行定期修改，以便为任何设计高性能、弹性和高效云基础架构和应用的人定义和更新一套最佳实践。](https://aws.amazon.com/blogs/architecture/announcing-the-new-version-of-the-well-architected-framework/)

该框架包括五大支柱:卓越运营、安全性、可靠性、性能效率和成本优化。在这五大支柱中，可靠性支柱刚刚增加了一个[显著的新支柱。除了围绕工作负载架构构建弹性分布式系统的指导，作者现在将混沌工程命名为可靠系统的一个需求。](https://aws.amazon.com/blogs/architecture/whats-new-in-the-well-architected-reliability-pillar)[AWS 架构良好的首席可靠性解决方案架构师 Seth Eliot](https://www.linkedin.com/in/setheliot/) 指出:“除非你假设你的工作负载将如何应对故障，注入这些故障来测试你的设计，然后将你的假设与测试结果进行比较，否则你不能认为你的工作负载具有弹性。”

WAF 以前的版本提到了注入失败和执行[游戏日](https://www.gremlin.com/community/tutorials/how-to-run-a-gameday)，这是专门用于对我们的系统进行实验的日子，但 AWS 的最新更新明确指出了混沌工程对于可靠系统的必要性和好处。

## 混沌工程的早期

混沌工程是通过注入精确和可测量的故障数量，对系统进行有意实验的过程，以观察我们的系统和团队如何响应，从而提高可靠性。对可靠性支柱的更新恰当地指出了网飞是如何推广这种做法的，而亚马逊甚至在此之前就已经应用了这一流程。

混沌工程的实践始于这样一种认识，即事情可能在任何时候发生故障，为这些故障做准备比一厢情愿地认为它永远不会发生在我们的系统上要好。云是建立在商用硬件上的，因此人们认识到实例会失败。正如混沌猴的设计目的一样，增加随机节点关闭并不是为了造成伤害，而是为了迫使工程师设计能够在公司不再直接控制的环境中处理随机主机故障的系统。

自云计算的早期以来，AWS 已经变得更加可靠，由 AWS 基础设施故障导致的停机已经变得很少——部分原因是内部执行了混沌工程。然而，虽然快速创新、微服务和敏捷方法的兴起提高了创新的速度，但同时也增加了系统的复杂性。我们可以不太担心在我们的应用程序下 EC2 实例失败，但是小的配置更改可能导致未知的依赖性，其中一个服务破坏了被认为是松散耦合的架构，有可能导致整个应用程序崩溃。

## 故障测试的发展

混沌工程，作为一种实践，以两种方式发展。首先，为了测试新的、越来越复杂的分布式系统，简单的节点故障是不够的。SREs 和应用程序团队可以注入延迟，直到完全服务连接丢失，以测试服务如何处理服务之间的常见网络故障；或者注入高 CPU 和内存使用率来模拟高负载的症状。这种全面的测试发现了断路器和自动伸缩等可靠性机制中的缺陷，这些缺陷可能没有正确到位，或者反应太快或太慢。对这些故障进行测试可以确保客户永远不会因为购物车装满而无法结账，或者因为要支付账单而无法使用资金而陷入困境。

第二，AWS 可靠性支柱强调实践的核心原则:深思熟虑的受控实验；而不是随机注入失败。该晶片声明:

*“运行测试，定期将故障注入预生产和生产环境。假设您的工作负载将如何应对失败，然后将您的假设与测试结果进行比较，如果不匹配，则进行迭代。”*

工程师现在可以在整个开发生命周期中构建失败测试。类似于测试驱动的开发，开发和测试时考虑到失败，通过提前发现可用性缺陷，而不是等待客户来发现缺陷，降低了缺陷修复的成本。如果应用程序在好的和坏的条件下都能很好地一起工作，那么将失败测试合并到我们通常的集成测试中会突出这一点。

一旦您的代码已经过测试，并为预生产中的失败做好准备，[将测试转移到生产中](https://www.gremlin.com/blog/testing-doesnt-stop-at-staging/)。正如报告指出的那样，在生产中进行游戏日活动将“帮助你了解哪里可以改进，并有助于培养组织处理事件的经验。”

这些练习不仅测试我们用于自我修复的工具，如自动伸缩和负载平衡，还测试第三方依赖性和团队。例如，我们可以为失去与超出我们控制的 API 的连接做准备，比如支付提供商或由另一个团队运行的服务。我们还可以通过行动手册指导团队，让他们做好利用监控工具的准备，并确保他们能够快速应对和解决事件。

2016 年， [Gremlin](http://www.gremlin.com) 创始人 Kolton Andrus 和 Matthew Fornaciari 从亚马逊和网飞获得了他们的混沌工程经验，建立了第一个完全托管的平台，用于安全可靠地运行实验。任务是使实践民主化，增加失败注入的[好处](https://aws.amazon.com/blogs/apn/how-gremlins-chaos-engineering-platform-validates-aws-operational-excellence-and-reliability/)，许多公司在编写脚本和使用开源工具如 Chaos Monkey 和 ToxiProxy 时开始看到这些好处。

随着越来越多的工程师可以随时进行深思熟虑的混沌实验，我们可以使用架构良好的框架来构建操作出色且更加可靠的系统——我们的客户可以依赖的系统。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>