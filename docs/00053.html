<html>
<head>
<title>Airbnb's AirPal Reflects New Ways to Query and Get Answers from Hive and Hadoop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Airbnb的AirPal体现了从Hive和Hadoop中查询和获取答案的新方式</h1>
<blockquote>原文：<a href="https://thenewstack.io/airbnbs-airpal-reflects-new-ways-to-query-and-get-answers-from-hive-and-hadoop/#0001-01-01">https://thenewstack.io/airbnbs-airpal-reflects-new-ways-to-query-and-get-answers-from-hive-and-hadoop/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">Airbnb的数据存储累积规模接近1.5与脸书的300相比只是沧海一粟，但仍然是一个庞然大物。当Airbnb需要一个工具来查询和可视化这个不那么无限的数据池时，它为自己建立了一个名为<a href="https://nerds.airbnb.com/airpal/" class="ext-link" rel="external "> AirPal </a>的工具。这个可视化工具是开源的，它检查来自数十Pb集群的记录。</p>
<p class="translated">AirPal的发展故事很好地说明了互联网规模的公司是如何合作建立自己的数据基础设施的。这些公司不得不构建自己的工具，这些工具比来自Oracle、微软或任何其他数据库和数据仓库巨头的工具更适合他们的需求。AirPal展示了正在发明的工具是如何超越第一代的，并享受着成熟，允许Airbnb、脸书、Dropbox和其他许多公司的数千名工程师存储、管理和利用其数据。</p>
<h2 class="translated">唤醒沉睡的巨人</h2>
<p class="translated">在Airbnb的数据中心内外，“bnb”代表“床和早餐”。移动设备用户依靠这项服务从提供住宿的好心人那里找到住处。这也是一个来自美国宇航局的前数据可视化专家可以感觉宾至如归的地方。</p>
<p class="translated">Airbnb不仅仅是一个应用程序，还是一个支付系统，促进了房东和房客之间的货币交易。这是一个被称为共享经济的平台。为了让Airbnb的员工能够跟踪经济中发生的事情，该公司的开发人员——包括软件工程师Andy Kramolisch，他曾在美国宇航局兰利研究中心工作；之前在脸书数据库团队工作的产品经理James Mayfield为分布式数据查询引擎构建了自己的前端，用于监控他们的Hadoop集群。</p>
<p class="translated">“我一直是一个试图确保决策发生在组织的正确级别的人，”梅菲尔德在与新堆栈的对话中说。“其中一部分是确保人们根据数据做出最佳决策。”在他的职业生涯中，包括在脸书，他说他的目标是推广分布式数据模型。</p>
<p class="translated">他告诉我们，这种推广的一部分包括建立一种神经中枢，“在这里，人们觉得他们可以自己去写问题并回答问题，而不是在一个环境中，有一些精选的、指定的人必须为每个人回答问题。”</p>
<p class="translated">员工倾向于将数据视为一个地方，而不是一个设备、一个引擎、一个运输仓库、一个机场跑道或任何其他在过去十年中用于数据存储的隐喻。当时在雅虎工作的软件工程师首先构建了一个系统，在这个系统中，任何地方的所有数据都可以被视为一个地方。</p>
<p class="translated">但是是脸书的一个重要贡献使得这个地方成为你可以参观的地方。</p>
<h2 class="translated">旧的，新的蜂巢</h2>
<p class="translated">早在2009年，Hive是第一个可以像其他数据仓库一样查询的Hadoop数据仓库。它表明，与集体数据存储相比，巨型关系数据库几乎没有真正的质量优势。</p>
<p class="translated">在大量数据用户中，脸书可能处于独特的位置。虽然它经常吹嘘其蜂巢集群的大小，但Mayfield(前脸书工程师)指出，它实际上拥有能够永久存储所有数据的奢侈品。处理仅仅1或2 Pb数据的小型机构必须有更好的战略。</p>
<p class="translated">因此，Airbnb将其最新数据存储在EC2实例上的Hadoop分布式文件系统(HDFS)集群中，延迟较低。然后，按照设定的时间间隔，它将老化存储从“热”区“退役”到“冷”区S3存储。梅菲尔德表示，这种策略有助于减少Airbnb的总数据集大小。</p>
<p class="translated">“就像亚马逊的大用户，像Dropbox和网飞，我们都经常聊天，我们都有相同的方法，”Kramolisch说。“有些人有较小的HDFS集群，有些人有较大的集群，但将大部分历史数据保存在S3的基本想法就像是一种屡试不爽的做法。”</p>
<p class="translated">Hive是Airbnb最初的单一真实来源。但是由于速度和延迟问题，它后来切换到亚马逊红移，这<a href="http://docs.aws.amazon.com/redshift/latest/dg/tutorial-loading-data.html" class="ext-link" rel="external ">消耗来自S3桶</a>的数据。</p>
<p class="translated">“这有它自己的问题，”他说，“比如并发查询的数量有限，每天晚上从Hive到Redshift复制我们所有数据的ETL(提取/转换/加载)过程非常痛苦，这或多或少增加了我们系统必须做的工作量。”</p>
<h2 class="translated">床和早餐来拯救</h2>
<p class="translated">是脸书在Hive的其他用户之前发现了这个问题。正如这家社交巨头的软件工程师<a href="https://www.youtube.com/watch?v=qZsfpK9bafY" class="ext-link" rel="external ">马丁·特拉弗斯在2013年的一次公司会议上解释的那样，“Hive的问题在于它是为批处理而设计的。”他的演讲引用了一位未透露姓名的脸书数据科学家的话说，“一个好的一天是我可以运行六个Hive查询的时候。”房间里的其他数据科学家也笑着表示同意。</a></p>
<p class="translated">脸书将是第一个为脸书几年前的第一个解决方案所引起的问题创造解决方案的国家。起初它开发了<a href="https://prestodb.io/" class="ext-link" rel="external "> PrestoDB </a>，这是一个SQL查询引擎，可以聚合来自多个来源的数据，包括Hive，但也包括Cassandra。根据梅菲尔德的说法，该公司后来实际上接触了Hive的一级客户，包括Dropbox、网飞和Airbnb，提出成为PrestoDB的早期采用者，甚至在它向开源社区发布查询引擎之前。</p>
<p class="translated">他说，迁移到PrestoDB对Airbnb来说非常有效，关键原因是因为Redshift不是开源的。获得PrestoDB的源代码使Airbnb能够在早期调试问题，并将其补丁发送回上游。</p>
<p class="translated">但是少了点什么。Hive确实有一些前端查询UI工具可用，<a href="http://gethue.com/" class="ext-link" rel="external ">比如Hue </a>，但是PrestoDB没有。</p>
<p class="translated">在脸书期间，梅菲尔德为Hive使用了一个名为HiPal的前端。它是脸书基础设施堆栈的内部部分，不会开源。尽管如此，梅菲尔德说，Airbnb通过将其可视化工具AirPal配音向HiPal致敬。</p>
<p class="translated">它为用户提供了一个简单的Web界面，不仅可以搜索数据表，还可以搜索元数据和模式。它能够在Hive中基于从检索到的数据中过滤出的结果创建新的表格，或者它可以将查询结果流式传输到可以在Excel中打开的CSV文档中。</p>
<p class="translated">“当安迪和我在Airbnb建造这个时，我们实际上去了脸书，会见了那里的Presto团队和数据工具团队，向他们展示了我们的工作，并与他们讨论了开源AirPal的可能性。他们真的很支持这个想法。部分原因是他们希望世界上存在一个类似HiPal的工具，但这可能不是他们实现这一目标的路线图的一部分。”</p>
<p class="translated">正如梅菲尔德在Airbnb的企业博客中写道，“我们站在巨人的肩膀上制作了这个工具，我们感谢脸书的数据基础设施和数据工具团队能够提供的影响和投入。”</p>
<p class="translated">讲述Airbnb迅速崛起的金融出版物<a href="http://www.telegraph.co.uk/technology/news/9525267/Airbnb-The-story-behind-the-1.3bn-room-letting-website.html" class="ext-link" rel="external ">称其为“网站”这似乎可以称芝加哥小熊队为“运动俱乐部”更准确地说，Airbnb突然成为了世界数据可视化专家。顺便说一句，你可以用它来预订房间。</a></p>
<p class="attribution translated">特色图片<a href="https://www.flickr.com/photos/ouishare/7920234298/in/photolist-roFRBC-qrMz4s-roM2Hc-roFPMq-r7dxib-o9Mbyd-o9S5wg-o9S67e-dhxxA4-9PNNsD-dy8JL9-nRZ6Wb-heGaqy-e9cTaq-nJBrUL-pXspiP-ePdTEo-peyRRR-d4TgHL-dy3icR-ojyJBa-r7jYpv-r7jXkB-pkzErq-9x5UBm-bYZT51-duQ61v-jfWP5F-hwPhLC-e2aaZE-e23G2z-fbnqVw-duVwyh-bWyhmQ-dNfgXU-nnsSsF-nkpdGh-nnsRQ8-qV1GrE-a6nKnJ-pkzKR3-qSciqx-pVcepf-pKaScK-oNy2ay-psV1re-pC3XjW-fboch5-fbnZMC-fb8JBt" class="ext-link" rel="external ">通过</a> Flickr知识共享。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>