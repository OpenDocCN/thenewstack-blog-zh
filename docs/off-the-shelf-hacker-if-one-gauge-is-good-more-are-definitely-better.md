# 现成的黑客:如果一个标准是好的，那么更多的标准肯定会更好

> 原文：<https://thenewstack.io/off-the-shelf-hacker-if-one-gauge-is-good-more-are-definitely-better/>

我最近一直在屏幕上看电视。[蒸汽朋克会议徽章](https://thenewstack.io/hacking-hardware-the-never-ending-saga-of-steampunk-name-badge-development/)有一个超声波测距仪，通过前置 3.5 英寸液晶屏幕上的模拟仪表显示到物体的距离。仪表面上的蒸汽朋克字体和装饰与徽章的整体主题相得益彰。

嗯，如果[一号](https://thenewstack.io/off-shelf-hacker-use-processing-build-screen-gauge/)好，二号肯定更好。谁知道呢，你可能有一个项目，你想跟踪速度，温度，光照水平和其他类似的事情，所有这些都在某种风格化的仪表板上。

我想用一个计量器来显示测距仪数据，用一个计量器来测量落在光电池上的环境光。光电管将是徽章侧面的几个之一，我将使用它来代替按钮。用手指盖住光电池，它就会有效地按下一个按钮。在仪表上显示亮度是测试“照片按钮”操作和学习使用多个仪表的一种方式。

我们今天将讨论 Arduino 部分。下周，我们将讨论树莓 Pi 加工计量方面的模型。

## 更新两个数据流的 Pro Mini 代码

单个超声波传感器的操作非常简单。

我们使用 Arduino Pro Mini 从传感器读取测距数据，然后将数据转换为文本流。文本流然后通过串行或 USB 线路发送到 Linux 计算机上的[处理脚本](https://thenewstack.io/off-shelf-hacker-use-processing-build-screen-gauge/)。该脚本在模拟仪表上显示数据。在便携式会议徽章操作期间使用有线串行线。在开发和编程期间使用 USB 连接。

因为我们想显示来自超声波测距仪和光电池的值，我们需要通过 USB 线发送两组数据。每个额外的仪表将需要一个新的数据流。

我很遗憾地告诉大家，我还没有真正把光电池焊接到徽章上。项目总是需要更长的时间，生活的挑战有时会对你不利。不过不用担心，因为我们可以使用我在第一次世界大战中学到的一个老技巧。

没错……一个模拟。

说真的，没有必要仅仅因为我们没有一个“真正的”传感器就停止这个项目。模拟数据相当容易。为将来的项目记住一个不错的小技巧。

基线代码来自 Arduino 示例中的 HC-SR04 超声波测距仪程序。我简单地添加了几行代码，将第二个数据值从 0 增加到 100，并将其放在要通过 USB 发送的串行打印代码行中。当数据值达到 100 时，它会重置为 0，并不断重复。看着屏幕上的标尺，我们会看到指针慢慢扫过 100，然后跳回 0，重复这个过程。当我开始在实际的光电池中布线时，我将更改代码来读取连接到光电池的模拟引脚，并张贴值来代替递增的模拟值。这有多简单？

| )(这)(就)(是)(这)(些)(事)(,)(我)(们)(在)(这)(些)(事)(上)(没)(有)(什)(么)(可)(能)(看)(到)(这)(么)(的)(情)(况)(,)(只)(是)(这)(些)(事)(,)(只)(是)(在)(这)(些)(事)(上)(才)(有)(一)(个)(实)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)(验)( )(我)(们)(都)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(有)(些)(什)(么)(好)(的)(情)(情)(。 | 

/*

【HC-SR04 Ping 距离传感器】

VCC 到 arduino 5vGND 到 arduino GND

Echo 到 Arduino 第 7 针；Trig 到 Arduino 引脚 8

*/

#包含

伺服my Servo；  //创建伺服对象来控制一个伺服

#定义 echo pin 8

#定义 trig pin 7

intval，g；

作废 设置(){

连载 。 开始(115200)；

pin mode(trig pin，OUTPUT)；

pin mode(echo pin、INPUT)；

my servo。 附上(9)；

}

voidloop(){

//在 trigger 引脚上发送一个脉冲以启动测量

digital write(

延迟微秒(2)；

digital write(trig pin、HIGH)；

delay 微秒(10)；

digital write(trig pin、LOW)；

//echo 引脚上脉冲的长度与距离成正比

长=pulse in(echo 引脚，)

长 远=(持续时间/2)/29.13937；

如果 ( 距离&gt；=200&#124;&#124;距离&lt；=0){

//serial . println("超出范围")；

}

其他{

连载 。打印 ( 距离)；

序号 。 打印 ( ，)；

如果(g=100){

g=

}

else{

g++；

}

连载 。println(g)；

//serial . println(" in ")；

}

val=map(距离，  1 ，】  //缩放它以使用它与伺服(值在 0 和 180 之间)

my servo。 写(val)；

//serial . println(val)；

(300)；

}

 |

更好的是，为了在 Pro Mini 上编辑代码，我们可以在 Raspberry Pi 上加载 Arduino IDE 并在那里进行修改。

## 让它变得更好

在过去的文章中，我用我的 Linux 笔记本和最新的 Arduino IDE 来编程 Pro Mini。一根 [FTDI 串行转 USB 电缆](https://www.sparkfun.com/products/9718)非常适合这种特殊的 Arduino。只需将其插入板载连接器，另一端插入 USB 端口，您就可以尽情摇滚了。Pro Mini 的电源开关需要处于关闭位置，因此与 Raspberry Pi 的常规有线串行连接没有冲突。

如果您使用带有附加微控制器板(如 Arduino)的 Raspberry Pi，则无需外部笔记本。连接一个 HDMI 显示器和外部键盘/鼠标垫，在 Pi 上完成所有的编码和开发工作。无需将 Pro Mini 电缆连接到 Linux 笔记本电脑，只需将其插入 Pi 上的一个可用 USB 端口即可。

会议徽章有一个 Raspberry Pi 2 model B，它绝对足够快，可以使用 Arduino 或处理 IDE 应用程序。

要安装 Arduino IDE，请在 Raspberry Pi 上打开浏览器，并从 Arduino 网页下载最新版本。

下载完 tar 文件后，用下面的命令展开该文件。

|  | 

tarxvfarduino-1 . 8 . 5-Linux arm。 焦油 。 xz

 |

别忘了下载文件的 ARM 版。在撰写本文时，最新版本是 1.8.5。此外，请确保您的 Pro Mini 已连接到串行转 USB 电缆，然后将目录更改为 Arduino 目录。

您可能还想用 stty 命令设置串行端口。

|  | 

stty-raw-icrnl-F/dev/TT yama 0115200

 |

使用以下命令启动 Arduino IDE。

## 下一步是什么

既然我们已经看到了徽章的 Arduino 端需要的更改，下一步就是修改 Raspberry Pi 上的代码。我们将获取具有两个值的数据流，并将其分解，以便它们可以进入各自的仪表。这将是下周的话题。

随着我们的项目变得越来越复杂，我们的编程技术也越来越复杂，我们需要执行的任务也越来越多。徽章非常简单，一个 Pro Mini 与一个 Raspberry Pi 相连。

什么样的项目可能会使用一个以上的 Arduino 或几个以上的传感器，为树莓 Pi 提供数据？你能想到任何可能需要不止一个 Pi 的工作吗？

如果一个是好的，几个可能会很棒。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>