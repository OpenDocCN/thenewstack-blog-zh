# 蜂巢的慈善专业:继续，在生产中测试

> 原文：<https://thenewstack.io/honeycombs-charity-majors-go-ahead-test-in-production/>

继续质疑软件更新应该在他们自己的沙盒环境中测试的传统智慧， [Charity Majors](https://twitter.com/mipsytipsy) ，observability 软件提供商 [Honeycomb.io](https://www.honeycomb.io) ，[在上周](https://www.slideshare.net/CharityMajors/chaos-engineering-without-observability-is-just-chaos) [Gremlin](https://www.gremlin.com/) 的混沌工程会议上谈到了在生产环境中测试的好处。

“在 prod 中测试已经得到了一个坏名声，”她告诉观众，指的是传统智慧，在真实用户上运行未经测试的代码是自找麻烦——和客户不满。

她解释说，最初对这个想法的负面反应是基于一个错误的二分法。它假设软件开发只有两种选择，本质上是一种重复测试的练习。一种是完全在自己的“沙箱”环境中测试软件。另一个选择是为所有用户上传新代码到云中。

但是有多种技术，比如 A/B 测试和金丝雀测试，允许你在整个用户群的一小部分上测试代码，这样你就可以在系统升级之前收集数据。

> “试图将您的试运行环境镜像到生产环境是徒劳的。就放弃吧。”

她说，我们所认为的典型软件升级周期是时候升级了，尤其是当我们的架构转向基于容器的分布式系统时，旧工具无法轻松管理这些系统。

“分布式系统对被克隆、被模仿、被监控或被上演有着难以置信的敌意，”她说。“试图将您的试运行环境镜像到生产环境是徒劳的。就放弃吧。”

大多数架构比标准灯组要复杂得多。“找到合适的细节来问合适的问题是一项挑战，”她说。

对于分布式系统，可能出错的是这种可能永远不会发生的无限长的事情，但有一天它们会发生。有些人的照片加载速度很慢，但有些人则不然。“您将如何在暂存环境中找到它？剧透:你不是。”

这就是为什么可观察性如此重要——这是蜂巢[的专长——因为你无法预测故障会发生在哪里。维护分布式系统不仅仅是将一组标准的监控代理附加到您的应用程序上。](https://thenewstack.io/honeycomb-addresses-flawed-systems/)

![](img/3bfa94eca0f93ca36935fa3ed16c0c66.png)

阿德里安·科克罗夫特

当天早些时候，亚马逊副总裁、全方位可扩展微服务专家艾德里安·科克罗夫特也附和了梅杰斯的观点。“你的失败模型将不包括打破一切的离群值，”他说。

梅杰斯指出，分布式系统的问题不会出现在仪表板上。一种诱惑是创建一个新的仪表板条目，在问题下次发生时捕获它。问题是，这样的问题可能再也不会发生了。她说，你需要采取一种更加开放、探索性的方法。

“对于复杂的系统来说，监测本身是不够的，”她说。“仪表盘是一个遗迹。”

## 事件而非指标

“难的是找出问题所在。难的部分不是调试代码。梅杰斯说:“困难的部分是确定调试哪部分代码。

她谈到了分布式系统中的大多数问题是如何涉及高基数的。基数是一个集合中元素的数量，完美的基数是每个元素都有自己的集合。分布式集合中几乎所有问题的答案都来自高基数数据——或者是以某种方式一起制造麻烦的因素的非常小的子集。

传统的控制理论对可观测性的定义是，它是[一个衡量系统内部状态如何从其外部输出的知识中推断出来的尺度](https://en.wikipedia.org/wiki/Observability#cite_note-1)。在这种情况下，诀窍是收集你需要的所有数据，这样你就可以问任何问题，而不必编写更多的代码来获取更多的数据。

科克罗夫特的发言也符合这一点。对于“可观察”的东西，意味着你完全可以根据它提供的度量来预测它的行为。由于没有状态，微服务本质上是可观察的。巨石柱更难建模，因为它们有太多的潜在状态。

调试任何分布式系统的最困难的部分是找到合适的问题。任何运行它们的人都知道，分布式系统永远不会完全运行。总有一些问题会随时威胁到他们。

你问问题。基于你得到的答案，你问更多的问题，然后跟着面包屑走。“你必须能够对你的原始事件提出问题，”她说。

更多关于混沌大会的见解可以在这里找到:

Gremlin 协助支付了这次活动的差旅费。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>