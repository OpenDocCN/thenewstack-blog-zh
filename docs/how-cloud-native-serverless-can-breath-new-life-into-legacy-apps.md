# 无服务器云如何为传统应用注入新的活力

> 原文：<https://thenewstack.io/how-cloud-native-serverless-can-breath-new-life-into-legacy-apps/>

[TriggerMesh](https://triggermesh.com/) 赞助了这篇文章。

 [马克·辛克尔

Mark 在新兴技术和开源领域有着悠久的历史。在共同创立 TriggerMesh 之前，他是 Node.js 基金会的执行董事，也是 Citrix、Cloud.com 和 Zenoss 的高管，在那里他领导了他们的开源工作。](https://www.linkedin.com/in/markrhinkle/) 

在过去的 20 年里，很少有技术像 Kubernetes 这样飞速发展。容器编排平台最初于 2014 年发布，StackRox 在 2019 年[进行的一项调查](https://www.stackrox.com/kubernetes-adoption-and-security-trends-and-market-share-for-containers/)发现，超过 86%的组织已经采用了该平台，比前六个月增加了 51%。部分吸引力在于用户可以在云中运行 Kubernetes，并在内部自行管理它。StackRox 调查显示，与任何其他部署模式相比，更多的组织自行管理 Kubernetes，占 44%。在托管的 Kubernetes 产品中，亚马逊 EKS 以 27%的份额领先，其次是 Azure AKS (16%)、谷歌 GKE (12%)和 IBM Red Hat OpenShift (12%)。

与 Kubernetes 的爆炸相关的是无服务器计算的兴起，它抽象出操作系统、存储、网络和其他系统，这样开发人员只需专注于编写应用程序代码。据 [Forrester Research](https://www.forrester.com/report/Serverless+Development+Best+Practices/-/E-RES155355#) 称，近 50%的公司正在使用或计划在明年采用无服务器架构。

这种技术标准化的速度在一个充满厂商不断努力争取产品领先地位的行业中是罕见的。虚拟化在 21 世纪初作为一种改变游戏规则的基础架构模式的出现代表了常见的场景。在这里，我们看到了来自 VMware、微软、Red Hat 和 Citrix 的各种技术。相比之下，今天我们在 Kubernetes 中看到围绕容器的标准化和事实上的容器编排技术。这意味着更多的精力被用于增强技术，而不是差异化，这对 DevOps 从业者来说是好事。

## 数字转换或数字增强

Kubernetes 的增长实际上是围绕现代化的更大战略的一部分，通常被称为数字化转型。实施此类计划的目标包括提高运营效率、加快上市时间以及满足客户期望的能力。

有两种类型的 IT 项目:绿地和棕色地带。绿地项目，也就是从头开始构建应用程序的项目，最近得到了最多的关注。把 greenfield 想象成相当于用新材料盖了一栋新房子，没有遗留问题的考虑。

我们相信棕色地带项目中的无服务器应用会有更广阔的机会。这更像是在改造一所房子，那里有骨头，但我们更新了立面，让你的“遗产房子”的外观和设施现代化这些要么是正在进行的项目，要么是使用传统技术构建的生产应用。

为了将微服务和 Kubernetes 扩展到无服务器，绿地项目可能适合“纯无服务器”——也就是说，用无服务器架构提升和替换部分或全部应用程序。棕色地带项目通常适合通过添加无服务器功能来进行扩展，从而提供一个进入云原生世界的门户。

借助 brownfield 项目，DevOps 团队可以实现 API 的现代化，通过托管在无服务器功能上的工作人员完成提取、转换和加载(ETL)任务，并在无服务器基础架构上开发应用程序，这些应用程序也可用于管理传统基础架构。这些数字增强可以延长现有 IT 投资的使用寿命。

## 克服云的固有障碍

无服务器的障碍不比任何其他新技术更大。这只是知识和经验的问题。许多开发人员习惯于开发代码并让其他人来执行它们，但是对于无服务器开发人员来说，他们通常更愿意参与应用程序的部署。

然而，许多组织根本不具备交付云原生应用的内部技能。在接受 [New Relic](https://newrelic.com/) 采访时，[Amazon Web Services(AWS)](https://aws.amazon.com/)LEGO Group 的解决方案架构师 Sheen Brisals 分享了他们在[取得无服务器成功的关键](https://blog.newrelic.com/technology/serverless-predictions-2020-sheen-brisals/):

*培养组织思维转变，将无服务器视为托管服务的生态系统，而不是将无服务器视为一堆 Lambda 功能。*

*向高层管理人员展示内部或托管环境与无服务器场所之间令人信服的同类成本比较通常是一项挑战(甚至是不可能的)。如果没有这种直接比较，it 通常会延迟向无服务器的迁移或无服务器的管理买入。*

本质上，采用无服务器和云原生采用的真正障碍是知识和经验的问题。

## 理解云原生设计模式

传统上，应用程序是通过持久数据和服务来部署的。即使微服务不断发展，尽管它们仍然是无状态的和短暂的，但它们也倾向于总是在“永远在线”的虚拟机或容器中运行。在无服务器的世界里，函数更加短暂，单独或并行执行，完成它们的任务，然后缩减到零。它们由事件触发，并且是无状态的。它们就像一股烟，升起又消失在云里。

## 事件驱动编程

事件驱动的无服务器架构依赖于指示给定系统中的变化的事件。事件驱动的设计支持服务的松散耦合，这支持服务抽象和隔离、部署灵活性和独立扩展。这与功能平台尤其相关，因为功能的范围较小，因此松耦合架构使功能和/或微服务能够独立运行。版本控制可以通过引入一个新的服务来完成，如果服务引入了一些不需要的变化，软件开发人员可以很容易地切换回早期版本。与重新编译以合并软件库中的更改的整体架构相比，这一过程有所不同。这种松耦合版本控制是支持更多小型组件有效协作的关键，同时利用了运营独立性、自动扩展和按需成本模型。

## 可观察性

与可用性监控不同，大多数 IT 管理员不熟悉需要不同类型监控的无服务器功能。这是因为无服务器功能在事件发生时被调用，并在完成时关闭或缩放到零。因此，无服务器系统的状态和健康状况是通过一段时间内系统的属性来推断的，通常是通过日志数据来推断的，日志数据允许管理员查看一段时间内输入和输出的结果。有越来越多的可观察性解决方案，但它们通常不与您现有的监控套件集成(Datadog 是一个明显的例外)。

## 安全性

无服务器可以减轻您的安全负担。由于无服务器提供商处理基础设施、网络或主机安全，基础设施不再需要像我们希望的云提供商中知识更丰富的专家那样精心管理。但是，组织仍然必须非常关注无服务器环境中的安全管理。[新的攻击载体已经出现](https://cloudsecurityalliance.org/artifacts/the-12-most-critical-risks-for-serverless-applications/)例如，针对无服务器应用程序和托管基础架构的攻击，以及针对无服务器环境的常见攻击。

## 无状态与有状态函数

也许无服务器开发的最大区别是函数是无状态的，而大多数应用程序是有状态的。有状态应用程序会记住之前的事件或用户交互。由于无服务器函数是短暂的，并且在不使用时缩放到零，所以来自一个函数调用的状态对于同一函数的另一个调用是不可用的。要构建需要状态数据的无服务器应用程序，状态数据必须存储在外部数据库或缓存中。虽然不是标准，但是有一些技术，比如像[微软 Azure 持久函数](https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-overview)，允许你在无服务器环境中编写有状态函数。

## 结论

一般来说，无服务器和云原生架构正在被大量采用，但许多团队的学习曲线很陡。对于一些组织来说，可能有必要等待一些应用程序寿终正寝，然后重新编写它们。例如，已死的语言 COBOL 在许多应用程序中仍然活得好好的。正如 MicroFocus 的[调查](https://www.microfocus.com/en-us/press-room/press-releases/micro-focus-survey-finds-cobol-modernization-at-center-of-strategic-business-change)所示，代码库正在增长，使用它的公司更喜欢更新系统而不是替换它们。这是云原生前端可以帮助延长应用程序寿命的许多例子之一，这些应用程序可能必须服务几十年而不是几年。

幸运的是，通过从维护任务和部署在 Amazon Lambda 或您选择的功能即服务(FaaS)提供商的相对独立的功能的自动化开始，相对容易地涉足无服务器。然而，为了充分受益于云原生，公司将需要一个深思熟虑的战略计划，该计划以最佳方式为处于其生命周期不同位置的应用程序整合无服务器等新功能。无论您是有一个新的绿地项目，还是需要扩大和增强棕色地块项目，您都可以看到无服务器计算的优势。

VMware、Red Hat 和 AWS 是新体系的赞助商。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>