# 在码头集装箱中发现新的密码劫持蠕虫

> 原文：<https://thenewstack.io/new-cryptojacking-worm-found-in-docker-containers/>

据帕洛阿尔托网络公司的研究人员称，一种名为 Graboid 的新型密码劫持蠕虫已经传播到 2000 多台 Docker 主机中。这是第一次这样的恶意软件通过 Docker 引擎中的容器传播(具体来说是 **docker-ce** )。

对于任何使用过容器的人来说，这一点非常重要是显而易见的。在大多数情况下，可以使用标准软件工具发现并删除密码劫持蠕虫。在容器的情况下，这并不总是(如果曾经)正确的。事实上，根据 [Unit 42 报告](https://unit42.paloaltonetworks.com/graboid-first-ever-cryptojacking-worm-found-in-images-on-docker-hub/)，“这种类型的恶意活动可能很难被发现。”

作为一种密码劫持蠕虫，Graboid 恶意软件有两个用途:

*   秘密采矿
*   传播到其他易受攻击的主机

它的工作原理大概是这样的:

*   该黑客找到一个不安全的 Docker 主机，并发送远程命令来下载和部署一个名为 **pocosow/centos:7.6.1810** 的恶意映像。
*   使用容器内的恶意脚本( **/var/sbin/bash** )，从命令和控制(C2)服务器下载四个 shell 脚本( **live.sh** 、 **worm.sh** 、 **cleanxmr.sh** 和 **xmr.sh** )。

执行四个脚本，一次执行一个，目的如下:

*   **live.sh** 将可用 CPU 的数量发送到受损的 C2 服务器。
*   worm.sh 脚本下载一个文件，该文件包含带有不安全 Docker API 端点的主机的 IP 地址列表，然后随机选择其中一个地址作为目标来部署受感染的容器。
*   **cleanxmr.sh** 脚本从列表中随机选择一个主机，并停止目标上的加密劫持容器。
*   **xmr.sh** 随机选择一个主机并部署另一个映像(gakeaws/nginx)，其中包含伪装成 nginx 的二进制文件。

## 复杂的问题

在容器映像中发现的恶意软件对企业构成了重大威胁。如果图像没有经过审查和保护，它们可能包含许多问题。“安全有效的交付是企业操作系统的基础。其运行的软件应该总是来自可信的来源，但不安全的 Docker 图像的泛滥是一个严重的问题。

关于 Graboid，Hatch 说，“Graboid 漏洞不仅可以传播，而且它使用的攻击媒介是最古老的攻击媒介之一。这是一个简单的软件交付劫持。”换句话说，由于攻击者使用容器，通常简单的传播和检测方法变得更加具有挑战性(在检测方面)。

对于任何依赖 Docker 容器映像的组织来说，只对这些映像使用可信来源变得比以往任何时候都更加重要。然而，责任不仅仅在图像上。托管服务器和网络也带来了一些负担。

集装箱安全公司 [StackRox](https://www.stackrox.com/) 的高级产品经理 Connor Gilbert 说，“确实没有一个好的理由以这种方式暴露 Docker 引擎——这几乎肯定是服务器和网络防火墙(如果有防火墙的话)上的配置错误。”换句话说，配置不良的服务器和网络同样有罪。Gilbert 继续说道，“让 Docker engine API 服务器暴露在外而不进行身份验证，可以让人们在您的服务器上运行他们想要的任何容器，如果他们能够联系到它的话。由于 Docker 引擎所拥有的特权，这就像让 root 帐户在 SSH 上可用而无需密码一样。”

## 能做些什么？

对于集装箱来说，我们已经到了一个必须始终将安全性放在首位的时刻。反病毒和反恶意软件应用程序目前没有分析和清理容器和容器图像的手段。这是问题的核心。甚至像 Harbor 这样的工具也只能确定图像是否包含漏洞(而不是修复它们)。

因此，对于 Docker 和 Kubernetes 这样的公司来说，只使用可信的映像和保护 API 服务器是绝对重要的。作为容器管理员，您必须完全了解可用的工具以及您使用的工具的最佳实践。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>