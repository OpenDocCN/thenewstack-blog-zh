# 为什么微服务需要重新思考存储

> 原文：<https://thenewstack.io/why-microservices-require-a-storage-rethink/>

开发人员越来越多地考虑如何至少以某种方式迁移到微服务平台，这是有充分理由的，因为在可扩展性、应用性能和其他优势方面有充分的记录。

然而，与整体部署相比，微服务在许多方面代表了一种完全不同的计算环境。由于微服务的计算结构代表着根本不同的东西，许多组织面临着尝试和测试新的和不同的数据存储方法，而不是单一的替代方案。

“微服务和容器被视为无状态实体，直到它们不再是。像大多数数据源一样，他们很快成为分析、人工智能、机器学习和数据科学所需的数据源，” [MapR](https://mapr.com/) 行业解决方案副总裁 [Bill Peterson](https://www.linkedin.com/in/williampetersonjr/) 说。因此，他们需要变得有状态，他们需要成为企业数据生态系统的一部分。”

突然间，数据从众多不同的微服务中生成，而不是从单个整体计算结构中生成。通过这种方式，存储和数据库访问必须考虑到每个微服务，微服务通常可能有数百个甚至数千个线程。

企业管理协会(EMA)的分析师[托尔斯滕·沃尔克](https://www.enterprisemanagement.com/about/team/Torsten_Volk.php)概括了三个需要牢记的问题:

*   **性能和可靠性问题:**“将驱动程序用于动态映射到容器化微服务的持久块存储已被证明是困难的，因为块存储从未被设计为快速映射到目标并与其分离，”Volk 说。此外，当数据块卷必须同时映射到大量容器时，客户很难保证数据块卷的数据完整性
*   **合规:**“企业正在努力保持统一的审计日志，以证明数据的合规存储、加密和使用，”Volk 说。“虽然虚拟机通常会保持几个月或几年，但这对于容器来说要困难得多，因为容器可能会加速旋转并创建事件，然后仅在两三秒钟后就停止旋转。监控工具通常无法捕捉到这些快速变化，这导致了审计历史中的整体变化。”
*   **备份、数据恢复和归档:**“虽然 Kubernetes 提供内置冗余，但企业仍需要遵守备份、数据恢复和归档政策，”Volk 说。“他们中的许多人正在努力利用他们当前的工具(通常用于 vSphere 虚拟机)来开发 Kubernetes 容器。”

## 微服务，而不是容器

微服务和容器经常被错误地互换使用。然而，根据 EMA 的研究，63%的被调查企业——但不是所有的组织——在容器上运行微服务。例如，微服务可以像在容器中一样轻松地在虚拟服务器上运行。

[LightStep](https://lightstep.com/) 的联合创始人兼首席执行官[本·西格曼](https://www.linkedin.com/in/bensigelman)说，出于几个原因，组织应该寻求将容器和微服务管理分离开来。

“最终，微服务只是一个‘想法’或概念，而容器是一种机制，微服务通常(但不总是)通过这种机制进行打包和部署。容器有很多好处，特别是当试图摆脱以虚拟机为中心的基础设施时，但归根结底，它们将成为一个往往不可见的实现细节，”Sigelman 说。“持久存储对于容器来说是困难的，因为默认情况下它们的存储是短暂的。就持久存储解决方案而言，许多挑战源于在容器层和微服务或应用层管理存储的愿望——获胜的项目和技术将是那些一劳永逸地隐藏容器层实施的项目和技术。”

## 安全性反思

持久存储受益于微服务的灵活性和功能，但在许多方面，与数据整体应用程序创建相比，数据安全风险更加复杂。

[Alcide](https://www.alcide.io/) 的联合创始人兼首席技术官 [Gadi Naor](https://il.linkedin.com/in/gadinaor) 说:“从安全的角度来看，微服务安全，以及一般的微服务安全，是一场噩梦。“因为您需要控制和定义策略的移动部件的数量会不断增加。这就是边缘元素特别重要的原因。”

锁定存储在众多微服务线程中的数据需要一种三管齐下的方法。Naor 说，这包括保护运行时的数据威胁和数据。

“保护数据威胁涉及到对传输到存储环境的数据进行加密这一显而易见的第一步，无论是在云上还是在本地连接的存储环境中。这种加密涵盖了未经授权的访问，”Naor 说。“然而，嵌入受保护边界内数千个微服务数据线程中任何一个线程的恶意代码都足以允许攻击者在运行时访问未加密的数据。在这种情况下，微服务可能会将数据加载到位于云上的容器或存储服务内的存储环境中，这可用于访问和渗透受保护边界内的数据。”

在运行时微服务存储攻击的情况下，加强网络边界的运行时防御可以防止数据泄露。Naor 说:“如果出现问题，第三方工具会让你知道有问题，比如有人试图以非预期的方式访问数据。”“从历史上看，事情确实会像这样出错。我们不断听到这类违规事件。”

微服务数据存储的这一运行时保护层涵盖了许多组织面临的最坏情况，即攻击是从受保护的边界和防火墙内部策划的。

“你需要做一个假设，如果事情变坏了，或者事情确实变坏了，你的策略是什么？”Naor 说。“这就是构建运行时防御帮助您处理从存储层到微服务存储运行时的数据转换的地方。”

## 别忘了 DevOps

遗憾的是，由于多种原因，存储和数据库往往无法受益于 DevOps 为开发管道提供的相同级别的敏捷性，而微服务数据存储和数据库也不例外。尽管如此，DevOps 在微服务的软件和存储开发中扮演着同样重要的角色。

“DevOps 可以利用所有可用的数据构建更多的应用程序。例如，随着新的微服务的部署，即使微服务被删除，数据卷也可以被创建和保留，”MapR 的 Peterson 说。"让 DevOps 能够独立于微服务的位置访问这些数据."

然后，开发人员可以确保应用程序可以通过统一的视图进行同步和更新，而不会出现中断，并使用最新的数据。有了这一级别的 DevOps，开发人员可以确保其应用程序中的容器数据:

*   是最新的
*   是高性能的
*   安全的
*   高可用性
*   受到保护

借助 DevOps，微服务存储可以充分发挥其潜力。“DevOps 可以利用所有可能的数据构建更多的应用程序，”Peterson 说。

埃尔希德是新堆栈的赞助商。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>