# Linux 内核终于被锁定了

> 原文：<https://thenewstack.io/linux-kernel-finally-gets-its-lockdown/>

在一则姗姗来迟的新闻中，首席 Linux 维护者 Linus Torvalds 终于批准了一个新的安全特性，Linux 安全模块(LSM，昵称“锁定”)成为 Linux 内核 5.4 分支的一部分。虽然该功能在默认情况下会被关闭——因为担心它可能会破坏现有系统——但它确实承诺为市场上使用最广泛、最坚固的内核之一带来额外的安全性。

## 它是如何工作的？

锁定特性的目的是限制各种内核功能。它到底限制的是什么？首先，它将限制对内核特性的访问，这些特性可能允许通过内核之外的任何应用程序或服务提供的代码来执行任意代码。新功能还将阻止进程对 **/dev/mem** 和 **/dev/kmem** 内存的读/写，以及阻止对打开的 **/dev/port** 的访问(作为防止原始 ioport 访问的一种手段)。其他功能包括:

*   强制内核模块签名。
*   甚至防止根帐户修改内核代码。
*   **Kexec** 重启(以防启用的安全引导无法在新内核中保持安全引导模式)。
*   锁定可能产生直接内存寻址(DMA)的硬件。
*   锁定 **KDADDIO** 、 **KDDELIO** 、 **KDENABIO** 和 **KDDISABIO** 控制台 ioctls。
*   还有更多

锁定模块有两种可用模式:完整性和机密性。当处于完整性模式时，允许用户代码修改正在运行的内核的内核特性被禁用。当处于保密模式时，从内核中提取保密信息的用户代码将被禁用。

### **为什么封锁需要这么长时间？**

内核锁定工作始于 2010 年左右，最初由谷歌安全工程师马修·加勒特设计。Garrett 的想法是创建一个新的安全机制，防止特权提升的用户(比如拥有 sudo 访问权限的用户，甚至是 root 用户)修改 Linux 内核代码。

托瓦尔兹最初反对这个想法，因为他觉得这只不过是让 Linux 在只有 Windows 的硬件上启动的一种手段。托瓦尔兹和加勒特就微软签名密钥进行了一次相当直接的交流。在对来来回回的回应中， [Greg Kroah-Hartman](http://www.kroah.com/log/) ，Linux 内核稳定分支和 Linux 驱动程序项目的维护者，补充了他的两个观点，“我并不是说它们不是好东西，就个人而言，我想在我自己的机器上安装一些这样的东西，只是为了让事情更安全，但再次重申，这些是‘我想要的’，而不是‘别人说 Linux 必须要有的’。”"

最终，许多 Linux 发行版开发了自己的锁定补丁。例如，Ubuntu 附带了一个类似的补丁，可以确保 UEFI 安全启动不会被破坏。然而，在 2018 年达成了一项协议，并开始认真开发锁定功能。托沃兹指出，随着锁定补丁的到位，“我们离不需要外部补丁更近了一步。”

### **阉割了根账**

有效地降低 root 用户在系统中的工作能力(在内核级)，这种想法可能会被认为是对 Linux(和 Linux 管理员)的一种伤害。然而，在商业领域，绝对安全是必要的——尤其是在存储敏感业务/客户数据的机器上。当根帐户处于某种形式的严格锁定之下时，恶意代码在系统上猖獗运行的难度会大大增加。这可以减少数据泄露。由于内核开发人员将锁定特性设为“可选的”，企业管理员可以在存储此类敏感数据的生产机器上启用该特性。相反，在标准的桌面机器(或开发者机器)上，该特性可以保持禁用。

任何经历过系统漏洞的管理员都会考虑在漏洞到达主线内核时立即启用锁定。尽管 Linux 内核是市场上最安全的内核之一，但通过 root 帐户，用户*可能*对系统造成严重破坏。该根帐户是任何 Linux 系统受到危害的主要途径。一旦一个坏演员声称可以访问该帐户，他们可以做的事情是没有限制的。这就是锁定模式发挥作用的地方。启用后，root 帐户将被阻止对内核代码进行任何更改，从而阻止许多黑客入侵系统的企图。

锁定模式应该对增加内核安全性有很大的帮助，这将受到许多企业的欢迎。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>