# 集装箱既有漏洞又有风险——但事实总是如此

> 原文：<https://thenewstack.io/containers-can-be-both-leaky-and-risky-but-thats-always-been-true/>

[Synopsys](https://www.synopsys.com/software-integrity.html) 赞助本帖。

 [泰勒·阿梅尔丁

泰勒·阿梅尔丁(Taylor Armerding)是一名屡获殊荣的记者，他在 2011 年离开了主流报纸日益衰落的领域，投身于信息安全领域的爆炸性发展。Taylor 目前是 Synopsys 软件完整性小组的高级信息安全作家，之前曾为 CSO Online 和 Sophos 博客 Naked Security 写过文章。当他不写作的时候，他会去远足、骑自行车、打高尔夫球，还会播放蓝草音乐。在 Twitter @tarmerding2 上关注他。](https://www.linkedin.com/in/taylor-armerding-b6b2b03b/) 

提示泄漏容器笑话——安全初创公司 Prevasio 本月早些时候发布了一份报告，应该会给你提供大量材料。该公司分析了 Docker Hub 上托管的大约 400 万个公共 Docker 容器图像，发现超过一半(51%)存在严重漏洞。它还发现了 6，432 张包含恶意或潜在有害元素的图像。

很多容器上都有很多洞。

当然，这并不好笑。听起来很严重。普雷瓦西奥在 T2 的一份新闻稿中说，他们的发现表明“Docker 容器对没有足够安全协议的企业客户实施容器技术带来了潜在的严重风险。”

“Docker Hub 并不像之前认为的那样具有抵御攻击的能力，”Prevasio 首席执行官 [Rony Moshkovich](https://www.linkedin.com/in/ronym) 说。

嗯，是也不是。其他集装箱专家说，它既没有听起来那么严重，也没有听起来那么令人震惊。他们同意 Docker 容器图像中存在许多漏洞，但这是多年来的常识，并且该报告的结果需要更多的上下文。

新思软件公司软件完整性小组的副首席顾问 David Belcher 称这份报告为“一个众所周知的问题的耸人听闻的观点”

“这是一个非常真实和有效的问题，所以也许以一种耸人听闻的方式出售它并不是那么糟糕，”他说，但随后指出了一个明显的事实 Docker Hub 是一个开放的平台。“任何人都可以在那里提交项目，不再维护的旧项目可以在那里搁置多年。使用来自公共来源的容器图像一直是，并将永远是有风险的。”

云原生服务提供商[容器解决方案](https://www.container-solutions.com/)的首席科学家、2015 年出版的书[《使用 Docker》的作者](https://www.oreilly.com/library/view/using-docker/9781491915752/)Adrian Mouat 对此表示赞同。他说，缺乏背景使得原始发现“危言耸听”

“如果我今天使用完全最新的软件构建并推送一个映像，希望它没有漏洞，”他说。“但新的漏洞一直在被发现，所以在几周或几个月后，这种情况可能会改变。与此同时，我可能已经停止使用该图像，因为我创建了一个较新的图像，或者因为我不再需要它。但它仍然在集线器上，贡献了 51%。”

Mouat 还表示，其他分析师也发现了类似的结果，尽管他们使用了不同的分析工具。“这份报告侧重于‘动态’分析，但看起来结果不会有很大不同，”他说。

普雷瓦西奥的报告说，它的方法确实不同，而且更完整。它表示，它使用自己的专有分析器进行了“首次也是唯一一次对整个 Docker Hub 的全面安全扫描”，该分析器在专用的虚拟环境中“引爆”了每个容器，捕捉到了其行为。”普雷瓦西奥继续说，这个系统“在 800 台并行运行的机器上不间断地运行了一个月。”

根据 Prevasio 的报告，这种在“动态分析沙箱”中进行的扫描允许该公司以“任何静态图像扫描仪都无法达到的”方式捕捉容器图像的行为。

芯片设计公司 Synopsys 软件完整性小组的首席安全顾问 Chandu Ketkar 同意动态扫描优于静态扫描。“它可以检测具有动态有效负载的图像，其中原始图像表面上看起来没有恶意软件。但在运行时，它会被编写脚本来下载恶意软件并执行它。这类问题更难静态检测，”他说。

他补充说，“受恶意软件感染的容器映像可以更快地扩散，因为通过可信注册表的传输机制已经被固化。”

这份报告显然是为了给业内最受欢迎的集装箱平台之一敲响警钟。普雷瓦西奥的报告指出，2013 年首次发布的 Docker Hub“通过提供一个通用的行业标准”，使构建和运行容器变得更加容易。

“从开发者的角度来看，容器提供的最大好处是‘一次构建，随处部署’的概念。”Docker 容器是打包软件的标准形式，将所有软件及其依赖项打包成一个轻量级的、独立的、可执行的形式，”报告继续说道。

它补充道，Docker Hub 库“允许开发社区推送(上传)和拉取(下载)容器映像。”

但正如普雷瓦西奥报道的那样，许多这些图片都有漏洞，可能包含恶意软件。具体是:

*   所有容器中有 51%存在严重漏洞，13%的漏洞被归类为高，4%为中等。
*   6，432 个容器感染了密码矿工、黑客工具/笔测试框架和后门木马。尽管许多密码挖掘者和黑客工具本身可能并无恶意，但它们给企业带来了潜在的不必要的问题
*   有超过 400 个“武器化的 Windows 恶意软件进入 Linux 世界”的例子(有近 60 万次)。这种交叉直接归因于跨平台代码的激增(例如，GoLang，。NET 核心和 PowerShell 核心)。”

Moshkovich 说，普雷瓦西奥“在 9 月初就我们计划的扫描与 Docker 进行了几次通话。我们还在上市前 24 小时向 Docker 披露了研究结果以供评论，但我们没有收到对研究结果的反馈。”

[Docker](https://www.docker.com/) 的通信副总裁 Michelle Lazzar 说，该公司“建议用户只使用已知/可信的内容”，并补充说 Docker“已经在我们的工具中内置了漏洞扫描，以确保开发者能够在应用程序开发过程的早期发现问题。”

但是[pre vasio 的联合创始人兼首席技术官 Sergei Shevchenko](https://www.linkedin.com/in/sergei-shevchenko) 表示，Docker 提供的漏洞扫描只对付费的开发者开放，他们订阅了 Pro 或 Team 计划。他还表示，该服务不会扫描恶意软件，并认为 Docker 应该为免费和付费用户进行“综合安全扫描”。

Mouat 说一些被感染的图片是低风险的。“它们可能会被贴上‘cryptomminer’这样的标签，这样用户就不会有意外运行它们的风险——尽管质疑它们是否应该由网络中心分发仍然是合理的，”他说。

“但也有一部分人伪装成别的什么东西，试图欺骗人们运行它们。这很危险——理想情况下，这些图像应该从网络中心移除。”

Mouat 还表示，如果“关注‘官方图片’——在某种意义上由 Docker 或合作伙伴审查的那些——并找出最新版本中有多少漏洞会更有帮助，因为旧版本预计会有漏洞。此外，还要查看有多少易受攻击的映像正在被频繁使用，以及它们是否是最新版本。”

贝尔彻同意。“几乎任何人都可以轻松地将图片上传到 Docker Hub，并且不需要清理旧图片，这大大降低了这个问题的重要性，”他说。“如果他们的评估仅限于特定的、可信的枢纽——由 Docker 自己或其他可信方策划的图像——结果将会重要得多。”

所有这些都提出了一个基本问题:谁有责任发现并修复这些漏洞？

Shevchenko 说这取决于 Docker 和它的用户，他指出容器“就像一个迷你操作系统，所有的依赖都预先打包在里面。如果在相当长的一段时间内对其置之不理，它将变得易受攻击，从而被人利用。容器映像需要不断地重建和重新测试，以确保它们不依赖于易受攻击的依赖项。”

关于如何构建和维护容器映像的安全性，有很多建议可供参考，包括本次网络研讨会:“容器化生产环境中的漏洞”， [Synopsys 网络安全研究中心](https://www.synopsys.com/software-integrity/cybersecurity-research-center.html) (CyRC)的首席安全策略师 [Tim Mackey](https://www.linkedin.com/in/mackeytim/) 。

Ketkar 说，一般来说，“你需要担心你的构建基础设施的安全性，映像安全性，注册表安全性，以及运行时安全性。”

还有，先验证再信任。“我们总是建议不要相信从任何公共存储库中检索到的图像，”贝尔彻说。“在使用之前，您应该始终测试和验证由第三方创建的容器。一个易于访问的公共图像存储库具有包含旧的易受攻击的库甚至恶意软件的图像，这是容器安全领域的常识。”

Mouat 说，组织从报告中得到的主要收获是“他们需要保持软件更新。这是一项艰巨的任务——这意味着不仅要查看容器映像，还要查看开发人员使用的库、运行映像的主机上的 Kubernetes 和 Linux 版本等。”

但他说，同样重要的是要记住，漏洞和恶意软件“并不特定于容器。同样的代码也可以通过其他方式部署，比如通过包管理器或在虚拟机中部署。”

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>