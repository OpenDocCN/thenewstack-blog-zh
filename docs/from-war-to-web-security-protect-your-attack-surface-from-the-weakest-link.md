# 从战争到网络安全，从最薄弱的环节保护您的攻击面

> 原文：<https://thenewstack.io/from-war-to-web-security-protect-your-attack-surface-from-the-weakest-link/>

随着数据的快速增长、域和子域数量的增加以及第三方提供商的增多，攻击者可以用来渗透公司 web 环境的入口点的数量是无穷无尽的。攻击越来越多地造成超出组织边界的后果，如今年早些时候的[Colonial Pipeline break](https://www.bloomberg.com/news/articles/2021-06-04/hackers-breached-colonial-pipeline-using-compromised-password)导致美国东海岸燃料价格飙升，以及[对软件提供商 Kaseya](https://helpdesk.kaseya.com/hc/en-gb/articles/4403440684689-Important-Notice-August-4th-2021) 的攻击迫使北欧数百家杂货店停业数日。

## 战斗中的真理在商业中也是真理

 [弗雷德里克·诺德伯格·阿尔姆罗斯

Fredrik Nordberg Almroth 是 Detectify 的联合创始人和安全研究员。他被赛门铁克选为 2015 年未来安全专家，并入选谷歌安全名人堂。](https://fredrik-almroth.se/) 

安全漏洞经常通过一种没人预见到的途径发生——没人知道存在的服务器、旧的登录页面、弱密码或缺少补丁的应用程序。或许从来没有比今天更清楚的一点是，一家公司的实力取决于其不断增长的攻击面中最薄弱的一环。

公司在当今互联网环境中面临的挑战让人想起了[生存偏见](https://www.bbc.com/worklife/article/20191001-the-bias-behind-the-worlds-greatest-catastrophes)的概念，以及二战中最著名的例子。美国空军在战争期间面临的最大问题之一是如何防止他们的飞机被击落。安装装甲会使飞机更重，航程更短，所以解决方案只是对最重要的部分进行装甲化。

在分析了飞机受损最严重的地方后，该公司决定需要加固飞机的翼尖、中央机身和升降舵。然而，数学家亚伯拉罕·瓦尔德指出，有另一种方法来看待这些数据。他认为屏蔽不应该在有弹孔的地方，而应该在没有弹孔的地方——在引擎上，因为那是被摧毁的飞机上的损坏之处，而且根本没有回来。

通过借鉴互联网和第二次世界大战之间的类比，很容易看出公司如何将更多的资源投入可见的载体，而不是更危险和不可见的载体。无论是战斗还是商业，这都是关于精通你所做的事情，并消除低效的系统和流程。你把你的盔甲放在正确的地方了吗？您是否在攻击者所在的地方寻找安全问题？你们公司有哪些你看不到的弹孔？

这些现实生活中的攻击方法都是生存偏见如何在现代网络安全中发挥作用以及如何避免它们的例子。

## CVE-2019-7609:基巴纳·RCE

有时，保护攻击面可能就像评估将某些系统暴露在网络中是否真的有价值一样简单。Kibana 是一个免费的、开放的应用程序，公司使用它来可视化内部数据。因为它用于内部数据分析，所以它通常位于公司的内部网上，不需要暴露在互联网上——因此将精力放在这里似乎是对安全资源的低效使用。

然而，在 Shodan (一个互联网连接设备的搜索引擎)上的快速搜索显示，大约有 8000 个 Kibana 实例实际上是在网上公开的，我敢打赌，其中许多是不应该的。此外，Kibana 依赖于 Elasticsearch，这是一个针对数字和基于文本的数据的搜索和分析引擎，它又依赖于基于 Java 的日志框架 Log4j。

> 你把你的盔甲放在正确的地方了吗？您是否在攻击者所在的地方寻找安全问题？你们公司有哪些你看不到的弹孔？

2018 年，研究人员在 ki Bana 5 . 6 . 15 和 6.6.1 之前的版本中发现了一个任意代码执行漏洞，该漏洞允许攻击者发送一个试图执行 JavaScript 代码的请求。这可能导致攻击者以主机系统 Kibana 进程的权限执行任意命令。该漏洞已于 2019 年 2 月被修补。据报道，目前在互联网上引起轩然大波的 Log4j bug [CVE-2021-44228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228) 并没有影响到基巴纳，但它说明了这些暴露的系统是多么的脆弱。

确保关注网上公开的内容，如果不应该在网上公开，就把它从网上撤下来，这样可以节省资源，用在其他地方会更好。

## WordPress 插件“WooCommerce 的 Mailchimp”本地文件包含

仅仅因为您的第三方应用程序是最新的，并不一定意味着它可以免受攻击——它下面仍然可能有不太明显的安全漏洞。WordPress 是世界上最受欢迎的内容管理平台，估计为全球所有网站的近 40%提供支持。许多公司都在他们的基础设施中安装了 WordPress，很容易相信只要你运行的是最新版本，你就是安全的。

一个例子是如果你在 WooCommerce 上使用旧版本的 WordPress 插件 Mailchimp。攻击者可以访问配置、日志文件、API 密钥和密码等机密信息，这些信息可以作为其他攻击的立足点。该漏洞还可以通过远程代码执行(RCE)来发现。

保留您创建的所有网站的清单，尤其是那些用于活动的临时网站，对于防止恶意子域接管或 RCE 等表面攻击非常关键。有许多开源和许可选项可以自动监控和枚举连接和遗忘的 web 资产，并在它们以任何方式发生变化时提醒您。

## 过期名称服务器

有时，部分外部攻击面会被遗忘，因为它们不需要定期维护——尽管它们是基础架构的重要组成部分，因此应该不断监控问题。名称服务器就是一个例子，它通常被配置一次，然后就不再使用了。例如，为活动网站配置 CNAME 记录可能比配置整个域名服务器记录更常见。因此，名称服务器指针很容易被忘记。然而，如果攻击者控制了它，这种影响可能是毁灭性的和深远的。刚果民主共和国的顶级域名[就是这种情况。cd”。](https://labs.detectify.com/2021/01/15/how-i-hijacked-the-top-level-domain-of-a-sovereign-state/)

一年前，我发现其中一个域名服务器。cd 国家代码即将到期。显然，一个如此重要的域名——被 9000 万人口使用——本不应该过期，但刚果政府中的某个人可能忘了支付续费。幸运的是，过期域名不会立即消失。

当我发现域名即将到期时，我开始监控它，以为刚果政府中有人会出钱收回域名。但是，令我惊讶的是，没有人这样做。2020 年 12 月圣诞假期期间，该域名即将从互联网上脱落。在域名变得可用的几分钟内，我以 9 美元的价格抢购了它，以防止坏人接管它。

如果它落入坏人之手，恶意行为者可能会发起中间人攻击，拦截数百万用户的互联网流量。在这种情况下，有可能滥用 SSL/TLS 证书的颁发来进一步破坏加密通信。这意味着攻击者不仅可以看到，还可以修改流入和流出所有设备的流量。cd 域名，即使是在加密的情况下(包括从常规网络流量到电子邮件和其他种类的互联网通信)，这一切都是因为有人忘记了他们攻击面的这个小而重要的角落。

## 入侵自己是保护外部攻击面的唯一方法

攻击者的眼睛和耳朵遍布网络，成功的攻击者总是在别人看不到的地方寻找。当我作为一个 bug 猎人接近一个目标时，我会跳过主应用程序，寻找不太明显且有时简单的路径。我走的是阻力最小的道路，这也是我能够在谷歌、Dropbox、优步和 Tinder 等许多网站上发现安全漏洞的原因。在不断变化的安全环境中，公司需要不断地自我攻击，以跟上黑客社区的步伐。

这意味着应用黑客思维，持续监控您拥有的资产，并进行压力测试以发现可利用的异常情况。你也可以通过各种方式与有道德的黑客合作，以最小化攻击面。在我看来，公司和黑客之间的合作将让我们更快地获得更安全的互联网。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>