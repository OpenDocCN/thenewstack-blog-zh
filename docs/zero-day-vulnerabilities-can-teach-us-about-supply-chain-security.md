# 零日漏洞可以教会我们供应链安全

> 原文：<https://thenewstack.io/zero-day-vulnerabilities-can-teach-us-about-supply-chain-security/>

Log4Shell 漏洞是一种异常现象，还是组织未来将面临的安全事件类型的前兆？

虽然对 CVE 最糟糕的预测没有成真，但是每个组织都有一个容易受到攻击的软件供应链。嵌入开源第三方库是常见的开发实践，因为它大大加快了速度，但每个库都可能是风险的来源。由于额外的好处，大多数开发团队都愿意接受这种风险。

然而，网络罪犯和民族国家行为者知道在开源代码中发现和利用漏洞是有价值的。由于开源项目最终资金和人员不足，有动机的攻击者将继续利用这些漏洞。我们可以从管理和减轻未来威胁中学到什么？

## **一年后:每天 50 万次以上的攻击**

Log4Shell 漏洞是近年来发现的最严重和最麻烦的 CVE 之一。鉴于几乎每个企业 Java 开发人员都使用 Log4j 日志服务框架，我无法想象还有比这更糟糕的库会有漏洞。

一年多后，许多组织[还没有在他们的系统上实施针对该漏洞的补丁](https://thenewstack.io/log4shell-lives/),原因有二:

*   企业优先修补其外部系统，但这仅占整个 IT 基础设施的一小部分。许多公司尚未解决其内部应用程序的问题，而内部应用程序是公司基础架构的主要组成部分。
*   识别或减少商业现成软件中的漏洞需要时间，因为您对潜在的问题没有深刻的理解。

尽管已经存在一年多了，但是与 Log4j 相关的漏洞仍然是一个活跃的威胁。事实上，自 2021 年 12 月以来，所有 CVE 请求中有 12%与 Log4Shell 有关，这相当于平均每天 [500，000 个攻击请求](https://www.imperva.com/blog/log4j-one-year-later/)。大约 7%的恶意请求是成功的，这强调了对于在 Java 环境中使用日志框架的企业来说，这仍然是一个可行的威胁。

攻击者能够快速利用该漏洞，因为它在几天内自动完成，并且发现了新的排列和编码技术，允许绕过薄弱的防御。虽然请求也来自 cURL、PhantomJS、Nessus Cloud、Go HTTP library 和 Node.js，但它通常被机器人和 Chrome 浏览器利用。

此外，一些漏洞扫描器能够扫描易受攻击的 Log4j 应用程序，并构成我们在互联网上扫描 Log4Shell 漏洞时看到的流量的一部分。虽然这些漏洞扫描器通常用于无恶意目的，但它们有时也会被攻击者用来探测漏洞。

根据对用于利用漏洞的有效载荷的分析，Imperva 威胁研究通常将它们分类为:

*   **探测:**攻击者通常会在发送实际负载之前探测应用程序，并检查应用程序是否易受攻击。
*   **反向外壳:**这个有效载荷会在易受攻击的应用程序和黑客之间打开一个通信通道。黑客收到通信后，可以进一步探索目标系统并远程运行任何外壳命令。
*   **恶意软件部署:**攻击者试图在易受攻击的系统上部署恶意软件。
*   **数据泄漏:**有效载荷试图泄漏信息。
*   **打补丁:**有趣的是，Log4Shell 可用于部署更改配置且不允许查找的 Java 代码。换句话说，您可以用 Log4Shell 有效负载来修补 Log4Shell 漏洞。

## **争取时间:安全团队如何帮助开发人员并最小化影响**

不幸的是，供应链风险不可避免，像 Log4j 这样的零日事故还会再次发生。当公布一个漏洞时，开发团队需要花费时间来编写、测试和验证一个修复程序是否能在不破坏现有功能的情况下修补该问题。为了最大限度地减少这些事件的影响，并为开发人员赢得修补系统的时间，安全团队应该实施以下几项控制措施:

*   **部署** [**web 应用程序和 API 保护(WAAP)**](https://www.imperva.com/learn/application-security/web-application-and-api-protection-waap/) **解决方案:**WAAP 解决方案是保护生产工作负载的有效、非侵入式安全防御。它们提供了有效的早期缓解措施，可以检查所有内容、有效负载和恶意内容请求。此外，如果您正在使用 gRPC 或 GraphQL 编写和构建 API，WAAP 产品可以减轻自动威胁，如恶意机器人、分布式拒绝服务(DDoS)或 API 滥用，这与 web 应用防火墙不同，后者通常对 gRPC 或 GraphQL 流量视而不见。
*   **投资运行时应用程序自我保护(RASP):** 除了是 NIST ( [SP 800-53 修订版 5 | SI-7 (17)](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r5.pdf) )认可的唯一解决方案，作为阻止软件供应链攻击的推荐控制措施，RASP 还通过持续集成、持续交付(CI/CD)流程将安全性集成到 DevOps 中，无缝地成为组织的安全软件开发生命周期(SSDLC)的一部分。从攻击到注入，甚至是弱点，RASP 都能够实时检测和阻止攻击。该技术可以将攻击精确到一行代码，并自动停止利用漏洞，这使开发人员有时间根据自己的计划修补漏洞。
*   **采用微分段方法:** [微分段](https://www.imperva.com/learn/application-security/micro-segmentation/)在特定工作负载级别将网络划分为独立的安全段。这使得定义安全控制和限制对每个网段的访问成为可能，从而防止危害一个网段的攻击者能够向其他网段执行横向移动或权限提升。

## **管理供应链风险始于安全开发**

通过实施安全控制，开发人员可以有足够的时间来修补漏洞。理论上，这个过程听起来很简单，但事实并非总是如此。我从客户开发团队那里听到了两个常见的挑战:

*   **第一方软件打补丁需要时间。**编写、测试和验证修补程序是否能解决漏洞需要反复试验。根据定义，零日没有补丁，这意味着开发人员通常需要几天才能开始修补他们的应用程序。此外，在确定真正的修复之前，软件需要经历 QA 周期。这就是为什么安全控制对于在恶意活动到达运行时之前阻止它是必要的。此外，开发人员必须分析他们的软件开发生命周期(SDLC ),并在漏洞公布之前对其进行扩充。资产或应用程序清单应该是一个强制组件，以便当漏洞被披露时，组织知道谁拥有该应用程序以及应该联系谁。最后，开发人员不仅要注意直接依赖项的安全威胁，还要注意传递依赖项，即依赖项的依赖项，因为它们也容易被利用。
*   **商业现成软件是安全团队的泥潭**。保护第三方或商业现成软件是每个组织面临的最大网络安全挑战之一。不幸的是，大多数供应商不公开组成他们软件的组件和库，这使得组织很难知道漏洞一旦被公开是否会影响他们。从历史上看，公司关注的是由他们的直接供应商和他们依赖的关键软件带来的风险。然而，这种姿态已经不够了。

开发人员必须团结起来倡导采用几个软件标准，如[软件材料清单](https://ntia.gov/page/software-bill-materials)和[漏洞利用交换](https://ntia.gov/files/ntia/publications/vex_one-page_summary.pdf)。此外，像 [OpenSSF Foundation](https://openssf.org/) 这样的行业驱动的努力正在为开发人员提供基本的指导，以确保安全开发成为一种习惯，尤其是在运营防御还不能完全解决这一挑战的时候。

## **结论**

令人欣慰的是，让公众意识到 Log4Shell 漏洞的活动鼓励了组织修补系统和部署预防机制。这降低了更大、更具灾难性影响的可能性，包括大规模安全事件和数据泄露。

对 Log4j 的回应是一个很好的例子，说明了私营部门和公共部门如何合作解决高优先级问题。此外，我们看到安全和开发团队可以协同工作，快速响应和解决风险。

我们可以将 Log4j 的回应部分归功于许多组织在 2017 年 Apache Struts 零日(最后一个大规模软件供应链漏洞)之后所做的准备工作。这个经验强调了组织需要[将软件材料清单(sbom)](https://thenewstack.io/sbom-everywhere-the-openssf-plan-for-sboms/)包含到他们的开发过程中，使他们能够知道软件供应链中的依赖项是什么以及在哪里。

最终，Log4j 是一个零日。虽然一旦零日漏洞被披露，人们会尽最大努力快速修补漏洞，但在发现软件供应链攻击之前，您必须采取其他控制措施来防止它们。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>