# Azure Kubernetes 服务如何提高开发人员的工作效率

> 原文：<https://thenewstack.io/how-the-azure-kubernetes-service-makes-developers-more-productive/>

容器简化了应用程序的部署、扩展和运行。Kubernetes 是编排和管理容器的首选平台，这些容器将应用程序的组件打包，以便在混合环境中运行。对这种现代应用程序开发方法近乎贪得无厌的需求，在构建容器和 Kubernetes 技术的开源社区中创建了一个强制功能。

Kubernetes 生态系统仍在开发在生产中有效运行复杂的容器化应用的关键技术。但是对于现在开始使用容器的主流开发者来说，问题不是他们是否应该在 Kubernetes 上运行他们的应用程序，而是如何高效地运行。

有了强大的 Kubernetes 核心，现在进入了容器和 Kubernetes 发展的下一个阶段。管道准备好了。现在，开发者的体验才是最重要的。这是开发 Azure Kubernetes 服务的架构师的核心信念。AKS 简化了开发人员的开发体验——从构建和测试容器映像到调试和部署到生产。

[微软](https://azure.microsoft.com/en-us/?v=17.14)的新[AKS](https://azure.microsoft.com/hu-hu/blog/introducing-dev-spaces-for-aks/)开发者工具反映了对开发者体验的重视。基于 Visual Studio，Dev Spaces 工具简化了 Kubernetes 上的开发人员工作流程。对于在 Kubernetes 上运行的复杂的基于微服务的应用程序，这些工具允许更简单的开发环境设置、生产前测试、迭代开发和更快的调试。

“在分布式系统时代，做一名开发人员很难。微软 Azure 容器团队的首席项目经理 Gabe Monroy 说:“在让主流开发者能够使用容器和容器编排并构建分布式应用程序方面，我们还有很长的路要走。“行业一直专注于 API 和有原则的分层架构，这很好，我们需要所有这些，但对应用程序开发人员的体验没有太多关注。我们如何让在这个新世界中开发软件的过程感觉像他们以前在做的事情？”

## Kubernetes 从构建到部署都在挑战开发人员

刚接触 Kubernetes 的开发者面临着很高的准入门槛。利用容器可能意味着许多小时的研究。他们开始学习如何写一个 docker 文件，一个清单和一个舵图，可能会使用当地发展草案。然后，他们继续研究如何测试代码，将其构建到映像中，链接到与 Brigade 的持续集成工作流中，并安全地部署到集群上，这需要创建审计日志，并且没有任何意外部署。

但是开发人员还需要设置他们的开发环境来使用容器，使其看起来、感觉起来和行为起来都像生产环境。它还必须与驱动应用程序其余部分的所有其他微服务、容器和外部依赖项集成，这意味着在本地删除或模仿服务以与之匹配。在一个大型项目中，每个开发人员都必须花时间去做，即使他们可能只做其中的一小部分。

此外，他们希望在自己的环境中使用他们熟悉的丰富的开发人员工具，包括日志记录，以便他们可以针对实时服务进行调试，以及断点和直接从他们的 IDE 进行快速部署，以便他们可以尝试代码更改。

Monroy 说:“你可能已经听说了现在业界流传的说法，Kubernetes 对开发者来说仍然太难使用了。“我们一致认为这是下一层基础架构，没有人可以使用它，这太好了！”他说，这是一个有严肃意义的笑话。

### 微软为 Kubernetes 开发的工具

一次又一次，微软改变了不同领域的开发者体验，从 Excel 和 Access 到 Logic 应用，现在是新的 [Azure Dev Spaces](https://aka.ms/devspaces) 服务，用于针对 AKS 的快速开发。

该公司的目标是支持现在开始使用容器的主流开发者。为了做到这一点，该公司正在利用其在开发工具方面的历史，以及从创建 Helm、Brigade 和 Draft 等开源工具中学到的东西。微软也是上游 Kubernetes 项目的主要贡献者——Kubernetes 联合创始人 [Brendan Burns](https://www.linkedin.com/in/brendan-burns-487aa590/) 领导微软容器团队——微软是 Kubernetes 之家[云本地计算基金会](https://www.cncf.io/) (CNCF)的成员。

“微软作为一家以开发者为导向的公司的 DNA 已经发挥出来，你将看到微软开发者部门的全部力量在 CNCF 世界释放出来，”蒙罗伊说。

微软向对开发者更友好的 Kubernetes 迈出的第一步是针对 Visual Studio 的新工具、Visual Studio 代码(以及针对喜欢这些的开发者的 CLI)。Kubernetes 工具自动为新的或现有的项目创建 Kubernetes 部署所需的“配置代码”脚手架，如 Dockerfiles 和 Helm charts(帮助容器化现有应用程序)。这些工具还集成了新的 Azure Dev Spaces 服务，因此搭建不仅仅是为了开始使用第一个 Hello World 容器应用程序；它为开发人员提供了资产和工件，他们可以将它们一直带到生产中，并提供了组织模板来帮助团队坚持编码标准。

### 使用 AKS 上的 Dev Spaces 在 5 分钟内调试微服务

Dev Spaces 在运行于 AKS 上的 Kubernetes 集群中为每个项目开发人员创建了一个单独的沙盒“空间”。他们可以直接从熟悉的 ide(比如 Visual Studio 和 Visual Studio 代码(在 Windows、Mac 或 Linux 上))或者从命令行使用这个空间。他们在云中针对实时 Kubernetes 集群工作，并获得了一个看起来和感觉上完全像生产环境的开发环境，所有的依赖项、微服务和连接服务组成了应用程序。没有权限(或技能)来设置这些服务的开发人员仍然可以测试它们在云中的运行。但是他们直接进入代码所在的容器，他们可以独立地调试、测试和迭代；他们正在编写的代码不会影响团队中的其他开发人员。

用名称空间隔离和多租户控制为 Kubernetes 集群设置隔离通常非常复杂；对于 Dev Spaces，它只是附带了 Azure 访问模型。但是因为 AKS 的底层是完整的 Kubernetes，而 Dev Spaces 是使用原生 Kubernetes 概念实现的现有 AKS 集群的附加组件，所以可以使用其他 Azure 服务或第三方工具。如果你想使用 Azure Key Vault 或 Hashicorp Vault 来注入秘密，而不是将它们存储在代码中，那就可以了。

但是与 Visual Studio 集成的美妙之处在于，除了容器和云服务的所有功能之外，开发人员还可以获得他们熟悉的工具和工作流的生产力。他们可以创建一个新项目，设置断点，按 F5 键调试代码，就像代码在他们自己的系统上运行时一样。他们获得 IntelliSense 和新的 IntelliCode AI 支持的帮助来编写代码，甚至使用 Visual Studio Live Share 进行协作编辑，就像他们编写任何其他类型的应用程序一样。但是因为他们是针对 AKS 工作的，他们还可以看到运行中的容器的健康状况，并通过搜索丰富的日志来查看生产中错误发生的确切位置。一旦他们发现了一个 bug，他们可以进行修复，然后按 F5 键将这些修改直接发送到 AKS，并看到它们运行。

Monroy 指出:“随着世界接受了这些复杂的微服务环境，现在开发人员走向一个环境并提高工作效率变得非常困难。

当一个应用可以由数百个微服务组成，每个微服务都有自己的数据存储排列时，修复一个服务中的错误就像大海捞针。对于开发人员来说，在一台笔记本电脑上设置一百个服务或模仿它们，以及它们所有的后备存储，是极其耗时的。只是设置他们的环境，以便他们可以找到并修复过去需要一天时间的整体应用程序。现在，如果开发人员能够正确设置复杂的分布式应用程序，那么准备工作可能需要几周时间。

“Dev Spaces 提供了使用你的 Azure 账户的能力，你可以在五分钟内修复一个错误，”Monroy 说。

在幕后，Dev Spaces 将开发人员正在本地处理的代码中的更改直接同步到容器中。对于大多数更改，这种更新不需要重新构建和重新部署容器映像。这意味着开发人员不会丢失他们的编码流程，同时等待查看更改是否修复了 bug。对于 Node.js 开发人员来说，习惯于让 nodemon 在每次检测到文件更改时自动为他们重新启动节点服务，并且只需要刷新浏览器来查看他们的新代码，这将会感觉很熟悉——并且很有效率。

Monroy 解释说，Dev Spaces 使用服务网状路由，允许开发人员调试非常复杂的分布式应用程序。“通过给 URL 添加前缀，你可以指示服务网格将你的流量路由到正在积极开发的容器。”

“现有的开源生态系统中没有任何东西在做智能代码同步或流量路由，”Monroy 指出。“如果你在 GKE 上有一个应用程序，在 GKE 上使用 Draft，你可以将同一个应用程序带到 Azure，通过更快的迭代循环、集成的空间和交通路线，获得更好的开发空间体验。”

Visual Studio、Dev Spaces 和 AKS 之间的紧密集成意味着，在 Azure 上使用 Kubernetes 的开发人员在开始使用云原生工具时，不会失去他们习惯于本地开发的生产力。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>