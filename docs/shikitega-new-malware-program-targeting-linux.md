# Shikitega:针对 Linux 的新恶意软件程序

> 原文：<https://thenewstack.io/shikitega-new-malware-program-targeting-linux/>

美国电话电报公司外星人实验室发现了一种针对终端和物联网设备的新的 [Linux 恶意软件](https://thenewstack.io/vmware-finds-linux-malware-on-the-rise/)程序。

通常，Linux 恶意软件的目标是服务器和云实例。你知道，哪里有一流的 CPU 能力来转向[加密货币挖掘](https://thenewstack.io/how-devops-sites-are-battling-cryptocurrency-miners/)。[然而，Shikitega 喜欢购买桌面电脑和物联网设备这些唾手可得的果实。当然，它也会愉快地攻击服务器。像所有恶意软件一样，它是一个机会均等的攻击者。](https://cybersecurity.att.com/blogs/labs-research/shikitega-new-stealthy-malware-targeting-linux)

## 多阶段感染

根据发现它的外星人实验室的说法，Shikitega 是一个多级感染链。感染始于一个很小的(370 字节)可执行和可链接格式(ELF)文件。如果你已经忘记，或者你从来不知道，永远不要下载一个未知的精灵文件。简直是自找麻烦。

当然，你可能甚至不知道在一个更大的包里藏着这样一个微小的文件。所以，就像 Windows 一样，在安装之前，确保你知道每个包里有什么，以及它来自哪里。

然后，一旦就位，就下载并执行另一个模块，然后下载并执行下一个模块，以此类推。除了引入下一个模块，每个模块都有自己的特定任务。其中包括下载并执行 [Metasploit meterpreter](https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/) ，追捕并利用 [Linux 漏洞](https://thenewstack.io/two-serious-vulnerabilities-hit-the-linux-kernel/)，以及在受感染的机器中设置持久性。它通过尝试运行 shell 程序来设置四个 crontabs 来完成最后一部分:两个用于当前登录的用户，另外两个用于 root 用户。如果您没有安装 [crontab](https://opensource.com/article/17/11/how-use-cron-linux) ，它将尝试安装并启动 crontab 服务。

最后，它会试图下载并执行一个 [cryptominer](https://thenewstack.io/startup-harvests-human-body-heat-mine-cryptocurrencies/) ，并试图以 root 用户身份控制你的机器。最后一种是试图利用基于 [CVE-2021-4034](https://nvd.nist.gov/vuln/detail/cve-2021-4034) ，又名 [PwnKit](https://thenewstack.io/how-to-mitigate-the-pwnkit-vulnerability/) ，和 [CVE-2021-3493](https://nvd.nist.gov/vuln/detail/CVE-2021-3493) 的漏洞。如果你让你的 Linux 系统保持最新，这可能是一个问题，如果你的物联网供应商没有做好自己的工作，这些攻击将会失败。

## 隐藏文件

Shikitega 通过使用 [Shikata Ga Nai](https://en.wikipedia.org/wiki/Shikata_ga_nai) 多态 XOR 加法反馈编码器来隐藏文件。使用 Shikata，它解码每个模块，直到最终的 shellcode 有效载荷被解码并运行。

接下来，它从其命令和控制(C&C)服务器下载并执行其他命令。这些都是运行在内存中，而不是存储在您的设备的驱动器。

所有这些的重点是将你的机器变成一个低功率的密码挖掘器。特别是 XMRig miner，一个 [Monero](https://www.getmonero.org/) miner。

## 避开 Shikitega

那么，你如何避免得到一个 Shikitega 的基本案例呢？简单。只是最基本的，安装安全补丁，保持备份，从不安装未知程序。如果您想使用安全带和吊带来保护您的安全，您还可以在您的终端上使用[反恶意软件程序](https://thenewstack.io/dont-forget-viruses-the-computer-kind/)。

和往常一样，如果你只是练习良好的服务器安全性，你应该是安全的。我在这里看到的唯一真正的危险是物联网设备。很多时候，物联网供应商在更新其嵌入式操作系统的安全补丁方面做得很糟糕。如果你的设备是这种情况，我建议从重视安全的供应商那里寻找替换设备。不幸的是，Linux 恶意软件的实例正在迅速增加。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>