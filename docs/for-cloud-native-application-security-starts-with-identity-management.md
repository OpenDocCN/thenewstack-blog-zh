# 对于云原生应用，应用安全性始于身份管理

> 原文：<https://thenewstack.io/for-cloud-native-application-security-starts-with-identity-management/>

[](https://www.protego.io/)

 [希勒尔·索洛

希勒尔·索洛是 Protego 的 CTO 和联合创始人。在此之前，他是思科物联网安全部门的首席技术官，负责为新技术市场开发创新的安全解决方案。](https://www.protego.io/) [](https://www.protego.io/)

关于如何看待无服务器应用程序中的权限和角色，我最近有了一些顿悟。也许对你们中的一些人来说，这不会像对我来说那样是“Soylent Green is People”。如果是这样，恭喜你。如果没有，让我打开你的眼睛。

让我们从一些家务开始。IAM(身份和访问管理)的理念是，像云帐户这样的系统中的参与者拥有一组有限的权限，这限制了他们可以做什么。虽然它最初是一个定义你的*用户*能做什么的概念，但它很快被吸收到其他事物的能力范围。

例如，如果您在 AWS 云环境中启动一个 EC2 实例，那么您需要为该实例分配一个 IAM 角色。AWS 将为您强制执行该角色，确保无论什么逻辑找到进入该实例的途径，它都无法绕过这些限制。ECS 容器、Fargate 容器和 Lambda 函数也是如此。每个人都有自己的角色，定义自己能做什么和不能做什么。

## 从前…

从历史上看，IAM 角色不是 AppSec 的事情。我的意思是，您并没有真正思考过“我该如何防止那些讨厌的 OWASP A1 注入攻击？我知道，我会配置一个 IAM 角色。”IAM 角色是一种基础设施。它们被用来广泛地限制某些邪恶(或者它们不是)，但是它们与你的开发人员在代码中写的东西没有什么关系，除了它们最好不要碍事。想要证据吗？过了一段时间，云提供商才允许您为每个无服务器功能分配一个独特的角色。有的还是没有(没错，谷歌，我在看你)。这是因为，如果您想从工作负载 IAM 角色中获得的只是划分出您不想触及的领域，那么您可能会满意地在一个通用策略中为所有工作负载这样做。

## 让有功能…

出于一些有趣的原因，向云原生开发的转变，也就是说，从第一天起就为云构建应用*的想法，也带来了对小微服务的新的亲和力。对于词源学证据，追踪与术语*纳米服务*相关的情感。两年前，这是一个向云转型失败的同义词，就像“小心不要走极端，以纳米服务告终”。今天，它是当今的设计选择。*

向更细粒度的微服务转变的一个有趣的副作用是有机会为每个小功能分配一个单独的 IAM 角色。我以前写过这方面的文章。无服务器应用程序给你机会收缩包装你的权限。我甚至谈到了在 Protego，我们如何使用应用程序代码和行为的自动分析来为您的应用程序的每一部分应用最小特权。

## *新*新 AppSec

最近我明白了为什么这如此重要。这是因为当你在函数的粒度上做 IAM 的时候， **IAM** **就变成了 AppSec 工具**。推动这一需求的应该是您的 AppSec 人员，而不是您的云基础架构安全人员。如果您能够将应用程序中每个函数、容器、存储桶和表的角色和策略限制到最低限度，您就可以防止您所担心的一大类应用程序攻击。

发生这种转变有两个原因。让我试着通过重新想象 Equifax 违规来说明这一点。

你会记得，2017 年，Equifax 遭到黑客攻击，超过 1.4 亿人的社会安全号码和驾照信息等敏感数据被盗。Equifax 在一系列虚拟机上运行易受攻击的 Apache Struts 版本，攻击者能够在这些服务器上轻松执行恶意代码。从那里，他们可以相对容易地访问相邻数据库中的敏感数据。在这个整体应用程序中，运行 Struts 的机器可能拥有对所有数据库表的完全访问权。

相反，假设您是 Equifax 团队的领导，刚刚在 Amazon Web Services 上以云原生方式重新构建了 Equifax 应用程序，利用了最新的技术和架构。这意味着你为云设计了它，并使用了云的原生资源，如 S3、DynamoDb 和 Kinesis。这还意味着，基于 Apache Struts 的大型应用程序将被重新设计为大量小型的单一用途功能，通过 API Gateway 响应事件。

好吧，你在想，大地震在哪里？我告诉你。第一部分是，你可能有 150 个 Lambda 函数和 12 个 Fargate 容器映像，而不是 5 个 VM 映像来存放应用程序。您不必为这五个虚拟机中的每一个都创建一个大的高风险角色，而是能够设计 162 个不同的角色，其中每一个都可以缩小到单个功能或容器所需的最低限度。

第二块是你停止部署自己的数据库、文件系统和数据处理管道，并重构这些来使用云原生资源。IAM 策略可以管理的云原生资源。

因此，想象一下 2017 年的那些攻击者从你的酷新应用中窃取 SSN。一个很大的优势是，用 Amazon 管理的东西(如 API Gateway)代替您需要管理的东西(如 Apache Struts ),这意味着他们正在处理您可能会忘记的补丁。更强大的是，您现在可以使用 IAM 非常具体地说明每个函数可以做什么，并且 IAM 在阻止访问每个函数中您不需要接触的数据方面更加有效。即使攻击者找到了在您某个函数中执行恶意远程代码的方法，IAM 也有可能阻止该函数访问大量不同数据库中的 1.4 亿条记录。

## 那又怎样？

因此，在使用 Lambda 和 Fargate 之类的细粒度云原生应用程序中，为每个功能定制的精心制作的 IAM 角色将减轻您的攻击面，甚至在您让开发人员编写更好的代码之前。我们在这里看到的主要挑战是让组织拥有向定制的最小角色的转变。技术，就像我们平台的一些功能一样，可以在现实世界中实现这种变化，在现实世界中，我们没有成千上万的安全工程师来审查代码和 API 以确定最佳策略。

云原生应用可以是 AppSec 的一次巨大飞跃，不仅因为我们现在如何使用 IAM，而且正确地使用它既是机遇也是挑战。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>