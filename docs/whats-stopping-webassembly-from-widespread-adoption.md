# 是什么阻止了 WebAssembly 的广泛采用？

> 原文：<https://thenewstack.io/whats-stopping-webassembly-from-widespread-adoption/>

[WebAssembly (Wasm)](https://thenewstack.io/what-is-webassembly-and-why-do-you-need-it/) [已经有五年了](https://wasm5.org/)。在原生云领域，这是一段相对较长的时间——例如，比 Kubernetes 出现的时间少三年。

Wasm 是一种基于堆栈的虚拟机的二进制指令格式，允许开发人员“构建一次，在任何地方运行”，被广泛认为具有[改变游戏规则的潜力。](https://thenewstack.io/how-webassembly-could-streamline-cloud-native-computing/)那么，为什么需要这么长时间才能被组织采用呢？

采用缓慢的一些原因可以追溯到 Wasm 生态系统本身的剧变。

## 程序集脚本分裂

最近几周已经清楚地展示了网络组装世界内部的问题。专门为在浏览器中使用 WebAssembly 而设计的语言 AssemblyScript 宣布，它已经取消了对 Wasm 系统接口 WASI(Wasm system interface)的支持，该接口使它更容易在浏览器之外使用。

AssemblyScript 决定离开 WASI 的具体原因尚不清楚，但似乎存在技术和个人分歧的不安混合。

WASI 项目的提议集中在 WebAssembly 与诸如 Rust 和 C++等语言的互操作性上，以牺牲 JavaScript 为代价；这最终会损害 AssemblyScript(因为它的 [TypeScript](https://thenewstack.io/what-is-typescript/) 性质),并迫使它对项目进行重大修改。

AssemblyScript 作者[在他们的在线文档](https://www.assemblyscript.org/standards-objections.html)的“标准异议”部分声称，万维网联盟(W3C)的 WASI 小组已经“扩大了它的范围”并且“设计了它自己的提议，与已建立的或当前设计的 Web 标准竞争。”

此外，提交人还声称，"我们的代表受到系统的歧视，他们的关切被压制"。

除此之外，AssemblyScript 还瞄准了字节码联盟，这是一个主要的技术组织团体，包括云提供商亚马逊、谷歌和微软，他们支持 WebAssembly 和 WASI。

AssemblyScript 的作者警告说:“我们想提醒公众注意潜在的反竞争行为，这表明需要反垄断立法的介入。”

这里有一些很容易被忽略的有用背景:数据表明对 AssemblyScript 的兴趣正在下降。在 Scott Logic 于 6 月发布的“【2022 年 WebAssembly 状态”调查中，只有 17%的受访者表示他们希望在未来大量使用 AssemblyScript，低于 2021 年调查中的 26%。

虽然对于 AssemblyScript 来说，这种下降可能是其在更广泛的 Wasm 项目中的待遇的症状，但很难不看到这实际上只是一个随着开发人员将注意力转向 Go 和 JavaScript 等语言而改变偏好的故事。

关于反竞争的指控，虽然字节码联盟成员的名单强调它代表了一些异常强大的利益，但没有理由认为正在发生的事情更多地是在赌什么可能胜出，而不是强行通过一个特定的议程。

[字节码联盟成员、边缘云平台公司 Fastly 的首席技术官泰勒·麦克马伦](https://www.linkedin.com/in/tylermcmullen)表达了他对新堆栈冲突的失望。但他强调，症结集中在一个“单一的、细微的技术细节——是否允许字符串包含某些无效的代码点。”

他还强调，关于这个“技术细节”的决定不是由一个人或一家公司做出的:“这个提议是由整个行业的一大群人审查和投票的，包括每一个主要的浏览器制造商。”

[开源平台工具公司 Suborbital 的工程总监奥斯卡·斯潘塞](https://www.linkedin.com/in/oscarspen/)，也是[谷物编程语言](https://grain-lang.org/)的合著者，回应了麦克马伦的失望，但也谈到了此举可能带来的影响。

“这将导致很多分裂，”他说。“诸如此类的事情阻碍了标准的发展和进步，这对于拥有这样一个有凝聚力的生态系统来说有点问题。”

## 跟踪 WebAssembly 的轨迹

像这样的冲突和分歧使得更广泛的软件社区很难真正理解 Wasm 应该如何以及为什么被使用。

尽管最初是为浏览器设计的，但现在这种用例已经不那么紧迫了。更多的关注和兴趣来自 Wasm 在浏览器之外的潜力，例如在服务器上运行它(有人建议它可以替代或与 Docker 结合使用),或者将代码捆绑在一起运行在多个应用程序上。

斯潘塞提供了他对 Wasm 发展轨迹的看法:“我们最终看到的是，JavaScript 引擎实际上非常非常快。仅仅在 WebAssembly 中重写你现有的应用程序有时实际上并不能让它们变得更快，只是因为 JavaScript 引擎在这一点上已经发展了几十年。

“因此，我认为我们看到的是在浏览器上用 WebAssembly 编写整个应用程序的用例越来越少，而[现在]更多的是，‘嘿，我需要这个真正快速的后台任务。’"

这并不是说 Wasm 已经从网络上消失了。相反，它已经发展到找到一个利基:解锁速度和性能。

[全球开源咨询公司 Igalia 的软件工程师 Andy Wingo](https://www.linkedin.com/in/andy-wingo-68823354/) 向新的堆栈展示了这类工作。他举了最近一个项目的例子，这个项目是一个广泛使用的基于浏览器的电子表格，他试图“提高 JavaScript 和 WebAssembly 之间字符串的效率”

他认为，这种类型的项目——他将其描述为“大型利益相关者和浏览器供应商之间专门的一对一关系”——是 Wasm 目前最常见的应用环境之一。

这是一个有用的视角:这是一个重要的提醒，尽管对一项新技术的炒作和兴趣程度很高，但它的直接影响甚至相关性往往植根于非常具体的用例。接着谈到 Wasm 在 Fastly 和电子商务平台 [Shopify](https://shopify.engineering/shopify-webassembly) 等公司的使用，Wingo 表示，对于这两家公司来说，Wasm 解决方案是由供应商推动的。

“我认为这些东西是由平台持有者的欲望驱动的，并在用户中产生兴奋，”他说。"但并不是用户立即驱动功能."

Wingo 的观点可以用 McMullen 的观点来解释:Wasm 并不是每个平台都支持的。“它尚未得到广泛支持的原因之一是它很难嵌入。很难嵌入的一个主要原因是因为没有标准的交互模型，”McMullen 说。

因此，看起来尽管业界对此很感兴趣，并且有很强的说服力——运行任何东西并快速运行——但在这一切的背后是相当大的复杂性和分歧。

## 以局外人的眼光看待 Wasm

对于局外人来说，WebAssembly 可能看起来很奇怪。虽然 Wasm 的炒作似乎只是因为它脱离了它的起源而增加，但在脱离浏览器的过程中，它也变得更加流畅和灵活，因此作为一种技术更难确定。

这可能是在标准开发方面存在如此紧张的原因之一——缺乏明确的共识，不同的团体朝着不同的方向努力。

当然，这对用户和潜在的 Wasm 开发者来说不是好消息。“一般来说，人们对 WebAssembly 只有非常基本的了解，却不知道为什么，”Wingo 说。

这并不意味着不屑一顾；相反，它说明了 WebAssembly 背后的叙述之间的差距(您可以在浏览器中运行任何代码！它兼具安全性和性能优势！)，以及将其成功应用于特定项目的挑战。

斯潘塞对此表示赞同，他告诉《新书库》,他认为大多数尝试谷物的人只是把它作为探索 Wasm 的一种方式。他说，大多数用户“想在 WebAssembly 中做些事情”，但发现其他与 Wasm 相关的语言，如 Rust 或 C++，太令人生畏了。他说，这些人“只是想尝试一下。”

虽然就构建编程语言而言，这有一个不可否认的逻辑——帮助人们进入以复杂著称的领域——但 Scott Logic 调查中的数据有趣地与斯潘塞的解读相矛盾。

在至少有时在 WebAssembly 中使用 Rust 的开发人员中，有 24%的人对未来使用 Grain 感兴趣。在其余的调查参与者中，只有 7%的人对未来使用谷物感兴趣。看起来，虽然 Grain 正在传递其易于使用的愿望，但它实际上是被那些寻找更简单的方法来解决特别复杂的工程问题的人选中了。

“许多语言都有很好的想法，但它们最终被认为深奥或太难学而被摒弃，因此，很难在它们周围聚集起一个庞大的社区，”谷物项目的主页上写道。“Grain 希望给这些想法带来新的生命，并以一种易于使用和理解的方式呈现出来。”

那么，Grain 的存在可能会被视为 WebAssembly 生态系统中最大的问题之一——事实上，没有一种简单的方法可以开始并真正看到它如何帮助解决问题。

这是一个似乎在互联网上出现的问题。例如，在 Quora 上，IT 支持软件公司甘草精的首席技术官朱利安·詹森(Julian Jensen)回答了一个来自 [Quora 的关于 WebAssembly 是否很难使用的问题。](https://www.quora.com/Who-has-used-WebAssembly-Is-it-hard-to-use)

“你可能会发现，几乎每篇关于这个主题的文章都不约而同地在浏览器中加载并执行了一个过于简单的功能，”詹森回答道。

他进一步强调了自己的观点:“这种类型的例子与你在现实世界中可能会写或需要的任何东西都不一样。它也没有触及你在试图让某些东西变得真正有用时会遇到的任何痛点。”

Jensen 的观点可能很强，但它仍然强调了尽管人们对 WebAssembly 很感兴趣，但它的生态系统并没有以一种让学习变得容易的方式发展。

但不仅如此，它还凸显了 Wasm 面临的一个主要挑战:如何以一种广大开发人员容易理解的方式呈现它，而又不会简单到毫无意义？

## WebAssembly 组件模型

问题又回到了标准化上。没有它，实现它所承诺的事情并不像你期望的那样容易。

目前，未来的希望在于 [WebAssembly 组件模型。](https://github.com/WebAssembly/component-model)据斯潘塞称，工作组尚未就此达成一致并最终定稿，这是“唯一真正阻止 WebAssembly 大爆炸的事情”

麦克马伦附和了这一观点。他说，组件模型在确保“标准的交互模型”方面至关重要，这反过来将使其更容易获得广泛的支持。

组件模型的目的是简化浏览器外 WebAssembly 的使用。通过编纂关于不同事物如何协同工作的规则和规范，它应该消除一些实际使用 WebAssembly 所需的认知负荷(和额外的代码)。

“组件模型的关键，”McMullen 说，“是使跨语言和生态系统安全有效地共享和连接代码成为可能。但除此之外，还有 WebAssembly 代码公开和期望的接口。通过以更高级的方式定义这些接口，我们可以开始就跨语言和平台工作的模式和标准达成一致。”

尽管它对整个 Wasm 项目非常重要，但是组件模型的细节仍然由 W3C WebAssembly 社区组进行讨论——这个过程可能需要一些时间。斯潘塞注意到，尽管初衷是好的，但在这个深度民主的过程中，有很多机会会让人们“放弃自行车”，或者花太多时间争论一些小细节，这可能会让事情进展缓慢。

那么整个过程需要多长时间？斯潘塞说，如果该小组直到 2023 年春天才进入实施阶段，他“不会感到震惊”。

麦克马伦为延误提供了强有力的辩护。“大多数工业标准没有 WebAssembly 及其配套标准那样严格，”他说。“它需要非常精确的措辞，并且最终是用数学写成的，这使得我们能够对它们的正确性进行强有力的证明。

“特别是组件模型，它试图定义一个标准，该标准将跨语言、异步模型、线程模型和行业工作，同时保持高效率和非常强的安全保证。”

尽管进展缓慢，斯潘塞和麦克马伦都承认它对 Wasm 用户的重要性——无论是现在还是将来。“这都是关于工具，”斯潘塞说。“这是开发人员最终关心的事情。”

## Wasm 会有专有的未来吗？

WebAssembly 的[未来——至少超越浏览器——似乎存在于组件模型中。但是我们也应该把眼光放远一点，看看更广阔的软件市场。](https://thenewstack.io/whats-next-in-webassembly/)

“将会有风投支持的竞争来占领这个领域，”Wingo 预测道。“其中一些可能会渗透到标准中，但我认为很多将会是专有锁定。”

这可能是 Shopify 和 Fastly 等公司目前所做的事情的自然演变；问题是厂商将 WebAssembly 打包成边缘计算解决方案有多容易。如果更广泛的 WebAssembly 项目可以帮助工程师们更加熟悉这项技术，这自然会影响供应商如何提供这样的解决方案。

字节码联盟内部的人不一定这么看。麦克马伦谈到将其视为一个“元生态系统”

他说:“我们绝对没有试图以任何方式‘用一枚戒指统治所有人’。“我们不仅希望看到语言的巨大多样性，还希望看到平台和行业的巨大多样性。”

## 找出 Wasm 适合的地方

无论风险投资者选择发挥他们的作用，无论项目不同分支背后的核心开发团队选择前进，Wasm 将仍然是一项重要而有价值的技术，在正确的情况下有能力改变游戏规则。

具有挑战性的是抵制抽象的冲动，并将其影响和价值转化为软件工程中每个人的银弹。

“最终，WebAssembly 只是一个编译器目标，”斯潘塞说。“归根结底，这是一个实施细节，如果 WebAssembly 在几年内做得很好，它就不会像现在这样成为一个热门词汇——这只是事情的工作方式。”

这个未来听起来很简单，也是这个项目的合理目标。WebAssembly 今天向我们展示的是，实际上实现这一目标需要大量的争论、探索、实验和建立共识。

* * *

[云本地计算基金会](https://cncf.io/?utm_content=inline-mention)目前正在进行一项简短的 [Wasm 调查](https://www.surveymonkey.com/r/cncf-wasm)，调查本文中讨论的许多主题:

*   **大肆宣传:**因为它专注于云本地市场，所以很可能会倾向于认为 WebAssembly 将产生长期影响，而不仅仅是一种时尚。
*   **挑战:**缺乏技能或工具是使用 Wasm 的最大障碍吗？更清晰的用例和标准会增加采用吗？
*   运行时:运行时之间的性能差异和缺乏一致的开发人员体验在多大程度上是一个问题？

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>