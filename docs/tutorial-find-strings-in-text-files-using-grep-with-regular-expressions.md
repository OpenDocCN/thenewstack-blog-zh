# 教程:使用 Grep 和正则表达式在文本文件中查找字符串

> 原文：<https://thenewstack.io/tutorial-find-strings-in-text-files-using-grep-with-regular-expressions/>

[](https://www.linkedin.com/in/matt-zand-64047871)

 [马特·赞德

马特·赞德是 DC 高中技术服务、网页制作和编码训练营的创始人。他撰写了大量关于网页设计、移动应用程序开发和区块链的高级主题的文章。他是 Touchstone Words 的高级编辑，撰写和评论编码和技术文章。他还是一名居住在华盛顿 DC 的高级讲师和开发人员。](https://www.linkedin.com/in/matt-zand-64047871) [](https://www.linkedin.com/in/matt-zand-64047871)

grep Linux/Unix 命令行实用程序是在文本文件中搜索和查找字符串的最流行的工具之一。“grep”这个名字来源于现在已经过时的 Unix ed 行编辑器工具中的一个命令——这个 ed 命令用于在一个文件中全局搜索*正则表达式*，然后*打印*这些行是 *g/re/p* ，其中 re 是您将使用的正则表达式。最终，grep 命令被编写为在不使用 ed 的情况下对文件进行搜索。

在本文中，我们通过给出 10 个关于 Grep 实现的实例，向您展示如何使用 Grep 和正则表达式来运行高级字符串搜索。本文中讨论的许多例子都有实际意义，意味着您可以在日常的 Linux 编程中使用它们。以下示例描述了一些常用搜索模式的 regexp 示例。

### 在文本文件中查找单个字符

要输出文件“book”中包含“$”字符的行，请键入:

### 在文本文件中查找单个字符串

要输出包含字符串“$14.99”的文件“book”中的行，请键入:

### 在文本文件中查找单个特殊字符

要输出文件“book”中包含“\”字符的行，请键入:

### 匹配以特定文本开头的行

在正则表达式中使用“ˇ”来表示一行的开始。

要输出“/usr/dict/words”中以“pro”开头的所有行，请键入:

```
$  grep  ’ˆpro’  /usr/dict/words

```

要输出文件“book”中以文本“in the beginning”开头的所有行，不考虑大小写，请键入:

```
$  grep  -i  ’ˆin the beginning’  book

```

***注:**这些正则表达式是用字符引用的；这是因为有些 shells 将“ˇ”字符视为特殊的“元字符”。*

除了单词和短语搜索，您还可以使用 grep 搜索称为正则表达式的复杂文本模式。正则表达式——或“regexp”——是一个特殊字符的文本字符串，它指定了一组要匹配的模式。

从技术上讲，单词或短语模式是正则表达式——非常简单。在正则表达式中，大多数字符——包括字母和数字——代表它们自己。例如，正则表达式模式 *1* 匹配字符串“1”，模式*男孩*匹配字符串“男孩”。

有许多称为元字符的保留字符，它们在正则表达式中不表示自己，但是它们有特殊的含义，用于构建复杂的模式。这些元字符如下:*。*、 *** 、*、*、*、*、ˇ、$和 *\* 。值得注意的是，这样的元字符在几乎所有的[通用](https://myhsts.org/tutorial-list-of-all-linux-operating-system-distributions.php)和[特殊](https://coding-bootcamps.com/list-of-all-special-purpose-linux-distributions.html) Linux 发行版中都很常见。这里的是一篇很好的文章，涵盖了元字符的特殊含义，并给出了它们的用法示例。

### 匹配以特定文本结尾的行

使用“$”作为引用文本的最后一个字符，以便仅在行尾匹配该文本。

要输出文件“going”中以感叹号结尾的行，请键入:

### 匹配一定长度的线

要匹配特定长度的行，使用该数字的“.”“ˇ”和“$”之间的字符—例如，要匹配两个字符(或两列)宽的所有行，请使用“ˇ..$ "作为要搜索的正则表达式。

要输出“/usr/dict/words”中正好三个字符宽的所有行，请键入:

```
$  grep  ’ˆ...$’  /usr/dict/words

```

对于较长的行，使用不同的结构更有用:“ˇ。\{number\}$ "，其中 number 是要匹配的行数。使用“，”指定数字范围。

要输出“/usr/dict/words”中正好 12 个字符宽的所有行，请键入:

```
$  grep  ’ˆ.\{12\}$’  /usr/dict/words

```

要输出“/usr/dict/words”中 22 个或更多字符宽的所有行，请键入:

```
$  grep  ’ˆ.\{22,\}$’  /usr/dict/words

```

### 匹配包含任何正则表达式的行

要匹配包含任意多个正则表达式的行，请指定要在交替运算符(" \| ")之间搜索的每个正则表达式作为要搜索的正则表达式。将输出包含任何给定正则表达式的行。

要输出“playboy”中包含“the book”或“cake”模式的所有行，请键入:

```
$  grep  ’the book\|cake’  playboy

```

### 匹配包含所有正则表达式的行

要输出与多个 regexp 中的所有 regexp 匹配的行，请使用 grep 输出包含要匹配的第一个 regexp 的行，并将输出通过管道传输到一个 grep，将第二个 regexp 作为参数。继续将管道添加到 grep 搜索中，以搜索您想要搜索的所有正则表达式。

要输出“playlist”中包含“the shore”和“sky”两种模式的所有行，不考虑大小写，请键入:

```
$  grep  -i  ’the shore’  playlist  |  grep  -i  sky

```

### 匹配只包含特定字符的行

要匹配只包含某些字符的行，请使用 regexp "ˇ[characters]* $ "，其中字符是要匹配的字符。

要输出“/usr/dict/words”中只包含元音的行，请键入:

```
$  grep  -i  ’ˆ[aeiou]*$’  /usr/dict/words

```

“-I”选项匹配字符，不区分大小写；因此，在本例中，所有元音字符都匹配，不考虑大小写。

### 不考虑间距查找短语

搜索单词之间或跨行或分页符出现额外空格的短语的一种方法是从输入中删除所有换行符和额外空格，然后进行 grep。为此，使用“' \r\n:\>\|-'”作为“-d”选项的参数将输入传送到 tr(删除输入中的所有换行符)；使用“-u”选项将它传送到 fmt 过滤器(以均匀的间距输出文本)；并用管道将它与要搜索的模式进行 grep。

要在文件“docs”中跨换行符搜索字符串“同时”，请键入:

```
$  cat docs  |  tr  -d  ’\r\n:\&gt;\|-’  |  fmt  -u  |  grep  ’at the same time as’

```

## **总结**

在本文中，我们回顾了使用 Grep Linux 命令在文本文件中搜索和查找字符串的 10 个实例。在这个过程中，我们学习了如何结合使用正则表达式和 Grep 来对文本文件进行复杂的搜索。到目前为止，您已经对 Linux 搜索功能有多强大有了更好的了解。

对于那些有兴趣学习更多 Linux 编程知识的人，这里有一些额外的资源:

**系统管理员资源**

### **Linux 内核程序员资源**

### **Linux 文件系统字典**

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>