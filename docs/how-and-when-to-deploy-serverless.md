# 如何以及何时部署无服务器

> 原文：<https://thenewstack.io/how-and-when-to-deploy-serverless/>

我们会说:无服务器并不适用于所有的 it 基础设施。随着无服务器变得越来越流行，许多组织出于错误的原因采用了该平台。

“无服务器化”的一个很好的目的是，该平台消除了许多与无服务器管理相关的繁琐任务，因为实际的物理服务器是由第三方维护的。典型的现收现付模式通常由一个[功能即服务(FaaS)平台](https://en.wikipedia.org/wiki/Function_as_a_service)上的短期容器组成，它代表了一个额外的优势——因此消除了冗余的服务器容量，同时增加了灵活价格模式提供的成本节约。

然而，不幸的是，人们很容易认为无服务器可以解决许多部署和资源管理问题，但实际上却不能。

“对于大多数组织来说，无服务器平台仍然相对较新，许多开发人员开始实施解决方案，因为它们具有可扩展性且易于部署。他们后来发现，确保低延迟响应时间非常困难，因为冷启动时间以及为每个请求启动运行时的成本，”[俱乐部](https://clubhouse.io/)工程副总裁[扎克·奥泽尔](https://www.linkedin.com/in/zachary-ozer)说。“优化，如预热脚本和减少包大小可以有所帮助，当缓存是一个选项时，cdn 是非常宝贵的。但是，开发人员在使用无服务器之前应该仔细考虑他们的性能需求，因为标准的 HTTP 服务器可能更适合他们的需求。”

当然，无服务器可以提供如上所述的巨大优势——尤其是如果您没有构建或部署简单的代码或应用程序。对于从事试点项目的开发人员或小型团队来说，没有什么比构建 web 服务应用程序更容易的了。然后，在一个无服务器平台上，用很少的额外代码部署和存储该应用程序，该平台有许多可用的框架来完成这项工作。

有了 FaaS 提供的无服务器框架和其他功能，许多原本与将应用程序和软件部署到服务器相关的任务变得非常简单，[德尔福](https://www.delphix.com/)的首席技术官埃里克·施勒克说。“但在很大程度上，无服务器解决了这个问题，只是把复杂性推到了云的结缔组织或其他连接这些功能的东西上，”施勒克说。例如，谁负责管理这种分布式体系结构中的数据模式转换？这就像《绿野仙踪》中的幕后人物，当你看到幕后时，你会发现它就像胶水一样，你需要把它粘在一起才能让一切正常运转。”

领先的技术公司已经成功地建立了大规模的无服务器、Kubernetes 和微服务平台，并一直在大声宣扬他们的成功。但是对于大多数组织来说，构建大规模的无服务器并不一定代表一个可以遵循的商业案例。

“网飞人、谷歌人和亚马逊人受到的媒体压力不成比例。“但事实是，他们的方法和架构实际上并不适合大多数公司，例如在你的公司内部建立一个应用程序，持续的 CI/CD 无服务器部署和滚动升级，你不一定需要，”施勒克说但是，无论是作为云生态系统中的粘合剂，还是当您部署超出规模的东西，其好处是值得的，无服务器都是有意义的。"

## 了解你需要什么

在成为主流平台之前，无服务器还有很长的路要走。与此同时，在此之前，组织的开发运维通常需要在行业范围内更深入地了解无服务器到底是什么，以及它如何能够或不能帮助他们。

“在这一点上，我认为许多人仍然在做出假设，而不是衡量无服务器如何帮助他们的实际业务需求，”[企业架构副总裁 Jim Scott](https://mapr.com/blog/author/jim-scott/) 对 [MapR](https://mapr.com/) 说。“仍然没有足够多的人这样做或要求这样做，他们有足够坚实的理解，可以说‘是的，这正是我们应该做的。’"

如果无服务器适合一个组织，那么开发人员将会并且应该知道他们实际上在寻找什么，无论他们是否是第一次采用无服务器。“例如，他们应该知道如果做得对，他们就不必担心将代码封装到容器中，”斯科特说。软件和存储会自动部署到容器中，然后集成为更大基础架构的一部分

## 标准云 API 的案例

当无服务器适合组织时，谨慎的做法是避免局限于单一 FaaS 供应商和/或 API，尤其是对于多云部署。

“谈到无服务器，我认为人们希望有一个标准的 API 来使用，这样他们就可以自由移动，就像能够在多个云和内部运行相同的软件一样，”斯科特说。否则，如果他们想在无服务器的两个地方运行相同的业务逻辑，他们将不得不重写它

## 现在领养，以后付钱

[HashiCorp](https://www.hashicorp.com/) 的创始人兼联合首席技术官阿蒙·达德加尔说，开发人员通常是最先从无服务器中直接受益的，但他们在敏捷性方面获得的优势可能会在组织的其他地方付出代价。“通常，这意味着开发人员直接提交容器或函数，而不遵循既定的流程，”Dadgar 说。"虽然最初速度更快，但这可能会在操作上造成混乱."

Dadgar 说，采用无服务器的组织不应该忘记所有的标准最佳实践，包括拥有适当的 CI/CD 管道，对代码进行版本控制，使用基础设施作为代码来定义如何部署应用程序，以及使用适当的秘密管理。Dadgar 说:“否则，开发人员将迅速行动，造成一个混乱，需要由运营和安全团队来清理。”

鉴于生态系统仍处于早期阶段，组织应该考虑如何将无服务器平台整体融入他们的基础设施产品，[Niraj Tolia](https://www.linkedin.com/in/nirajtolia),[Kasten](https://kasten.io/)的联合创始人兼首席执行官说。

托利亚说:“通常部署属于一个系列的平台更有意义。”。此外，组织需要进行仔细的工作负载分析，以防止在成本和复杂性方面出现意外

当然，保持可观察性和监控能力至关重要。

“部署无服务器技术的人通常将他们的思维局限于无服务器功能背后的一小段代码，而将维护和理解这些代码的操作现实作为事后的想法。在生产环境中，尤其是在火灾期间，这可能会给根本原因分析和调试带来很大困难，” [LightStep](https://lightstep.com/) 的联合创始人兼首席执行官 [Ben Sigelman](https://www.linkedin.com/in/bensigelman) 说。通过在无服务器软件中建立可观察性，它可以有一个良好的开端:作为大型分布式应用程序的一个可见的、可维护的部分

## 库伯内特方程

尽管有上述警告，无服务器可以在灵活性和成本节约方面提供潜在的巨大飞跃。但是，无服务器提供的东西不一定与 Kubernetes 或微服务平台兼容，也不一定是后者独有的。首先，Kubernetes 用于编排多个容器，以便部署大型、可扩展和复杂的应用程序， [InfluxData](https://www.influxdata.com/) 的物联网开发者布道者 David Simmons 说。Simmons 说，无服务器适用于为应用程序部署特定的小功能。

“所以，假设你有一个大型复杂的应用程序，可以同时处理成千上万的交互，”西蒙斯说。“您可以将该应用程序的各个部分划分为单独的服务，并将它们分布在一系列容器中，所有这些都由 Kubernetes 进行编排，以便它们可以根据需要进行扩展。”

Simmons 说，但是在单一数据库查找功能的情况下，它可以作为无服务器组件或单一功能来实现，例如在数据库中查找某人的名字。它只在有人直接调用该函数并且没有底层容器运行它时运行。“如果没有人调用那个函数，它就永远不会出现。现在，这个功能可以在一个由 Kubernetes 管理的容器中运行的数据库中查找某人，”Simmons 说。“它们并不相互排斥。”

InfluxData 是新堆栈的赞助商。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>