# 不使用编程循环的 4 个理由(以及避免它们的几种方法)

> 原文：<https://thenewstack.io/4-reasons-not-to-use-programming-loops-and-a-few-ways-to-avoid-them/>

TNS 编辑主任

[Libby Clark](https://thenewstack.io/author/libby/)

促成了这个故事。

据 IT 咨询公司 [Codecentric](https://www.codecentric.de/) 的 [Marco Emrich](https://twitter.com/marcoemrich) 在本月早些时候在波特兰举行的今年 [OSCON 会议上的发言，尽管循环是初级程序员学习的第一个构造之一，但它会给软件开发过程带来许多潜在的问题，并且在许多情况下是可以避免的。](https://conferences.oreilly.com/oscon/oscon-or/public/schedule/detail/75675)

“如果你还在写循环，你不是一个坏人。想想你是否需要写循环，或者是否有更好的选择，”他建议大家。他指出，循环最好在 CPU 级别执行，这远低于大多数开发人员的顾虑。

因此，在开始编写下一个 do/while 循环之前，考虑一下困扰循环作者的潜在问题:

**1:一次性问题:**这里程序员认为他们让一个循环执行了 10 次，而实际上它只执行了 9 次。或者 11。想到“< =”(小于或等于)而不是“<”(等于)。这是一个微妙但经常发生的错误，它导致开发人员通过稍微更改参数来获得正确的答案，从而对他们的代码进行“巫术”，而不是完全理解驱动代码的实际逻辑。

**2:无限循环:**当一个程序被卡住，用户所能做的就是强制关闭应用程序时，可能的罪魁祸首是一个无限循环，一个继续执行，永不退出的循环。像一次性问题一样，这些错误可能很微妙。Emrich 举了一个例子，一个错误的分号放在“while”语句之后，会导致程序永远无法进入循环的退出状态。

**3:状态性:**与最初的认知相反，循环都被束缚在状态中。“循环确实是有状态的。我要说的是，loops 几乎是受政府控制的。这在调试软件时是有问题的，因为你在运行时得到的代码和你在编辑器中看到的并不一样。

**4:隐藏的意图:**在许多情况下，循环构造可能会掩盖它的设计意图，或者至少没有提供它试图做什么的可见证据，导致程序员(或另一个程序员)不得不返回并逆向工程其意图。“我可以把这些时间花在更重要的事情上，”埃姆里奇说。

好的老式迭代的替代方案是什么？

一个是递归。坚持使用快速排序算法，它不是通过循环而是通过重复比较两个数字来对数字进行排序，逐个元素地遍历数组。自然，函数式语言如 [Haskell](https://www.haskell.org/) 擅长递归，但是通用语言如 JavaScript 也提供了函数库。

递归更容易理解，通过一些简单的优化，可以和循环一样快。他警告说，递归只适用于问题的子集，例如复杂的列表操作、多维问题以及基于树和图的算法。

也要注意高阶函数，它们处理你正在试图解决的特定问题，并且也带来了它们自己的词汇，有助于使你写的东西在以后能被别人或你自己理解(例如，使用“过滤器”来获得数组的子集)。

这解决了“隐藏意图”的问题:“所以你的程序开始变得更有意图，”他建议道。Map 函数将对数组的所有元素应用一个特定的函数(比如平方一个数)。Java 8 中首次引入的流 API 提供了这种能力。Emrich 说，使用映射函数“起初看起来有点可怕，因为你需要将列表转换成流，但这并不坏，因为你在开始时就这样做，然后进行尽可能多的转换，最后你将它收集回数组中”。

同样，JavaScript 为[提供了 reduce()方法](https://codeburst.io/learn-understand-javascripts-reduce-function-b2b0406efbdc)来将数组简化为单个值。检查一下你最喜欢的编程语言，看看它提供了哪些库来消除循环的需要。

在演讲结束后的简短交谈中，Emrich 承认他对循环结构的妖魔化是故意挑衅，这是为了提高人们的意识，即循环并不总是需要使用，使用循环也有危险。他告诉我们，他现在希望有人在他开始的时候给他上这些课。

那么什么时候应该使用循环呢？当性能至关重要时，它们可以提供性能优势。即使这样，查看性能瓶颈在哪里也很重要，而且很少是循环本身。

“loops 真的应该死吗？答案是:看情况。这是你在软件开发中得到的唯一答案，”Emrich 说。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>