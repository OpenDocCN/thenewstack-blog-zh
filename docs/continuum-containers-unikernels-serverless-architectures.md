# 从容器到单核和无服务器架构

> 原文：<https://thenewstack.io/continuum-containers-unikernels-serverless-architectures/>

以下节选自我们的电子书《码头和集装箱生态系统》要阅读更多内容，请下载该书

[here](https://thenewstack.io/ebookseries/)

.

在生产中管理 Docker 和容器的复杂性是采用它带来的更大挑战之一。对数百万程序员和管道工来说，问题在于简单。

很明显，容器代表了虚拟机的一个重大进步。但从更普遍的角度来看，这一发展代表了一个连续体，将导致[无服务器架构](https://thenewstack.io/year-ahead-stateless-computing/)和其他更有效的管理复杂性的手段，如[单核技术](https://thenewstack.io/defining-a-unikernel-and-how-it-works/)。

## 建造集装箱化的建筑

Rally Software 有一个容器架构堆栈，工程师 Matt Bajor 在[奇怪循环会议](https://www.youtube.com/watch?v=W9F4pn9Lngc)上使用它来讨论微服务架构的复杂性。

不同的平台有不同的架构。Rally 容器化架构具有动态 DNS 和负载平衡器来管理流量，以及用于服务发现的 etcd。有对象存储、内存存储和关系存储。这些服务与 Kubernetes 或 Mesos 捆绑在一起，并通过配置管理工具(如 Puppet 或 Chef)进行管理。虚拟机管理程序充当划分硬件的分区系统。虚拟机管理程序之上是操作系统，如 CentOS。在此之上是 Docker 运行时，带有共享库和语言运行时。然后我们有了应用程序和应用程序配置。

巴约尔说，这些系统作为一个整体是有效的，但它们相当复杂。在任何给定的时间，事物如何相互作用是很难预测的。有很多升级节奏可以匹配。很大一部分是多余的。隔离发生在管理程序层、用户进程和容器中。这些都是针对单个服务器上的单个应用程序或单个用户的。

## 异构和过度一般化

开发人员隐含地知道许多层，但并不清楚它们是如何工作的。系统在历史上是异构的，并且在很大程度上过于一般化。在新的体系结构中，硬件在很大程度上被商品化了，虚拟机在虚拟机管理程序和虚拟设备驱动程序上工作。

Bajor 指出，Linux 内核和用户是天生的敌人，因为 Linux 内置了相当多的复杂性来保护应用程序免受用户攻击，保护用户免受其他用户攻击，保护应用程序免受其他应用程序攻击。这意味着系统中的大量代码和复杂性。在操作系统上也有许多权限检查。这些检查起源于在大型系统中需要时间共享的时代。有许多应用程序和用户，都在相同的硬件上工作，都在一起互动和工作。

[cyclone slider id = " ebook-1-赞助商-2 "]

巴乔尔说，还有许多效率低下的问题需要管理。系统上有虚拟驱动程序，但也可能有硬盘甚至磁带。有许多存储和 RAM 经常未得到充分利用，并占用了资源。

Linux 内核攻击面大，更容易进入系统。安全补丁是由操作团队完成的，这给编写代码的开发团队带来了不兼容问题。很难跟踪两个团队之间的互动。每个变更集都有不同的形状和大小，会产生问题，比如中断。

从大型机、客户机/服务器时代到现在的分布式系统，技术有了很长的发展。异构环境的集成归结于系统和软件的兼容性。客户一直在寻求效率，因为他们想方设法提高基础架构的成本效益。前 VMware CTO Steve Herrod 在接受采访时表示，销售 VMware 在其鼎盛时期的虚拟化技术变成了帮助客户不再购买另一台服务器的问题。在那个年代，这是一笔容易的买卖，因为客户需要减少而不是增加其数据中心中运行的机器数量。

现在，随着容器的出现，我们看到了使事情变得更简单的真正努力。兼容性很难做到，但由于丰富的工具生态系统，现在更容易做到，这些工具生态系统越来越多地植根于开源。微服务更容易构建。容器更容易部署。现在，市场已经为下一阶段做好了准备，这是建立在效率的前提下，也许最重要的是性能。

## 单核:满足当今的性能需求

Bajor 指出，性能是容器的关键值驱动因素，但是它们确实有相关的复杂性。为了获得更高的性能增益，人们对像单核这样的技术越来越感兴趣，支持者说，单核简化了技术堆栈。

Bajor 指出，单核是独特的专用虚拟机，类似于应用程序堆栈——它们下面有应用程序二进制文件和虚拟硬件。中间是一个库操作系统，它有自己的网络栈。与容器堆栈相比，单核是自包含的，并且具有少得多的层。

单核实现了最少的传统操作系统功能。巴乔尔说，没有许可，也没有隔离。它们所做的仅仅是支持它所支持的应用程序。通过去除传统的操作系统层，单核去除了大量不需要的标准操作系统环境，以及与之相关的攻击服务。单核非常轻，允许在商用硬件上有更高的密度。他们可以运行自己的服务，这些服务在需求出现时诞生，在需求消失时消亡。其中一些瞬态微服务的寿命可能以秒计，甚至不到一秒。它们是即时计算服务，仅在有工作要做时存在，允许您最大限度地利用您的计算基础架构。

单核是新的无服务器架构流行的必然结果。我们从 AWS Lambda 等服务中看到了这一点，亚马逊正在对其进行深度投资。

Lambda 被设计成在云中运行用户生成的函数，而不需要用户担心运行所述函数的任何支持栈。Lambda 是一种无状态的计算机服务，这意味着它运行一个用户定义的函数，从外部服务收集数据，处理数据并将输出传递给另一个服务。代码必须由外部事件触发，例如来自移动应用程序、web 服务或另一个 AWS 服务的来电。亚马逊 S3 桶或 DynamoDB 表的变化也可以触发函数调用。

Lambda 的新颖之处在于，它消除了对任何支持基础设施的担忧。不再仅仅为了运行一个功能而维护 EC2 实例。基础设施问题，如扩展或维护，在抽象中被一笔带过。典型的 Lambda 工作包括图像转换、更改通知和文件压缩——事实上，AWS 有预建的功能来处理这些特定的任务。

## 摘要

总之，随着世界开发新的技术堆栈，这说明了什么？有一组新的应用程序模式和部署。我们已经实现了一定程度的兼容性，接下来的努力是获得更好的性能。容器和 uni kernel 是类似的技术，uni kernel 被描述为“节食中的 Docker 容器”通过将 unikernels 引入 Docker，可以让人们更加熟悉这项技术。

如果您正在构建任务关键型系统，那么单核让开发人员可以明确控制他们应用程序的核心安全领域。开发人员可以在使用 unikernels 时选择输出结果。相比之下，Docker 容器默认启用了运行所需的一切。在 unikernels 中，许多特性在默认情况下是关闭的，这意味着项目团队有更多的初始设置和选择。根据单核支持者的说法，一旦做出了这些选择，结果就是安全的弹性新堆栈，同时还可以根据项目的需要进行定制。

这对容器意味着什么？在一次采访中，Docker 首席技术官 Solomon Hykes 表示，Docker 所做的事情的影响非常广泛。

> “我们的重点是继续支持一个着眼于应用程序整个生命周期的平台，因此我们的重点将是增加越来越多的创新；我们的工作是简化和加速组织的应用程序生命周期之旅。”

但与此同时，真正的赢家将是那些能够提供轻量级系统所带来的速度的组织。他们将如何做到这一点，这将需要一种新的思维，即如何从单片服务器过渡到微服务以及随之而来的一切，因为我们正在沿着连续体走向一个越来越可编程的世界。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>