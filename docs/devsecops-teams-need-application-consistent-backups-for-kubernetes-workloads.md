# DevSecOps 团队需要针对 Kubernetes 工作负载的应用程序一致性备份

> 原文：<https://thenewstack.io/devsecops-teams-need-application-consistent-backups-for-kubernetes-workloads/>

[戴尔科技](https://www.dellemc.com/en-us/index.htm)赞助了这篇文章。

 [尼瓦斯·伊耶

Nivas 是戴尔技术公司的产品经理和战略合作伙伴领导，以提供创新产品而闻名。他热衷于了解客户需求并提供解决方案。凭借卓越的市场洞察力，Nivas 能够提取关键信息，并快速制定精确的产品响应。](https://www.linkedin.com/in/nivasiyer/) 

当您考虑现代应用程序世界中的 DevSecOps 转型时，您需要首先考虑开发人员的观点，当时整个组织的开发都有自己的挑战。在任何时候，您都可以让数百名开发人员参与到一个构建中——并且任何时候一名开发人员签入变更，如果有冲突，就可能会出现问题。从那时起，底层平台就已经成熟，从物理机变成了虚拟机，现在又变成了容器。在这种软件开发范式中，微服务的概念让每个团队都是依赖的；这使他们能够独立开发和部署自己的代码版本。这有效地将他们的工作与组织的其他部分隔离开来。现在开发团队可以使用插件兼容性——通过软件模块或使用标准接口的服务——来合并变更。

把这想象成使用 USB 或 HDMI 电缆插入一个“盒子”，通信的另一端是什么并不重要。这两种连接都需要使用一个通用的工具才能协同工作；这类似于今天需要构建软件的方式。需要不同的应用程序能够协同工作，以满足一个共同的输出或同一种语言。此外，开发人员需要依靠后端层来写入数据库，但是将面向对象的结构映射到关系数据库并不总是一件容易的事情。这就是为什么出现了 NoSQL 数据库，以及更容易在 Kubernetes 集群中部署的新的关系数据库(例如 PostgreSQL 和 DB2)。现在，结果是一个无共享架构，它消除了单点故障，但要求每个开发团队现在在自己的微服务和软件实例化中管理自己的数据服务。

> 以前，IT 运营团队集中管理数据库，但现在每个开发人员和/或开发运维团队都必须这样做，这导致了额外的开销，更不用说后顾之忧了。

*等待和什么？！！！？*迷茫了吗？归根结底，这些软件体系结构为个人开发者提供了灵活性，他们现在可以使用自己选择的编程语言和数据库，这导致了新的和不同的操作挑战。

以前，IT 运营团队集中管理数据库，但现在每个开发人员和/或开发运维团队都必须这样做，这导致了额外的开销，更不用说后顾之忧了。对于 DevSecOps 来说，与保护、备份和恢复同样重要的是备份和提供备份的方式。在这种情况下，对应用程序一致性备份的需求成为终端用户的一项关键优势。通常，崩溃一致性备份有利于虚拟机的时间点恢复。块级备份，但对于 Kubernetes 工作负载来说，尤其不可靠。对于开发人员来说，实现应用程序一致性以满足其各自应用程序和服务的严格恢复点和恢复时间目标至关重要。

让我们更深入地了解一下应用程序一致性。传统上，数据库将数据写入内存，从而产生高性能的写入操作。它们通常还会持续写入日志文件。每当您想要将内存中的数据保存到持久存储层时，您都需要经历一个称为检查点的过程，即您需要检查所有日志，将所有日志提交回磁盘，然后获得数据的一致视图，我们称之为持久数据磁盘中数据的“时间点”版本。之后，会拍摄一个快照，当数据库重新启动时就可以使用了。此外，如果有数据损坏或硬件故障，数据库可以快速重启；这就是所谓的应用程序一致性。

现在介绍库伯内特挑战赛。对于 Kubernetes，挑战在于开发人员有多个数据库和许多选择，如 MySQL、MongoDB、Postgres、Cassandra 等。因此，精明的 UI 架构师需要开发一种无代理机制，这种机制不需要在数据库层进行安装，并且可以是一个简单且可扩展的接口来备份所有这些数据(以及来自任何来源的数据)。

为了实现这一点，可以创建一个模板，每次创建备份时，都会使用该模板创建一个称为前挂钩和后挂钩的东西。pre-hook 正在做的事情与前面描述的完全一样，它基本上是暂停一个数据库，以便不再有写操作。它将内存中的所有数据刷新到磁盘，以便我们获得高效的时间点操作。之后，当您进行备份时，您实际上拍摄了磁盘的快照；现在，当您从那里重新启动数据库时，效率会高得多。

所有这些操作过去都是由 IT 团队完成的，但现在可以由负责管理自己的数据服务的各个团队来管理。这平衡了 IT 运营策略控制和开发人员自助服务的需求。此外，根据 DevSecOps 的最佳实践，这可以作为持续集成和持续交付/部署管道的一部分进行自动化。

通过 Pixabay 的特征图像

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>