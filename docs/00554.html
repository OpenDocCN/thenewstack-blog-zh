<html>
<head>
<title>Distributed Database Performance, Health, and Optimization with NuoDB Insights</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">借助NuoDB Insights实现分布式数据库性能、运行状况和优化</h1>
<blockquote>原文：<a href="https://thenewstack.io/distributed-database-performance-health-and-optimization-with-nuodb-insights/#0001-01-01">https://thenewstack.io/distributed-database-performance-health-and-optimization-with-nuodb-insights/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">作为负责客户成功的高管，我可能对客户如何使用我们的产品以及他们的困难所在有着最深入、最实际的了解。我们一再收到的一个请求是，如何更好地访问系统级和域级指标和数据，以帮助优化NuoDB实现的资源和部署。</p>
<p class="translated">这就是为什么我很兴奋地介绍<a href="https://www.nuodb.com/product/insights" class="ext-link" rel="external "> NuoDB Insights </a>，现在可以在Linux版本的NuoDB 3.01和更高版本中使用。所以，事不宜迟，让我们来谈谈基础知识。</p>
<h2 class="translated">为什么选择NuoDB Insights？</h2>
<a href="https://www.nuodb.com/" class="clearfix infoBlock " target="_blank">

<div class="infoBlockTextBlock">
<p class="infoBlockTitle translated">努奥德布·德克·汉姆斯特拉</p>
<p class="infoBlockText translated">Dirk负责客户的成功，专注于确保数据库部署成功，客户满意度高。德克于2014年加入NuoDB，此前他在微软工作了10年，负责全球100强客户。在此之前，他在成熟和初创公司担任了20多年的销售和服务管理职位，包括IBM、微软、Vitria Technology和IONA Technologies。他在这些公司的主要行业重点是医疗保健和电信公司。</p>
</div>
</a>
<p class="translated">开发NuoDB Insights是为了优化数据库操作和系统配置。借助NuoDB Insights，您可以更好地:</p>
<ul>
<li class="translated">随着时间的推移，评估您的NuoDB配置的运行状况</li>
<li class="translated">确定使用模式并根据需要调整配置</li>
<li class="translated">了解硬件利用率以确保正确的操作环境</li>
</ul>
<p class="translated">为了实现这一目标，NuoDB Insights的设计和构建有两个主要目标:</p>
<ul>
<li class="translated">提供单一、标准化的方式来收集、共享和处理来自NuoDB配置的监控数据</li>
<li class="translated">支持与现有监控框架的集成</li>
</ul>
<p class="translated">通过Insights，数据库管理员(DBA)和运营团队可以获得一个<a href="http://doc.nuodb.com/Latest/Default.htm#About-Domains.htm" class="ext-link" rel="external "> NuoDB域</a>及其物理环境(内存、磁盘、网络)的单一聚合视图，无论他们在哪里运行。一个NuoDB域是一组NuoDB主机的集合，这些主机被配置为协同工作以支持NuoDB进程。NuoDB Insights提供了对系统运行状况、问题识别和解决、容量管理和性能管理的可见性。该工具实现了任务的自动化，例如NuoDB配置的通知和生命周期管理。</p>
<h2 class="translated">NuoDB Insights是做什么的？</h2>
<p class="translated">具体来说，NuoDB Insights从NuoDB数据库和系统环境中收集相关数据，并提供时间序列指标和事件监控数据，以便DBA和运营团队了解和控制NuoDB域。默认情况下，NuoDB Insights是关闭的，必须在开始收集数据之前打开。如何操作的说明可以在<a href="https://www.nuodb.com/product/insights" class="ext-link" rel="external ">这里</a>找到。</p>
<h2 class="translated">NuoDB Insights组件</h2>
<p class="translated">NuoDB Insights由三个逻辑元素组成:收集、共享和行动。作为Insights的基础，NuoDB收集代理(NuoCA)是一个在每个NuoDB节点上运行的进程，用于收集NuoDB及其运行系统上的近实时监控和事件数据。</p>
<div id="attachment_4496569" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496569" decoding="async" loading="lazy" class="wp-image-4496569 size-full" src="../Images/1a0bd37c42286107103fd123409dab18.png" alt="" data-id="4496569" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/704018d6-nuodb1.png"/><p id="caption-attachment-4496569" class="wp-caption-text translated">洞察力逻辑分解</p></div>
<p class="translated">NuoCA使用使用开源监控工具<a href="https://www.zabbix.com/" class="ext-link" rel="external "> Zabbix </a>收集的系统数据来扩充它从NuoDB进程和日志文件中收集的数据。收集的数据包括生命周期事件(进程的开始和停止)、域信息和来自NuoDB的数据(SQListener信息)以获得系统中工作的详细信息。</p>
<p class="translated">NuoCA是一个管道架构，有三个不同的阶段:输入、转换、输出。信息由输入级收集，然后流到转换级，再流到输出级。NuoCA还有一个灵活的插件架构。插件类型有“输入”、“转换”或“输出”Insights插件具有开放的架构，任何人都可以通过添加到GitHub 上的<a href="https://github.com/nuodb/nuoca" class="ext-link" rel="external "> NuoCA项目中，使用额外的转换或集成插件来扩展系统。</a></p>
<p class="translated">NuoCA可以通过不同的通信方式将监测数据发送到不同的目的地。NuoCA输出可以存储在内部或发送到托管服务。支持使用HTTP和https连接的标准通信，但也提供包括<a href="https://www.elastic.co/products/elasticsearch" class="ext-link" rel="external "> Elasticsearch </a>和<a href="https://kafka.apache.org/" class="ext-link" rel="external "> Kafka </a> publisher在内的替代选项。</p>
<p class="translated">通过支持基于标准的通信，NuoCA允许集成现有的监控和管理工具，如<a href="https://www.sumologic.com/" class="ext-link" rel="external "> SUMO Logic </a>、<a href="https://www.ca.com/us/products/ca-application-performance-management.html" class="ext-link" rel="external "> CA应用性能管理</a>或<a href="http://www.solarwinds.com/" class="ext-link" rel="external ">网络安全管理软件产品</a>。这些工具提供了对数据进行分析、可视化和操作的工具。</p>
<p class="translated">此外，数据可以发送到任何时间序列引擎，如ElasticSearch或<a href="https://www.influxdata.com/" class="ext-link" rel="external "> InfluxDB </a>进行进一步的分析和操作。存储后，可以使用许多工具访问数据，例如，生成仪表板、网络图等。NuoDB使用ElasticSearch和Grafana提供免费的托管服务来监控数据。启用Insights时，会提供您在该仪表板上的唯一URL。下图显示了Insights组件的概述。</p>
<div id="attachment_4496563" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496563" decoding="async" loading="lazy" class="size-full wp-image-4496563" src="../Images/0350539d21780611edc535e703a4d575.png" alt="" data-id="4496563" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/6229940b-nuodb2.png"/><p id="caption-attachment-4496563" class="wp-caption-text translated">洞察组件</p></div>
<p class="translated">下面是默认的NuoDB Insights仪表板的概述。下面的例子讨论了系统配置、SQL操作的细节和系统资源。</p>
<h2 class="translated">配置</h2>
<p class="translated">NuoDB Insights提供了按时间映射的正在运行的NuoDB配置的聚合视图。活动配置数据有助于控制云和内部的生命周期管理。数据点可用于评估配置的健康状况，确定使用模式，并根据需要进行调整。</p>
<p class="translated">下图显示了运行两个事务引擎(te)和两个存储管理器(SMs)的NuoDB域的视图；这是一种冗余配置，即使在(例如)SM停止时也将继续运行。当提供位置信息时，您可以看到机器在哪里运行:例如，在您的数据中心和像AWS这样的云环境中。图表底部的线条(2)显示配置在过去七天内没有变化(3)。仪表板允许您在时间线上放大和缩小，以获得一段时间内的总体概述或非常详细的数据。</p>
<div id="attachment_4496558" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496558" decoding="async" loading="lazy" class="size-full wp-image-4496558" src="../Images/ee6d5fe6299d6b62ab599ce4cfbfdad5.png" alt="" data-id="4496558" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/db322d41-nuodb3.png"/><p id="caption-attachment-4496558" class="wp-caption-text translated">配置</p></div>
<h2 class="translated">数据库活动</h2>
<p class="translated">下图更详细地显示了数据库正在进行的工作。该面板显示了所有系统进程的数据库提交数量。此时，只有节点4(一个TE)正在执行工作，每秒处理大约60次提交。</p>
<div id="attachment_4496552" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496552" decoding="async" loading="lazy" class="wp-image-4496552 size-full" src="../Images/c93798e11746223c6eedd3e4355693af.png" alt="" data-id="4496552" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/759bf959-nuodb4.png"/><p id="caption-attachment-4496552" class="wp-caption-text translated">数据库提交速率</p></div>
<p class="translated">下面显示的数据库活动是由93个客户端连接跨两个te生成的。随着时间的推移，与流程的联系一直是稳定的，但有所偏差；一个TE拥有93个连接中的80个。这种配置工作得很好，但是，通常您会在TEs之间寻找一个更平衡的连接分布。</p>
<div id="attachment_4496546" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496546" decoding="async" loading="lazy" class="size-full wp-image-4496546" src="../Images/e72fb544060222202deda8ade35445bb.png" alt="" data-id="4496546" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/564acd01-nuodb5.png"/><p id="caption-attachment-4496546" class="wp-caption-text translated">客户端连接</p></div>
<p class="translated">NuoDB Insights旨在捕获特定于NuoDB的数据，但又足够通用，可以用应用程序提供的数据丰富这些数据，从而获得完整的视图。通过让应用程序将数据写入日志文件，然后配置NuoCA LogStash输入插件以接近实时地从该日志文件中收集数据，可以收集应用程序数据点。</p>
<h2 class="translated">系统</h2>
<p class="translated">NuoDB Insights还有助于了解硬件基础设施组件(如CPU、内存和磁盘)的利用率。收集这些数据点有助于确保解决方案的正确操作环境。收集磁盘容量、内存使用和CPU消耗等关键指标。</p>
<p class="translated">下图显示了特定节点(TE)在25分钟时间间隔内的CPU使用情况。通常，TE的性能受CPU限制。数据显示，TE CPU消耗几乎没有波动，并且有可用的容量来做更多的工作。</p>
<div id="attachment_4496540" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496540" decoding="async" loading="lazy" class="size-full wp-image-4496540" src="../Images/9c10df64a752fdd9995cc9abbd79cf35.png" alt="" data-id="4496540" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/5104b0fc-nuodb6.png"/><p id="caption-attachment-4496540" class="wp-caption-text translated">CPU使用率</p></div>
<p class="translated">下图显示了同一时间范围内同一TE使用的内存。节点的内存使用量变化很小，这提供了另一个数据点，即系统资源的使用在可接受的范围内。</p>
<div id="attachment_4496534" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4496534" decoding="async" loading="lazy" class="size-full wp-image-4496534" src="../Images/624a72cb8d560b1a1f5f8eaf328e5da5.png" alt="" data-id="4496534" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/04/714c82cf-nuodb7.png"/><p id="caption-attachment-4496534" class="wp-caption-text translated">内存使用</p></div>
<p class="translated">查看系统数据点(如CPU消耗和内存使用)补充了来自数据库的警报，有助于评估硬件配置是否支持NuoDB的健康环境。</p>
<h2 class="translated">摘要</h2>
<p class="translated">NuoDB等分布式系统增加了对聚合监控数据的需求，从而使数据库管理员和运营团队能够了解并控制配置。NuoDB Insights提供了一种标准的方法来收集、共享和处理来自NuoDB的监控信息。Insights可以与现有的监控工具集成，并提供一个开放的架构来使用插件添加更多的集成点。本文中讨论的仪表板仅显示了NuoCA收集的一小部分数据，在即将发布的版本中，我们将添加关于数据库活动(TPS、回滚、插入、更新)、系统数据点和通信数据的信息。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>
</div>
</div>    
</body>
</html>