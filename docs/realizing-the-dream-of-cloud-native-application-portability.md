# 实现云原生应用可移植性的梦想

> 原文：<https://thenewstack.io/realizing-the-dream-of-cloud-native-application-portability/>

将一个应用程序从一个地方移动到另一个地方听起来很简单:压缩它，运过去，然后解压缩。这有什么难的？

这种简单化的想法可能已经描述了虚拟机(VM)时代的[应用程序可移植性](https://thenewstack.io/kubernetes-data-portability-and-the-rise-of-portable-stateful-applications/)，当时对整个卷进行映像可以捕获移动应用程序所需的一切。

然而，在云原生世界中，事情并非如此简单。

组织希望从云原生应用程序可移植性中获得什么？为什么这么难？最重要的是，你怎样才能做对呢？

## 我们为什么想要云原生应用程序的可移植性？

想要迁移[云原生](https://thenewstack.io/key-concepts/cloud-native-ecosystem/)应用有几个原因:

*   **热备份**。一个组织可能希望在两个不同的云中运行云原生应用的实时副本，或者可能在内部和云中运行，以便能够在发生故障时快速地将流量从一个云切换到另一个云。
*   **多云负载均衡**。如果一个组织要运行热备份，它可能会在应用程序实例之间划分实时流量。这种方法还避免了“所有鸡蛋放在一个篮子里”的问题，只要应用程序实例运行在单独的云中。
*   **部署到新环境**。在某些情况下，生产部署遵循 GitOps 实践，本质上是在持续、渐进的基础上更新它们。在其他情况下，组织可能希望将整个应用程序作为一个单元从开发转移到试运行，或者从试运行转移到生产(或者转移到其他环境，比如 canary 或 A/B 测试部署)。
*   **因业务原因切换云**。许多组织从一种云转移到另一种云，以节省资金，或者可能是因为与提供商闹翻了。其他人从云迁移到内部部署，因为在某种程度上，内部部署更具成本效益。

## 为什么云原生应用移植这么难？

仔细看看云原生应用意味着什么，许多挑战很快就会出现:

*   **Kubernetes 上运行的应用程序并不是单一的。**它们由短暂的微服务以及配置和数据组成。此外，这些元素可能不会全部驻留在同一个虚拟机上。移动它们就像用叉子移动沙子一样。
*   **微服务一般是无状态的，而 Kubernetes 以抽象的方式处理持久化的数据。**与数据库连接显式的三层应用不同，云原生应用通过抽象连接的操作符来访问持久数据和其他状态信息。了解在特定时间哪些数据与哪个应用程序在一起可能很棘手。
*   **快照通常是短暂的。**创建卷级快照是加速卷级迁移的一种常见且通用的方法。虽然 [Kubernetes](https://thenewstack.io/docker-versus-kubernetes-start-here/) 支持这样的快照，但它们通常是短暂的，因此不能保证应用程序一致的交付。

## 如何实现云原生应用可移植性

幸运的是，来自 Veeam 的 [Kasten 等供应商的现代数据保护解决了上述挑战。卡斯滕是这样做的:](https://www.kasten.io?utm_content=inline-mention)

*   **自动发现和迁移所有 Kubernetes 组件、配置和数据**。与其采用以卷为中心的方法，不如采用以应用程序为中心的方法，这种方法考虑到了 Kubernetes 的分布式和短暂性。
*   **支持跨名称空间、集群、区域、云和 Kubernetes 发行版的可移植性。**理论上，Kubernetes 在一个地点和另一个地点的运行方式是一样的。然而，在实践中，云提供商和 Kubernetes 发行版之间存在许多微妙的差异。提取并解决这些差异至关重要。
*   **大规模强调数据的可移植性。**对于应用一致的云原生可移植性，恢复、克隆和升级数据以及将数据从一个位置迁移到另一个位置至关重要。此外，大规模处理这些错综复杂的问题也很重要。
*   **云原生应用程序可移植性应该是其数据保护专业知识的延伸。**应用程序和数据的备份和恢复是数据保护的核心。因此，可以将计划内的应用程序移动性视为在突然和意外故障后更困难的应用程序恢复问题的特例。

## 智能带

业务连续性是成功实现应用程序可移植性的关键，就像它对于应用程序备份和恢复一样。在某些情况下，在移动应用程序之前关闭它肯定是有意义的。在其他情况下，在迁移完成之前，应用程序不会接收实时流量。

但在更普遍的情况下，组织需要能够在应用程序运行的同时移动应用程序，而活动工作负载当前正在处理事务，底层数据也在不断变化。

在这种情况下，应用程序的可移植性就像在通电的情况下给你的房子重新布线——走错一步，你就死定了。

市场上大多数云原生应用程序可移植性方法本质上都是零技术——在任何东西投入使用之前处理应用程序迁移。

另一方面，Kasten 构建了自己的技术来处理正在运行的应用程序的备份和恢复，这对于跟踪正在进行的事务的状态非常重要。

反过来，这种能力对于大多数云原生应用程序可移植性场景来说也是必不可少的，因为组织希望他们的云原生应用程序始终保持运行，而不仅仅是在一个虚拟机上，而是跨虚拟机和云，根据需要进行扩展和缩减。

换句话说，云原生应用程序的可移植性可以是第 2 天(全面生产)的工作，而没有触电的风险。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>