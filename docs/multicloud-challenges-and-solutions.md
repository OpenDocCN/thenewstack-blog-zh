# 多云挑战和解决方案

> 原文：<https://thenewstack.io/multicloud-challenges-and-solutions/>

[](https://www.linkedin.com/in/shaun-omeara/)

 [肖恩·奥米拉

肖恩·奥米拉是米兰蒂斯公司的现场首席技术官。15 年来，他一直在设计和构建企业 IT 基础设施解决方案。他与客户一起工作，为云之旅提供建议并协助开发云解决方案，这给他提供了学习和尝试各种新技术的广阔空间。](https://www.linkedin.com/in/shaun-omeara/) [](https://www.linkedin.com/in/shaun-omeara/)

在过去十年中，基础架构领域发生了巨大的变化，越来越多的组织将其工作负载分布在多个平台上，包括内部平台和云中平台。这导致我们管理工作负载的方式发生了变化，随之而来的是复杂性和风险的增加。跨多个平台的工作负载分布有许多不同的方式，其中多云和混合云是最常见的。

简单来说，多云就是在两个或更多云基础设施平台上部署应用组件。这些平台可以是两个公共云服务提供商，或者两个私有云，或者它们的某种组合。混合云大致相同，只是它总是指公共云和私有云的组合。

多云和混合云应用程序设计模式可以采取多种形式，但有两种是最重要的:

***托管在不同云上的组件—*** 最常见和最简单的模型包括分离组件(应用层)，以便每个不同的组件部署在单个提供商上，整个应用程序分布在多个云上。例如，应用程序的前端可能位于公共云上，中间件位于私有云上，数据库位于本地裸机集群上。

详细说明:这个例子可能涉及一个流量很大的以前端为中心的 web 应用程序，可能经常更新，它对后端资源进行少量调用。将应用前端安装在公共云上可以快速、动态地扩展该资源以响应流量，并可以简化临时(但资源密集型)程序，如频繁新版本的蓝/绿部署。将中间件放在私有云上可以实现类似的、但更受限的灵活性和更严格的安全性。在裸机上运行数据库提供了最高的可调性和性能，同时为关键和/或受管制的数据提供了最大的保护。

***单个组件，分布在多个云中—*** 我们很少采用单个应用程序组件，并将其分布在多个云中。这种模式的挑战在于，我们现在在单个应用程序组件中引入了延迟等问题以及潜在的其他网络挑战。

例如，随着组织扩大公共云服务的使用规模并寻求成本优化，他们经常会遇到所需资源不可用的情况(例如，区域接近容量，没有所需类型的“现场实例”可用等)。).在这种情况下，像 Kubernetes federation 这样的技术可以用来支持容器工作负载，甚至在原则上，对等微服务可以横向扩展以执行单个应用程序功能，从而在公共云之间“跨越鸿沟”。然而，编写在这种架构上蓬勃发展的微服务和应用程序意味着要预测一系列延迟和其他条件，这些条件在单个基础架构上运行的应用程序通常不会遇到。

## 多云顶

帮助开发人员更轻松地使用来自多个云提供商的资源和服务提供了许多优势，包括以下几点。

1.  *—您希望能够对您的供应商施加一些影响，以便能够协商出尽可能好的价格并确保尽可能好的服务水平。如果你被锁定在一个供应商身上(或者如果存在垄断)，你就失去了这种优势。您很容易受到成本上升和服务水平下降的影响。*
**   ***性价比效率*** —访问多个公共云的能力使您能够持续优化性价比，不仅针对工作负载托管，还针对与服务应用相关的所有其他性能因素和成本(例如网络出口成本、互连性、延迟)。但是，通过在提供商和基础设施之间转移组件和工作负载，最大限度地提高您的成本和性能优化自由度，意味着限制您对您使用的平台和提供商的高度差异化功能和服务的依赖。Kubernetes 和容器可以在这里扮演重要的角色(更多内容见下文)，形成一个跨越多个云和基础设施的一致的底层。*   ***风险缓解*** —扩展上述主题，您需要能够轻松地将鸡蛋转移到另一个篮子。云提供商的定价很复杂，很难观察和预测，而且可能会随时改变。服务可以退役。提供商的政策也可能发生变化——提供商在执行方面可能反复无常，服务协议的条款让客户在发生纠纷时几乎没有追索权。因此，提前计划，提供冗余，并确保关键数据库和其他难以移动的组件不会被特定的提供商锁定，这是非常明智的。*   ***位置*** —公共云提供的一项关键服务是将工作负载和数据放在特定区域的能力。利用位置的能力可以进入利润丰厚的市场，这对于应用程序性能(例如，最大限度地减少延迟)、存储和运输成本以及(在某些情况下)特定服务和规模的可用性至关重要。*   ***法规遵从性选项*** —对工作负载和数据位置(静态数据和动态数据)的控制对于实施辖区策略以实现法规遵从性、数据主权和数据保护也至关重要。对于寻求服务于全球市场的组织来说，遵守司法管辖区和客户要求以及 GDPR、隐私保护和其他法规的能力至关重要。*

 *## 多重云挑战

需要制定策略来确保多云既能带来优势，又不会给开发人员、开发人员和运营团队带来额外的挑战。

1.  一致性至关重要。通过确保跨私有云和公共云的一致的应用平台，您可以帮助确保应用将能够在任何地方运行而无需更改；并且配置、操作自动化、CI/CD 和其他辅助代码库可以在单一通道中维护。Kubernetes 是目前最适合改造公共和私有云基础架构以及裸机的平台，它提供了一系列抽象机制，用于将工作负载与底层基础架构隔离开来，即使底层基础架构出现问题也能保持工作负载的活力，并允许快速、高效、低影响的应用程序更新、扩展和生命周期管理。
2.  但仅有 Kubernetes 是不够的，组织需要在任何基础设施上提供一致的 Kubernetes，作为从一个中心源提供的易于定制、易于扩展、完全可观察、包含电池(但不要过于固执)、安全、普遍兼容且对运营商友好的应用环境。单一集群模式加快了运营速度，实现了容器、配置和自动化的可移植性(见上文)，同时还提高了安全性(消除了未知和变化，从而减少了攻击面)，促进了策略管理并简化了法规遵从性。
3.  使用一个集中管理的系统来交付、更新和管理您的多云中的集群也为大幅度提高生产力打开了大门；用于观察和手动操作的单一平台，全自动和无中断更新，用于构建自助服务应用程序和按需交付集群的单一 API 集(无论您需要它们在哪里)。通过“提供商”中间件(中央命令和控制设施)操纵各种公共云和私有云基础设施，有助于确保您获得特定于平台和公共云的服务的好处，同时还强制执行运行您的应用程序的 Kubernetes 集群的一致配置和行为。
4.  选择的自由与这种模式是一致的。集中管理的多云基础设施应该让您的运营商和开发人员能够自由选择公共云和私有云方案，同时还支持使用一系列操作系统以及一系列自动化、CI/CD、安全和其他工具。
5.  集中式监控和容量管理也很重要，它可以确保您清楚地了解系统的运行情况以及它们消耗的资源，以便您能够就应该在哪里运行应用程序做出明智的决策。
6.  在核心需求列表中，易用性也应该排在前面。如果系统使用起来过于复杂，或者要求开发人员必须学会处理新的或陌生的系统，这将极大地阻碍采用。

## 选择多云你可能会放弃什么

当然，选择多云策略并确保使用一个通用平台来跨多个平台部署和管理一致的 Kubernetes(以及可能在 Kubernetes 之上运行的应用程序)也有一些缺点。其中最主要的是，你可能无法(直接)利用公共(和私有)云提供商提供的所有这些很酷的附加服务，包括他们的“一键 Kubernetes”版本

很难反对便利和无成本/低成本/低摩擦的创业。但并非不可能。请考虑以下情况。

*   个人尝试公共云托管的 Kubernetes 解决方案所需的工作并不代表组织想要大规模交付多个相同类型的开发、测试和生产集群所需的工作。后者的提升要大得多——处理平台的身份和访问管理，用适当的组和用户填充新的集群，管理(和优化成本)快速增长的 Kubernetes 集群群(加上它们相关的网络和辅助服务配置),这些集群可能跨越多个提供商区域。并考虑到所有这些都可能与其他提供商和平台上概念相似但代码不兼容的设置有所不同。提示:在现实世界中，在真实的比例下，这个模型不是多云友好的。只有当您深入购买单一公共或私有云平台时，它才能优雅地工作。
*   根据您选择的集中式部署/更新/操作/观察解决方案，跨多个提供商和平台大规模交付和管理集群的摩擦可以从非常低的水平开始，并且(例如，通过针对解决方案的 API 运行的简单自助服务自动化)几乎为零。您也可以通过这种方式实现“一键式集群”,甚至可以用于生产。
*   同样，根据您选择的集中式解决方案，您应该会从许多核心公共云服务中获得间接好处。这是因为您的解决方案供应商已经设计(并将继续更新)了他们特定于提供商的配置和部署中间件，以便在合理的情况下最佳利用每个公共云提供商的服务组合。不同之处在于，你不需要弄清楚如何使用(和自动化)AWS Route53、Azure DNS、OpenStack Designate 和 VMware 等。围绕 Kubernetes 集群及其入口，在多个平台上建立生产集群。
*   在一个集中的 Kubernetes 体制下，云提供商服务仍然是完全可访问的，并且可以免费使用。您也可以拥有自己的 AWS Lambda 功能和集中式、多云 Kubernetes 管理。

最重要的一点是:低摩擦的进入服务(包括 Kubernetes 提供的服务)似乎让初创企业没有摩擦。但是，在没有集中式解决方案提供的抽象和中介的情况下，您投入的越多，对提供商服务组合挖掘的越深，您就变得越受限制。实现多云意味着在每个提供商的企业范围内重复开始工作(有所不同),并维护您为此创建的工具的所有并行渠道。因此，将你的运营和业务的任何部分从一个提供商“提升和转移”到另一个提供商就成了一个多层面的挑战。

[https://www.youtube.com/embed/tRQjhmAqISY?feature=oembed](https://www.youtube.com/embed/tRQjhmAqISY?feature=oembed)

视频

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>*