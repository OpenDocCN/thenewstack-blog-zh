# 微服务、API 和创新:API 的力量

> 原文：<https://thenewstack.io/microservices-apis-and-innovation-the-power-of-apis/>

[](http://amundsen.com/blog/)

 [Mike Amundsen，API 学院首席 API 架构师

Mike Amundsen 是一位国际知名的作家和演说家，他周游世界，就网络架构、web 开发和其他主题进行咨询和演讲。作为 API 学院的架构总监，他与公司合作，就如何最好地利用 API 给消费者和企业带来的机会提供见解。](http://amundsen.com/blog/) [](http://amundsen.com/blog/)

作为 API 学院的一员，我有机会在世界各地旅行，遇见令人惊奇的人。他们在各种各样的公司里从事奇妙的项目——从新的创业公司到成熟的全球企业。令人难以置信的是，无论我在哪里，无论我在和谁交谈，许多相同的想法、实践和经验都会浮现出来。我经常听到的三个是微服务、API 和创新文化。所有这些都是以推进组织数字化转型的名义进行的。

在本文(三部分系列的第二部分)中，我将分享 API Academy 对这些强大趋势的了解，以及公司正在使用的一些技术，以使数字化转型不仅仅是一个流行词。在[上一篇文章](https://thenewstack.io/microservices-apis-and-innovation-empowering-digital-transformation-at-speed/)中，我重点介绍了微服务的重要性以及您现在可以做的三件事:1)采用连续交付，2)支持工程化部署，以及 3)减少在制品队列以加快上市时间。这三个关键习惯可以帮助您的组织利用微服务的力量。

在这篇后续文章中，我将分享世界各地的公司告诉我们的 API 在增强团队能力和帮助组织快速为包括浏览器、移动和桌面在内的广泛分发渠道制定及时、稳定和经济高效的解决方案方面可以发挥的作用。我将提供三种常见的做法，我们发现其他公司正在使用它们来推动他们的数字化转型之旅。

## API 支持多渠道交付

许多公司正在使用微服务，以可扩展和可靠的方式封装组织内的关键功能。微服务代表了贵公司 IT 的重要功能元素。但这只是故事的一部分。您还需要能够以一种易于解决当前业务挑战的方式公开这些功能。这就是 API 的用武之地。

API——应用程序编程接口——是公司信息系统用户界面的机器等价物。API 通常用于将各种功能混合到一个一致且可访问的解决方案中。例如，您的组织可能有处理客户、帐户和销售活动的服务。每个都经过精心设计、编码、测试并发布到您公司的基础架构中；提供对您的业务至关重要的功能。然后，有一天你需要创建一个新的客户入职解决方案——一个可以在各种设备和平台上工作的解决方案。现在是使用 API 的时候了。

> “我们知道设计 API 是一项非常重要的任务，因为我们只有一次机会把它做好。”—亚马逊首席技术官沃纳·威格尔

单一的、面向解决方案的 API(例如，客户入职 API)可以被设计为呈现对成功的入职流程至关重要的重要交互和工作流。一种可行的方法是 API，它可以将客户、帐户和销售活动的各种功能元素混合到一个安全、可扩展和强大的用户体验中，供公司内的广泛受众使用，例如通过浏览器的销售人员、通过桌面应用程序的办公室管理员以及通过手持和平板设备的潜在客户。

您可以将 API 视为将事物结合在一起的“粘合剂”——内部服务和外部服务消费者之间的中介。API 是一种分发关键功能的方式，供负责在各种硬件平台上创建重要用户参与体验的服务消费者使用。这些消费者可能是您办公室的其他团队、远程位置的同事、关键业务合作伙伴，甚至是第三方、前端和设计团队。

## 设计思维和 API

大多数公司都知道花时间为他们的应用程序设计用户界面是很重要的。他们知道好的设计可以取悦用户，提高品牌忠诚度，并推动新的业务。同时，糟糕的界面设计会惹恼顾客，损害品牌，减少收入和机会。API 设计也是如此。

设计糟糕的 API 会让你的开发人员很难理解它们，可能会在系统中引入错误，并且可能会在错误修复和基础设施修改中增加不必要的成本。但是设计良好的 API 可以让员工更有效地工作，减少构建稳定解决方案所需的时间，甚至鼓励团队创造新的、创新的解决方案来帮助客户和同事。API 设计如此重要，以至于亚马逊网络服务的首席技术官沃纳·威格尔说:“我们知道设计 API 是一项非常重要的任务，因为我们只有一次机会去做好它。”

正是 API 的力量为您的数字生态系统带来了合作伙伴，并推动了您自己的内部转型。在擅长利用 API 的公司中，花时间“把事情做好”并进行长期构建是一个重要的实践。

## 关键 API 设计建议

获得正确的 API 非常重要，原因有很多。一旦你发布了一个 API，就不可能收回。当客户和关键业务单元依赖于您的 API 时，更改它可能会破坏系统的其他部分，撤销重要的功能，并破坏时间和金钱上的关键投资。在实现您的 API 程序时，还有其他重要的事情要记住。这里只是几个。

## 没有规范的 API

试图为整个公司做一个“预先”规范的 API 设计是错误的。仅仅尝试企业范围的数据和对象模型——尝试创建一个单一的 API 模型来考虑组织现在和未来的所有方面——是不太可能成功的。相反，为所有开发人员提供指导方针和约束，防止他们犯错误，同时允许他们应用自己的创造力和领域知识来构建令其他团队成员和合作伙伴高兴的 API。

## 简化实施流程

由于 API 只是接口，而不是实际的功能，你应该能够在几天或几周内设计、实现、测试和部署 API，而不是几个月。我们已经看到公司专注于降低创建 API 的风险，使其易于早期测试，并提供一个降低组装 API 的成本和风险的发布自动化过程。

## 关注互操作性，而不是集成

我们看到成功公司做的另一个关键因素是教导团队专注于在设计本身中建立互操作性。这些组织提供 API 指南，使得 API 不仅易于理解，而且易于与其他公司的 API“混合”。以广泛的互操作性为目标比在狭窄、紧密的集成中进行设计要好。

## 你今天可以做的三件事

像任何重要的改变一样，这种工作需要时间。但是你不必等很久就能体验成功。以下是我们在许多公司看到的三件事，你可以从今天开始在你的组织内做。

## 采用 API 设计实践

API 程序取得长期成功的一个关键因素是采用与技术无关的设计实践。技术趋势来来去去，但是你的 API 将会存在很长时间。确保不要在编程、平台或库的最新潮流上构建整个 API 程序。最好的方法是依靠“API 优先”的范例。

“API 优先”意味着在担心实现细节之前设计好 API。无论您是使用 SOAP、CRUD、REST、gRPC、GraphQL 还是任何其他流行的技术将业务流程实现为 API，业务流程本质上都是相同的。事实上，一个构造良好的设计程序很可能会产生一个可以在多个技术堆栈上实现的界面指南，从而帮助您的团队实现跨平台和连续几代技术转变的成本节约和设计一致性。

## 启用低风险 API 创建

一旦你有了一个设计良好的 API，是时候把它变成现实了。为此，我们建议采用我们所谓的草图、原型和构建模式。

API 草图就像它们听起来一样。小而粗糙的“图纸”,以查看 API 对开发人员的“观感”。您应该能够在几个小时内，而不是几天内构建一个 API 草图。它应该产生一个设计，你可以向关键的利益相关者或队友展示，以几乎零成本征求一轮反馈和修改。我喜欢用 Apiary 的 API 蓝图来做这个。它依靠简单的 markdown 语言在几分钟内模拟出一个工作的 API 服务器。具体的工具并不重要，但实践至关重要。草图是您在开发生产就绪的 API 之前进行廉价探索的方式。

对于原型开发，我们看到一些公司使用 Swagger/OpenAPI 这样的工具。原型是你最终产品的更详细的再现。但是它们缺少关键的功能。它们就像电影布景。如果你不仔细看，它们看起来就像真的一样！你的团队应该能在几天内完成一个详细的原型。这个原型应该能够连接到测试工具、虚拟化服务和其他平台元素，让您看到它将如何在您的系统中交互。原型是用来测试的。在花费时间和金钱构建实际的生产就绪 API 之前，它们是您的最后一道防线。

这就离开了构建阶段。这是你制定工作计划、设定截止日期并努力实现原型的地方。您已经使用了草图和原型阶段来制定细节、暴露缺陷等。构建过程也不应该非常令人兴奋。只需要每天上班，完成 API 设计，定期发布直到工作完成。我们交谈过的许多公司都致力于在不到 90 天内完成 API 构建。

## 支持 API 治理的三大支柱

最后，超越设计和实现任何单个 API 的工作，拥有健康的 API 程序的组织也有与开发团队共享的通用实现治理指南。可靠的指导使得企业级的监督成为可能，而不需要对实现细节施加控制。

我在 API Academy 的同事 Erik Wilde 称之为“管理您的 API 环境”的一个关键习惯是为您的 API 程序的三个关键元素(协议、格式和词汇)制定企业级指导。

协议指南意味着在设计新版本时，为 API 团队需要支持的应用程序级协议建立明确的指示。大多数公司表示，所有新的 API 都必须支持 HTTP。有些还增加了对 MQTT、Thrift 和其他二进制协议的可选支持。这里的关键是提前告诉所有团队，“如果你想确保你的 API 将来的互操作性，你需要使用这些协议。”您也可以使用本系列上一篇文章中描述的连续交付管道来实施这个准则。

格式指导意味着识别用于在服务之间发送数据的消息格式。正如所有的浏览器都期待 HTML 格式的响应一样，您的 API 也需要既定的格式，以便在您的生态系统中进行互操作。虽然大多数公司选择简单的格式，如 JSON、XML 或 CSV，但这些消息模型缺少关键的元数据信息，如对象名、链接和输入表单，而这些信息是确保长期互操作所必需的。相反，我们看到一些公司为基于 HTTP 的 API 采用了像 HAL、Siren 和 Collection+JSON 这样的高级格式。对于服务之间的二进制交互，我们看到组织在 protobuf 和类似格式上标准化。无论您选择什么格式，使用您的构建管道来验证它们是很重要的，以确保只有符合治理的 API 被发布到产品中。

API 治理的第三个支柱是词汇表。这是对服务之间发送的消息中的数据点名称和操作标识符的控制。维护词汇表是组织确保发布到产品中的新服务已经被现有服务理解的方法。就像来自领域驱动设计的 Eric Evans 的“无处不在的语言”一样，您使用的词汇表代表了每个人“谈论”您的关键业务操作的方式。将一个仅仅“制造”新的数据字段名称和动作标识符的服务发布到产品中应该是很困难的。相反，构建管道的元素应该测试消息是否符合公司范围的词汇表，并防止不符合词汇表的 API 进入生产环境。

采用 API 优先设计、草图-原型-构建的习惯，以及 API 治理的三大支柱可以帮助您和您的团队利用 API 的力量，而不会导致风险增加或运行时稳定性降低。

## 但是这一切怎么能帮助我创新呢？

为团队提供核心 API 指南的能力可以刺激 IT 部门所有级别的创新。但是仅仅提供技术指导是不够的。在本系列的下一篇文章中，我将回顾我们在组织内部看到的一些重要的模式和实践，这些模式和实践使得利用您在公司内部已经拥有的技能和创造力成为可能。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>