# 耶格大战齐普金:开源追踪工具之战

> 原文：<https://thenewstack.io/jaeger-vs-zipkin-battle-of-the-open-source-tracing-tools/>

[](https://www.linkedin.com/in/serkanozal/)

 [塞尔坎·奥扎尔

塞尔坎是桑德拉的联合创始人兼首席技术官。他在软件开发方面有 10 多年的专业经验，是 AWS 认证专家，拥有分布式环境专利。他主要从事无服务器架构、分布式系统和监控工具方面的工作。](https://www.linkedin.com/in/serkanozal/) [](https://www.linkedin.com/in/serkanozal/)

通常，一个革命性想法的标志是，起初，它似乎是完全愚蠢的。以 Twitter 为例:这项服务在 2006 年推出时，大多数人很难看到它的潜力。更糟糕的是，Twitter 不仅怪异，而且不可靠。Twitter 是手机一代的杀手级应用，但它的后端系统无法应对它的突然流行和大规模采用。当时，大多数后端软件都是作为一个单一的应用程序编写的；这些系统不仅脆弱，而且难以扩展和维护。

为了创建更具弹性和可伸缩性的系统，在线服务采用了分解为微服务的分布式架构。像许多革命性的想法一样，这既解决了现有的问题，也产生了许多新的问题..具体来说，在高度分散的环境中运行的微服务更难监控和调试。

在本文中，我们将考察两个工具， [Zipkin](https://zipkin.io/) 和 [Jaeger](https://www.jaegertracing.io/) ，它们旨在使分布式计算和基于微服务的架构更易于监控和管理。我们将看看这些工具提供了什么，它们的优点和缺点，并且我们将对您为什么应该选择其中一个提出建议。

## 可观察性:一个勇敢的新世界

在我们看这些工具之前，让我们更深入地看看这个问题及其解决方案背后的哲学。单片应用程序就像一辆旧车:一旦它开始发出奇怪的噪音或感觉有什么不对劲，我们大多数人都能找出问题所在。如果我们有足够的经验，我们就潜到引擎盖下解决它。但是分布式系统更像一辆现代汽车:它会告诉你有什么地方出了问题，但是它不会告诉你如何在没有专门工具或知识的情况下修复它。

微服务使您能够构建具有高水平冗余的分散系统，同时提供高水平的可伸缩性和可靠性。然而，它们的小尺寸、互连特性和高冗余性使得系统问题更难定位、调试和修复。此外，现有的监控和记录软件是为单片应用程序开发的。

分布式架构，就像你现在的汽车，是黑匣子。两者都可以通过工程师所谓的[可观察性](https://thenewstack.io/observability-a-3-year-retrospective/)来监控，这让你通过收集和观察其输入和输出来推断被观察系统的内部状态。例如，当你仪表板上的警示灯熄灭时，你的机械师会将它连接到一台读取相关输入和输出数据的计算机上。

在虚拟世界中，利用 [OpenTracing](https://opentracing.io/) 、 [OpenCensus](https://opencensus.io/) 和 [OpenTelemetry](https://opentelemetry.io/) 等平台，分布式追踪被用来使系统可观察。这些平台允许您跟踪和记录从起点到目的地的请求，以及请求通过的系统。一旦有了解决方案，你就需要像 Zipkin 和 Jaeger 这样的工具来管理和处理收集到的数据。

## 背景和特点

正如最好的家庭一样，齐普金和耶格之间的竞争源于他们共同的历史。早于耶格的 Zipkin 是谷歌 Dapper 的开源版本，由 Twitter 进一步开发。Zipkin 的核心是一个基于 Java 的应用程序，它提供了许多服务。每个服务都实现了 Zipkin 的特性集，并包括一个用户界面和跟踪框架的接口。每项服务还提供了一系列存储引擎来保存记录的数据，如内存数据库、MySQL、Cassandra 和 Elasticsearch。

此外，Zipkin 还提供了传输机制——如 RabbitMQ、Scribe、HTTP 和 Kafka——以及用于在 Cassandra 中存储数据的基于节点的服务器。即使 Zipkin 目前不能满足您的需求，但它确实为大多数流行的高级语言提供了库——包括 C#、Java 和 JavaScript。

耶格是优步创造的，是用围棋写的。它和它的哥哥姐姐相似，但也不同。除了 Zipkin 的功能集，Jaeger 还提供了动态采样、REST API、基于 ReactJS 的 UI，以及对 Cassandra 和 Elasticsearch 内存数据存储的支持。为了实现这些功能，Jaeger 采用了一种与 Zipkin 不同的、更加分布式的方法。

Jaeger 的架构包括一个向代理发出跟踪的客户端，代理监听入站范围并将它们路由到收集器。然后，收集器会验证、转换和保存跨度。Jaeger 的分布式架构使其具有高度的可扩展性。Jaeger 还有一种独特的收集数据的方式:与其他试图收集生成的每一个痕迹和跨度的系统不同，Jaeger 对监控数据进行动态的代表性采样。这种方法不仅可以处理流量的突然增加，还可以提高 Jaeger 的整体性能。

## 比较和对比

让我们从积极的方面开始。Zipkin 更老，是更成熟的平台。它拥有广泛的行业支持和一个庞大而活跃的社区。Zipkin 是用 Java 编写的，这使得它非常适合企业环境。但是，它也支持大多数流行的高级语言，如果你不知道或者不喜欢 Java，这是很好的。无论你选择哪种语言，Zipkin 都支持三大开放追踪框架 [OpenTracing](https://opentracing.io/) 、 [OpenCensus](https://opencensus.io/) 和 [OpenTelemetry](https://opentelemetry.io/) ，并拥有广泛的可扩展性选项和工具集成。

Jaeger 与它的哥哥大体相似，但也有自己的一些独特之处。首先，它有更现代的设计和建筑。它的更加分布式的方法是高度灵活和高性能的。Jaeger 为您提供了一个基于 web 的(React) UI，您可以轻松地部署和扩展它。

Jaeger 社区通过提供良好的文档和一系列部署选项来弥补 Jaeger 相对不成熟的缺陷。Jaeger 还有[云原生计算基础支持(CNCF)](https://www.cncf.io/announcements/2019/10/31/cloud-native-computing-foundation-announces-jaeger-graduation/)；虽然这更多的是一个建议而不是标准，但它应该被考虑。

让我们把注意力转向每个工具的消极方面。因为 Zipkin 是两者中较老的一个，它较老的设计使用了一个较不模块化和更集中的架构——这使得它比它较新的竞争对手更慢和更不灵活。虽然这种差异对于较小的系统来说可能无关紧要，但是当您的系统开始增长或需要快速扩展时，这可能会成为一个问题。Zipkin 的模块化程度较低，缺乏新方法的灵活性，这可能会影响其整体性能。

Zipkin 的核心组件是用 Java 编写的，这对于任何重视稳定性多于性能的组织来说都是非常好的。因此，如果您的系统停机或断电，您将丢失所有记录的数据。Zipkin 为大型语言提供了许多库，但是没有对流行语言如 Python、Ruby 和 PHP 的官方支持。

Jaeger 可能更新，但这不一定意味着它更好。事实上，许多人——尤其是在企业 IT 部门——会将 Jaeger 的相对不成熟视为一种劣势。耶格选择 [Go](https://www.infoworld.com/article/3198928/whats-the-go-language-really-good-for.html) 作为其主要语言就说明了这一点。Go 是作为一种系统语言编写的，但它远不如 Java 受欢迎；这意味着你可能需要学习一门新的语言，而不是使用你熟悉的语言。

对耶格来说，另一个既是福也是祸的领域是它更现代的建筑。这种体系结构在性能、可靠性和可伸缩性方面提供了优势，但是它也更加复杂和难以维护。Jaeger 也和 Zipkin 一样存在短暂的内存存储问题，而且它的 API 缺乏对 Zipkin 的支持。

## 齐普金和耶格:哪个更适合你？

在给出我们的建议之前，让我们总结一下 Zipkin 和 Jaeger 提供了什么以及它们的优缺点。在选择其中之一时，您还应该考虑您的组织的结构、监控需求以及内部的技术专长。此外，您应该决定您的组织和团队是喜欢更新的还是更成熟的技术。

这两种工具都是收集和管理分布式跟踪数据的好选择。他们都非常相似，势均力敌，会做的工作；它们都支持分布式追踪库、OpenCensus、OpenTracing 和 OpenTelemetry。此外，Zipkin 和 Jaeger 具有广泛的可扩展性选项和工具集成，并且都支持虚拟化和容器化。这两种工具都依赖于内存存储，并且面临类似的数据丢失问题。

对于那些不想活在流血边缘的人来说，Zipkin 是更好的选择。它更成熟，有更大更成熟的社区。Zipkin 拥有广泛的行业支持，它的 Java 根基使它适合企业 it 领域(Java 仍然统治着这个领域)。

Jaeger 在成熟度方面的不足，在速度和灵活性以及更新、更分散的并行架构方面得到了弥补。它还具有更高的性能，更易于扩展。Jaeger 比它的老对手有更好的官方语言支持，你也可以把它对 CNCF 的支持看作是一种认可。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>