# 为什么便携性是提高工作效率和安全性的关键

> 原文：<https://thenewstack.io/why-portability-is-key-to-better-productivity-and-security/>

[](https://www.linkedin.com/in/torin-sandall-1967387/)

 [托林·桑德尔

托林是开放政策代理(OPA)项目的联合创始人。作为一名软件工程师，Torin 已经在大型分布式系统项目上工作了 10 多年。Torin 经常在 KubeCon、DockerCon、Velocity 等活动上发言。](https://www.linkedin.com/in/torin-sandall-1967387/) [](https://www.linkedin.com/in/torin-sandall-1967387/)

最不受欢迎的事情:中断和返工是最糟糕的。现代开发管道是专门为使协作更容易而构建的，并允许个人和团队一起工作，为定期的代码推送做出贡献。这当然意味着大量的发明、反馈、创造力和迭代，当它们成为当前关注的焦点时，所有这些都会发挥最佳作用。因为个人或团队不得不返回并基于配置错误或合规性问题做出更改而中断创造新想法的过程是令人沮丧的。也很慢。不好。

好消息是什么？在管道中的多个位置实现自动化策略检查可以将检查向左移动，加快反馈周期，并显著减少上下文切换。为了证明这一点，我们来一点前后对比。

## **没有自动策略代码检查**

周一，我花了一整天思考并编写了一个很酷的新客户特性，特性 A，并在完成后将其签入 Git。

星期二，我花了一天时间写了一个不同的特性，特性 B，它与特性 a 无关。当我完成时，我将它签入 Git。我参加了一些会议，我正在进行下一个任务，特性 c。

周三，我完成了周二开始的任务，特性 C，并将其签入 Git。我开始开发另一个特性，特性 D，却在中午收到了关于特性 A 的一些配置错误反馈。现在，我不得不停止开发特性 D，转而专注于我周一想到的关于特性 a 的任何事情。我正在和 UI 团队开会，我们真的取得了一些进展，但现在我被打断了。我将我的大脑功能排队，以解决需要的变化。从签入 A 到发现 A 存在一些合规性问题之间的时间不仅干扰了我的工作，还伤害了团队，因为我现在正在参加一个协作会议。

## **带** **自动化策略代码检查**

如果我能实时收到反馈会怎么样？或者至少，当我还在思考我所贡献的代码的时候？我的一周会看起来很不一样:

周一，我花了一整天时间为一个很酷的新客户特性——特性 A 编写代码，并在完成后将其签入 Git。我立即得到了策略检查的结果，它告诉我，我错误地配置了一个工作负载以 root 用户身份运行，我错误地命名了它，并且我指定了一个我不需要的入口。哎呀。

我进行更改并重新提交。然后，我开始关注特性 B，相信在本周晚些时候，我不会再因为特性 A 的合规性问题而被打断。

每次检查也是如此:我在还在思考工作的时候就得到反馈，而不是几个小时或几天之后。我更有效率，更少沮丧，更能把精力集中在重要的事情上。

更重要的是，同样的政策可以反馈给我的平台团队。稍后在 CI/CD 中，当需要推进构建时，需要执行完全相同的合规性检查，以确保只有安全的代码才能进入我们的应用程序。我不需要被打扰，但 DevOps 团队可以看到，在所有开发该应用程序的团队中，所有代码都经过检查，是安全的，并且符合我们的内部和外部法规。这证明事情正在按计划进行。(我有没有提到在这一点上我不需要被打扰？)

相同的检查可以在不同的阶段、不同的时间执行，并针对不同的受众(开发人员、开发运维人员、合规人员、云团队等)提供结果。，所有这些都具有完全相同的策略自动化，这得益于策略的可移植性。

## **跨团队提高生产力和安全性**

可移植性对政策来说很重要，因为它能提高生产率*和*更好的安全性。

例如，团队可以采用一个通常在管道中稍后应用的策略，并在编写代码时应用它(左移)。开发人员可以更早地获得反馈，更快地解决问题。运营团队需要看到这些早期检查的结果，然后可能需要在准入控制时间再次检查，以满足法规遵从性要求。然后，系统/云团队可能需要在另一个地方(例如 Terraform 运行时)查看检查，以确保在向客户推出软件更新之前没有错误。

相同的政策意图必须在多个点上实施，但是将该政策重写四次并在四个不同的地方实施是一个灾难。当团队重新输入策略时，它不仅浪费时间并导致错误，还意味着持续的管理麻烦，因为任何小的更新都需要在许多地方进行和检查。相反，在多个地方对相同的代码实现相同的检查，消除了返工和风险，同时实现了最大限度地减少开发人员中断的目标。

## **通过开放策略代理使策略可移植**

更高的工作效率、更好的安全性、更好的合规性—这真的可能吗？是的，伴随着一些关键技术的选择:

1.  **工装需要迎头赶上。**为非技术用户设计的慢速点击式用户界面无法实现快速反馈周期。工具需要无缝地适应开发人员的工作流程，这不仅意味着策略，还意味着[策略即代码](https://blog.styra.com/blog/what-is-unified-policy-as-code-and-why-do-you-need-it)，与所有其他代码一样对待。
2.  **基本政策需要可移植。**您需要能够在您以前从未想过的地方，例如在开发人员笔记本电脑上的 IDE 中，获取并执行策略。同样，集中式的、基于 UI 的工具不适合这种情况。
3.  文化必须适应。一旦有了可移植性,“左移”就变得容易多了，因为在 K8s 集群上运行——或者出于扫描目的离线运行，或者在 CI/CD 管道内运行，或者在开发人员的笔记本电脑上运行——都变成了同样的问题。但是，当然，所有不同的团队需要就合规性检查的工作以及他们负责的部分达成一致。这不可能是一个“将一切都推给开发人员”的问题，而是一个共同的责任，有多个检查点来确保所有团队朝着一个共同的和充分理解的目标一起工作。

这种可移植性是在现实世界中实现[开放策略代理(OPA)](https://blog.styra.com/blog/what-is-open-policy-agent) 的关键部分。OPA 允许您以相同的方式编写策略代码，无论您决定将检查放在哪里，无论是 K8s 准入控制、同行评审时间还是在开发人员的笔记本电脑上。安全性或合规性解决方案也能提高开发人员的工作效率，这种情况并不常见，但在这种情况下，OPA 确实可以最大限度地减少中断/返工，并防止导致风险的错误。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>