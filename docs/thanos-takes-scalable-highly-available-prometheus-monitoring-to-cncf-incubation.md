# 灭霸将可扩展、高可用的普罗米修斯监控引入 CNCF 孵化项目

> 原文：<https://thenewstack.io/thanos-takes-scalable-highly-available-prometheus-monitoring-to-cncf-incubation/>

开源的[灭霸](http://thanos.io)项目，为基于[普罗米修斯](https://prometheus.io/)的监控集中、扩展并提供长期存储和高可用性，已经进入[云本地计算基金会](https://www.cncf.io) (CNCF)的孵化阶段。

Prometheus 是用于监控 Kubernetes 应用程序的核心开源项目之一，也是一个毕业于 CNCF 的项目，它是在容器编排工具成为今天这样家喻户晓的云工具之前很久构建的。虽然 Prometheus 做得很好，但它并没有考虑到云原生应用程序所必需的可扩展性和数据存储需求，因此像灭霸[和 CNCF 的另一个项目 Cortex](http://thanos.io)这样的工具被创造出来。

随着向孵化的转移，灭霸略微领先于 Cortex，Cortex 在灭霸之前不久加入了 CNCF 沙盒，但在你过于投入赛马叙事之前，灭霸的合著者 [Bartek Plotka](https://uk.linkedin.com/in/bwplotka) 解释说，这里没有真正的竞争，更多的是维护者、贡献者和方法的混合。事实上，普罗特卡不仅是灭霸的维护者，也是普罗米修斯，并为皮质做出贡献，对许多参与者来说也是如此。

普洛特卡说，这两个项目的真正区别在于一些最初的设计方法，Cortex 使用基于推的系统，而灭霸是基于拉的。灭霸也依赖于对象存储，Plotka 指出这非常便宜，而 Cortex 使用 NoSQL 和对象存储。最后一个最初的区别是，灭霸使用时间序列数据库格式，而 Cortex 使用定制的索引时间序列数据库。

[https://www.youtube.com/embed/2oTLouUvsac?feature=oembed](https://www.youtube.com/embed/2oTLouUvsac?feature=oembed)

视频

普罗特卡说，他在多人游戏初创公司[工作期间与人合著了《灭霸》,在尝试使用 Cortex 后，他遇到了一些问题。](https://improbable.io)

“我们 3 年前开始使用 Cortex，然而，部署模型和复杂性并不是我们在 Cortex 最开始时所寻求的。我们一直在寻找更适合普罗米修斯的东西，它可能使用相同的存储格式，更便宜的存储，也可能是更简单的部署模式，”普罗特卡说。“我们希望有一个全球查询联盟，而不是立即将指标和流式指标推送到一些长期存储群集，这样您就可以在许多群集、许多 Prometheus 服务上进行查询，就像在 Prometheus 的单个实例上一样。”

法比安·雷纳茨当时是 CoreOS 的员工，也是普罗米修斯的维护者，他们两人与法比安·雷纳茨一起工作，创建了灭霸，为扩展普罗米修斯提供了一个皮质替代方案。Plotka 说，核心区别在于灭霸可以非常容易地安装，只需一个 Prometheus 实例以及一个侧柜和一个微服务，就可以提供“具有 Prometheus 高可用性功能和全球联盟视图的全功能灭霸”

普罗特卡说，灭霸从 2017 年底开始，到 2018 年初就有了一个工作版本，并迅速受到欢迎，因为它很容易使用和安装，还因为对象存储很便宜，“足够快”，所有云提供商都可以使用，甚至可以使用开源项目在裸机上运行。到第二年，灭霸已经有了来自各大知名公司的采纳者和贡献者，包括阿里巴巴、红帽、腾讯、Adobe、易贝等等。

回到今天的灭霸，普罗特卡再次强调了各种项目维护者的混合，指出灭霸团队从 Cortex 那里学到了更高性能和更稳定，而 Cortex 从灭霸那里学到了如何更容易使用和更便宜。

“在某个时候，我们也开始使用彼此的代码，所以这是一个非常有趣的方向，这些项目可能会在某个时候更加紧密地结合在一起，”普罗特卡说。

在当前版本中，灭霸提供了各种功能，包括:

*   跨所有连接的 Prometheus 服务器的全局查询视图
*   对从 Prometheus HA 对收集的指标进行重复数据删除和合并
*   与现有的普罗米修斯装置无缝集成
*   任何对象存储作为其唯一的、可选的依赖项
*   对历史数据进行缩减采样以实现大规模查询加速
*   跨集群联盟
*   容错查询路由
*   简单的 gRPC“商店 API ”,用于跨所有指标数据的统一数据访问
*   定制指标提供者的简单集成点

展望灭霸路线图，一些关键的新增内容包括删除数据(由于像 [GDPR](https://gdpr-info.eu/) 这样的事情而变得必要)和增加一个新的负责查询规划和查询缓存的微服务。在第二次添加时，普罗特卡指出，微服务实际上是灭霸正在与 Cortex 合作并共享的一项服务。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>