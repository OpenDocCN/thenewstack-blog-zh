# IBM i 应用程序现代化的逐步指南

> 原文：<https://thenewstack.io/a-step-by-step-guide-to-modernizing-ibm-i-applications/>

[](https://www.linkedin.com/in/matthewromero2021/)

 [马修·罗梅罗

马修·罗梅罗是 Skytap 的技术产品宣传员，这是一种在公共云中本地运行 IBM Power 和 x86 工作负载的云服务。Matthew 在支持和创建云技术(尤其是 Microsoft Azure)的技术内容方面拥有丰富的专业知识。他在 3Sharp 和 Indigo Slate 工作了九年，负责管理企业 IT 服务和构建技术演示，在此之前，他在微软服务器和工具业务部门担任了四年的项目和实验室经理。](https://www.linkedin.com/in/matthewromero2021/) [](https://www.linkedin.com/in/matthewromero2021/)

在 IBM i 系列大型机上运行的许多应用程序都是已经运行了几十年的业务关键型系统，比如航班预订系统。

这些应用程序不仅非常复杂(并且通常随着时间的推移进行了大量的定制)，而且经常无法关闭，哪怕是短暂的关闭。

当组织决定将它们迁移到云时，无论是为了实现现代化还是为了提高安全性、灾难恢复、可扩展性、灵活性等。—初始迁移通常必须在不停机的情况下完成。

出于这个原因，许多组织甚至不愿意尝试迁移这些应用，这是可以理解的，但有时 IT 无法控制的情况(如昂贵的硬件更新或服务提供商停止对 Power platform 的支持)会迫使他们采取行动。

在不停机的情况下将这些类型的工作负载迁移到云中极具挑战性，但并非不可能。

下面是一种方法，基于我和我的团队最近参与的一个客户部署。

这次迁移的目标是将本地 IBM i 工作负载实时迁移到 Azure，并且不停机。这是使用 Azure Data Box 物理存储设备、Commvault 的备份和恢复系统以及 Mimix 的 IBM i 高可用性(HA)和灾难恢复(DR)工具完成的。下面是这些工具在整个迁移中的作用。

## **大文件批量上传**

拥有许多 TB 数据的客户需要一种方法来高效地将这些数据转移到云中。

在我们最近的项目中，我的团队使用 Azure Data Box 物理存储设备进行大型 IBM i 逻辑分区的初始批量数据导入(术语“LPAR”在 IBM Power Systems 中使用，类似于虚拟机)。

对于大于 40TB 的数据集，这种方法有助于避免用户网络连接过载。Azure 将盒子运送给用户，用户将盒子与他们的数据一起加载，然后将其发送回 Azure，以便上传到相关的 Azure 数据中心。

## **简化恢复流程**

在文件的批量上传完成之后，团队将需要迁移较小的 LPARs，并恢复在初始上传过程中不可避免会丢失的任何文件。

Commvault 备份和灾难恢复技术非常适合 IBM i 应用程序。我的团队使用 Commvault 创建了源 LPARs 的 IBM i ISO 可引导映像，该映像被备份到 Azure Data Box。

这种方法简化了将数据恢复到 Azure 的过程，并对数据集进行重复数据删除和压缩，从而减少了整体传输时间。Commvault 还可以通过直接连接将较小的 LPARs 迁移到 Azure 中。这是初始批量上传中未包含的任何内容的备份选项。

## **最终同步和灾难恢复**

为了在不停机的情况下从旧的本地工作负载切换到云中的新工作负载，团队需要一个系统来实时同步两者之间的任何最终更改。

在新工作负载投入使用之前为其设置灾难恢复是一种很好的做法，以防止任何不可预见的问题。在我们最近的部署中，我的团队将 Mimix 用于这两个功能。

一旦数据完全融入到云中，Mimix 就用于在转换之前同步任何最终更改。我们还在云中的生产前工作负载和位于不同 Azure 区域的灾难恢复工作负载之间建立了一个 Mimix 复制关系。直到完全基于云的灾难恢复就绪后，才执行最终转换。

下面是使用这三项技术的迁移过程的详细步骤列表。

### **铺垫**

1.验证现有网络，并在本地的源 LPARs 和云中的着陆区之间建立连接。在我们最近的部署中，我们使用了支持全局到达的 ExpressRoute 和可传递路由。通过快速专用网络连接使用 FTP 也是一种可行的选择。

2.在云中建立着陆区。在这种情况下，IBM i 应用程序被提升并转移到云中而不进行重构，必须使用一些在云中重新创建 IBM POWER 环境的解决方案。具体选项和细节因所选的云提供商而异。

3.设置 Commvault，包括内部 iSeries 环境中的 Commvault 媒体代理服务器(Linux)、Commvault Commserve 服务器(Windows)和云中登录区旁边的 Commvault 媒体代理服务器。

4.在 Azure 门户中配置和订购 Azure 数据框。请注意，必须提前配置 Azure Blob 存储帐户。一旦数据盒发货，就不能更改。完成这些后，将箱子运送到用户数据中心的物理地址。

### **为迁移准备源数据**

5.将数据盒子配置到用户的网络，并在 NFS 到达后启用它。媒体代理服务器将与 IBM i 对话，并从数据盒子上的 NFS 位置挂载 NFS 共享。

6.获取源生产 LPARs 的一个快速副本。这允许将闪存拷贝置于完全受限状态，以减少任何过度的生产负载，并降低在文件传输过程中丢失任何正在备份的锁定文件的风险。

7.在快速副本上安装 IBM i Commvault 代理。这允许快速复制 LPARs 直接与 Commvault IBM i 媒体代理服务器对话。

8.启动 Commvault 备份过程，该过程将在 Data Box 存储库中创建经过重复数据消除和压缩的备份。这减少了需要存储和上传的数据量。

### **移入云端**

9.将 Azure 数据箱运送到 Azure。当它到达时，Databox 将自动加载到步骤 4 中创建的 Azure Blob 存储容器中。这又将 IBM i 备份数据加载到 Blob 存储容器中。数据已经传到云端了！

10.使用 Commvault 将 IBM i 备份数据恢复到云登录区。

11.在本地(源)生产 LPAR 和云中的生产前目标 LPAR 之间配置 Mimix 复制。

### **在云端建立灾难恢复并执行割接**

12.如果在切换之前需要为云工作负载启动并运行基于云的灾难恢复，那么克隆正在运行的生产前 IBM i 实例，并将它们复制到目标灾难恢复站点。在 Azure 中，这可以通过 Azure 主干完成。然后使用 Mimix 在运行的生产前 LPAR 和新的 DR LPARs 之间建立一个新的 DR sync 关系。

13.一旦基于云的灾难恢复以及源 LPAR 和预生产 LPAR 之间的 Mimix 关系处于稳定状态，就可以从本地源 LPAR 切换到云中预生产的 IBM I 实例。这些是新的生产工作负载。

14.庆祝向云的成功过渡！

这种方法不仅实现了零停机和灾难恢复冗余的迁移，还允许以高效的方式将大量数据迁移到云中。许多在数据中心使用较旧的 IBM Power 硬件的客户在迁移到云时也能立即获得性能提升。

我们的许多客户发现这个过程比他们预期的更顺利，有些人甚至说他们希望他们能更快完成。虽然这种类型的迁移是一项复杂的任务，不应该掉以轻心，但云提供商和第三方供应商的最新进展使得它没有许多 it 团队和首席信息官想象的那么可怕。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>