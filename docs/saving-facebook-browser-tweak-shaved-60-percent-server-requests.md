# 重装上阵:脸书如何调整浏览器以减少 60%的服务器请求

> 原文：<https://thenewstack.io/saving-facebook-browser-tweak-shaved-60-percent-server-requests/>

脸书公布了谷歌 Chrome 和火狐浏览器的工作细节，以显著改善网页加载时间。据脸书称，由于这一共同努力，两家公司取得了以下成果:

*   Chrome 和 Firefox 中的新特性使它们的缓存效率显著提高。
*   脸书能够将对其服务器的静态资源请求减少 60 %,让这些服务器有更多的 CPU 空间来加载网页的其余部分。
*   尤其是 Chrome 对重新加载按钮行为的改进，从 63%的请求有条件变为 24%。

今天，脸书代码网站将会有一篇博文[详细介绍它与谷歌和火狐共同完成的工作，以显著改善他们的网络程序——修改过时的、长期存在的网络行为，减少服务器流量并提高整体效率。](https://code.facebook.com/posts/557147474482256)

这一合作带来了新的功能，使脸书能够将对其服务器的静态资源请求减少 60%，并使 Chrome 和 Firefox 的浏览器缓存大大提高了效率。Chrome 本身能够将浏览器的条件重载请求比例提高 39%。

![](img/a567e01d535f4826aa7a755044e011bc.png)

无偿脸书猫照片。

更快的加载时间和减少的服务器流量，伟大的东西！但是对于我们这些在战壕中工作的 web 开发者来说，这在现实生活中意味着什么呢？当然，除了能够更快地看到脸书发布的搞笑猫咪视频之外。

三家互联网巨头之间的这种特殊合作最有趣的结果并不是精简的代码，尽管它带来的效率提高确实很显著。相反，真正的价值在于它是如何发生的:退一步批判性地评估长期存在的网络行为。

我们所有人都认为事情必须如此，因为事情一直都是这样。这些共同的假设为我们开发新的 web 应用程序和改进现有应用程序提供了参数。在匆忙启动下一个项目和修复所有到处都在坏掉的东西时，很难将资源投入到看起来像向后看而不是向前看的事情上。

然而，这次合作的结果是一个令人印象深刻的例子，说明停下来问一个关于实际上没有损坏的东西的问题可以产生非常值得的性能改进。

具体来说，脸书的工程师们非常想知道为什么 63%的 Chrome 静态资源重新验证请求会返回“ [304 Not Modified](https://httpstatuses.com/304) ”的响应，而 Firefox 的条件请求率是 14%(Safari 和 Internet Explorer 的性能水平类似)。由于静态资源很少改变，所以被称为静态资源，304 响应表明了完全不必要的重新验证、请求和返回链，这不必要地浪费了资源。

所以当务之急是“为什么，Chrome，为什么？？?"

脸书的工程师们追踪到了 Chrome 中的一行代码，该代码询问浏览器为什么可能想要重新验证资源——例如当页面从 POST 请求加载时。这对于用户需要最新信息的邮件或企业网站很有意义。然而，许多网站(咳咳脸书咳咳)使用 [POST](https://loadfocus.com/blog/2014/02/27/what-is-http-post-request/) 请求登录，这意味着 Chrome 每次都忽略其缓存并下载整个 enchilada。

脸书和 Chrome 团队一起工作，确定这种行为(a)是 Chrome 独有的，(b)是不必要的。通过对其代码基础进行一些不太大的改动，Chrome 的条件请求率从 63%骤降至 24%。

然而，该团队并没有就此止步。他们认为对于所有浏览器来说，这个过程仍有改进的空间，他们是对的。阅读脸书的博客(以及一篇相关的[谷歌博客](https://blog.chromium.org/2017/01/reload-reloaded-faster-and-leaner-page_26.html))了解具体细节，但简而言之，它涉及到认真审视网页设计的一个由来已久的特性:重新加载按钮。

https://youtu.be/FhgcPjM16TE

目前，这些性能改进适用于所有开发者和所有网站，没有任何其他变化。这很好。但是对于任何地方的工作的 web 开发人员来说，从这个声明中得到的最终收获是花时间停下来嗅嗅浏览器。

很有可能，我们的集体习惯和对网络行为的想当然的假设隐藏了一些非常美味的低挂果实——也就是说，简单的改变可能会带来巨大的改进。整个故事提醒我们，技术每天都在向前发展，但重要的是也要看看我们从哪里来，看看我们是否带着不必要的行李走向未来。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>