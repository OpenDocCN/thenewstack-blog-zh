# åº“ä¼¯å†…ç‰¹ RBAC çš„ 3 ç§ç°å®æ–¹æ³•

> åŸæ–‡ï¼š<https://thenewstack.io/three-realistic-approaches-to-kubernetes-rbac/>

[](https://www.linkedin.com/in/catherine-ting-cai/)

 [çŒ«è”¡

çŒ«è”¡ç°ä»»åšè§ˆä¼šå¹³å°å·¥ç¨‹æ€»ç›‘ã€‚å½“ä¸ç¼–ç æ—¶ï¼Œä½ å¯ä»¥æ‰¾åˆ°å¥¹å†™çš„å…³äºç¼–ç æˆ–ä¸¾é‡çš„æ–‡ç« ã€‚](https://www.linkedin.com/in/catherine-ting-cai/) [](https://www.linkedin.com/in/catherine-ting-cai/)

Kubernetes ä¸ŠåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)ç†è®ºä¸Šçœ‹èµ·æ¥å®Œå…¨åˆç†ã€‚æ˜¾è€Œæ˜“è§:ç»„ç»‡å½“ç„¶å¸Œæœ›å¯¹é›†ç¾¤å®æ–½ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºè®¿é—®ç­–ç•¥ã€‚Kubernetes å®˜æ–¹æ–‡æ¡£[æä¾›äº†å¾ˆå¤šå…³äº RBAC API å¯¹è±¡å¦‚ä½•å·¥ä½œçš„æŒ‡å¯¼](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)ï¼Œä½†æ˜¯å¾ˆå°‘æœ‰å…³äºå¦‚ä½•ä¸ºç»„ç»‡ä»¥åŠŸèƒ½æ–¹å¼éƒ¨ç½²å®ƒçš„æœ€ä½³å®è·µã€‚å¼€å‘äººå‘˜åœ¨â€œ [Kubernetes æœ€ä½³å®è·µ](https://lmgtfy.com/?q=kubernetes+best+practices)â€ä¸Šå°è¯•äº†çœŸæ­£çš„ Google-fu æ–¹æ³•ï¼Œç»“æœå‘ç°åŒæ ·çš„ä¿¡æ¯ç¼ºä¹è¢«åŒ…è£¹åœ¨å®‰å…¨å’’è¯­çš„åˆ—è¡¨ä¸­(èŒè´£åˆ†ç¦»ç­‰ç­‰)ã€‚)

ä»¥ä¸€ç§é€‚åˆä½ å…¬å¸è§„æ¨¡çš„æ–¹å¼ç®¡ç† RBAC ä»¤äººå›°æƒ‘å’Œä¸çŸ¥æ‰€æªã€‚åœ¨åŠ é€Ÿå®æ–½æ”¿ç­–ä¹‹å‰ï¼Œæœ‰å¿…è¦å¼„æ¸…æ¥š RBAC å®é™…ä¸Šåœ¨è¯•å›¾è§£å†³ä»€ä¹ˆé—®é¢˜ã€‚

æ‚¨é€šå¸¸ä¼šå‘ç°ï¼Œå®ç° RBACï¼Œå°±åƒæ‰€æœ‰çš„å®‰å…¨é—®é¢˜ä¸€æ ·ï¼Œæ˜¯é™åˆ¶è®¿é—®å’Œæ“ä½œç®€ä¾¿æ€§ä¹‹é—´çš„ä¸€åœºè··è··æ¿æ¸¸æˆã€‚

è¿˜æœ‰æœ€ä½ç‰¹æƒåŸåˆ™ï¼Œè¿™æ˜¯ä½ çš„å®‰å…¨å›¢é˜Ÿä¸€ç›´å›°æ‰°ä½ çš„é—®é¢˜ã€‚ä½†è¿™å®é™…ä¸Šæ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿè¿è¡Œåœ¨ä¸­çš„åº”ç”¨ç¨‹åºå’Œè®¿é—®é›†ç¾¤çš„å¼€å‘äººå‘˜åº”è¯¥åªèƒ½è®¿é—®ä»–ä»¬éœ€è¦çš„èµ„æºã€‚ä½ çš„åº”ç”¨ç¨‹åºåº”è¯¥åªèƒ½è¯»å–å®ƒä»¬è‡ªå·±çš„[æœºå¯†](https://kubernetes.io/docs/concepts/configuration/secret/)å’Œ[é…ç½®å›¾](https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/)ã€‚å¾ˆç®€å•ã€‚ä½ çš„å¼€å‘äººå‘˜æœ‰ç‚¹éš¾ææ¸…æ¥šï¼Œå› ä¸ºæœ‰è®¸å¤šå¼€å‘äººå‘˜çš„è§’è‰²ï¼Œä»–ä»¬å¾ˆå®¹æ˜“éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ã€‚ä¾‹å¦‚ï¼Œç§»åŠ¨å¼€å‘äººå‘˜å¯èƒ½åªéœ€è¦å¯¹ Kubernetes é›†ç¾¤çš„åªè¯»è®¿é—®æƒé™ï¼Œè€Œä¸»è¦å¹³å°å¼€å‘äººå‘˜åˆ™éœ€è¦ç®¡ç†å‘˜è®¿é—®æƒé™ã€‚å¦ä¸€æ–¹é¢ï¼Œæ‚¨è¯•å›¾å¹³è¡¡æ“ä½œç®€ä¾¿æ€§ã€‚ä½œä¸ºé›†ç¾¤ç®¡ç†å‘˜ï¼Œæ‚¨å¸Œæœ›èƒ½å¤Ÿå¿«é€Ÿæˆäºˆæ–°ç”¨æˆ·ä¸€ä¸ªè§’è‰²ï¼Œè®©ä»–ä»¬æ‹¥æœ‰æ‰€éœ€çš„æ‰€æœ‰è®¿é—®æƒé™(è€Œä¸æ˜¯æˆäºˆä¸ªäººç‰¹æƒçš„ç–¯ç‹‚è¡Œä¸º)ã€‚è¿™ä½¿å¾—å®¡è®¡æ›´å®¹æ˜“ï¼Œå› ä¸ºæ‚¨å°†é€šè¿‡ä»–ä»¬æ‰€æ‹¥æœ‰çš„è§’è‰²ç¡®åˆ‡åœ°çŸ¥é“è°å¯ä»¥è®¿é—®ä»€ä¹ˆèµ„æºã€‚æ‚¨è¿˜å¸Œæœ›èƒ½å¤Ÿè¯¦ç»†è¯´æ˜éšç€æ—¶é—´çš„æ¨ç§»ä¸ä¼šæˆä¸ºå·¨å¤§çš„è¿è¥éš¾é¢˜çš„è§’è‰²ã€‚

æˆ‘å·²ç»é˜æ˜äº†ä¸‰ç§ç°å®çš„æ–¹æ³•å»äº†è§£åº“ä¼¯å†…ç‰¹Â·RBACã€‚æˆ‘çŸ¥é“è¿™äº›ï¼Œå› ä¸ºæˆ‘åšè¿‡

## æ–¹æ³• 1â€“é¢å‘æ‰€æœ‰äººçš„é›†ç¾¤ç®¡ç†

![](img/0ab9c6d091647233fe740a4c7f965b17.png)

å¦‚æœä½ ä»ä»¥å‰åšé›†ç¾¤ç®¡ç†çš„æ—¶å€™å°±å¼€å§‹åš Kubernetes äº†ã€‚

å¦‚æœä½ æ˜¯ä¸€å®¶ç¼ºä¹å·¥ç¨‹èµ„æºçš„å°å‹åˆ›ä¸šå…¬å¸ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯ç°çŠ¶ã€‚ä¸šåŠ¡é€Ÿåº¦å¾€å¾€èƒœè¿‡å®‰å…¨æ€§ï¼Œè¿™æ²¡ä»€ä¹ˆã€‚çŸ¥é“ä½ çš„é£é™©æ˜¯ä»€ä¹ˆæ˜¯å€¼å¾—çš„ã€‚

### é˜¿æ‹‰ä¼¯å›½å®¶åŒºåŸŸå±€å·²å®æ–½:âœ…

**æœ€ä½ç‰¹æƒåŸåˆ™:**ğŸ™ˆä½ åˆšåˆšåšäº†ä½ çš„å®‰å…¨å·¥ç¨‹å¸ˆæœ€å¯æ€•çš„å™©æ¢¦ã€‚æ¯ä¸ªå¼€å‘äººå‘˜éƒ½å¯ä»¥è®¿é—®ä¸€åˆ‡(æ˜¯çš„ï¼Œæ‚¨ç»„ç»‡çš„å›½å®¶æœºå¯†ï¼)æ‚¨çš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿé’ˆå¯¹ Kubernetes é›†ç¾¤è¿è¡Œ API å‘½ä»¤ã€‚å¦‚æœåº”ç”¨ç¨‹åºå—åˆ°å±å®³ï¼Œé‚£ä¹ˆåœ¨è¿™ç§å®ç°ä¸‹ï¼Œå¯ä»¥å®‰å…¨åœ°å‡è®¾ä¸€åˆ‡éƒ½å—åˆ°å±å®³ã€‚

**æ“ä½œç®€ä¾¿:**ğŸ¤·ğŸ»â€â™€ï¸:è¿™ä¸ªå®ç°å¾ˆå®¹æ˜“ï¼Œå› ä¸ºä½ çš„å¼€å‘äººå‘˜è¦ä¹ˆå¯ä»¥è®¿é—®é›†ç¾¤ä¸­çš„æ‰€æœ‰ä¸œè¥¿ï¼Œè¦ä¹ˆæ ¹æœ¬ä¸èƒ½è®¿é—®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéšç€ä½ çš„æˆé•¿ï¼Œä½ ä¼šæ‹›è‡´ç»„ç»‡é£é™©å’Œéº»çƒ¦ã€‚æ‚¨çš„å¼€å‘äººå‘˜å¯èƒ½ä¼šæ— æ„ä¸­åˆ é™¤æ‚¨çš„é…ç½®æ˜ å°„å’Œæœºå¯†ã€‚å“å‘€ã€‚

**ç»“è®º:**å®ƒç¡®å®å®Œæˆäº†ä»»åŠ¡ã€‚å¯¹äºä¿¡ä»»åº¦é«˜ã€æ—¶é—´å°‘ã€èµ„æºå°‘çš„å°å‹åˆåˆ›å…¬å¸æ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯å®Œå…¨å»ºç«‹(æˆ–éœ€è¦)æ›´ä¸¥æ ¼çš„ RBAC æ”¿ç­–çš„ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚å¯¹äºé‚£äº›å·¥ç¨‹äººå‘˜è¶…è¿‡ 30 äººçš„å…¬å¸æ¥è¯´ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸å¤ªå¥½ã€‚

## # 2â€“RBAC å©´å„¿å°é˜¶

åœ¨æ‚¨çš„ç»„ç»‡å‘ç”Ÿäº†ç¬¬ n èµ·å› å¶ç„¶å‡»é”®è€Œå¯¼è‡´æ‰€æœ‰é›†ç¾¤é…ç½®å’Œ/æˆ–æœºå¯†è¢«åˆ é™¤è€Œéœ€è¦æ‰‹åŠ¨å¹²é¢„çš„äº‹ä»¶åï¼Œæ‚¨å¯èƒ½å·²ç»è¶…è¶Šäº† CAFA è§£å†³æ–¹æ¡ˆã€‚åœ¨è¿™äº›äº‹ä»¶å’Œæ„¤æ€’çš„å®‰å…¨å›¢é˜Ÿå’„å’„é€¼äººçš„å‚¬ä¿ƒä¹‹é—´ï¼Œæ‚¨è¢«è¿«ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºå’Œç”¨æˆ·åˆ’åˆ†å‡º RBAC è§’è‰²ã€‚è¿™çœ‹èµ·æ¥åƒä»€ä¹ˆï¼Ÿ

ä½ æ‰€æœ‰çš„**åº”ç”¨**éƒ½åº”è¯¥æœ‰ä¸€ä¸ªæœåŠ¡è´¦æˆ·ï¼Œè€Œä¸ä»…ä»…æ˜¯é»˜è®¤è´¦æˆ·ã€‚

```
<em># Specify a service account name for your application</em>
apiVersion:  v1
kind:  ServiceAccount
metadata:
name:  data-engineering-app
namespace:  data-engineering
â€”
apiVersion:  apps/v1
kind:  Deployment
metadata:
name:  data-engineering-app
namespace:  data-engineering
spec:
replicas:  2
template:
metadata:
labels:
app:  data-engineering-app
spec:
<em># Reference the service account in your deployment</em>
serviceAccountName:  data-engineering-app
containers:
â€“  name:  data-engineering-app
image:  nginx:latest
ports:
â€“  containerPort:  80
env:
â€“  name:  AWS_REGION
value:  â€œus-west-2â€
â€“  name:  WHATS_THIS_EVEN_NEED_CONFIGS_FOR
valueFrom:
configMapKeyRef:
name:  data-engineering-app
key:  totally.real.configs
resources:
requests:
cpu:  10m
memory:  40Mi
limits:
cpu:  10m
memory:  40Mi

```

ç„¶åï¼Œæ‚¨å°†æŒ‡å®šä¸€ä¸ªè§’è‰²å’Œä¸€ä¸ªç›¸åº”çš„ RoleBindingï¼Œä»¥ç¡®ä¿æ‚¨çš„æœåŠ¡å¸æˆ·åªèƒ½è®¿é—®å®ƒéœ€è¦çš„ K8s API èµ„æºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¤ºä¾‹åº”ç”¨ç¨‹åºåªéœ€è¦è¯»å–è‡ªå·±çš„é…ç½®ã€‚

```
<em># Create a role that allows the deployment to read configs</em>
apiVersion:  rbac.authorization.k8s.io/v1
kind:  Role
metadata:
<em># Remember that roles are scoped to a namespace</em>
namespace:  data-engineering
name:  umbrella:data-engineering-app
rules:
â€“  apiGroups:  [â€œâ€]
resources:  [â€œconfigmapsâ€]
resourceNames:Â   [â€œdata-engineering-app-configmapâ€]
verbs:  [â€œgetâ€]
â€”
<em># Create a rolebinding to bind the role to the service account</em>
apiVersion:  rbac.authorization.k8s.io/v1beta1
kind:  RoleBinding
metadata:
name:  umbrella:data-engineering-app
roleRef:
apiGroup:  rbac.authorization.k8s.io
kind:  Role
name:  umbrella:data-engineering-app
subjects:
â€“  kind:  ServiceAccount
name:  data-engineering-app
namespace:  data-engineering

```

åœ¨**ç”¨æˆ·**ä¾§å®æ–½ RBAC åœ¨æ¦‚å¿µä¸Šæ˜¯ç±»ä¼¼çš„ã€‚æ‚¨å¯ä»¥ä¸ºå•ä¸ªç”¨æˆ·åˆ›å»º RoleBindingsï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯æ¨èçš„æ–¹æ³•ï¼Œå› ä¸ºè¿™æ ·åšæœ‰å¾ˆé«˜çš„æ“ä½œå‘˜ç²¾ç¥é”™ä¹±çš„é£é™©ã€‚

å¯¹äº sane RBAC æ¥è¯´ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯åˆ›å»ºç”¨æˆ·æ˜ å°„åˆ°çš„å†…å®¹ï¼›è¿™ç§æ˜ å°„æ˜¯å¦‚ä½•å®Œæˆçš„å–å†³äºé›†ç¾¤çš„[éªŒè¯å™¨](https://kubernetes.io/docs/reference/access-authn-authz/authentication/%23authentication-strategies)(ä¾‹å¦‚ï¼ŒEKS çš„ aws-iam-authenticator ä½¿ç”¨ mapRoles å°†è§’è‰² ARN æ˜ å°„åˆ°ä¸€ç»„ç»„)ã€‚

ç»„å’Œä»–ä»¬å¯ä»¥è®¿é—®çš„ API æœ€ç»ˆæ˜¯æ ¹æ®ç»„ç»‡çš„éœ€æ±‚æ¥ç¡®å®šçš„ï¼Œä½†æ˜¯ä¸€èˆ¬çš„è¯»è€…(å¯¹äºåˆšåˆšç†Ÿæ‚‰äº‹ç‰©çš„æ–°å·¥ç¨‹å¸ˆæ¥è¯´)ã€ä½œè€…(å¯¹äºæ‚¨çš„å·¥ç¨‹å¸ˆæ¥è¯´)å’Œç®¡ç†å‘˜(å¯¹äºæ‚¨æ¥è¯´)è§’è‰²æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ã€‚(å“ï¼Œå¯¹æ‰€æœ‰äººæ¥è¯´éƒ½æ¯” admin å¼ºã€‚)

```
â€”
<em># An example reader ClusterRole â€“ ClusterRole so youâ€™re not worried about namespaces at this time. Remember, weâ€™re talking generic reader/writer/admin roles.</em>
apiVersion:  rbac.authorization.k8s.io/v1
kind:  ClusterRole
metadata:
name:  reader
rules:
â€“  apiGroups:  [â€œ*â€]
resources:
â€“  deployments
â€“  configmaps
â€“  pods
â€“  secrets
â€“  services
verbs:
â€“  get
â€“  list
â€“  watch
â€”
<em># An example reader ClusterRoleBinding that gives read permissions to</em>
<em># the engineering and operations groups</em>
apiVersion:  rbac.authorization.k8s.io/v1beta1
kind:  ClusterRoleBinding
metadata:
name:  reader-binding
roleRef:
apiGroup:  rbac.authorization.k8s.io
kind:  ClusterRole
name:  reader
subjects:
â€“  kind:  Group
name:  umbrella:engineering
â€“  kind:  Group
name:  umbrella:operations
â€”
<em># An example writer ClusterRole</em>
apiVersion:  rbac.authorization.k8s.io/v1
kind:  ClusterRole
metadata:
name:  writer
rules:
â€“  apiGroups:  [â€œ*â€]
resources:
â€“  deployments
â€“  configmaps
â€“  pods
â€“  secrets
â€“  services
verbs:
â€“  create
â€“  delete
â€“  patch
â€“  update
â€”
<em># An example writer ClusterRoleBinding that gives write permissions to</em>
<em># the operations group</em>
apiVersion:  rbac.authorization.k8s.io/v1beta1
kind:  ClusterRoleBinding
metadata:
name:  reader-binding
roleRef:
apiGroup:  rbac.authorization.k8s.io
kind:  ClusterRole
name:  reader
subjects:
â€“  kind:  Group
name:  umbrella:operations

```

### **RBAC å®æ–½äº†:** ![âœ…](img/147600907327f791501815a192184617.png) ![âœ…](img/147600907327f791501815a192184617.png) (RBAC æƒ³ä¸å¼€ï¼ŒåŠ å€æ£€æŸ¥)

**æœ€ä½ç‰¹æƒåŸåˆ™:**ğŸ¤·ğŸ»â€â™€ï¸å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ˜¯çš„ã€‚æœ‰ç‹¬ç«‹çš„è¯»è€…ã€ä½œè€…å’Œç®¡ç†å‘˜è§’è‰²ã€‚æ‚¨çš„åº”ç”¨ç¨‹åºéƒ½è·å¾—ç‰¹å®šçš„è®¿é—®æƒé™ã€‚æ˜¯æ—¶å€™æ‹æ‹æˆ‘ä»¬è‡ªå·±çš„èƒŒäº†ã€‚å·¥ä½œåšå¾—å¾ˆå¥½â€¦

**RBAC å·²å®æ–½:** âœ…âœ… (RBAC éå¸¸åŠªåŠ›ï¼Œåå¤æ£€æŸ¥)

**æ“ä½œç®€å•:**å½“ç„¶ï¼Œè¿™å¹¶ä¸åƒèµ‹äºˆæ¯ä¸ªäººå’Œæ‰€æœ‰äº‹ç‰©ç¥åŠ›é‚£ä¹ˆç®€å•ï¼Œä½†æ˜¯è¿™é‡Œçš„è®¾ç½®æ€»ä½“æ¥è¯´è¿˜ä¸é”™ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä½ ä¼šå‘ç°è¶Šæ¥è¶Šå¤šçš„ä¸åŒå›¢é˜Ÿå‘ä½ å’¨è¯¢ RBAC æ”¿ç­–ã€‚é™¤äº†ä½ çš„ç»„ç»‡çš„å¹³å°/å¼€å‘/åŸºç¡€è®¾æ–½/å·¥å…·å›¢é˜Ÿä¹‹å¤–ï¼Œæ²¡æœ‰äººä¼šå»å¼„æ¸…æ¥š Kubernetes çš„ RBAC æ˜¯ä»€ä¹ˆã€‚æ‚¨å‘ç°è‡ªå·±ä¸å¾—ä¸ç»å¸¸æ›´æ–°ç­–ç•¥ï¼Œä»¥è¯†åˆ«æ–°çš„è‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼Œç”¨äºæ‚¨çš„æ•°æ®å·¥ç¨‹å¸ˆä¸æ–­å¼€å‘çš„é…·é…·çš„ Kubernetes é›†æˆã€‚æ ¹æ®æ‚¨ä½¿ç”¨çš„èº«ä»½éªŒè¯å™¨çš„ç±»å‹ï¼Œæ‚¨è¿˜å¯èƒ½æ‰‹åŠ¨å°†å¼€å‘äººå‘˜è®¾ç½®åˆ°ä»–ä»¬æ‰€å±çš„ç»„ä¸­ï¼Œä»¥è·å¾—æ­£ç¡®çš„è®¿é—®æƒé™ã€‚ä½ å¼€å§‹è§‰å¾—è‡ªå·±åƒä¸€ä¸ªè¢«ç¾åŒ–äº†çš„ YAMLÂ·å¾·å¤«ã€‚

## #3:è‡ªåŠ¨åŒ–

![](img/6bad74f5413fee4d18dbb1347e9fc820.png)

è¿™æœ€åä¸€ç§æ–¹æ³•â€¦å¹¶ä¸æ˜¯çœŸæ­£çš„æ–¹æ³•ã€‚å®ƒæ›´å¤šçš„æ˜¯ä¸€ç³»åˆ—æŒ‡å¼•ï¼Œè®©ä½ èµ°ä¸Š RBAC çš„æˆåŠŸä¹‹è·¯ã€‚åœ¨æ„Ÿå—åˆ°ç¬¬ä¸€ç‚¹å’Œç¬¬äºŒç‚¹çš„ç—›è‹¦åï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä½ ä¼šè‡ªç„¶è€Œç„¶åœ°é‡‡ç”¨å¾ˆå¤šè¿™æ ·çš„æ–¹æ³•ã€‚

å¯¹äºæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯èƒ½å¸Œæœ›é‡‡ç”¨ä¸ç¬¬äºŒéƒ¨åˆ†ä¸­çš„é€šç”¨è¯»å–å™¨/å†™å…¥å™¨/ç®¡ç†å™¨æ–¹æ³•ç±»ä¼¼çš„æ–¹æ³•ã€‚å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸å¤ªå¯èƒ½å¤§é‡ä½¿ç”¨ Kubernetes APIï¼Œé™¤äº†è¯»å–å®ƒä»¬è‡ªå·±çš„é…ç½®å’Œç§˜å¯†ã€‚

å¯¹äº CI/CD ç›¸å…³çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥å¯¹ API ç»„ç¨å¾®å®½æ¾ä¸€äº›ã€‚åˆ›å»ºä¸€ä¸ªé€šç”¨ RBAC æ¨¡æ¿å’ŒæŒ‡å¯¼æ–¹é’ˆçš„çŸ¥è¯†åº“ä¾›å…¬å¸å…¶ä»–äººä½¿ç”¨æ˜¯å¾ˆå¥½çš„ç¬¬ä¸€æ­¥ã€‚å¦‚æœå®ƒä»¬æ˜“äºä½¿ç”¨å’ŒæŸ¥æ‰¾ï¼Œæ‚¨çš„å¼€å‘äººå‘˜æœ€ç»ˆåªä¼šå¤åˆ¶/ç²˜è´´å®ƒä»¬(è¿™æ­£æ˜¯æ‚¨æƒ³è¦çš„)ã€‚

æ ¹æ®æ‚¨åœ¨ Kubernetes ä¸­çš„èº«ä»½éªŒè¯æ–¹æ³•ï¼Œç”¨æˆ·é…ç½®å¯èƒ½æ˜¯å¤„ç† RBAC çš„ä¸€ä¸ªæ£˜æ‰‹é—®é¢˜ã€‚ [strongDM](https://strongdm.com/docs/user-guide/kubernetes-connection/) é›†æˆäº† Kubernetesï¼Œä½¿å‘ç”¨æˆ·æˆäºˆåŸºäºè§’è‰²çš„é›†ç¾¤è®¿é—®æƒé™å˜å¾—æ ‡å‡†åŒ–å’Œç®€å•ã€‚

strongDM çš„è§£å†³æ–¹æ¡ˆä¸æ˜¯åˆ›å»ºç›´æ¥çš„ç”¨æˆ·æ˜ å°„ï¼Œè€Œæ˜¯ä¾èµ–äºåœ¨ Kubernetes ä¸­ç”Ÿæˆè§’è‰²ï¼Œå¹¶ç”¨å®¢æˆ·ç«¯è¯ä¹¦å’Œå¯†é’¥å¡«å…… strongDMã€‚ç„¶åï¼Œç”¨æˆ·å¯ä»¥æŒ‰ç…§ä¸æ‰€æœ‰æ•°æ®æºç›¸åŒçš„æ ‡å‡†åŒ–æ–¹å¼è·å¾—å¯¹é›†ç¾¤çš„è®¿é—®æƒé™ã€‚

![](img/5a08054d7d1587be48ffad8ce732d10b.png)

éšç€æ—¶é—´çš„æ¨ç§»ï¼Œéšç€ç»„ç»‡çš„å‘å±•ï¼Œé€šç”¨çš„è¯»è€…/ä½œè€…/ç®¡ç†å‘˜æ–¹æ³•æ— æ³•æ‰©å±•ã€‚(ä¸€ä¸ªéšæœºçš„ç½‘ç»œé™Œç”Ÿäººæå‡ºçš„è§£å†³æ–¹æ¡ˆéš¾é“ä¸æ˜¯è§£å†³ä½ æ‰€æœ‰é—®é¢˜çš„è‰¯è¯å—ï¼ŸæƒŠå–œå§ã€‚)ä½ çš„æ¯ä¸ªè§’è‰²éƒ½éœ€è¦æ›´å¤šçš„ç²’åº¦ï¼Œè¿™æ„å‘³ç€ä½ éœ€è¦åˆ›é€ æ›´å¤šçš„è§’è‰²ï¼Œè¿™åœ¨ç²¾ç¥ä¸Šå˜å¾—æ›´åŠ å›°éš¾ã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œå¼€æºè§£å†³æ–¹æ¡ˆæ¥æ‹¯æ•‘è¿™ä¸€åˆ‡ï¼Œä½¿ä¹‹æ›´å®¹æ˜“ç®¡ç†ã€‚ [RBAC ç®¡ç†å™¨](https://github.com/FairwindsOps/rbac-manager)é€šè¿‡æ ‡ç­¾ä½¿ç®¡ç†ç”¨æˆ·ã€æœåŠ¡å’Œè§’è‰²ç»‘å®šå˜å¾—æ›´åŠ å®¹æ˜“ã€‚ [rakkess](https://github.com/corneliusweig/rakkess) å’Œ [rbac-lookup](https://github.com/FairwindsOps/rbac-lookup) éƒ½æä¾›äº†æœåŠ¡å¸æˆ·å’Œç”¨æˆ·è§’è‰²çš„ç®€å•å¯è§æ€§ï¼Œç”±äºæœªçŸ¥çš„åŸå› ï¼Œå•ç‹¬ä½¿ç”¨ kubectl å¾ˆéš¾ç¡®å®šã€‚(è¿™å‡ ä¹å°±åƒåº“ä¼¯å†…ç‰¹æœ‰æ„è®©ä½ éš¾ä»¥ç†è§£ RBAC)ã€‚Popeye ï¼Œä¸€ä¸ªç”¨äºæ‰§è¡Œæœ€ä½³å®è·µçš„é€šç”¨ Kubernetes æ‰«æå™¨ï¼Œå¯¹äºæ£€æµ‹ç”±äºæ›´æ–°å’Œåˆ é™¤è§’è‰²è€Œé€æ¸ç§¯ç´¯çš„æœªä½¿ç”¨çš„ RBAC è§„åˆ™éå¸¸æœ‰ç”¨ã€‚

### **RBAC å·²å®ç°:** âœ…âœ…æ‚¨å·²ç»å¾—åˆ°äº†è¿™ä¸¤ä¸ªæ£€æŸ¥ï¼Œæ‰€ä»¥å¸Œæœ›æ‚¨æ²¡æœ‰å€’é€€å¹¶ä¸¢å¤± RBAC å®ç°ã€‚

**æœ€å°ç‰¹æƒåŸåˆ™:æ˜¯ï¼**

**æ“ä½œç®€ä¾¿:**é™æ­¢ğŸ¤·ğŸ»â€â™€ï¸.åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæ‚¨å¯èƒ½å·²ç»æ„è¯†åˆ°å®æ–½ RBAC å¹¶ä¸æ˜¯ä¸€é—¨ç²¾ç¡®çš„ç§‘å­¦ï¼Œå¹¶ä¸”å®¹æ˜“éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ï¼Œè¿™å–å†³äºæ‚¨çš„ç»„ç»‡çš„å¢é•¿è½¨è¿¹ã€‚å¸Œæœ›æœ‰äº†ç°æˆçš„å¼€æºè§£å†³æ–¹æ¡ˆï¼Œæ‚¨å°†èƒ½å¤Ÿæ‹¼å‡‘å‡ºä¸€ä¸ªé€‚åˆæ‚¨çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸ä¼šå°†æ‚¨é€¼å…¥ç»å¢ƒã€‚å·¥ç¨‹å¸ˆçš„æ¢¦æƒ³ã€‚

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>