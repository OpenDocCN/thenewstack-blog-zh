# 为什么无服务器是 2018 年构建 API 的必由之路

> 原文：<https://thenewstack.io/why-serverless-is-the-only-way-to-build-apis-in-2018/>

Stackery 赞助了这篇文章。

当从您自己的 web 应用程序中创建 API 不符合逻辑或不切实际时，有三种主要的方法来创建 API。您可以使用虚拟机(例如 AWS EC2 实例)构建服务，使用您的服务构建容器，或者在无服务器环境中构建服务。

这就是为什么在创建 API 时采用无服务器是最有意义的。****

## 不要使用容器来构建你的 API

 [托比·费

Toby 是 Stackery 的社区开发人员。她的角色和经历结合了软件工程师、作家和技术讲师的工作，用新兴工具构建有趣的项目，并与世界分享她的发现。在加入 Stackery 之前，Toby 是 NWEA、瓦卡萨和新遗迹公司的工程师。](https://www.stackery.io/) 

容器是近年来最令人困惑的时尚。在某些情况下，说“我们可以建造新的机器，它们是你以前建造的机器的完美复制品”的能力是一种超能力，它解锁了一些关键过程——但公共 API 很少以需要旋转几十个复制品开始，这种优势不会超过许多困难。

与[虚拟机(VMs)](https://en.wikipedia.org/wiki/Virtual_machine) 相比，容器启动更快，并且需要更少的资源来运行多个，但是这些都不太适用于 API 服务。一般来说，容器启动不够快，直到收到 API 请求才会启动。与传统虚拟机相比，他们的开销更低，这里我们看到了一个基本的发展事实:没有高管抱怨他们不能购买更多的 RAM，但他们缺少工程师。如果 RAM 或 CPU 周期非常宝贵，没有人会编写一行 Javascript。大多数被广泛采用的技术主要是为了节省开发人员的时间。

容器以开发时间为代价节省 RAM 的一个例子是缺乏可靠的管理工具。这只是一个轶事，但我从未在 Amazon EC2 或 Azure 虚拟机的管理程序接口上遇到过问题。另一方面，在管理 Docker 容器方面，我从来没有成为(甚至没有遇到)一个自学成才的专家。

当面对大多数 web 开发人员在使用容器时遇到的一些基本困难时，答案通常是“通过一点培训，您可以很容易地管理这个或那个”,这让我们想到了容器的一个基本问题:在引入容器多年后，web 开发人员仍然不能自己动手。总的来说，当领导者谈论什么资源短缺时，这是“人力不足”，而不是出现的技术问题。一个需要更多工程师时间的解决方案似乎注定会带来更多的麻烦。

## 不要在你的 API 中使用虚拟机

虽然我反对容器的理由很长，但我反对使用虚拟机的理由可以归结为一个词:安全性。事实上，虚拟机的噩梦场景是一种类似公共 API 的服务。想象一下如下情况:

*   您的团队被要求提供一个公共 API 来帮助与并行服务建立潜在的合作关系；
*   在开发之后，几个月或几年过去了，社区对终端只有适度的兴趣，公司的所有开发人员都转移到其他东西上；
*   在此期间，我们的虚拟机的操作系统出现了新的漏洞，但由于公共 API 不是任何人的全职“工作”,这些更新要么不会发生，要么如果虚拟机管理程序服务强制它们，当没有人可以找出它们破坏服务的原因时，它们必须回滚；
*   再过一两年，你会收到一封黑客发来的电子邮件，解释他们如何通过一个很久以前就修补过但从未应用于你的 API 虚拟机的安全漏洞，获得了你的生产数据库的完整克隆。

这里的问题是显而易见的，但解决方案并不清楚:高度管理的 VM 让我们看起来更像是无服务器的，并且试图将服务迁移到更现代的机器映像可能需要大量的开发人员时间。更糟糕的是，很难知道什么时候会发生这种情况，因此您的堆栈中可能会有一些非常陈旧的虚拟机。

## 为什么无服务器胜出

无服务器正在“跨越”容器的趋势。在 Heroku 这样高度抽象的环境中管理虚拟机的最简单速成课程之后，许多新开发人员正在学习无服务器。

无服务器提供了一个环境，在这个环境中，更新和安全漏洞正式“不是你的问题”，你可以对已经可靠工作了一段时间的服务采取“如果它没坏就不要修复它”的态度。

最后，使用单个函数(在 AWS 中是 [Lambdas](https://aws.amazon.com/lambda/) )来处理单个路由意味着通过 API 泄漏数据的危险将会大大降低。无服务器可能无法提供更好的资源使用、价格或复制便利性，但这些都不是问题，尤其是在构建公共 API 时。在 [Stackery](https://www.stackery.io/) ，我们已经明确将解决这些问题作为我们的使命，让开发者更容易快速启动和运行无服务器应用。

对于内部服务、关键任务项目和分布式系统，几乎可以对任何现存的技术进行论证。在构建 API 的例子中，除了无服务器，很难找到其他解决方案的成功论据。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>