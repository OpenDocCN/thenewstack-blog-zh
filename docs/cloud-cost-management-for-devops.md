# 面向开发运维的云成本管理

> 原文：<https://thenewstack.io/cloud-cost-management-for-devops/>

[](https://archera.ai/)

 [阿兰·卡纳

阿兰·卡纳是 Archera.ai 的首席执行官兼联合创始人，这是一个云资源自动化平台，使组织能够在云中动态运行。作为哈佛计算机科学校友和前亚马逊产品工程师，Aran 专注于理解技术在我们生活中日益重要的作用的后果，特别是在个人隐私领域和机器学习系统的影响。Aran 已经就数字化社会的后果做了很多演讲，包括一个受欢迎的 TedX 演讲。他还与加州理工学院教授 Anima Anandkumar 合作发表了深度学习领域被广泛引用的研究，以及与前 FTC 首席技术官和哈佛大学教授 Latanya Sweeney 合作发表了多篇关于消费者隐私的论文。](https://archera.ai/) [](https://archera.ai/)

[云服务](https://thenewstack.io/category/cloud-services/)的使用在过去几年中急剧增加，并且还在继续增长，预计 2022 年的支出将达到 3970 亿美元(Gartner)。随着组织在云服务上的花费越来越多，对云资源管理的需求也越来越大。

这一责任通常落在开发人员或站点可靠性团队成员的肩上，因为他们知道基础设施需要或当前正在使用哪些服务。云资源管理成为 DevOps 职责之上的一组附加职责。

该团队成员通常充当工程和财务部门之间的中间人角色，来回传递云支出信息。第一个增加的职责是实现跨部门的成本可见性。

随着云使用和支出的增长，成本优化成为优先事项。此时，DevOps 开始承担通过解决成本异常和根据实际使用情况调整云服务合同来应对成本的任务。随着云应用的成熟，许多组织开始采用主动成本优化方法。这包括通过利用一到三年承诺提供的折扣来优化购买，例如[亚马逊网络服务](https://aws.amazon.com/?utm_content=inline-mention)的预订实例和节省计划。这些承诺必须及时购买、更新和交换，以避免损失金钱。

如果操作得当，云成本管理可以真正为组织节省大量成本。但是有一个学习曲线。反复试验帮助我们确定了 DevOps 团队成员可以预见的一系列近乎确定的挑战。更重要的是，这些障碍可以通过适当的前瞻性规划来避免。

## 1.准确地将成本分配给团队和项目

在您开始围绕成本优化进行规划之前，您需要准确了解您当前的基础架构和支出情况。虽然这看起来是一个相当简单的任务，但成本归属不能通过简单地打开 AWS 账单来完成。您的月度账单所提供的数据不够详细，无法将成本归因于项目和团队。此外，您的账单中还包括与您的销售成本无关的额外费用，例如与培训机器学习模型相关的 R&D 费用。

准确分配成本的最佳方式是标记基础架构。您不必猜测哪些实例与您正在检查的业务单元相关联。但是标记只有在准确和有纪律的情况下才会起作用；否则，你的时间将被用来重新标记。标记基础设施的行为需要对每个子账户中的每个基础设施进行大量的人工操作。在最坏的情况下，标记可能需要重新启动基础架构，这可能会对应用程序产生影响。由于实施标签卫生本身就是一项挑战，因此可以考虑提供自动标签的云管理解决方案。

## 2.与财务团队一起规划

跨部门的所有团队成员都不容易访问云使用和成本信息。这导致资源选择成为一个脱节的过程，其中财务团队成员指导预算，但依赖 DevOps 团队成员了解成本、使用情况并选择符合预算的实例。然后是从财务团队获得批准的来回过程。

摆脱这一耗时过程的一个方法是创建跨部门可见性。手动方法是通过电子表格跟踪购买和使用情况，但这需要持续维护，并且容易出现人为错误。

我们强烈建议使用跨团队工作的工具。他们至少应该将历史使用和支出信息与可定制的业务部门保持一致，并在清晰的控制面板中呈现这些信息。购买基础设施的部分挑战是能够预测跨团队和产品的支出，尤其是当外部因素可能改变服务需求时。我们所说的外部因素是指潜在的情况，如产品增长 10%或销售额下降 10%。

虽然基线可见性在我看来是云管理工具中的一种商品，但预测和规划工具同样重要，但更难找到(特别是在与管理解决方案干净地集成以实现预测的方式中)。理想情况下，您需要一个能够将业务知识(如预测、预算和场景分析)集成到购买建议中的工具。

## 3.优化采购

除了按需购买，您使用的每个实例都有多种不同的购买方式。你也可以改变合同的期限。你预先花的钱。这变成了一个 NP 难题，从成千上万个不同的选项中为您的基础架构找到一套合适的合同太复杂了。通过电子表格手动确定最佳承诺集几乎是不可能的，因为实在是太多了。这导致许多团队通过更容易使用的节约计划实现了高水平的覆盖率，但是这也留下了很多钱。

有一些工具可以帮助您制定购买计划，但是您必须确保他们的建议超出了 AWS Cost Explorer 提供的范围。这些建议不应被视为一刀切的方法。许多推荐引擎只会根据一种合同类型、期限承诺或前期支出给你一组推荐。相反，你应该寻找一种考虑到所有可能组合的工具；否则，你将错过节省或灵活性的机会。

在这种情况下，灵活性指的是几个不同的东西。例如，计算平面图可以跨实例族和区域使用，因此它们在覆盖范围上更加灵活。但是，EC2 保留实例只能用于单个实例族的单个区域中。这也意味着要考虑不同的任期长度。用途可变的资源不一定最适合较长的三年承诺，而用途更可预测的其他资源可能最适合。

## 4.持续管理和优化

手动执行购买、更换和续订需要持续的努力。合同在不同的时间购买，涵盖不同的时间段，因此很难记住何时续签一份合同。建立一个系统，在你购买它们的时候提醒你过期，或者更好的是，建立一个管理系统，让它自己进行购买或交换。

除了记住何时续订，持续监控使用和成本数据对于立即识别和解决成本异常也很重要。在人工方法中，成本异常只有在月底账单到达时才被发现。这意味着你有几周可以避免的浪费。使用实时成本异常检测工具，提醒适当的团队成员和问题的根本原因。

持续优化要求能够在新的 AWS 产品和价格发布后立即在您的模型中使用它们(这很常见)。虽然您可以尝试手动完成这项工作，但使用一个可以根据最新价格数据提出建议的工具将会节省您很多精力。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>