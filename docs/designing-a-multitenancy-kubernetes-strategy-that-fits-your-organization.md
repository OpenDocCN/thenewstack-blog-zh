# 设计适合您组织的多租户 Kubernetes 战略

> 原文：<https://thenewstack.io/designing-a-multitenancy-kubernetes-strategy-that-fits-your-organization/>

[](https://www.linkedin.com/in/deepakgoel9/)

 [迪帕克·戈尔

迪帕克·戈尔在 D2iQ 担任首席技术官。在这个职位上，Deepak 领导技术架构小组，负责监管所有 D2iQ 产品的架构。Deepak 于 2016 年加入 D2iQ，领导在其 Kubernetes 平台上设计、开发和构建产品的工作，实现多集群、多租户 Kubernetes 环境中的第二天运营。](https://www.linkedin.com/in/deepakgoel9/) [](https://www.linkedin.com/in/deepakgoel9/)

虽然预计使用 Kubernetes 的生产项目将在未来两年[增长 61%](https://d2iq.com/resources/report/kubernetes-in-the-enterprise-uncovering-challenges-and-opportunities)，但几乎所有组织(94%)都面临着挑战。许多组织开始采用 Kubernetes，但没有专门的管理策略。各个团队创建自己的集群来满足特定的业务功能，但是在整个企业中没有一致的结构、政策或管理实践。随着集群和工作负载数量的增长，它们通常被独立地管理和治理，从而造成集群蔓延，阻碍组织实现容器和 Kubernetes 的全部价值。这种混乱的环境充斥着多余的努力和浪费的资源。

帮助解决这一挑战同时提高投资回报的一种方法是创建多租户 Kubernetes 策略。在同一个共享基础设施上运行更多的应用程序意味着更好的资源利用率和总体运营成本的降低。

## 成功的多租户战略的优势

无论您是 Kubernetes 新手，还是您的组织已经在许多集群中采用了 Kubernetes，多租户策略都可以带来显著的好处。

1.  **提高投资回报率**:强大的管理和多租户战略可以大幅减少 IT 投资，从而提高投资回报率。更大的共享集群可以更有效地利用共享资源并降低运营成本，从而减少基础设施开销。通过应用一致的配置策略简化了管理，并且应用程序能够更好地应对基础架构故障，从而减少应用程序停机时间。换句话说，从基础架构和运营成本的角度来看，正确的多租户策略能够让您从现有 IT 资产中获得更多的利用。
2.  **严格而强大的工作负载隔离** : Kubernetes 通过促进共享基础设施上的软件层隔离来实现多租户。Kubernetes 中提供这种隔离的一些关键多租户功能是名称空间、角色和角色绑定、资源配额和网络策略。这些软件构造的使用应该通过正确的组织模型和文化得到加强，这些模型和文化将技术能力与业务目标结合起来。这种级别的隔离所提供的好处包括减轻“噪音邻居”问题，以及提高按应用程序、项目或团队分配和跟踪资源的能力
3.  **提高扩展应用程序的能力:**大多数应用程序都会出现 CPU 和内存资源的“爆发式”消耗，这些爆发发生在不同的时间。使用多租户配置，可以通过巧妙的资源共享来确保所有应用程序都有足够的资源，而不是简单地累加所有应用程序的最大资源需求。

## 管理多租户部署的挑战

在管理多租户 Kubernetes 部署时，一个非常常见的问题是“吵闹的邻居”吵闹的邻居被定义为在多租户环境中霸占共享资源的一方，这对于 IT 团队来说已经是司空见惯的问题。

嘈杂的邻居会严重影响同一集群上其他工作负载的性能，有时会阻止它们一起运行。当一个应用程序耗尽集群中的所有 CPU 或内存时，其他工作负载运行缓慢(如果有的话)。长期缺乏对容器的可见性，再加上缺乏统一的策略，这意味着 IT 运营和技术团队可能无法在多租户环境中的干扰性邻居问题发生之前防止它，并且一旦发生，可能很难缓解它。

Kubernetes 中隔离的核心元素是名称空间。命名空间是帮助组织代码运行位置的声明性区域。正确使用命名空间有助于排除故障和防止邻居吵闹。通常，平台上的每个租户(通常是应用程序或微服务，但也可能是团队或项目)都需要一个专用的命名空间。部署在名称空间中的应用程序可以利用 Kubernetes 提供的强大的安全性和资源管理结构来构建有效的多租户平台。

## 任何好的战略都包括风险管理

在任何策略中，从业务角度考虑风险领域都是至关重要的。这一视角包括法规环境、法规遵从性目标和其他因工作负载而异的业务需求。在许多组织中，这些要求证明了根据每个风险域组织集群的合理性，以便可以通过实施适当策略的自动化控制来部署工作负载。

例如，按照某些行业特定的法规或数据法律来安排几个集群可能是有益的。在正确的多租户策略中，重要的是安排集群来代表特定的风险域，并为要在集群级别应用的每个工作负载提供所需配置的自动实施。然后，应用程序可以依靠集群基础设施来提供这些功能，而不是每个应用程序自己必须独立地重新发明这样的实施。

随着 Kubernetes 环境的增长，其复杂性也在增加。通过后退一步并创建简化的多租户策略，组织可以定制部署以满足其 IT 和业务需求。通过适当的策略，任何组织都可以优化成本节约、降低风险和提高安全性，而不管您的集群数量或规模如何。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>