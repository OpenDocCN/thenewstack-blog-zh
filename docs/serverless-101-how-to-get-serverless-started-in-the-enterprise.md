# 无服务器 101:如何在企业中启动无服务器

> 原文：<https://thenewstack.io/serverless-101-how-to-get-serverless-started-in-the-enterprise/>

编者按:这篇文章是探索无服务器基础的多部分系列文章的第一篇。请每周一回来查看更多的分期付款。

一开始有[裸机](https://en.wikipedia.org/wiki/Bare-metal_server)，还不错。

单租户服务器快速、可靠且安全，只受其主人的控制。但是，调配和扩展起来确实很麻烦。对敏捷性和可扩展性的需求催生了[虚拟机](https://en.wikipedia.org/wiki/Virtual_machine)，云提供商为我们带来了[基础架构即服务](https://en.wikipedia.org/wiki/Infrastructure_as_a_service) (IaaS)，于是云中的 lo 自助服务诞生了。在这片肥沃的土地上出现了代码为 (IaC)的[亚马逊网络服务](https://aws.amazon.com/)、编排和[基础设施；然后容器化也出现了，这导致了](https://en.wikipedia.org/wiki/Infrastructure_as_Code)[平台即服务](https://en.wikipedia.org/wiki/Platform_as_a_service) (PaaS)架构。一切都很顺利……除了开发人员大声疾呼缺乏语言无关的端点、水平可伸缩性和为服务的实时消费付费的能力。

作为对他们请求的回应，最终，一份伟大的礼物被赐予了这个世界:无服务器计算，通常也被称为[功能即服务](https://en.wikipedia.org/wiki/Function_as_a_service) (FaaS)。执行应用程序但不存储数据的运行时。这意味着，像 AWS、 [Google Cloud](https://cloud.google.com/) 或 [Microsoft Azure](https://azure.microsoft.com/en-us/) 这样的云提供商可以动态管理资源的分配和分发。

无服务器是基于实际消耗的现收现付，而不是基于猜测的预购服务。这是它应该有的基础设施，在 2018 年出现在我们眼前。

## 这不是月光

第一:名字完全是误导。无服务器计算仍然需要服务器。没有神秘的魔法月光驱动一切。

这个术语的出现是因为服务器管理和容量规划决策是完全隐藏的。就用户/开发人员而言，无服务器是“无服务器的”,他们从来不需要关心甚至意识到任何基础设施——服务器被完全抽象掉了。无服务器代码可以与以传统方式部署的代码(如微服务)一起使用，或者，应用程序可以编写为完全无服务器的，根本不使用调配的服务器。

> 无服务器的真正价值不是成本效率，而是时间效率。

“我喜欢认为它有一个类似胶水的软件的迷你 PaaS，”现任 [Bitnami](https://bitnami.com/) 云技术高级总监的 [Sebastien Goasguen](https://ch.linkedin.com/in/sebastien-goasguen-382b7b21) 解释道。“无服务器的真正优势在于能够从云中发生的事件中调用函数，即胶水。”例如，Goasguen 描述了将图像放入 AWS 上的存储桶中，然后调用一个函数来调整图像大小的场景。无服务器系统获取这些代码，并自动将其注入到运行时环境(服务器或容器)中，然后将其公开，以便可以调用该函数。

## 那么，什么是无服务器呢？

传统云计算和无服务器计算的主要区别在于，您——需要所述计算的客户——不会为未使用甚至未充分利用的资源付费。以前，无论是在内部数据中心还是在云中，我们都必须预测容量和资源需求，并对其进行预配置。然而，在我们前面的例子中，这意味着在 AWS 中启动一个服务器到袖手旁观，以便随时执行这个图像大小调整服务。然而，在无服务器设置中，当且仅当函数被调用时，您只是增加了一些代码执行时间。

无服务器计算服务将您的函数作为输入，执行逻辑，返回您的输出，然后关闭。您只需为实际执行这些功能时使用的资源付费。

按需付费，而且只针对实际消耗的资源，显然是一件好事。然而，Goasguen 和其他云原生专家强调，无服务器的真正价值不是成本效率，而是时间效率。

## 有点像时间机器？

嗯，是的，算是吧。或者更像是通向未来的门户，因为无服务器(像其他“即服务”技术一样)是一种工具，它允许公司专注于构建利用人工智能和机器学习等前沿技术的应用程序，而不是将精力转移到永远的构建上，然后重新构建必要的基础架构层来跟上。

“无服务器”的另一个时间机器优势在于缩短了从代码开发到将代码投入生产的时间。这真的是“这是我的代码，现在运行它”——中间几乎没有基础设施的拖累。

“基本思想是开发人员只需编写代码，然后推送到无服务器服务。就是这样。其余的由服务来处理，”[甲骨文](https://www.oracle.com/index.html)的无服务器副总裁[查德·阿里穆拉](https://www.linkedin.com/in/chadarimura)说。更好的是，他补充说，数据库和存储等依赖项也是无缝集成在无服务器罩下的服务。

Arimura 说:“在幕后，结合大量自动化的专业团队正在大规模操作这些系统，这样开发人员就不必考虑这些事情了。”“它看起来和感觉起来确实有点像魔术和月光，这就是为什么无服务器的宣传周期很长。因为这是一种更好的体验。”

## 感受 FaaS 平台的力量

虽然 Docker 已经简化了分布式应用程序的打包和依赖处理，Kubernetes 正在帮助企业在生产中运行这些应用程序，但它们仍然不简单或不易于使用。Bitnami 的 Goasguen 说:“Dockerfile、基础设施细节、Kubernetes 清单——所有这些对于有开发意识的观众来说都太复杂了。

那么，无服务器计算的核心就是作为一个服务平台的功能。本质上，这就是 [AWS Lambda](https://aws.amazon.com/lambda/) 或 [Google Cloud Function](https://cloud.google.com/functions/) ，处理资源管理、负载平衡和多线程，而开发人员只需专注于他们的代码，企业组织则专注于他们的任务。

[Yaron Haviv](https://il.linkedin.com/in/yaronh) ，iguaz.io 的创始人兼首席技术官，专门设计用于优化云中性能的连续数据平台，带领新的堆栈通过 FaaS 工作流:

1.  无服务器平台采用功能代码——FaaS 的“功能”部分——以及所有的依赖项(所需的库、内存量、属性等)。)，并构建一个容器化的应用程序包，通常采用 Docker 映像的形式。
2.  当另一个平台服务(例如对象存储或数据库)想要触发该功能时，或者当有一个外部 HTTP 请求指向该功能时，无服务器平台会将其定向到一个可用的功能微服务。如果没有可用的活动微服务，它将部署—“冷启动”这样的实例。
3.  无服务器平台负责在故障时恢复微服务，自动扩展以适应需求，记录和监控功能活动，并在代码被修改时进行实时滚动升级。其他人管理平台服务，这样开发人员就可以专注于“功能”方面。

## 有没有无服务器的缺点？

尽管有这些好处，FaaS 也有一些潜在的负面影响。专家说，首先，云提供商通常会减少没有多少用处的运行时环境，这意味着矛盾的是，他们也限制了可供您使用的资源总量，带来了延迟和高性能问题。对于这些云提供商来说，监控、调试和安全性也很棘手，就像任何云计算工作流一样，因为这一切都是在您无法访问或控制的公共云中运行的。

Amazon Lambda 已经成为无服务器计算的同义词，这是一个大多数人都可以理解的模型。因此，虽然 Lamba 开辟了无服务器的道路，但它的缺点已经被认为是无服务器的整体缺点:冷启动慢、性能慢、功能短命，以及一组封闭的触发器。这些限制现在被认为普遍适用于所有无服务器平台，而事实上这些都是实现的选择。值得注意的是，还有更新的无服务器平台，如 [Nuclio](https://nuclio.io/) ，它已经发展到可以服务更广泛的用例。这些平台限制较少，提供高性能，并且可以在多个云中运行，甚至可以在本地运行。

“极客们喜欢它，但企业仍在试水——他们甚至还没有习惯 Docker/K8s，现在有了无服务器，”Haviv 说。“像任何新技术一样，它需要从早期采用者(通常更敏捷、更愿意冒险)到大众之间‘跨越鸿沟’。谁需要建立信任、查看证据、解决性能、安全性等问题……”

显然，鉴于无服务器技术几乎每天都在出现和发展，并不是所有方面都是众所周知的实体。虽然不一定是一个不利因素，但这个因素肯定会让整个董事会在他们的 [Aeron 主席](https://www.hermanmiller.com/products/seating/office-chairs/aeron-chairs/)中坐立不安。Haviv 指出:“企业必须变得更加敏捷并承担风险，因为数字‘转型’正在以被创新者破坏的现任者的形式受到伤害，并且是无服务器的(像其他作为服务的技术一样)”。

“有趣的是，通过抽象出 Docker/Kubernetes 的大部分复杂性，无服务器可以更快、更容易地被采用，尽管它是较新的技术。”

## 如何知道无服务器是否适合您的公司？

引领潮流的人说，这不是关于一家公司是否适合无服务器的问题。

甲骨文公司的 Arimura 说:“几乎每一个写软件的公司和组织都非常适合无服务器。“也就是说，当前的文化和‘云原生’之旅的距离可能会加大采用无服务器的难度。”换句话说，如果一家公司没有使用公共云，也没有对 Kubernetes 和 Docker 等新项目进行内部实验，那么无服务器就不是他们应该开始的地方。

“这是一种新的架构，需要不同的思维方式。最简单的例子是，如果一个整体变成了 10 个微服务，就变成了 100 个具有独立部署周期和复杂依赖图的功能。这就是成熟和强大的 CI/CD 和自动化系统的用武之地，”Arimura 说。他继续说，当与无服务器搭配时，敏捷性和创新性可以飙升，但缺少其中一个可能弊大于利。

“这就是为什么 DevOps 不只是成为‘NoOps’——这是完全错误的思考方式，”Arimura 说。"事实上，无服务器使得开发运维比以往任何时候都更加重要."

事实上，Bitnami 的 Goasguen 指出，他观察到的大多数采用无服务器的公司——尤其是 AWS Lamba 都是以开发者为中心的组织，他们已经在 AWS 上使用它来将服务链接在一起。“所以，如果你现在不是 AWS，你就不需要无服务器，”Goasguen 说。“但是，您仍然应该保持关注，开始评估，确定企业中的事件源，并了解如何使用它们来构建完整的应用程序管道。”

## 如何最好地让企业涉足无服务器领域？

Arimura 建议说:“没有必要将一个整体完全转化为微服务和/或功能。”“也没有必要拿一个公司最重要的项目来学习新的架构——尤其是在文化仍在适应开发运维的情况下。”

他建议说，从小处着手。也许是一些自动化任务，或者一些市场营销的东西，或者事件驱动的用例。

新堆栈的无服务器系列将帮助您的公司起步。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>