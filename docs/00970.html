<html>
<head>
<title>Off-The-Shelf Hacker: Hedley the Robotic Skull Speaks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现成的黑客:赫德利机器人头骨说话</h1>
<blockquote>原文：<a href="https://thenewstack.io/off-the-shelf-hacker-hedley-the-robotic-skull-speaks/#0001-01-01">https://thenewstack.io/off-the-shelf-hacker-hedley-the-robotic-skull-speaks/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">不久前，我们已经报道过给机器人头骨赫德利增加一个<a href="https://thenewstack.io/hedley-the-robotic-skulls-orthognathic-surgery/" class="local-link">伺服控制颚</a>。事实证明，让颚骨真实地跟踪听觉语言是相当具有挑战性的。人类的声音是由空气在声带上移动而产生的，嘴巴的形状，舌头的位置和口腔内的体积，我们都知道这些都受到下巴开合的影响。不完全是。</p>
<p class="translated">张开嘴唱歌或说话，不要动下巴。你可以发出几乎无限多的声音，而不用移动下巴。这是怎么回事？很复杂，对吧？</p>
<p class="translated">我们对机器人所做的是通过上下移动头骨的下颌骨来给出语音的视觉队列。它最终变成了一种人类愿意相信的幻觉。</p>
<p class="translated">一种方法是通过所谓的拍颚法。这种技术使下颌运动跟随小型麦克风记录的声压峰值和谷值。作为机器人语言化的第一步，这种效果是可以接受的。它当然不是完美的。玩弄机制，Arduino代码和其他因素为如何进一步完善幻觉铺平了道路。有了一个相当好的幻觉，人类观察者开始心甘情愿地暂停现实，转而开始认为头骨实际上在说话。</p>
<h2 class="translated">制作颚瓣</h2>
<p class="translated">我的头骨设计使用了一个标准的全尺寸业余爱好伺服来上下移动赫德利的下巴。旧的<a href="https://en.wikipedia.org/wiki/Big_Mouth_Billy_Bass" class="ext-link" rel="external ">大嘴比利巴斯会说话的鱼</a>使用DC电机和控制器板，在很大程度上相同的作用。</p>
<p class="translated">在头骨的例子中，标准Arduino电位计到伺服示例草图被修改为使用模拟麦克风将我的声音的声压转换为0到1，023的值。基础代码位于Arduino集成开发环境(IDE)中的示例-&gt;伺服-&gt;旋钮主题下。Arduino然后将这些值转换为脉冲宽度值，用于随着声音的变化将伺服臂移动到相应的更高或更低的角度。颚的总角度运动约为25度。</p>
<p class="translated">这是代码。<br/></p>
<div id="crayon-642311b6de4f8727601139" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-c">/*</span>
<span class="crayon-c"> Controlling a servo position using a potentiometer (variable resistor)</span>
<span class="crayon-c"> by Michal Rinott </span>
<span class="crayon-c"> modified on 8 Nov 2013</span>
<span class="crayon-c"> by Scott Fitzgerald</span>
<span class="crayon-c"> http://www.arduino.cc/en/Tutorial/Knob</span>
<span class="crayon-c">*/</span>
 
<span class="crayon-p">#include </span>
 
<span class="crayon-e">Servo </span><span class="crayon-i">myservo</span>;<span class="crayon-h">  </span><span class="crayon-c">// create servo object to control a servo</span>
 
<span class="crayon-e">int </span><span class="crayon-i">potpin</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span>;<span class="crayon-h">  </span><span class="crayon-c">// analog pin used to connect the microphone</span>
<span class="crayon-e">int </span><span class="crayon-i">val</span>;<span class="crayon-h">    </span><span class="crayon-c">// servo value converted from analog pin input value</span>
<span class="crayon-e">int </span><span class="crayon-i">val2</span>;<span class="crayon-h">  </span><span class="crayon-c">// limit filtered servo value</span>
<span class="crayon-e">int </span><span class="crayon-i">micin</span>;<span class="crayon-h">  </span><span class="crayon-c">// microphone level variable</span>
 
<span class="crayon-e">void </span><span class="crayon-e">setup</span>()<span class="crayon-h"> </span>{
<span class="crayon-h">  </span><span class="crayon-i">myservo</span><span class="crayon-st">.</span><span class="crayon-e">attach</span>(<span class="crayon-cn">3</span>);<span class="crayon-h">  </span><span class="crayon-c">// attaches the servo on pin 3 to the servo object</span>
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">begin</span><span class="crayon-h"> </span>(<span class="crayon-cn">115200</span>);
<span class="crayon-h">  </span><span class="crayon-c">// set up fast ADC mode</span>
<span class="crayon-h">  </span><span class="crayon-i">ADCSRA</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span>(<span class="crayon-i">ADCSRA</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xf8</span>)<span class="crayon-h"> </span>|<span class="crayon-h"> </span><span class="crayon-cn">0x04</span>;<span class="crayon-h">    </span><span class="crayon-c">// set 16 times division</span>
}
 
<span class="crayon-e">void </span><span class="crayon-e">loop</span>()<span class="crayon-h"> </span>{
<span class="crayon-h">     </span>
<span class="crayon-h">     </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">available</span>()<span class="crayon-h"> </span><span class="crayon-sy">&amp;gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span>)<span class="crayon-h"> </span>{
<span class="crayon-h">     </span><span class="crayon-i">micin</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">analogRead</span>(<span class="crayon-i">potpin</span>);<span class="crayon-h">           </span><span class="crayon-c">// reads the value of the microphone level (value between 0 and 1023) </span>
 
<span class="crayon-h">     </span><span class="crayon-c">// micin = Serial.read();</span>
<span class="crayon-h">     </span>
<span class="crayon-h">     </span><span class="crayon-i">val</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">map</span>(<span class="crayon-i">micin</span>,<span class="crayon-cn">700</span>,<span class="crayon-cn">400</span>,<span class="crayon-cn">110</span>,<span class="crayon-cn">135</span>);<span class="crayon-h">     </span><span class="crayon-c">// scale it to use it with the servo (value between 0 and 180)</span>
<span class="crayon-h">     </span><span class="crayon-i">val2</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">constrain</span>(<span class="crayon-i">val</span>,<span class="crayon-h"> </span><span class="crayon-cn">110</span>,<span class="crayon-h"> </span><span class="crayon-cn">135</span>);<span class="crayon-h">           </span><span class="crayon-c">// set servo travel limits</span>
<span class="crayon-h">     </span>
<span class="crayon-h">     </span><span class="crayon-i">myservo</span><span class="crayon-st">.</span><span class="crayon-e">write</span>(<span class="crayon-i">val2</span>);<span class="crayon-h">  </span>
<span class="crayon-h">     </span><span class="crayon-e">delay</span>(<span class="crayon-cn">90</span>);<span class="crayon-h">                           </span><span class="crayon-c">// waits for the servo to get there</span>
<span class="crayon-h">     </span>}<span class="crayon-h">  </span>
}<span class="crayon-h">        </span>
</pre>
</div>
</div>

<p class="translated"><br/>注意，我添加了一些串行通信代码。虽然麦克风可以用于测试，但真正的目标是最终使用预先录制的音频文件通过扬声器播放，同时向Arduino发送数据以移动下巴。我可能会在赫德利的Raspberry Pi上使用一个处理脚本，它读取一个MP3文件并进行一些过滤，然后输出一个Arduino可以通过串行线路读取的数据流。串行线路数据将取代麦克风输入产生的值。我仍在进行这方面的工作，随着事情的进展，我将把它放在以后的操作文章中。</p>
<p class="translated">将<a href="https://www.sparkfun.com/products/12758" class="ext-link" rel="external ">驻极体麦克风</a>连接到Arduino非常容易，因为它内置了一个前置放大器。分别在Arduino上将VCC引脚连接到3.3伏，将GND端子连接到地。然后，输出连接到Arduino模拟引脚0 (potpin)。</p>
<h2 class="translated">提示:使机制可调</h2>
<p class="translated">当我使用Arduino代码、伺服角度和值缩放时，很明显伺服响应有点太慢了。你不能在声音和下颌运动之间有任何明显的脱节，否则，视觉排队效果就毁了。</p>
<p class="translated">减少主程序循环中的延迟，同时使伺服响应更快，也会导致颌看起来“紧张”90的值给出了相当好的响应，没有任何抖动。最终，我想到我可以改变伺服和下颚枢轴杠杆的比率，让下颚反应更快。标准尺寸的业余爱好伺服有足够的力量来承受这种水平的扭矩负荷。</p>
<div id="attachment_4863861" class="wp-caption alignright"><a href="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/05/830c86a8-adjustable-jaw-pivot.png" class="ext-image" rel="external "><img aria-describedby="caption-attachment-4863861" decoding="async" loading="lazy" class="wp-image-4863861" src="../Images/9f2a9ac2ae025d5b62eabdb16f50c7eb.png" alt="" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2018/05/830c86a8-adjustable-jaw-pivot-300x233.png"/></a><p id="caption-attachment-4863861" class="wp-caption-text translated">可调伺服和颚枢轴杠杆，带连杆</p></div>
<p class="translated">改变比率意味着我必须使连接在颚枢轴上的驱动杆可调。对于这些快速移动的原型项目，我通常只是根据我过去的制造经验来猜测杠杆和机构的大小和长度。我的猜测偶尔会有偏差，因此一个同样快速的解决方案是为机械调整做准备。在这种情况下，我只是简单地删除了下巴枢轴杠杆和钻了几个孔间隔沿手臂。杠杆被重新安装(并重新焊接)以与伺服杠杆平行对齐。伺服杆也有调整孔，虽然读者会注意到，我已经在使用顶部的孔。</p>
<p class="translated">想要更快地移动下巴吗？将伺服侧连杆端保持在同一孔中，并将钳夹杆枢轴端向下移动，靠近枢轴。</p>
<h2 class="translated">成功了吗？</h2>
<p class="translated">使用当前的设置，我可以对着麦克风说话，下巴会很好地跟随我的声音。说话时对气压的敏感是相当明显的。像“p”和“k”这样的硬音会导致下巴移动很多。更多的实验可能会产生更好的性能。</p>
<p class="translated">我将尝试将Raspberry Pi的音频输入Arduino的模拟引脚，看看效果如何。<a href="http://www.instructables.com/id/Talking-Arduino-Halloween-Skeleton/" class="ext-link" rel="external ">一组指令</a>使用一个<a href="https://www.adafruit.com/product/94?gclid=EAIaIQobChMIkvvNlq2p2wIVFBuBCh29EwINEAAYAiAAEgIf1PD_BwE" class="ext-link" rel="external ">波盾</a>连接到Arduino，作为它的骨骼说话者。看一下视频，你会发现伺服响应有一点滞后。虽然这是一份不错的工作，但我想让赫德利的动作更加自然。</p>
<p class="translated">最后，我将把记录在文件中的语音转换成Arduino将解释并用于伺服颚控制的值。一成不变的机器人程序和类似Alexa的体验将会非常巧妙。</p>
<p class="translated">敬请关注进一步的发展…</p>
<p class="translated"><em>每周回来查看新版的<a href="/tag/off-the-shelf-hacker/" target="_blank">下架黑客</a>，只在新栈上。</em></p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>