# 吉多·范·罗苏姆谈 Python 的类型、速度和未来

> 原文：<https://thenewstack.io/guido-van-rossum-on-types-speed-and-the-future-of-python/>

100 年后 Python 会在哪里？这是麻省理工学院的人工智能研究员莱克斯·弗里德曼在一次为期三小时的采访结束时向 Python 的创造者吉多·范·罗苏姆提出的问题。

这只是他们探索流行编程语言如何发展的方式之一——以及关于 Python 自身未来的具体问题。他们将如何改进 Python 的标准库？Python 会看到静态类型检查器吗？改善 Python 性能变慢的全局解释器锁前景如何？他们会采取什么步骤来避免另一个痛苦的突破性变化，比如向 Python 3 的过渡…？

[https://www.youtube.com/embed/-DVyjdw4t9I?feature=oembed](https://www.youtube.com/embed/-DVyjdw4t9I?feature=oembed)

视频

但在这一过程中，弗里德曼也向范罗森提出了一个更为假设性的问题，即这种语言在一个世纪后的遥远未来会扮演什么角色。“你想象过人类文明的未来吗——我们住在元宇宙里，在火星上，到处都是人类和机器人。

" Python 在其中扮演了什么角色？"

## 2122 年

Python 已经存在了 30 多年，所以 van Rossum 已经看到了流行编程语言的潮起潮落。因此，在回答弗里德曼的问题时，范·罗森回答说，再过几十年，非常受欢迎的 Python 将“最终成为一种遗产语言——它扮演着重要的角色，但大多数人从未听说过，也不需要了解它。”虽然人们可能会在它的基础上进行构建，但 Python 可能会被埋在更深处的某个地方，在这个具有许多抽象层的假想世界中——继续我们正在进行的进展。"我的意思是，现在的大多数程序员很少需要做二进制算术，对吗？"

这个元信息似乎是 van Rossum 仍然对这种语言的持久吸引力充满信心——目前，van Rossum 说他并没有积极地寻找 Python 标准库中需要填补的空白。“通常，当现在的标准库中缺少一些东西时，这是一个相对较新的想法，并且有一个第三方实现，或者可能有多个第三方实现。但它们的进化速度比在标准库中快得多……我喜欢有一个活跃的软件包生态系统。”

现在，他已经不再扮演“仁慈的终身独裁者”的角色——在 2019 年将语言控制权移交给 Python 指导委员会——范罗森仍然认为 Python 对未来的愿景是清晰的。旧的等级制度的优势在于它的可预测性——圭多描绘了“一条清晰、相当直的道路”

“幸运的是，指导委员会的后续结构找到了一种类似的方法，可以引导社区朝着相当稳定的方向发展，而不会停滞不前。”

“对我个人来说，这更有趣，因为有些事情我可以忽略不计！哦，多重处理有问题？让别人来决定解决这个问题是否重要吧！我将坚持打字和异步 IO 以及更快的解释器。"

## 重温 1991 年

Van Rossum 现在是微软团队的一员，致力于提高这种语言的性能。10 月份，微软的一篇博客文章报道说 Python 3.11 给该语言的某些部分带来了 10-60%的加速。当被问及这是如何实现的时，van Rossum 认为他们已经修正了可以追溯到 Python 起源的设计决策。在寻找提高 Python 速度的方法的过程中,“唾手可得的果实”就是解释器，他们几乎把所有的精力都放在了解释器上。

举个例子？像加号这样简单的东西有多种含义，根据要添加的数据类型，有完全不同的“添加”功能。它是一个普通的整数还是一个浮点数(小数点后有额外的数字)—还是一个字符串？或者是不同数据类型*的组合？“我们从统计学上知道，结果几乎总是对的，它们都是整数，”范·罗森说，“所以我们快速地进行检查，然后继续进行整数相加运算。*

“然后有一个回退机制，我们说，‘哎呀，其中一个不是整数……’"

归根结底，这是语言的一个基本特性:Python 不需要程序员声明变量的类型。这让程序员的生活变得更容易——但是它在解释器中引入了快速效率的缺乏。“因此，我们试图在不丧失语言的超级动态特性的情况下，提高翻译效率。这永远是一个挑战。”

但是，Python 有没有可能只提供静态类型——在代码中声明变量类型，以提高性能。Fridman 指着 van Rossum 给 [mypy](http://mypy-lang.org/) ，Python 的实验性(可选)静态类型检查器，问“mypy 现在处于什么位置——Python 中静态类型的未来如何？”

“这仍然是有争议的，”范罗森说。“但这比 mypy 和[Python Enhance Proposal # 484](https://peps.python.org/pep-0484/)年轻时更容易被接受……”PEP 484 于 2014 年推出，“这是一个非常富有成效的一年，在这一年中，数百条消息被交换，讨论该协议各个方面的优点……”(frid man 引用了估计，今天 20%到 30%的 Python 3 代码库正在使用类型提示。)

van Rossum 指出，谷歌、脸书和微软已经各自为 Python 开发了自己的静态类型检查器——这表明了他们对 Python 的兴趣。“我的假设是，很多很多专业开发 Python 软件的人，为了某种生产环境，都在使用静态类型检查器。尤其是那些有持续集成周期的人——很可能，他们测试程序中的一个步骤是“运行静态类型检查器”。所以我认为这是一个非常受欢迎的话题。”

弗里德曼问道，那么将来会不会有一种静态类型检查器被集成到语言中呢？“目前没有人对此感兴趣，”范罗森回答说，然后补充道，“这并不意味着从现在起 5 年或 10 年后，情况不会有所不同。”

但他也指出，由于 Python 的新版本一年才发布一次，类型检查器“发展的速度比 Python 及其注释语法快得多。”

van Rossum 还指出，一旦你在一门语言中引入了一个新的特性，你就必须假设人们是在使用它的*。也就是说，“一旦我们都同意加入新的语法，我们就再也不能收回了。至少放弃一个现有的功能需要很多版本……”*

## 更多可能的未来

话题转到 Python 臭名昭著的全局解释器锁，它通过一次只允许一个线程进入解释器来防止“竞争条件”。正因为如此，它经常被指责降低了 Python 的性能。(这是 van Rossum 追溯到多核 CPU 还很少见的时候做出的设计决定)。

当被问及是否有想法将它从 Python 中移除——也许用多个子解释器取代它——van Rossum 回答说“是的，有几种可能的未来。最有可能的未来是我们将得到多个子解释器——每个子解释器运行一个完全独立的 Python 程序，但这些程序之间更快的通信仍然有一些好处……”

但这也为那些让程序员吃惊的可怕的并发错误打开了可能性——范·罗森称之为“多线程编程模型的衰落”

在这里，van Rossum 重申了他的立场,“并发错误更难……如果 Python 没有全局解释器锁就好了，而且它有所谓的自由线程——但这也会导致更多的软件错误。”

然而“仍然有一个可能的未来，我们真的要去那里，或者我们至少可以在那里进行实验。”他提到了脸书的 CPython 分支，它有一个改进的解释器，完全消除了锁(以及其他优化)。“单线程的运行速度不会慢太多，而多线程实际上会使用所有的内核。所以这将是一个有趣的可能性——如果我们作为 Python 核心开发者愿意无限期地维护这些代码的话。如果我们愿意忍受解释器的额外复杂性，以及单线程情况下的额外开销。”

但这也可能不会发生。“就我个人而言，我不相信有足够多的人需要他们的 Python 程序具有多线程的速度，因此不值得牺牲性能和复杂性。我觉得全局解释器锁是一个非常好的“金发女孩”点，总是介于无线程和所有线程之间。但不是每个人都同意这一点。所以这绝对是一个可能的未来。”

同时，“对于 Python 3.12 来说，子解释器看起来是一个相当安全的赌注，所以说一年以后。”

## 当 Python 2 变成 Python 3 时

回顾 Python 的历史，Fridman 记得 Python 向 Python 3 的漫长过渡(Python 3 与 Python 2 并不向后兼容)。Fridman 问这样的中断是否会再次发生 van Rossum 立即强调说，即使是假设，“如果会发生，我们将会以非常不同的方式计划过渡——因为很明显，我们低估了在 Python 3 案例中过渡给我们的用户带来的痛苦。如果我们知道的话，我们可以设计出稍微不同的 Python 3，而不会让它变得更糟。我们只是认为我们有一个很好的计划。但是我们低估了用户在这种过渡中的能力…”

“如果我们要有一个 Python 4，我们必须有一个不同的理由，以及一个不同的流程来管理过渡！”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>