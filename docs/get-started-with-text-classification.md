# 开始使用文本分类

> 原文：<https://thenewstack.io/get-started-with-text-classification/>

理解原始文本是一个热门话题，无论是从收据中理解财务[数据，在代码库中发现](https://www.veryfi.com/)[数据安全风险和漏洞](https://www.bearer.com/)，还是改进你[发送给老板的重要电子邮件](http://grammarly.com/)。

对文本进行分类是一项任务，可以通过利用机器学习(ML)，更具体地说是[自然语言处理](https://thenewstack.io/machine-learning-still-struggles-to-extract-meaning-from-language/) (NLP)工具，或者通过使用更具确定性的模式匹配方法(也称为正则表达式)来解决。这两种方法各有优缺点，在许多情况下，结合使用这两种方法可能是有益的。

在这篇文章中，我将讨论这两个问题以及如何开始。

## 创建分类策略

在开始分类之前，您必须分析想要分类的数据，并查看是否可以确定一种数据结构，该数据结构可以告知您将如何设计标注策略。

以食品分类为例，第一分类级别可以是固体或液体。一旦我们将一个项目分类为液体，它将被更具体的分类所跟随，例如水、苏打水和果汁。对于水的类别，下一层将是火花和静止的。理想情况下，这些层次是由产品策略决定的。但是，如果没有明确的方向，工程团队就得主动出击。

这个标签结构将引导您首先匹配更高层次的类别，然后进入细节——我们将在本文中进一步讨论。接下来，您还可以使用它来衡量您的贴标过程的效率。例如，您的解决方案可能在标识汽水产品方面很有效，但在果汁方面却失败了。这种分类将有助于缩小棘手问题的范围。

## 模式匹配

虽然使用[正则表达式(regex)](https://thenewstack.io/dont-fear-regex-getting-started-regular-expressions/) 可能不像使用 ML 那样令人兴奋，但它是一个强大的工具，可以用很少的资源在很短的时间内获得分类结果。正则表达式也很有效，因为它们可以在大量数据上快速执行。首先，选择一个数据集，并确定您试图理解的数据的最常见迭代。然后为它们中的每一个，提出一个相关的正则表达式。然后，清洗并重复，当公共迭代被匹配时，您可以开始挖掘边缘案例。

我建议使用 JSON 或 YAML 格式来组织模式匹配函数。这将使导航它们变得容易，而且还可以添加、删除和更新模式对象字段。当构建正则表达式列表时，请记住您的标记策略。首先为更高级别的匹配构建匹配模式函数，然后继续往下。一些测试你的正则表达式的好工具包括[Python 的](https://pythex.org/)、 [Rubular 的](https://rubular.com/)(Ruby 的)，或者[正则表达式测试器](https://www.regextester.com/)(Javascript 的)。

虽然使用模式匹配策略可以快速捕获 90%的事件，但还是有局限性。最大的问题是假阴性:我们不知道我们没有发现什么，因为我们只能根据文本中特定的字符序列来匹配模式。对于需要更复杂的语言处理的任务，例如识别一段文本的情感或将文本分类为多个类别，正则表达式通常是无效的。对于一个工程团队来说，检查数百万行数据来捕捉正则表达式没有捕捉到的感兴趣的元素是非常耗时和耗费资源的，这将告知如何扩展模式列表。这就是 ML 的用武之地。

## 自然语言处理

使用 ML 模型的优点是它可以对任何新引入的数据产生精确的文本分类。首先，找一个训练有素的模型来解决类似的问题。使用我们的示例，寻找一个可以对食物进行分类的模型。如果你不能找到一个精确的匹配，找到一个预训练的模型做类似的事情，并训练它。比如，你可能会找到一个可以对冰淇淋进行分类的模型；虽然它可能不完全是你需要的，但它做了一些类似的事情，你可以训练它来实现你的目标。

在[抱脸](https://huggingface.co/models?pipeline_tag=text-classification&sort=downloads)、 [TensorFlow Hub](https://www.tensorflow.org/hub) 上可以找到很多 NLP(自然语言处理)模型。我个人最喜欢的文本分类任务是 [Bert](https://huggingface.co/docs/transformers/main/model_doc/bert) 和 [DistilBERT](https://huggingface.co/docs/transformers/main/model_doc/distilbert) 。Bert 是最全面的一个，而 DistilBERT 是一个小型、轻便、快速的训练模型。如果您不确定使用哪种算法，请尝试使用多种算法，并在测试集上比较它们的性能。

由于缺乏数据和训练，您进一步训练的预训练模型在第一次迭代中可能会导致非常低的准确性。要有耐心，有条理。收集更多数据和重新训练模型需要时间和精力。许多公共数据集可用于文本分类，如 [UCI 机器学习库](https://archive.ics.uci.edu/ml/datasets.php)和 [Kaggle 数据集](https://www.kaggle.com/datasets)。

如果查找训练数据是一个问题，那么通过使用正则表达式策略来提高带标签数据的质量可能是丰富训练数据集所必需的。最重要的是，通过用同义词替换单词，数据扩充可用于扩大训练数据集。开源的[手套](https://nlp.stanford.edu/projects/glove/)、 [Word2Vec](https://www.tensorflow.org/tutorials/text/word2vec) 都是完成这项任务的好工具。另一个技巧是使用回译；翻译成任何其他语言，然后回来。Google[和 Yandex](https://cloud.google.com/translate) 提供了可用于此目的的 API。

一旦有了足够的数据，就将这些数据分成训练集和测试集。使用训练集训练您的 NLP 模型，并使用测试集评估模型的性能。拥有两个唯一的数据集非常重要，因为您希望避免模型过度适应训练数据，从而导致误导性的高效数字，这将导致对新的、看不见的数据的较差性能。

下一步是将您的训练集提供给模型。在训练完模型之后，就进入了测试集的性能评估部分。要评估模型，请计算准确性、精确度、召回率和 F1 分数等指标。[这里有一篇很好的博文](https://towardsdatascience.com/accuracy-precision-recall-or-f1-331fb37c5cb9)解释了如何获得这些指标。通过微调模型的参数、预处理步骤、调整模型的超参数，或者向输入数据添加额外的特征，或者简单地对完全不同的模型进行试验来进行改进。

构建一个性能良好的 ML 模型是一个复杂的开发过程，需要知识、时间和资源。但这是值得的，因为这是可以让你达到 100%覆盖率目标的工具。

## 结论

虽然正则表达式是构建 MVP、更快获得第一分类结果或标记数据的好方法，但它很快受到已知模式列表的限制。另一方面，最大似然法耗时且计算量大，但一旦实现，它将提供更高的精度。

Khosla Ventures 认为 NLP 是未来五年最重要的技术趋势，市场[预计](https://finance.yahoo.com/news/natural-language-processing-nlp-market-070000969.html)将从今天的 1400 万美元增长到 2032 年的 490 亿美元，我们可以预计 NLP 方法将越来越容易使用。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>