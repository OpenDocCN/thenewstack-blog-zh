# 微服务、API 和创新:加速数字化转型

> 原文：<https://thenewstack.io/microservices-apis-and-innovation-empowering-digital-transformation-at-speed/>

[](http://amundsen.com/blog/)

 [Mike Amundsen，API 学院首席 API 架构师

Mike Amundsen 是一位国际知名的作家和演说家，他周游世界，就网络架构、Web 开发和其他主题进行咨询和演讲。作为 API 学院的架构总监，他与公司合作，就如何最好地利用 API 给消费者和企业带来的机会提供见解。](http://amundsen.com/blog/) [](http://amundsen.com/blog/)

作为 API 学院的一员，我有机会在世界各地旅行，会见在各种公司从事奇妙项目的了不起的人——从新创业公司到成熟的全球企业。令人难以置信的是，无论我在哪里，无论我在和谁交谈，许多相同的想法、实践和经历都会出现。其中三个我经常听到的是微服务、API 和创新文化。所有这些都是以推进组织数字化转型的名义进行的。

在这个系列文章中，我将分享 API Academy 对这些强大趋势的了解，以及一些公司正在使用的技术，以使数字化转型不仅仅是一个流行词。在本文中，我将重点关注公司所说的微服务对他们意味着什么，以及他们如何应用这一理念来转变组织内部的服务供应。最后，我将指出每家公司都可以做的三件事——从今天开始——来帮助团队快速、安全地构建优质服务。

## 作为工具制造的微服务

许多公司都在想办法提高他们为组织构建和部署的内部服务的速度和安全性。最新的说法是称这项工作为“微服务”无论我走到哪里，人们都说他们在“做微服务”。然而，这对每家公司意味着什么，可能会有所不同。

一些公司正在使用小型、轻量级的服务来改善他们的“上市时间”策略——他们希望让服务更快地启动和运行。其他人说他们的主要目标是重新设计他们现有的系统和减少技术债务。然而，有几家公司告诉我们，他们正在尝试构建一种应用程序级别的“基础架构”，即服务工具包，可以用作构建模块来组装成解决方案，这些解决方案可以作为产品快速部署，以满足特定需求并解决特定挑战。简而言之，他们不仅想增加速度，还想增加灵活性——轻松修改轨迹的能力——到他们的 IT 产品中。

### 微服务的一般原则

我开始称这项工作为“工具制作”当我向一些公司询问这项工作时，我从他们那里听到的一般原则看起来都有些相似:

*   构建能做好一件事的服务。
*   假设一个服务的输出将是另一个未知服务的输入。
*   设计和构建可以尽早试用的软件，最好在几周之内。
*   使用工具来减轻编程任务。

这些通常被称为微服务的特性。然而，如果你已经呆了足够长的时间，你可能还会意识到这份名单几乎与比尔·麦克洛伊 1978 年在贝尔系统技术杂志上发表的一份名单相同。这已经成为 Unix 哲学的一部分。

事实证明，我们想在公司范围内做的事情，在某些情况下是在互联网上做的事情，与 Unix(及其最受欢迎的后代 Linux)的作者为单台机器创建敏捷软件所应用的事情是一样的。规模更大，但原理是一样的。这是一个好消息，因为当我们努力将这些原则应用于我们自己的组织时，我们有 40 多年的经验可以依靠。

## 微服务的有用定义

在对 Unix 原理以及如何应用它们感到兴奋之前，有必要后退一步，讨论一下这个术语的有用定义。有很多定义(包括我和我的合著者在 2016 年奥赖利的书[“微服务架构”](http://www.apiacademy.co/resources/microservice-architecture-aligning-principles-practices-culture/)中提供的定义)。对于这个系列，我将分享一个我认为抓住了微服务和它们运行的 DevOps 环境的重要元素的例子。

### “微服务是在高度工程化的系统中运行的松散耦合的组件。”

这个定义中的两个关键要素是“松散耦合”和“高度工程化”

### 松散耦合的组件以提高速度

您如何知道您的组件是松耦合的呢？我得到的最好的答案可能是，您可以将该组件发布到产品中，而无需请求许可或安排会议来与公司内的其他部门协调。这种无需高度协调的发布能力是提高发布速度的关键之一。这意味着您设计的组件总是向后兼容以前的版本。您不需要其他团队按照您的计划采用新版本，相反，允许他们自己决定何时准备好升级到您的最新版本。当然，这也意味着您不会在发布新版本时就自动删除组件的旧版本。这就引出了第二个要素:高度工程化。

### 高度工程化的安全系统

这个定义中的短语“高度工程化”指的是在构建-测试-发布周期中尽可能自动化的 DevOps 模式。与我交谈过的许多擅长微服务的公司也投入了相当多的时间和精力来擅长开发运维。事实上，Thoughtworks 的 Martin Fowler 曾说过一句名言:DevOps 是做微服务的先决条件。

因此，工程化您的构建过程、您的测试制度和您的发布节奏都为您的服务基础设施提供了高度的安全性。本质上，自动化意味着可预测性和一致性——弹性系统的两个关键方面。您需要一个灵活、稳定的系统来部署您的微服务。这种将新代码安全发布到产品中的能力使得独立发布成为可能。

这听起来很简单，但当然不是。这是一项大工程。但是，今天你可以做一些事情，开始将你现有的编码和部署实践转变为那些擅长创建敏捷和稳定的微服务环境的公司所使用的实践。

## 你今天可以做的三件事

在你的公司擅长设计、构建和部署微服务之前，你需要做很多事情。好消息是，在开始之前，你不必全部学会。因此，考虑到这一点，您可以从今天开始做三件事，以帮助您的组织开始采用微服务实践的旅程。

### 实现构建管道

不仅可以提高发布的安全性，还可以提高服务质量的方法之一是实现持续集成/持续交付(CI/CD)管道。这意味着从团队中的某个人将代码签入到源代码控制中开始，一直到将代码发布到产品中，构建过程都是自动化的。对于这个元素，我将关注这个过程的一个小方面——包括构建过程中的代码质量和合规性检查。

好的构建工具允许您自动化的团队做的不仅仅是构建和测试——它们还使得自动化代码审查过程的许多方面成为可能。这方面的一个例子是检查代码的复杂性(每个函数有太多的代码行，循环引用等等。).自动化代码审查的另一个很好的例子是验证库的依赖性(你使用的是过时的库吗？)和数据模式(这是客户对象的最新模式吗？).团队应该能够将这种质量/有效性检查注入到构建过程中，并发出警告(该构建是黄色的，因为该库将在三个月后被否决)或构建失败(在该构建通过之前，您需要升级到 Customer Object v3)。

自动化构建——包括代码审查——可以大大提高组件的质量和安全性，甚至在它通过测试周期并进入生产之前。这是你今天能做的下一件事。

### 工程部署

今天您可以做的另一件事是开始自动化您的测试到部署周期。就像构建过程一样，自动化可以提高发布到产品中的代码的一致性和稳定性。这不仅仅意味着更好的工作台或单元测试。这意味着努力测试“更高的堆栈”,并且——只要有可能——不仅测试“快乐路径”(事情应该工作的方式),而且测试“悲伤路径”——生产中常见的出错方式。

构建期间的自动单元测试只是第一步。您还需要接受或行为测试来确认变更符合业务目标。如果没有某种程度的集成测试，任何组件都不应该发布到产品中。我合作过的大多数公司都依赖服务虚拟化工具来支持他们的集成测试。这意味着他们不需要接触生产服务就能知道他们的新组件在发布后的行为。

服务虚拟化还使得制造“坏数据”或“错误消息”来测试即将发布到生产环境中的组件的弹性成为可能。“sad 路径”的测试是在不增加微服务独立发布风险的情况下将高质量构建到您的组件中的重要部分。

### 减少在制品

为了提高系统的整体速度和安全性，你现在可以做的最重要的事情可能就是减少软件更新的工作进度。这是从某人记录一个变更请求(bug 或特性)到修复在生产中开始运行之间的时间。有些人称之为将“反馈转化为功能”或从“想法到安装”的时间。改变这个值比你能做的任何事情都更有影响。

我工作过的许多公司——尤其是大公司——都有相当严格的发布时间表。有些一年只有四次正式的产品发布。这意味着，在 2018 年，当涉及到修改你的系统时，你只有四次机会“做对”。这也意味着每一次释放都是一场高风险的赌博。

通常，发布包也很大。在一个季度发布中，您可能会有多达 150 个变更。这意味着有超过 10，000 种可能的事情会出错——仅仅在这一次发布中！失败的代价可能非常高。放弃这些改变中的一个也会带来难以置信的破坏性。

然而，通过将您的发布周期缩短到两周左右，您可以极大地降低风险并增加成功的机会。例如，两周一次的发布可能只有 5 到 10 个变化。这降低了一个版本中出现错误的几率，并提高了快速发现任何版本冲突的几率。两周一次发布甚至意味着取消一个发布的破坏性更小，因为你将有另一个机会在一周左右的时间里把它做好。

《实施精益软件开发》的作者 Tom 和 Mary Poppendieck(2006 年，Addison-Wesley)总结得很好:“你的组织需要多长时间来部署一个只涉及一行代码的变更？你是在可重复、可靠的基础上这样做的吗？”

这可能是违反直觉的，但是更频繁地发布会降低风险，并提高每个后续发布成功的可能性。这增加了对您的团队的信心，对构建过程的更好理解，以及对您正在构建的 IT 基础设施的更多信任。

## 那就是服务，那么 API 呢？

采用微服务模式来设计和构建您的组件是您可以安全地加速公司数字化转型的首要任务之一。但这仅仅是开始。一旦在您的组织中建立并运行了稳定、可靠的服务，您需要以一种在团队之间，甚至在您的组织之外，对合作伙伴和其他重要的服务消费者同样敏捷和可靠的方式来访问它们。这意味着你需要 API。因此，请继续关注，这是本系列下一期的主题。

[CA 技术公司](https://www.broadcom.com/info/aiops/docker-monitoring)赞助了这篇文章。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>