# AWS 的 Lambda@Edge 服务如何简化网络内容个性化

> 原文：<https://thenewstack.io/lambdaedge-moves-personalized-web-content-closer-norm/>

随着数字化、数据驱动、大规模分布式架构的出现，为每个用户提供更好的个性化网站内容和体验成为可能。网上冲浪可以从一开始就看起来更像个人谈话或定制的业务互动吗？

亚马逊网络服务的 Lambda@Edge 于 7 月份正式推出，旨在将无服务器边缘处理与其内容交付网络节点相集成，以便应用程序可以为每个访问的用户定制内容。

Lambda@Edge 函数提供对 URL、cookies 和标头等请求参数的读/写访问，并允许访问面向事件的源上的远程资源。总之，这些服务允许网站和应用程序开发人员构建符合每个人需求的定制响应。

Lambda@Edge locations 功能是由对亚马逊 CloudFront content delivery network service 的请求触发的，该服务是一个 [全球网络](https://aws.amazon.com/cloudfront/details/) ，覆盖 22 个国家的 79 个边缘位置和 11 个区域边缘缓存。Lambda@Edge 用户不需要支付额外的费用来将数据传输到亚马逊 CloudFront，并且能够调用 origin facing 函数上的一系列其他 AWS 服务。

## 基于 CDN 的个性化挑战

越来越多的网站对谁在访问他们进行计算猜测，以便立即提供更加个性化的上下文内容。像 Clearbit 的 Reveal API 这样的服务允许开发者使用网站或应用程序访问者的 IP 地址来识别关键属性，然后可能有助于立即定制内容。如果这样的 API 与 Lambda@Edge 基础设施一起部署，功能代码可以在靠近访问者位置的地方被触发，那么动态内容可以以可能增强访问者参与的方式提供。

决定内容交付的早期上下文信号的一个很好的例子是 [Stripe 的 API 文档](https://stripe.com/docs)。到达开发人员门户主页的访问者将会看到一个列表，其中列出了以他们的货币和国家可以使用的支付方式。开发人员可以立即看到条带集成是否适合他们的用例。

对于 Stripe 的全球架构来说，能够提供这种定制内容可能没问题，但任何其他想要提供这种环境的企业，一种方法是在用户请求之前在 CDN 节点上运行功能，以便能够在足够短的时间内向用户发送正确的 web 内容，让到达的读者感觉这是无缝的。

如果开发人员使用 Stripe 登录他们的帐户，他们会看到更多个性化的内容，这些内容可能与他们在参与和 API 消费之旅中所处的位置相匹配。Lambda@Edge 可以为任何提供 API 和开发者门户的企业提供这种定制体验。

例如，想象一下，如果一个开发人员在尝试进行 API 调用时收到一条错误消息，于是她打开了该 API 的 API 文档。使用一种识别和解析 cookies 和标题的方案，边缘的功能代码可以通过相应的重定向来立即决定提供哪些文档页面，或者创建一条个性化消息，向开发人员推荐可以帮助她解决错误的内容。

开发者门户只是一个用例:企业可以为回头客或服务客户提供个性化信息，或者向单页应用提供相关内容，从而在一系列垂直领域保持互动。

Lambda@Edge 提供了一系列工具来帮助这种个性化的 web 内容:

*   可以检查标头并编写函数，以根据用户位置和设备决定是否交付定制内容，然后可以在本地缓存这些标头响应，以进一步减少发送更多内容时的延迟。
*   HTTP 响应可以从离用户最近的 AWS CloudFront 位置动态生成，无论是定制的错误页面、为未经身份验证的用户自动生成的登录页面还是静态页面。
*   可以创建动态 URL 来避免暴露关于如何在内部管理内容的业务决策，而是作为与反映访问者如何到达网页的目录结构相匹配的漂亮 URL。
*   通过使用利用 cookies 来控制内容访问的功能，可以在边缘进行授权。用户可以第一次登录，之后边缘功能管理他们的访问。
*   可以编写 Edge 函数来引入 A/B 测试，更简单地将实时用户分成控制组，而无需提供单独的 URL。

在他的博客文章中第一次描述了这次发布(T1)，AWS 首席传道者(T2)杰夫·巴尔(T3)解释道:

*“功能全局复制，请求自动路由到最佳位置执行。您可以编写一次代码，无需任何公开的操作，就能以低延迟提供给全世界的用户。您的代码可以完全访问请求和响应，包括头、cookies、HTTP 方法(GET、HEAD 等)和 URI。除了一些限制外，它可以修改现有的标头并插入新的标头。”*

AWS 客户已经在使用 Lambda@Edge 来加快向客户安全交付内容的速度。波特兰的加密软件公司 Tozny 使用 AWS S3 和 CloudFront 来存储静态脚本和 HTML/CSS 数据。通过使用 Lambda@Edge，他们在通过 CloudFront 交付给客户的所有内容上使用安全头。Lambda@Edge 函数添加了内容安全策略、严格传输安全和 XSS 保护的标头，以便用户数据在浏览器或移动应用程序中加密，存储为加密数据，然后在经过身份验证的最终用户的客户端中解密后作为 JSON 对象进行访问。“Lambda@Edge 帮助我们实现了基于浏览器的尖端加密产品的规模和安全性，”首席执行官 Isaac Potoczny-Jones 在亚马逊材料中表示。

当然，过多的个性化也有危险。在社交媒体新闻源中，算法可能会不断地从你想听到的角度向你发送你想听到的新闻，而不是分享对整个世界的各种观点和观点。音乐发现算法可能会通过每周不断推荐同一类型的歌曲来缩小你的收听品味，忽略可能吸引人的新品味和口味。一个针对每个人的个性化网络失去了发现的兴奋感，也扼杀了好奇心和快乐巧合能够开花结果的环境。

但在某些特定领域，尤其是个人和企业之间的对话，如开发人员和 API 开发人员门户之间的对话，或者客户和供应商/零售商之间的对话，个性化 web 内容可以加快可用性，就像最终用户现在希望 CRM 连接到支持台一样，这样他们就不必重复他们联系聊天机器人或应用内服务台的原因。将边缘功能、cdn 和上下文内容结合在一起，可以为访问者登陆的任何网站创建应用内和聊天机器人消息体验。

专题图片:Andreas Selter 在 [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>