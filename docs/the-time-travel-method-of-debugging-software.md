# 调试软件的时间旅行法

> 原文：<https://thenewstack.io/the-time-travel-method-of-debugging-software/>

开发无缝运行的程序不是一项线性任务。代码越复杂，工程师潜在要处理的错误就越多。研究表明，软件开发人员花 35-50%的时间进行调试。

[杰森·林泓](https://www.linkedin.com/in/jason-laster-6657167/)，软件工程师，初创公司 [Replay.io](https://www.replay.io/) 的创始人，注意到了开发人员在调试时面临的困境。“早在 2016 年，我就加入了 Firefox，从事 Firefox 开发工具调试器的工作。我想让调试变得更容易，但我不断遇到开发者发现断点的问题，”林泓在接受新堆栈采访时说。“使调试更容易的方法是，让调试看起来更像是在代码中添加一条打印语句，然后查看控制台日志。”

所以林泓试图解决的问题是，如何让调试更直观？他总结道，做到这一点的方法是让开发人员“能够在调试时添加打印语句”他将这比作时间旅行，指出“这是每日记录——一些事情发生一次，然后能够重放它，然后添加那些打印声明，并在控制台上看到它们。”

Replay.io 最初是林泓和首席技术官布莱恩·哈克特(Brian Hackett)最喜欢的项目，但很快被火狐采纳。根据林泓的说法，工程师和团队其他成员之间的交流是“消除调试和开发人员之间的摩擦”的一部分。

GTM 负责人 Oliver de Albuquerque 补充道:“你实际上再也不用复制一个 bug 了。你可以在重播时录下来，然后分享网址链接。”

## **时间旅行的吸引力**

反向调试或时间旅行调试是大多数开发人员已经熟悉的概念。虽然不同的工具有不同的名称和特性，但都归结为同一个想法:记录整个浏览器会话，以便您可以及时查看应用程序的整个状态并进行追溯调试。

传统的调试通常是有根据的猜测和应用逻辑的混合。即使它有效，一行一行地检查代码，并不总是有效的。但是根据德·阿尔布开克的说法，在某些情况下，时间旅行调试是非常有用的。

*回放演示*

德阿尔布克尔克说:“Stripe 发表了一项有趣的研究，名为开发人员系数研究，有一项调查强调，一周内有近一半的开发人员的时间花在了糟糕的代码、调试、重构、修改上。我们已经看到开发团队使用 Replay 来显著减少这些活动中的生产力损失。"

“调试问题确实是人们倾向于锁定的第一个实际用例，”他继续说道，“因为这是许多开发人员每天都要处理的一个真正的问题。”

## **编程难度降低**

杰森·林泓希望通过消除人们对编程挑战性的先入为主的观念，来揭开编程的神秘面纱。“我们的目标是让软件更加平易近人，”他说。“我们希望更多的人觉得他们可以编程，做不需要数学学位的事情。”

他接着说，“想象一下，作为一个项目经理，你问你的工程师为什么东西坏了，得到的是一个很长的解释，仍然没有回答你的问题。使用 Replay，他们可以与工程师共享 URL，工程师可以直接进入并留下评论。现在，项目经理可以识别该功能，并自己找出问题所在。如果沿途的任何人都可以用重播来记录问题，那么下游的每个人都可以查看重播，调试它，并确切地看到哪里出了问题。”

林泓承认很容易将 Replay 误认为是另一种会话重放工具，他解释了 Replay 的不同之处。“在光谱的一端，您有类似于录像机的东西，然后沿着光谱再往前一点，您有类似于会话重放工具和可观察性工具的东西。那些类型的工具给你一些关于应用程序如何运行的数据，但是你不能在可观察性工具中调试。如果更进一步，您可以使用 Chrome Dev tools 和 Firefox tools 等工具来调试 Elements panel 或 network、network monitor 或 console.log 断点集中的元素。有了 Replay.io，你可以记录你的网站，重放它，深入代码行——并通过与你的团队甚至你的用户协作的方式做到这一点。”

## **开发者浏览器**

Replay 的开发者工具是用 React 构建的。它的后端兼容多种运行时，这是项目开始时的目标。

在[的一篇博客文章](https://medium.com/replay-io/launching-replay-the-time-travel-debugger-for-the-web-f886f0897d38)中，林泓写道“我们的目标是运行时可重复:我们应该能够彻底理解我们的软件，不管它在哪里运行，也不管它是用什么语言编写的。专注于一个浏览器会更简单，但我们从一开始就设计了 Replay 的记录器，可以在一系列运行时和平台上工作。”

根据林泓的说法，他们的录音机实际上是一个浏览器。

“所以当有人录制时，”他继续说道，“他们运行的是我们的火狐分叉版和我们的 Chrome 版本。此外，我们正在添加像 Cypress 和剧作家这样的 CI 集成，以便您可以在回放中记录您的自动化测试，从而大大提高制作前的生产力。”

林泓接着详细讲述了制作重播所涉及的程序设计。“我写了至少一百行内嵌汇编代码，用来拦截浏览器发出的低级系统调用。分配内存，打开一个套接字，读写一个文件——诸如此类的事情。我们把它录下来，然后当你在看回放的时候，我们用那个用来录像的浏览器，下载录像，把录像给你，它以为它在正常的电脑上运行，但它只是在模拟中运行，有点像。比如黑客帝国。”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>