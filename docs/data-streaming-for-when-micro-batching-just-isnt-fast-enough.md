# 数据流，当微批处理不够快时

> 原文：<https://thenewstack.io/data-streaming-for-when-micro-batching-just-isnt-fast-enough/>

微批处理尽可能接近实时，在某些情况下，当运行在与更长延迟批处理系统相同的基础设施上时，允许仅几分钟的延迟。但它只能做这么多。

转移到[数据流](https://thenewstack.io/what-is-data-streaming/)的最佳时间是什么时候？回顾过去，说“流媒体是一个很好的选择”很容易，但实际上对新技术进行投资要困难得多。

回到 10 月，我有幸参加了一场辩论“如果流式传输是答案，为什么我们还在做批处理？”在[汇流](https://www.confluent.io/?utm_content=inline-mention)的[本届 2022](https://thenewstack.io/confluent-have-we-entered-the-age-of-streaming/) 大会上。

由汇合公司开发者关系主管[克里斯·詹金斯](https://www.linkedin.com/in/krisjenkins/)主持，小组讨论包括[dbt 实验室](https://www.linkedin.com/in/yuanamychen/)合作伙伴工程经理陈彦蓉； [Adi Polak](https://www.linkedin.com/in/polak-adi/) ，Treeverse[的开发者体验副总裁](https://lakefs.io/)；[泰勒·阿基多](https://www.linkedin.com/in/takidau/)，雪花[的首席软件工程师](https://www.snowflake.com/?utm_content=inline-mention)；以及[可解码](https://www.linkedin.com/in/esammer/)的首席执行官埃里克·萨默。

这个演讲，现在可以在这里观看，涵盖了几个充满争论和矛盾的观点。

## **微批处理:不是脏话**

无论别人怎么说，微批处理都不是欺骗，但它有严重的局限性，而且它不是实时流系统。微批处理是一种低延迟的批处理系统，在某些情况下可以在几分钟内发送批处理数据。

陈解释说，“人们正在建立微批量，以刺激一个非常类似的流媒体效果。”她详细介绍了现场拍卖领域的一位客户。“他们之所以决定进行微批量生产，是因为这样更容易。他们可以在与批处理相同的基础设施上完成这项工作。”

但她也向这位特定客户承认，微批处理可能不是最佳用例，“他们只是运行它，但在这些情况下，需要更低的延迟。  你不应该像以前那样等待两分钟才能获得[低于]的服务水平协议。”

这个特殊的用例通过微批处理实现了这一切。优点:相同的基础设施和熟悉的框架和工作流意味着公司不必提供新的供应商。除了延迟之外，没有什么真正的变化。另一方面，微批处理只能走这么快，它没有很好的规模。

微批处理有一个时间点，超过了它的使用寿命。对此陈表示，“说到底就变成了劳动密集型对资源密集型的对话。我们注意到，随着人们开始进行更多的微批处理，但随着数据规模的扩大，它只会变得过于昂贵。”

## **使用案例——过去、现在和未来**

回顾过去并说，“哦，是的，这是流媒体的一个完美用例，”当然比推动市场前进或创造一个新的市场更容易。以高频交易为例。“在某种程度上，彭博终端变得越来越快，”Sammer 解释说，“然后最终有人会说，‘我们为什么不把它变成一个软件应用呢？’于是高频交易诞生了。“最初的对话可能并不容易。

陈将这一对话带入了更近的过去——一个为非技术利益相关者创建的实时仪表板，用于做出实时决策。她最初的想法是，“你不需要实时仪表盘。”但是在假日周末，当仪表板活跃而技术人员不活跃时，优惠券网站 [PayPal Honey](https://www.joinhoney.com/) 出现了一张错误的 1000.00 美元优惠券。

客户下了三个小时的订单，但后来订单被取消了。但是利益相关者的实时决策能力使损失最小化。对于利益相关者来说，这可能是最好的实时仪表板广告活动之一。

那么它是什么:流还是批处理？

好吧。都是。许多客户希望实时，但批处理不会很快消失，如果有的话。

Akidau 经常遇到想要实时的客户，但当他解释实时系统与批处理系统的成本和复杂性时，最终意识到他们不需要实时。客户的需求与他们的实际需求的对比表明，“实际上并没有太多的用例需要分钟以下的延迟，”他在谈到流媒体用例时表示，但他也认为，“有这样的用例很好。”

那么，如何确定实时是一种需要还是一种需要呢？阿基多说，这取决于他们如何回答这个问题，“你需要多快采取行动？”他为这两种情况都提供了一个模板，“如果它是交互式的，或者如果这需要以交易方式发生，这就是实时流有意义的情况。除此之外的任何东西，你可能不需要那种延迟。”

## **科技引力**

Polak 引用了技术重力来解释为什么流媒体仍然是一个艰难的过程。[数据引力](https://thenewstack.io/vendor-lock-in-and-data-gravity-challenges/)，更广泛的理解，是一个数据体吸引其他数据的能力。如果客户对雪花感到满意，那么很可能会有更多的客户使用雪花来管理他们的数据。

按照这种逻辑，技术重心是相似的，但在护栏和流程方面，支持和实施更健康数据的最佳实践。Polak 说，“问题是，什么工具将使我们仍然能够在不同的团队中工作于相对相似的方面。”

技术引力的概念坚持这样的观点，即现有的技能会比整个团队学习全新的技能更能推动开发团队前进。

关于流栈的细节和 Sammer 关于流“怪异”的评论遵循了技术引力的逻辑。Sammer 坚信流媒体将占据中心位置，他说解决方案是创建一个“共享的概念模型、模式和时间”他建议统一所有不一定是特定于流或批处理的概念。

Sammer 说，“概念的规范化、严格的 API 定义以及与数据质量相关的工具对于流和批处理来说不应该有所不同。”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>