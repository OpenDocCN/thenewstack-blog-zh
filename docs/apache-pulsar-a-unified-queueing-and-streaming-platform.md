# Apache Pulsar:一个统一的排队和流平台

> 原文：<https://thenewstack.io/apache-pulsar-a-unified-queueing-and-streaming-platform/>

[](https://twitter.com/addisonjh)

 [艾迪森·海厄姆

艾迪森·海厄姆是 StreamNative 的首席架构师，他帮助客户解决棘手的数据挑战。Addison 加入 Pulsar 社区已有三年半时间，是 Apache Pulsar 委员会成员，在他职业生涯的最后七年里一直参与流媒体生态系统。](https://twitter.com/addisonjh) [](https://twitter.com/addisonjh)

这里有一个大胆的声明——所有迹象表明，Apache Pulsar 开源分布式消息传递系统正在迅速抓住现代应用程序架构和开发的时代精神。

那么我们在这里谈论什么？让我们来布置舞台。

随着工程团队着手解决越来越复杂的挑战，解决问题所需的技术和工具也在不断发展。工程工具箱中的一个常用工具是消息传递。

消息传递基于可靠消息队列的概念，其中消息在客户端应用程序之间异步排队，而“代理”充当应用程序之间的中介。

在早期，代理非常简单，但是随着需求的变化，消息传递系统也发生了变化。分布式消息传递系统建立在这个概念的基础上，提供了可靠性、可伸缩性和持久性的好处，多个代理可以帮助分配负载。

大多数分布式消息传递系统支持两种语义类型之一:流式和排队。从历史上看，每一种都最适合特定的用例。Apache Pulsar 的独特之处在于它支持流和队列用例。

在探索使用统一的流和队列平台的优势之前，最好退一步，分别研究一下队列和流技术。

流媒体平台是行业中相对较新的创新，对于以有序、相对低延迟的方式移动大量数据非常有用。流媒体平台是移动数据(如日志、指标、点击数据等)的理想平台。)并将它集中到一个位置，并以高并行性和吞吐量来完成。

例如，想象一下从大型云部署中的 10，000 台机器获取点击或指标数据——流媒体平台有助于实现这一点。

排队平台在某种意义上有点类似于流平台，它是将系统连接在一起。然而，排队系统已经存在了很长时间，并且更多时候是点对点通信，允许广泛的应用程序交换信息。

两个系统之间的访问模式也不同。流系统专注于按顺序到达的消息，并处理一起处理的消息组，可能是为了聚合或转换数据。

相比之下，在排队系统中，通常一次处理一个事件，就像在工作队列中，每个消息可能代表一些特定的“任务”换句话说，虽然流式传输是为了成组地移动和处理大量数据，但排队通常是对单个消息的粒度处理，以促进系统中的一些工作。

最常见的流媒体平台是阿帕奇卡夫卡和 T2 亚马逊网络服务。最常见的排队系统包括 RabbitMQ 和 ActiveMQ。在云端，还有谷歌发布/订阅、AWS SQS 和社交网络。

## **阿帕奇 Pulsar 统一排队和流**

首先，简短的历史课。

Pulsar 最初是在 2010 年左右在雅虎内部开发的，当时需要对非常大规模的工作负载进行排队。雅虎的服务非常庞大，分布在许多不同的团队和数据中心。

当时，他们使用 Java 消息服务(JMS)，这是 Java 社区中的一个标准。Yahoo 需要一个可以促进 JMS 风格的工作负载的系统，但是它是以一种更加分布式可伸缩的方式设计的。

虽然 API 最初专注于消息工作负载，但该系统的架构也使其成为流工作负载的理想候选，允许雅虎团队在广泛的用例中非常灵活地使用该系统。

这项被称为“云信息服务”的服务在雅虎非常成功。它在雅虎内部继续开发，并于 2016 年[开源](https://pulsar.apache.org/)为 Pulsar。2018 年，该项目成为 Apache 软件基金会的顶级项目。从那时起，Pulsar 的采用量迅速增长。许多组织，如 Yahoo，都需要一个更具伸缩性的消息传递解决方案。

虽然像 Apache Kafka 这样的流系统能够扩展(围绕数据重新平衡需要大量的手动工作),但流 API 的功能并不总是合适的。它要求开发人员解决纯流模型的局限性，同时还要求开发人员学习一种新的思维和设计方式，这使得采用消息传递用例变得更加困难。

有了脉冲星，情况就不同了。开发人员可以使用熟悉的 API，以熟悉的方式工作，同时提供更多的可伸缩性和流媒体系统的功能。

对可伸缩消息传递和流消息传递的需求是我在 Instructure 的团队面临的一个挑战。为了解决这个问题，我们发现了脉冲星。

在 Instructure，我们正在处理需要更大规模消息传递的大规模情况。最初，我们试图通过围绕流媒体技术进行重新架构来实现这一点。然后，我们发现 Apache Pulsar 非常适合帮助团队获得他们需要的功能，但没有围绕基于流的模型重新架构的复杂性。

当 Instructure 的团队开始使用 Pulsar 时，他们立即看到了它的好处，并被广泛采用。Pulsar at Instructure 的采用使得应用程序之间的通信以及我们在团队之间共享数据变得更加容易。

然而，Pulsar 解决的不仅仅是消息工作负载，流媒体是大多数组织的真实需求，在这里，Pulsar 提供了一个比其他流媒体技术更容易使用、操作和集成的系统。

例如，Pulsar 易于扩展，当您需要增加集群规模时，无需“重新平衡”集群。它提供了对多租户和数百万主题的支持，而不会遭受延迟的大幅增加，这使得许多团队可以轻松地共享同一个集群。

这意味着组织不需要在他们自己的工具上投入大量精力，相反，他们可以专注于从消息和数据中获取价值，而不是管理基础设施。

对于 [Iterable](https://iterable.com/) (提供跨渠道营销平台)，Pulsar 提供了可扩展性、可靠性和功能的适当平衡，以取代 RabbitMQ，并最终取代其其他消息系统，包括 Kafka 和亚马逊 SQS。[正如 Iterable 的 Greg Methvin 指出的](https://www.infoq.com/articles/pulsar-customer-engagement-platform/)，Apache Pulsar 不仅非常适合流式工作负载，他们还发现 Pulsar 非常适合他们的排队需求。

## **阿帕奇脉冲星的好处**

正如那些已经采用 Apache Pulsar 的人可能已经发现的那样，它提供了比诸如 [Red Hat](https://www.openshift.com/try?utm_content=inline-mention) 的 RabbitMQ 或 ActiveMQ 之类的系统更可扩展的消息队列功能，以及更可扩展和更易于使用的流功能，具有诸如地理复制和多租户之类的内置功能。

还有！额外的好处是基于简单的数学。一个统一的流和排队平台比拥有单独的流和排队技术少一项技术。有了一项技术，就可以更容易地开发产品并将其推向市场，并从组织已经拥有的数据中获得更多的效用。

除了两种独立技术增加的 IT 成本和支出之外，它们没有很好地集成，这导致了数据孤岛。而当您有一个统一的系统时，您可以处理更多的事情，包括您正在构建的数据和您的应用程序、您的排队数据、数据分析、流系统，所有这些都在同一个底层系统中。

不需要将数据导出到另一个系统或团队，因为组织基于一种中央技术和一个贯穿其整个生命周期的数据中央存储。有了 Apache Pulsar，用户不再需要手动处理数据生命周期的不同阶段。有了 Apache Pulsar，由于数据来回移动的方式，架构得到了简化。

正如 Iterable 的员工工程师 Greg Methvin [完美地总结了这一点](https://www.infoq.com/articles/pulsar-customer-engagement-platform/)说:“Pulsar 是独一无二的，因为它支持流和队列用例，同时还支持广泛的功能集，这使它成为我们架构中当前使用的许多其他分布式消息传递技术的可行替代方案。Pulsar 涵盖了 Kafka、RabbitMQ 和 SQS 的所有用例。这使我们能够专注于围绕单个统一系统构建专业知识和工具。”

显然，有了阿帕奇脉冲星，你就可以鱼与熊掌兼得了。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>