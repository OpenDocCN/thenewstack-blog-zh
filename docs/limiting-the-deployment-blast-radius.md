# 限制爆炸半径

> 原文：<https://thenewstack.io/limiting-the-deployment-blast-radius/>

复杂的应用程序环境通常需要部署来保持顺利运行。但部署，尤其是微服务更新，可能会有风险，因为你永远不知道会出什么问题。

在本文中，我们将解释部署中可能出现的问题，以及您可以做些什么来限制爆炸半径。

## 什么是爆炸半径？

爆炸半径是爆炸周围可能发生破坏的区域。在部署环境中，爆炸半径是部署可能产生潜在影响的区域。

例如，如果你在你的网站上部署一个新功能，爆炸半径可能就是网站本身。但是，如果您正在部署一个新的数据库模式，爆炸半径可能是数据库和所有使用它的应用程序。部署的问题是他们通常有一个无限的爆炸半径。

虽然我们总是希望有一定的爆炸半径，但无限的爆炸半径意味着任何事情都可能出错并引发问题。那很糟糕。

## **什么导致爆炸伤害？**

### **计划不周**

仓促开发和计划的部署通常是无限爆炸半径的主要原因。当你匆忙进行部署时，你更有可能犯错误。这些错误可能包括忘记更新文档、意外破坏生产中的某些东西，或者没有给其他相关方(如依赖服务所有者)一个反映和响应部署的机会。

### **沟通不畅**

你有没有被疯狂的电话吵醒，说你的应用程序无法工作，却发现另一个团队进行了计划外的部署，并且没有通知你它正在进行？我有。

没有给他们足够的时间准备就告诉他们正在部署是另一个麻烦的来源。不沟通是导致灾难的原因。

### **缺乏测试**

要限制部署的爆炸半径，最重要的事情之一就是在将部署推向生产之前对其进行全面测试。这意味着在尽可能接近生产环境的试运行环境中进行测试。这也意味着做像单元测试和端到端测试这样的事情。

通过在部署代码之前对其进行彻底的测试，您可以捕捉任何潜在的问题，并在它们导致生产中的问题之前修复它们。

### **要求不完整或不明确**

如果您的开发人员不得不猜测需求是什么，他们很可能也没有一个清晰的测试计划。不明确的需求会导致代码在开发中有效，但在生产中却失效。此外，它还会导致代码不能很好地与其他系统兼容。这也可能导致功能不符合用户的需求。

为了避免这种情况，在开始开发之前，确保您有一个清晰完整的需求集。精确的需求将有助于确保您的开发人员了解他们需要构建什么，并且他们可以在部署之前对其进行适当的测试。

### **配置错误**

部署出错最常见的原因是配置发生变化。例如，您可能更改了数据库设置，却忘记了更新应用程序。或者，你可能会改变你的网站服务方式，断开与所有其他网站的链接。配置更改通常是部署出错的原因，因为它们会影响系统的许多不同部分。

### **人类的失败**

人类会累，会犯错误，会忘记事情。当部署一个复杂的系统时，有很大的出错空间。即使是最有经验的工程师也会犯错误。

### **环境平价问题**

有时，在混乱的生产支持世界中，事情会在生产中发生变化，并且不会影响到测试和开发环境。当你去部署时，环境的不平等会导致问题。您的应用程序可能无法在新环境中工作，或者您可能没有所有必需的文件和配置。或者，环境中有一些可怕的东西没有经过测试，没有人知道它们为什么会在那里。

### **软件问题**

最后，软件本身也可能出错。软件是复杂的，通常很难预测它在不同环境下的行为。例如，您可能在开发环境中测试您的软件，并且它运行良好。但是当您将它部署到生产中时，可能会有意想不到的后果。例如，如果您的代码是“意大利面条”，并且是紧密耦合的或难以维护的，那么您可能在部署方面有问题。

很多事情都可能出错！但是如果有方法可以限制爆炸半径呢？

## **如何限制爆炸半径**

有几种方法可以限制爆炸半径。

### **计划和进度**

通过建立常规的部署节奏和流程，帮助您的团队取得成功。一致性将最大限度地减少人为错误的可能性。

当每个人都知道什么时候应该进行部署，或者在出现特殊情况时应该做什么时，您的部署将会更加顺利。你还应该计划如果出了问题该怎么办。可以回滚吗？有备份吗？

### **过度沟通**

规划部署的一部分是确保所有负责和受影响的各方都被充分告知，并有时间进行审查、思考和响应。沟通包括向所有用户发送电子邮件，通知他们即将到来的部署，并告诉他们会发生什么。此外，这意味着与将要进行部署的人员进行交流。给他们足够的时间来准备、回顾、练习和清理他们的日程表。宁可提供过多的信息，也不要提供过少的信息。

### **了解风险**

最重要的准备方式是了解你的风险。首先，您需要知道什么可能出错，以及它将如何影响您的系统。只有这样，你才能采取措施防止它发生。

### **自动化一切**

限制爆炸半径的另一种方法是尽可能多地自动化部署过程。如果有可以自动化的事情，那就去做。例如，自动化部署将有助于确保一致性和准确性。这样，你可以确保所有的东西都被覆盖，都被正确地完成，并且你不会忘记任何东西。

有许多不同的工具可以帮助您自动化部署。选择最符合您需求的一个，然后尽可能多地自动化这个过程。

### **使用内部开发者门户**

最后，使用内部开发人员门户。一个内部开发者门户组织了你可能需要的大部分信息来帮助限制爆炸半径。

例如，它可以帮助您了解依赖于您的服务的下游服务，识别这些服务的所有者，查找相关文档，并在一个地方可视化关于这些服务的关键指标。这使您能够在部署之前知道与谁通信以及如何联系，提供关于那些下游服务如何工作的上下文，并提供在测试期间监视那些服务的地方(假设您的内部开发人员门户在环境级别上是基础设施感知的)。

内部开发人员工具还可以通过提供对版本控制信息的访问来帮助您了解风险，这些信息使您能够访问更改了什么、何时更改的以及由谁更改的。这样，您可以识别任何可能引入风险的更改，并采取措施降低风险。

一个这样的部署管理工具是[配置 8](https://www.configure8.io?utm_source=TNS&utm_medium=content&utm_campaign=blastradius) 。它将帮助您了解您的部署的爆炸半径，并限制潜在的后果，确保您的部署运行更加平稳、完美。它使您的团队能够回答以下问题:

*   谁拥有这项服务？
*   谁需要这项服务？
*   上次部署中有什么？
*   哪些应用程序依赖于该服务，它们的任务关键程度如何？
*   服务的健康状况如何，包括环境级别的监控？
*   上次有人更新服务是什么时候？

详细了解您的工程团队如何从配置 8 中受益，以及它如何帮助您限制部署的爆炸半径。你可以在这里查看。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>