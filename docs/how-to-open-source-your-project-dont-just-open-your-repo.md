# 如何开源你的项目:不要只开放你的回购！

> 原文：<https://thenewstack.io/how-to-open-source-your-project-dont-just-open-your-repo/>

4 月 1 日，我们宣布发布 StackRox 社区平台。这是我们团队将 StackRox 流行的专有安全平台转变为开源平台的大量工作的结果。

 [马蒂亚斯·梅丁格

Matthias 是高级集群安全团队的一名软件工程师，主要从事产品开发和开源工作。他也是上游开源项目 StackRox 的社区经理之一。在担任当前职务之前，他为 VMRay 的研究和恶意软件搜索提供基础架构、工具和自动化。工作之余，马蒂亚斯喜欢摄影和旅行。](https://www.linkedin.com/in/matthias-m-7866457a/) 

将项目从私有开发转变为公共开发不仅仅意味着改变 GitHub 库的可见性。有一个过渡计划是必要的，特别是如果目标是建立一个繁荣的社区，用户可以在那里成长和利用平台。

为了获得最大的成功机会，项目的目标和社区的目标应该尽可能一致。

对于 StackRox 团队来说，我们的最高目标之一是为贡献者和社区用户设置尽可能低的准入门槛。我个人认为这是一个巨大的挑战。

为工程师量身定制您的环境是一回事，希望提供全面的、有指导的入职体验。为更大的开发人员、操作人员和安全人员社区创建一个论坛是一个完全不同的挑战。

## 第一部分:你的产品和你的工程团队

### 我们开源什么？

如果你看一下 StackRox GitHub 组织，你会发现大量的存储库，平台包括许多不同的组件和特性，可以保持私有。然而，我们选择彻底，并采取额外的时间。我们决定开放完整的平台及其所有依赖项，包括我们在新安装时提供的开箱即用的策略规则集，以及预构建的 Docker 映像和舵图，以尽可能简化开源部署。

### 我们使用什么许可证？

当打开您的源代码时，第一个任务应该是选择一个适合您的用例的许可证。在大多数情况下，建议将您的法律部门包括在讨论中，GitHub 有许多很好的资源来帮助您完成这个过程。对于 StackRox，我们将自己定位于类似的 Red Hat 和流行的开源项目，并尽可能选择 Apache 2.0。

### 人们如何访问它？

在你决定了打开哪些部分以及如何打开之后，下一个问题是，你如何让它可用？

除了源代码本身，对于 StackRox 来说，还有 Docker 镜像，如前所述。这意味着我们也向公众开放 CI 流程。为了做到这一点，我强烈建议您重新审视您的 CI 流程。假设任何不安全的配置都会被用来对付你。审查内部 CI 流程的常见模式，如凭据、服务帐户、部署密钥或存储访问。

此外，应该非常清楚谁可以触发 CI 运行，因为您的 CI 信用/资源通常非常有限，并且 CI 集成会运行 cryptominers 或其他有害软件。

### 我们如何管理它？

StackRox 构建为上游公共构建，而 Red Hat Advanced Cluster Security(RHA cs)构建在内部 Red Hat 构建系统上。倾向于两个不同的构建管道自然会带来一些开销，因为这个项目的开源和商业风格各有不同的需求。

如果一切顺利，您的 CI 成功了，您很可能会得到一些工件——发布二进制文件、tgz 文件或 Docker 映像。

### 我们如何分配它？

公开这些人工制品以降低准入门槛至关重要。

对于 StackRox，我们决定将构建的图像推送给位于[码头](https://quay.io/stackrox-io)的公共组织。或者，您可以使用 GitHub 的发布特性或其他公共发布渠道，这取决于您的发布工件类型，如 NPM、PyPI、Crates。发布之后，下一步将是用户下载这些工件并运行您的产品。这就把我们带到了下一个重要的问题。

### 我们如何记录它？

项目文档是您的项目的公开表示，邀请用户和贡献者参加。潜在用户通常会首先查阅您的文档，以判断您的项目是否适合他们的用例，并了解如何最有效地使用它。编写文档的目的是向社区传达信息，同时最大限度地减少用户的困惑，澄清 GitHub 存储库中的问题。

请记住，面向操作人员和开发人员的文档是两码事。例如:

运营商对部署、配置、平台维护、数据保存、更新和灾难恢复感兴趣。开发人员对建立开发环境(IDE、本地部署、调试版本等)感兴趣。)并获得详细的 API 描述。

> 请记住，面向操作人员和开发人员的文档是两码事。

这两种目标受众都从“入门”指南中受益匪浅，无论是如何启动和运行您的第一次部署(操作员)，还是如何完成代码库中的日常扩展任务(开发人员)。

因为 StackRox 是 RHACS 的上游，我们决定将我们的文档工作集中在开发人员身上，因为有相当多的[用户定制的文档可用](https://docs.openshift.com/acs/)。带有 StackRox 品牌的开源特定用户文档是我们现在正在计划的一个项目。

我们开发人员定制的文档在主项目的 README 和 stackrox/dev-docs 中进行了扩展。后者是一个降价指南的集合，最初是作为私人的合流文章开始的。这个收藏一直在增长，特别是当我们从贡献者那里得到更多关于他们想看哪些指南的反馈时。这也是一项持续的工作，旨在迁移第一次迁移中可能遗漏的其他指南和操作方法，或者因为包含私人信息而未发布的指南和操作方法。

### 我们如何管理隐私？

说到私有信息:由于 git 的性质，项目的完整历史将是公开的，从第一次提交到您发布的存储库开始。这也适用于您的项目在一段时间内收集的任何问题、讨论和拉动请求。虽然这对于内部开发来说不是问题，但在上市时会带来相当大的问题。

> 强烈建议您查看您在 GitHub 或其他 git 存储库上的所有问题和评论，并从项目的 git 历史中寻找任何不打算公开使用的信息或参考。

强烈建议您查看您在 GitHub 或其他 git 存储库上的所有问题和评论，并从项目的 git 历史中寻找任何不打算公开使用的信息或参考。这些信息不一定要公开才能被认为是开源的，但它确实为未来的用户增加了上下文，所以您可能希望尽可能完整地保留这些信息。

一个快速简单的方法是从 GitHub 上的一个新项目开始，然后抛弃你的 git 历史。然而，这带来了许多问题。

您的工程团队失去了他们工作、解决问题和讨论的历史，而这些都是宝贵的资源。此外，这一步必须被很好地计划，并且工程团队必须是知情的——如果一个人将他们旧的 git 历史推送到您的新项目，完整的历史将会再次被访问。

### 我们如何处理简历？

谈到可见性:如果你处理 CVE/禁运的工作，你将需要一个适当的工作流程。由于您的存储库是公共的，您不能简单地使用公共特性分支来完成这种工作。例如，GitHub 提供了临时私有分叉的选项来解决安全问题。

### 我们如何照顾我们的员工？

最后但同样重要的是:正如已经提到的，在所有这些任务中，你应该注意让你的工程团队一直参与进来。

Red Hat Advanced Cluster Security(RHACS)工程团队在一个设计文档驱动的流程中工作，在该流程中，所有重大变更都通过共享文档和讨论在整个工程团队之间进行讨论，包括书面(文档注释)和口头(评审会议)。

在发布前的几个月里，我们进行了多次讨论，试图找到团队满意的解决方案、工作流程和方法。

由于工程团队仍将是项目的主要驱动力，他们应该知道一旦开放，他们的日常工作会有什么变化。

此外，这也是外部开放源码软件最初贡献的绝佳机会。如果您使用特定于产品的补丁维护私有分支，这是通过向原始上游项目提供这些更改而大放异彩的机会。

对我们的工程师来说，变化不大。他们仍然主要在上游存储库中工作，主要区别是所有的拉请求和它们的讨论现在都是公开可见的。这种变化意味着团队需要注意他们如何沟通，即使是在内部，因为所有的评论都可以被外部的人看到，这些人可能缺乏你的团队所拥有的背景或共同的幽默。

## 第二部分:社区、协作、背景

### 我们如何进行健康的讨论？

随着受众的增长，制定清晰的规则为每个人创造一个安全的参与环境至关重要。一种常见的方法是定义行为准则(CoC ),该准则规定了一些不允许的社区互动的基本准则。我们决定坚持完善的框架，并以贡献者契约为基础制定我们的 CoC。

### 我们如何帮助保持健康的讨论？

如果没有人来执行，最好的 CoC 定义也没有用。这意味着我们需要为 CoC 委员会寻找志愿者，并对他们进行相应的培训。委员会成员应公开并开放交流，以便在出现任何问题时可以联系他们。

我们通过在我们的[社区网站](https://www.stackrox.io/code-conduct/)上发布 CoC 和委员会成员来做到这一点。

> 随着受众的增长，制定清晰的规则为每个人创造一个安全的参与环境至关重要。

### 我们可以在哪里与社区交流？

此时，您应该知道您的开源上线的目标和预期的目标受众。这些问题的答案决定了你如何与你的社区互动。使用你能接触到的所有渠道，但是在今天众多可用的讨论媒介中选择一个，比如 Slack、Discord、邮件列表、论坛或矩阵。

StackRox 社区目前生活在#stackrox 频道的 CNCF Slack 工作区。

### 我们如何接受捐款？

你从贡献者那里接受的东西要清晰简洁。仅仅是讨论中的反馈吗？你在 GitHub 上接受问题或拉请求吗？如果是这样，建议以`CONTRIBUTING.md`文档或问题/请购单模板的形式提供指南以供填写。

如果你决定接受这些，这也有助于让人们大致了解你的反应时间。此外，确保有适当的流程来决定由谁来关注新项目。

例如，我们传达我们的目标是在一周内对新问题和 PRs 进行分类，在我们的月度会议上传达更详细的讨论和决策。

### 我们将如何与社区见面？

定期的公开会议降低了参与的门槛，并允许有效地提出问题。任何感兴趣的贡献者都可以很快停下来与您的项目取得联系。

目前，我们在每个月的第二个星期二，太平洋标准时间上午 9 点，美国东部时间下午 12 点，格林威治时间下午 5 点，召开 StackRox 社区会议。您可以通过将 community@stackrox.com 日历添加到您的日历来订阅活动。

在这些会议中，我们讨论并展示即将推出的功能的演示，讨论未解决的问题，展示指南和操作方法，并为社区提供一个公开的问答论坛。

## 第三部分:轮到你了

在过去的一年半时间里，我们努力为您带来一个完整的开源 Kubernetes 安全平台。我们的下一步是帮助强化尽可能多的容器工作负载。为了实现这个目标，我们需要用户的反馈。我们希望在我们的 Slack 频道看到你，主演 GitHub 库，成为我们每月的“RoxStar”

如果您有任何问题或想为 StackRox 做贡献，请到 CNCF 休闲区或参加下一次社区会议！

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>