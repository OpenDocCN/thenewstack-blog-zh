# 12 因素应用程序方法如何简化应用程序开发

> 原文：<https://thenewstack.io/12-factor-app-streamlines-application-development/>

“当你没有好的过程和平台来帮助你时，好的代码就会失败。当你没有一个拥抱开发运维、微服务而不是巨型独石的良好文化时，优秀的团队就会失败。”

这就是 Java Framework Spring 的蒂姆·斯潘(Tim Spann)雄辩地总结了为什么他的团队选择了 12 因素应用模式的组合(T4、T6、微服务和云铸造)。

在一个分布式团队中，本地开发机器运行在 Windows、Oracle JDK 和 Tomcat 上，还有一个“特殊的”Java 应用程序来模拟应用服务器，他们不得不在开发和 QA 之间来回切换。

然后他们开始应用 12 因素应用程序。

许多团队都在为过于复杂、缓慢的应用程序部署而苦苦挣扎。虚拟化、联网和设置运行时会遇到不同的工具版本和语言，而您的架构通常会拖您的后腿。

[12 因素应用方法](https://12factor.net/) 专为构建软件即服务(SaaS)应用而创建，同时避免了通常困扰长期企业软件项目的难题。 [SitePoint 简洁地将其描述为](https://www.sitepoint.com/12-factor-apps-methodology-implement-apps-appfog/) “构建结构良好且可伸缩的应用程序的概要”

这些最佳实践基于部署云原生应用程序的几个特定参数:

1.  它使用声明式格式来实现安装自动化。
2.  它与操作系统签订了明确的合同，以便在不同环境之间实现更好的可移植性
3.  为了持续部署，它限制了开发和生产之间的差异
4.  它允许在没有重大变化的情况下进行扩展和缩减

12 因素方法与编程语言无关，适用于任何组合的支持服务。

Mirantis 高级解决方案架构师 [Greg Pryzby](https://github.com/gpryzby) 在他今年早些时候在 OpenStack 峰会上发表的演讲“你必须有 12 倍高才能骑行”中表示:“它将改变你的思维方式，并能够更快地交付软件

[https://www.youtube.com/embed/GZ4sAEUMOnM?feature=oembed](https://www.youtube.com/embed/GZ4sAEUMOnM?feature=oembed)

视频

## 合适的环境

12 因素 app 方法解决了以下挑战:

*   你怎样才能更快地失败？
*   你如何准备好你需要的一切，然后，按下按钮，你和你的团队可以完成你的工作？
*   如何获取代码，然后通过流程使其可用于生产？
*   然后，您如何通过持续集成、持续部署，甚至有时是持续交付来自动化该过程？
*   你如何让人们改变方法论？他们需要定义哪些流程来完成工作？

与所有文化转型一样，应对这些挑战可以归结为三个部分:人员、流程和技术。

“了解这些过程并教育人们有助于我们理解我如何构建一个识别坑洞的应用程序，以便他们可以得到修复，”Pryzby 说。

## 指导 12 因素应用程序的九条规则

Pryzby 提供了 12 因子所代表的四个词:

1.  **性能:**对于 12 因素的应用程序，你要向外扩展大量的代码副本，这意味着性能必须优先考虑。
2.  **弹性:**专注于可伸缩的组件，可以根据需要伸缩。Pryzby 推荐 [Chaos Monkey](https://github.com/Netflix/SimianArmy/wiki/Chaos-Monkey) 不仅是坏数据的工具，也是扩大规模的工具。
3.  弹性:你想要松散地耦合你的各个部分。通过每个组件只做一件事，正常运行时间增加了。
4.  **安全性:**应尽可能加密所有数据，将安全性融入设计中。如果已知 80%的攻击是内部的，Pryzby 说，这并不是说他们不能进入网络，他们已经在网络上，这意味着你必须在别人问他们之前问安全问题，那就太晚了。
    在别人问安全问题之前，你自己先问，否则就太晚了

然后你需要遵循这五个设计原则，其中大部分都很符合逻辑，如果所有基于云的服务都遵循这些原则，那就太好了:

### 做一件事并把它做好

1.  **解耦数据。**你不希望你的应用中有任何数据。
2.  **尽量少沟通。**如果那个组件死了，你要确保你还能得到数据。通过使用后备存储，这意味着您可以更容易地传递数据，也意味着您在系统中传递的数据更少。
3.  **想想它在规模上的表现**。这整个系统是在考虑将应用扩展到大型社区的情况下创建的。
4.  **安全。**认真。从一开始就想到了。

## 12 因素应用的 12 个组成部分

### 因素 1:代码库

您需要在一个代码库的基础上构建，通过修订控制和许多部署进行全面跟踪。部署应该是自动的，这样一切都可以在不同的环境中运行，而不需要任何工作。

Pryzby 说:“如果你认为开发中的某些东西与质量保证中的不同，不要把它放在代码中，”这呼应了你将在 12 个因素中看到的一个共同主题。

### 因素 2:孤立的依赖性

“你有多少次安装或试图安装某个软件却发现自己安装的是错误版本的 **glibc** ？”普里斯比问道。或者您可能有错误的 Python 版本或错误的 Python 库版本？

第二个因素是关于显式声明和隔离依赖项，因为应用程序是独立的，需要安装依赖项。这就是为什么你在代码中声明你所需要的。

“你的开发、你的质量保证和你的产品必须完全相同，12 因素应用才能真正发挥作用，因为当你为网络扩展时，你不能有任何出错的空间。”

### 因素 3:配置

在这里，您将配置文件存储在环境中。这个因素集中在你如何存储你的数据——数据库[统一资源标识符](https://www.w3.org/Addressing/) (URI)在开发、QA 和生产中会有所不同。

### 因素 4:后勤服务

您需要将后台服务视为附加资源，因为您可能需要不同的数据库，这取决于您所在的团队。有时，开发人员需要大量的日志，而 QA 需要的日志较少。通过这种方法，甚至每个开发人员都可以拥有自己的配置文件。

### 因素 5:构建、运行、发布

您希望将构建和运行阶段严格分开，确保每个阶段都有正确的库。然后，您将所有东西放在一个可以发布并安装到环境中的东西中，然后就可以运行它了。

“作为一名开发人员，我希望能够开发出这种漂亮的、可紧密交付的对象，我可以交给运营部门。然后，运营部将它放在该环境中运行。理想情况下，我再也不会听到 Ops 的消息了，”Pryzby 说，“因为你已经把它变成了一个定义良好的解决方案”，几乎没有依赖性。

### 因素 6:无状态流程

您希望确保这些东西存储在后备存储中，这意味着您能够向外扩展并做您需要做的事情。该应用在一个或多个无状态进程中执行。当你向上和向外扩展时，你不想有一个你需要传递的状态。

### 因素 7:端口绑定

“人们反复强调这一点有多重要，”Pryzby 承认，但他认为通过端口绑定导出服务允许您的内部客户访问您的端点而无需通过安全检查。然后，您可以通过端口直接访问您的应用程序，了解是您的应用程序还是堆栈中的另一个点工作不正常。

### 因素 8:并发性

定义的小型应用程序允许根据需要向外扩展，以处理不断变化的负载。将你的应用分成更小的部分，然后在那里寻找你必须编写或者可以使用的服务。

### 因素 9:一次性

确保改变能很快生效。这是为了确保你能快速启动和关闭。你能处理车祸。

### 因素 10:开发-生产平价

开发、试运行和生产应尽可能相似。持续部署需要基于匹配环境的持续集成，以限制偏差和错误。如果你尽可能地保持开发、试运行和生产的相似性，任何人都可以理解并发布它。这当然是一个很好的开发，但是它也带来了更多的可伸缩性。

### 因素 11:日志

你的应用只关心创建一种事件流。然后，根据配置，您可以决定日志将发布到哪里。

[英特尔的尼克·韦弗讨论编排](https://thenewstack.simplecast.com/episodes/intels-nick-weaver-discusses-orchestration)

### 因素 12:管理流程

您的管理工具随产品一起提供。Pryzby 警告我们不要乱动数据库。相反，使用您在应用程序旁边构建的工具去检查数据库。这也意味着特权在您的系统中是相同的——不再有任何特殊情况会危及您的安全。

## 但是谁会用因子 12 呢？

当然，12 因子只是某些公司的解决方案。对于那些仍在努力克服传统本地应用程序包袱的人来说，它还没有准备好。这种 DevOps 方法的正确用例是在新的应用程序或实例中，在这些应用程序或实例中，您已经开始对您正在完全返工的棕色地块项目进行重构。

这是关于决定你的主要问题是什么，以及因素 12 是否能解决那个问题。即使是 12 因素的信徒也不总是应用所有的 12 因素。Will Koffel 写了一篇很好的文章，强调了哪些因素是必须的，哪些是非常重要的，哪些只是相当重要。

但是，当它归结到它，一如既往，你应该优先考虑什么对你的团队有效。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>