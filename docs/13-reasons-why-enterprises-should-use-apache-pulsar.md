# 企业应该使用 Apache Pulsar 的 13 个理由

> 原文：<https://thenewstack.io/13-reasons-why-enterprises-should-use-apache-pulsar/>

如果您需要一个平台来处理数据流和消息队列，您有几个选择。然而，如果你是一家寻求规模的企业，事情可能会变得更加复杂。

例如，Apache Pulsar 从一开始就被设计为能够处理流和消息队列。 [Apache Kafka](https://thenewstack.io/apache-kafka-primer/) 是流媒体的事实标准，它擅长向多个消费者提供大容量的发布-订阅(pub-sub)消息。

[另一方面，RabbitMQ](https://www.rabbitmq.com/) 和 [ActiveMQ，](https://activemq.apache.org/)非常适合竞争性消费者用例，在这种用例中，发布者向一个主题发送消息，但只有一组应用程序使用每条消息。在开源的 RabbitMQ 或 ActiveMQ 上，很容易增加或减少消费者的数量。

在 Kafka 上实现相同的场景更棘手，因为虽然您可以将它用于竞争消费者用例，但它在每个消费者的分区级别上工作。如果你想增加消费者的数量，你就必须增加你的话题的分区数量。如果您想减少消费者的数量，您可以这样做，但是您可能会得到您不需要的额外分区。

这不是一种简单的添加竞争消费者的方法。消费反弹可能发生在卡夫卡身上，过一段时间事情会变得复杂。

在 Pulsar 中，您不仅可以使用它进行流式传输，而且它非常擅长处理消息队列。您可以使用共享订阅，在共享订阅中，您可以自动添加和删除消费者，而无需对主题进行任何更改。新的消费者成为消息循环分发的一部分，使得该过程无缝。

如果一个主题基本上是空的，并且您有所有这些空闲的应用程序，那么您可以缩减它们，从而节省在您需要运行的机器和应用程序资源上花费的资金。整合 Pulsar 的流和队列功能简化了操作——您可以只运行一个平台，从而节省成本。

Apache Pulsar 特别适合解决统一流和消息传递的挑战。我们将探讨 Apache Pulsar 成为任何企业必备产品的另外 13 个原因。但是首先，让我们来定义运动数据和静止数据之间的关系。

## 动态和静态数据

动态数据是指主动传输或处理的数据，例如实时发送和接收的流数据或消息。示例包括低容量消息队列数据、高容量流数据、web 点击流、[物联网(IoT)](https://thenewstack.io/what-does-it-mean-to-be-on-the-internet-of-things/) 传感器数据、天气和交通数据、车辆遥测、商业交易、微服务交互、机票预订、银行交易、销售点记录等等。

静态数据是存储在永久存储系统中且当前未被使用或传输的数据，例如闪存或云存储。事件流和消息传递系统通常涉及不同系统或应用程序之间的实时数据传输和处理，然后这些数据被存储为静态数据以供进一步分析或使用。

Apache Pulsar 可以处理动态数据，并为不经常访问的数据(静态数据)提供经济高效的解决方案。请继续阅读，我们将探索 Pulsar 为何是处理这两种数据的企业的理想之选。

## 什么是阿帕奇脉冲星？

[Apache Pulsar](https://pulsar.apache.org/) 是一个开源的分布式消息系统，由雅虎开发，[于 2016 年捐赠给 Apache 软件基金会。它提供了一个发布-订阅模型，用于在系统组件之间实时有效地交换消息。](https://thenewstack.io/apache-pulsar-a-unified-queueing-and-streaming-platform/)

它还提供了一个共享日志抽象，允许同时用作消息代理和事件代理。Pulsar 通过消息重复数据删除和基于事务的确认，保证向用户发送至少一次(“至少一次”发送语义)和恰好一次(“有效一次”发送语义)，即使出现故障或网络问题。

Apache Pulsar 提供基于交易的“发布和订阅”来增加安全性。这确保了消息要么被至少一个应用程序使用，要么根本不被使用。当数据一致性至关重要并且所有消费者必须接收相同的数据时，这尤其有用。

以下是在企业中使用 Apache Pulsar 的 13 个理由:

## 1.Pulsar 拥有 Kubernetes 和云就绪架构。

其架构的关键组件之一是 [Apache BookKeeper，](https://bookkeeper.apache.org/)用于存储和管理 Pulsar 产生和使用的消息。它提供了一个高性能、容错和可扩展的存储层，允许 Pulsar 以低延迟和高吞吐量处理大量数据。

BookKeeper 是一个分布式的预写日志(WAL)系统，允许 Pulsar 使用多个独立的日志，称为分类帐。这使得能够随着时间的推移为不同的主题创建多个分类帐，从而增强系统的可扩展性和性能。

此外，BookKeeper 还提供了一系列功能，如数据持久性和复制，这对维护 Pulsar 中的数据完整性和可用性至关重要。

Pulsar 代理是 Pulsar 架构的关键元素。它接收和路由消息，并处理消费者状态、主题和名称空间管理。它充当簿记员的中间人，并链接到分类账以读取和写入消息。代理将元数据和状态存储在日志磁盘中，而分类帐数据保存在分类帐磁盘中。

舵图可用于在 Kubernetes 上轻松部署脉冲星簇。Helm 是 Kubernetes 的一个包管理器，它简化了 Pulsar 集群的安装、升级和管理。

[Pulsar 代理](https://pulsar.apache.org/docs/2.11.x/administration-proxy/)也至关重要，它能够连接到 Pulsar 集群，并将流量转发到相应的 Pulsar 代理。它有助于负载平衡、路由和服务发现，也有助于扩展和管理 Pulsar 集群。

这些特性使 Pulsar 脱颖而出，成为云和 Kubernetes 部署的首选。其分离存储和计算的能力，以及 Helm Charts 和 Pulsar proxy，使得 Pulsar 集群的部署和管理对于云本地、Kubernetes 本地分布式系统来说更加容易。

## 2.使遗留应用程序现代化很容易。

不需要重写为消息传递编写的应用程序，比如 RabbitMQ 或 JMS。例如，用于 Apache Pulsar 的 fast JMS 提供了 JMS 的替代产品，将您的 Pulsar 集群转变为符合 JMS 2.0 的代理。这使得现有的 JMS 应用程序可以很容易地用 Pulsar 替换以前的 JMS 代理类型。

此外，对长期存储和分层存储的内置支持允许经济地保留和重放大量数据。这对于需要存储历史数据以进行合规性或分析的应用程序尤其有用。

## 3.它可以降低总拥有成本。

与其他消息和流平台相比，Apache Pulsar 的总拥有成本(TCO)更低。正如在 [2021 GigaOM 报告](https://research.gigaom.com/report/the-cost-savings-of-replacing-kafka-with-pulsar/)中看到的，与 Apache Kafka 相比，Luna Streaming (Pulsar)可以节省高达 81%的总拥有成本。

Splunk [还报告称，](https://www.slideshare.net/streamnative/why-splunk-chose-pulsarkarthik-ramasamy)通过用 Pulsar 替换 Kafka，资本支出成本比 Kafka 低 1.5 到 2 倍，运营支出成本低 2 到 3 倍，这得益于 Pulsar 高效的分层架构。

这些成本节约和效率优势展示了 Pulsar 的强大功能。必须考虑到，根据使用情形、部署规模和所采用的存储解决方案，TCO 可能会有所不同。

Pulsar 的功能，如多租户、分层存储、负载平衡以及与不同存储解决方案的集成，可以帮助组织在其消息和流部署中节省成本并提高效率。

## 4.多租户没有问题。

Pulsar 允许多个租户使用同一个集群，每个租户都有自己的一组资产。当许多团队或协会需要使用相同的消息传递系统时，这被证明是有利的。每个租户可以拥有自己的主题、订阅和访问控制。

企业在 Kafka 上构建了一个完整的多租户包装器，包括主题名称的前缀，以保证多个组可以共享 Kafka，但不会相互干扰——这是内部构建和支持的。但有了 Pulsar，多租户能力是免费的。

## 5.Pulsar 可以处理高性能。

在基准测试中，Pulsar 已经被证明每秒可以处理数百万条消息。它可以支持多达一百万或更多的主题，使其成为实时分析和流处理等高吞吐量应用的理想选择。

## 6.延迟一直很低。

Pulsar 专为低延迟消息传递而设计，其关键设计目标是生产者延迟小于 10 毫秒，使其成为实时应用的理想选择。通过在内存中保存有限数量的消息，并使用日志结构的存储层，Pulsar 可以最大限度地减少传递消息所需的时间。

## 7.分层存储有助于节约成本。

Apache Pulsar 有一个分层存储架构，它划分了计算层和存储层。计算层处理消息，而存储层存储消息。这通过利用不同数据类型的不同存储资源，实现了显著的成本节约。

Pulsar 提供了多种存储选择，例如用于高速和最小延迟的磁盘存储，以及用于扩展存储的磁盘外存储。它提供了一个额外的存储层，通过在各种云服务中存储信息，如亚马逊 S3、谷歌云存储和 Azure Blob 存储。

分层系统允许根据数据保留、消息速率和其他因素配置单独的存储策略。这样，经常使用的数据可以保存在磁盘存储中，很少访问的数据可以存储在磁盘外的存储中，如云存储，从而通过减少不经常使用的数据的存储需求来节省成本。

值得注意的是，Pulsar 的功能允许根据访问模式在存储层之间移动数据，从而优化存储成本和性能。这也允许利用云存储服务的经济高效的存储选项，如[亚马逊](https://aws.amazon.com/?utm_content=inline-mention) S3、谷歌云存储和 Azure Blob 存储，它们比 SSD/NVMe 磁盘更经济。

## 8.地理复制降低了风险。

Pulsar 有助于跨不同地区的多个数据中心自动复制数据，使灾难恢复更容易，并最大限度地减少停机的影响。它可以通过 Pulsar CLI 或 REST API 进行管理，并支持主动/备用和主动/主动拓扑。

还提供了共享的全局配置存储，消除了跨数据中心手动传播数据的需要。

## 9.很容易扩展。

Pulsar 旨在处理大量并发连接和高吞吐量的消息。它通过使用基于分段的架构来实现这一点，其中每个主题被分成多个分段，每个分段在多个代理之间复制。这允许系统的水平扩展，因为可以根据需要添加更多的代理。

Pulsar 集群中的代理是无状态的，没有持久的数据或状态。这使得通过简单地添加或删除代理来扩大或缩小 Pulsar 集群变得容易。

Pulsar 还自动平衡代理之间的负载，通过“分片”帮助确保最佳性能。这个特性在可用的代理之间分配主题分区，当添加新的代理时，会根据集群中代理的数量重新分配分区。

这种自动负载平衡，加上轻松添加或删除代理的能力，使得扩展 Pulsar 集群以满足应用程序或服务不断变化的需求变得非常容易。

## 10.Pulsar 功能和 IO 连接器支持实时分析。

Apache Pulsar 具有两个强大的实时处理和分析组件: [Pulsar 功能](https://pulsar.apache.org/docs/2.10.x/functions-overview/)和 [Pulsar IO 连接器。](https://pulsar.apache.org/docs/2.11.x/io-overview/)这两个组件都集成到 Pulsar 的 CLI 和 API 中，便于部署、管理和监控。

Pulsar 函数是一个无服务器计算框架，用于实时过滤、转换和丰富数据等任务。它们用流行的编程语言编写，如 [Java、](https://thenewstack.io/java-adapts-to-cloud-native-computing/) [Python、](https://thenewstack.io/an-introduction-to-python-for-non-programmers/)和 [Go、](https://thenewstack.io/go-the-programming-language-of-the-cloud/)它们可以通过 Pulsar Functions API 进行部署和管理。

Pulsar IO 连接器提供 Pulsar 与外部源(如数据库、消息队列和文件系统)以及外部接收器(如数据仓库和分析平台)的预构建集成。

Pulsar 还具有[变更数据捕获(CDC)](https://pulsar.apache.org/docs/2.2.1/io-cdc/)功能，允许跟踪和流式传输数据库中发生的变更。Pulsar 功能和 IO 连接器就是建立在这个特性的基础上。

例如，Pulsar 的 CDC 功能可用于实时传输雪花中的数据变化，并使用 Pulsar 函数执行转换、分析和路由。

如果一个应用程序使用 Kafka 连接器将数据从雪花传输到 Pulsar，只需很少的修改，就可以使用相同的连接器将数据从雪花传输到 Pulsar。Pulsar 与 Kafka 兼容相同的客户端 API 和协议，因此现有的 Kafka 客户端无需修改即可连接到 Pulsar。

此外，Pulsar 有一个用于雪花的 IO 连接器，便于集成。使用雪花连接器，可以从雪花获取数据并将其传输到 Pulsar 主题，或者从 Pulsar 主题将数据传输到雪花。

## 11.它有一个内置的模式注册表。

Apache Pulsar 包括一个内置的模式注册中心，支持 Avro 和 JSON 模式。Avro 是一种数据序列化格式，它提供了数据的紧凑二进制表示以及描述其结构的方式。JSON 是一种轻量级的数据交换格式，对于人类来说易于读写，对于机器来说易于解析和生成。

Pulsar 中的 Avro 模式支持支持以紧凑的二进制格式对 Avro 数据进行编码和解码，这有助于最小化网络带宽和存储空间。它还允许为 Avro 格式的数据定义一个模式，并在模式注册表中注册它。

Pulsar 中的 JSON 模式支持允许以人类可读的格式编码和解码 JSON 数据。它还允许为 JSON 格式的数据定义一个模式，并将其注册到模式注册中心。

Pulsar 中的模式注册中心确保生产者生产的数据与消费者消费的数据兼容。当生成器向主题发送数据时，它会向数据附加一个模式，该模式描述数据的结构，例如字段及其数据类型。然后，消费者使用该模式来反序列化数据和访问字段。

在微服务架构中，数据可以由不同的微服务独立产生和消费。但是，对微服务上的模式进行更改会破坏依赖该数据的多个下游微服务，从而很难确保生产者生成的数据与消费者消费的数据兼容。如果没有模式注册表，这可能会导致数据不兼容问题。

## 12.Pulsar 提供多协议支持。

Apache Pulsar 集成了对多协议的支持，包括 Kafka 协议、MQTT 和 MQTT-over-WebSocket。这使得 Pulsar 成为一个多协议消息传递系统，允许它与不同类型的客户端和用例一起工作。

脉冲星的多协议兼容性的一个关键特征是“脉冲星上的卡夫卡”(KoP)，这使得脉冲星能够充当卡夫卡的替代品。KoP 使 Kafka-native 客户端能够使用 Kafka 的协议和 API 连接到 Pulsar，并受益于 Pulsar 的功能，如多租户、分层存储、自动负载平衡和模式注册。

除了 Kafka 协议，Pulsar 还支持 MQTT 和 MQTT-over-WebSocket 协议。这使得该系统能够适应广泛的物联网和移动用例，并与现有的 MQTT 和 MQTT-over-WebSocket 客户端和库轻松集成。

## 13.最后:它是开源的。

Apache Pulsar 在 Apache Software Foundation 下可以自由访问，允许使用、修改和传播。这使得许多企业采用 Pulsar 而不产生任何许可费用成为可能，也促进了社区对系统发展的贡献。

## 结论

总之，Apache Pulsar 的特性使它成为一个非常有效和灵活的事件和消息系统，可以应用于广泛的企业应用程序。

它的优势包括提高资源利用率、经济高效的数据存储、更快的数据访问、更高的可用性以及数据组织的灵活性，所有这些都有利于许多企业用例。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>