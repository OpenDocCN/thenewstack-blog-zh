# 集装箱化使安全性和合规性瞬间变得更加容易

> 原文：<https://thenewstack.io/containerization-security-compliance/>

随着容器成为交付和部署应用程序的常用方法，我们已经看到越来越多的客户采用“搬来搬去”的方法来迁移他们现有的应用程序。通过这种方式，他们可以立即获得容器的一些好处，例如大大简化了测试和部署，而不必将整个应用程序重新构建为微服务。

很少有技术不展示新功能和向后兼容性就能成功进入主流。因此，毫不奇怪，客户正在用集装箱运输 J2EE 和。他们投入了成千上万个小时来创建和维护，只做了很少的改动。

这并不意味着它们永远不会被重新架构为微服务。但是，从测试自动化、部署、密度、效率以及您将看到的安全性方面来看，将它们按原样转移会带来立竿见影的好处。

也许这种模式看起来很熟悉:当公共云刚刚建立时，组织通常会将整个虚拟机从他们自己的数据中心迁移到 AWS，而不做任何更改。在此之前，当虚拟化还是新生事物时，组织会将物理服务器不加改变地转换为虚拟机。在这两种情况下，这些组织的传统环境变得更易于管理。这让他们有时间积累经验和发展势头，同时保护他们现有的投资。看到这种趋势在容器中重演，是容器生态系统增长势头的一个很好的指标。

## 风暴潮

 [约翰·莫雷罗

John 是 Twistlock 的首席技术官，领导该公司与战略客户和合作伙伴的合作，并推动其产品路线图。此前，约翰是财富 500 强全球化学公司雅宝的 CISO。John 在微软的咨询服务和产品团队工作了 14 年。他负责在 Windows、Azure 和 Office 365 中发布安全技术的功能团队，并担任美国混合云咨询团队的首席架构师。约翰与妻子和两个年幼的儿子住在路易斯安那州。作为一名热情的渔夫和潜水者，他也是恢复路易斯安那海岸联盟的主席。](https://www.paloaltonetworks.com/prisma/cloud) 

在 [Twistlock](https://www.paloaltonetworks.com/prisma/cloud) ，我们的一个客户为一些世界上最大的民用水厂项目提供环境科学和工程咨询。他们有典型的数据收集、建模和其他核心业务线应用程序，但也有模拟风暴潮的关键应用程序。

该应用程序用于涉及美国陆军工程公司和其他政府机构的项目。它构建在 Red Hat、Oracle 和 Java 平台上，具有许多专有的业务逻辑。大约 12 年前，这个应用运行在数据中心的裸机 IBM xSeries 服务器上。然后，它被转移到一个 VMware ESX 虚拟机，后来又转移到一个 Azure 虚拟机。正是这个应用程序可以保持不变的事实，使得这些过渡变得可行。

但是，为这个频繁迁移的 14 岁的 storm surge 应用程序保持一致的开发和测试环境是一个持续的斗争。它的组件同时变成了新旧依赖的无数混乱。各个组件是在不同的时间单独安装的，其特定的配置不可避免地会产生冲突。实施灾难恢复需要运营团队手动按照分步操作手册进行操作。

转移到容器带来了立竿见影的好处:首先，暂存环境之间的一致性带来了更高的生产率。部署归结为一个简单的 **docker run** 命令。灾难恢复变成了简单地重复初始部署过程。

此外还有安全方面的好处。

此应用程序要求严格遵守特定的安全配置和合规性控制，必须手动检查和验证。入侵检测和防御系统(IDS / IPS)和主机防火墙等传统安全工具需要大量的手动设计和调试。因此，每当其中一个组件被升级(或者有时被降级)，安全系统就会频繁地崩溃。为了不冒再次崩溃的风险，该组织选择放松其安全控制。

一旦应用程序被对接，Twistlock 就帮助该组织简化和重建其安全性，特别是在三个关键部门:

## 漏洞管理

在 Twistlock 之前，开发团队检查一些库中的漏洞的能力有限，但他们从来没有全面了解堆栈的所有层，从上到下。漏洞扫描仅在应用程序构建后进行，因此任何突然出现的问题都必须手动修复。运营团队不得不依靠人工检查和流程来防止部署易受攻击的构建，并且直到环境促使他们执行时间点扫描时，他们才能了解其应用程序的漏洞状况。

现在，开发团队使用 Twistlock 的 Jenkins 插件作为他们构建过程的一部分，可以在单一窗格上看到整个应用程序的所有漏洞。现在，运营团队已经实施了一个阈值，如果新版本的组件包含具有中等或更高的 [CVSS 分数](https://www.first.org/cvss/specification-document)的漏洞，则该阈值会阻止部署这些组件。开发和运营团队都使用 Twistlock 的漏洞浏览器对开发、测试和生产环境中的漏洞进行实时查看和堆栈排序，因此他们可以尽早发现紧急问题。

## 服从

因为法规遵从性通常被认为是一个操作问题，一旦部署到生产中，应用程序中不可避免地会出现问题，需要开发团队来缓解。同时，在验证新版本时，运营团队依赖于手动创建的文档。因此在组件级别几乎没有版本控制。内部审计团队运行手动工具在某个时间点检查法规遵从性，但没有持续的保证。

在 Docker 之后，开发团队使用 Twistlock 的 Jenkins 插件来检查每个构建中每个映像的合规性状况，使他们能够尽早发现并纠正问题。运营团队可以在 Twistlock 中集中定义合规性规则，以监控和实施与其特定需求相关的所有设置，并自动阻止部署不合规的映像，或从官方、可信回购之外的任何地方获取的映像。运营和内部审计团队使用 Twistlock 的 Compliance Explorer 功能持续监控整个环境中所有主机、容器和映像的状态，以确保它们符合美国国家标准和技术研究所容器安全指南( [NIST SP 800-190](https://csrc.nist.gov/publications/detail/sp/800-190/archive/2017-04-10) )中规定的最佳实践。

## 运行时间

在容器化之前，为了在运行时保护 storm surge 应用程序，组织根本无法为应用程序的每个版本提供调整入侵检测和入侵防御系统规则或更新其全面、具体的网络防御策略所需的手动工作。相反，他们主要依靠边界防火墙和一些有限的基于主机的反恶意软件功能来在运行时保护应用程序。

现在，每次部署时，Twistlock 都会自动为应用程序的每个版本创建一个运行时模型。这个模型描述了应用程序*应该*在四个维度上做什么:进程、网络、文件系统和系统调用。它与图像摘要相关联，所以每个构建都有自己自动创建的、特别调整的模型。

每当开发人员对其中一个二进制文件进行小的更改时，生成的映像的自动替换模型将包括新二进制文件的 MD5 哈希，从而能够防止任何未通过哈希测试的映像的执行。该模型自动学习应用程序侦听的所有端口、绑定到每个套接字的每个二进制文件的特定版本，以及出站网络行为的特征，如出口 IP 和 DNS 名称空间。这导致在运行时有更多更强的[层纵深防御](https://www.us-cert.gov/bsi/articles/knowledge/principles/defense-in-depth)，同时消除了手动操作。

该客户现在不仅能够在相同的虚拟机上无冲突地运行多个 storm surge 应用程序实例，从而降低其 Azure 费用，还立即以切实可行的方式提高了安全性。他们可以更好地了解应用在整个生命周期中的漏洞状况。

将传统应用迁移到容器可能无法实现最终目标。但这是一个伟大的第一步，可以带来真正的好处，积累运营知识，并加速向完全集装箱化基础设施的过渡。

[扭锁](https://www.paloaltonetworks.com/prisma/cloud)是新栈的赞助商。

专题图片:英国邓弗里斯和加洛韦的威廉港附近的[大潮，由大卫·贝尔德拍摄，在知识共享许可下发布。](http://www.geograph.org.uk/photo/3833138)

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>