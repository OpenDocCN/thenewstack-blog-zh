# 处理可观测性数据管理

> 原文：<https://thenewstack.io/grappling-with-observability-data-management/>

[](https://www.linkedin.com/in/clintsharp/)

 [克林特·夏普

克林特是 Cribl 的首席执行官。在加入 Cribl 之前，Clint 在技术和软件公司领导了 20 年的产品管理和 IT 运营，包括 Splunk 和 Cricket Communications。作为一名前从业者，他在网络问题、数据库管理和安全操作方面有深厚的专业知识。](https://www.linkedin.com/in/clintsharp/) [](https://www.linkedin.com/in/clintsharp/)

*大多数可观测性环境使用一系列数据存储来存储他们需要接收和分析的不同数据。各司其职，各有利弊。*

我们的客户经常抱怨需要合并他们庞大的监控和可观察性环境。许多人想要一个工具或一块玻璃作为真理的唯一来源。虽然整合的愿望是可以理解的，但基础架构环境是由一系列同类最佳的软件组成的，每种软件都有自己的优势和挑战。这种碎片化的一个关键因素是用于管理每天流入这些平台的数 TB 可观察性数据的底层数据存储的范围。每个都针对不同类型的数据和分析进行了优化。

下面列出了目前在企业组织中使用的一些最常见的数据存储。

## **时间序列数据库**

顾名思义，时间序列数据库(或 TSDBs)针对时间序列数据进行了优化，比如股票报价机、医疗监控设备数据、天气数据等等。在可观测性空间中，TSDBs 通常用于存储有关应用程序或系统性能的带时间戳的指标。这些指标以固定的时间间隔收集，称为分辨率。

为什么不使用关系或非关系数据库，比如 PostgreSQL、Oracle、Cassandra 或 MongoDB？当然可以，但是 TSDBs 提供的优化使它们成为度量存储和分析的理想选择。与更通用的数据库不同，TSDBs 提供时间感知分析功能、过滤、压缩和汇总等功能。不太专业的数据库没有这些特性。对于可观察性数据，TSDBs 被优化来存储度量，而不专门处理完整的日志解析和保留。

## **对象存储**

另一方面，对象存储由于其灵活性而成为当今非常流行的数据存储。与分层存储数据的传统文件系统不同，对象存储将数据保存为对象。商店本身不知道对象中有什么，这意味着你可以在那里放任何你想要的东西。对象存储已经成为一些数据管理概念的支柱，如数据湖和云数据仓库。

对象存储在可观测性空间中是理想的，因为您可以以八分之一的块或文件存储成本存储可观测性所需的大量数据。如果您正在使用可观察性管道或类似的基础设施，您可以从对象存储中重放您的数据——有效地为您提供一个完整的 [Kappa 架构](https://towardsdatascience.com/a-brief-introduction-to-two-data-processing-architectures-lambda-and-kappa-for-big-data-4f35c28005bb),具有低成本和高灵活性。

对象存储的强大之处在于它们的灵活性，但这也是缺点之一。如果没有健壮的元数据管理实践，通常很难了解这些对象中有什么以及它们为什么存在。即使您经济高效地存储数据，您仍然必须管理这些数据。就像 IT 中的许多事情一样，没有免费的午餐。

## **索引日志分析平台**

这些平台，如 Elastic 或 Splunk，非常适合调查大型数据语料库中的性能问题或错误——主要通过基于搜索的界面。索引日志分析平台使用基于事件的日志数据，如访问日志或服务器日志。它们有自己专有的索引和存储格式；和剥离摄取的低价值元素的数据，它们表现得非常好。

索引日志分析平台的缺点是这些系统需要大量的基础设施。每天向这些系统中输入数十甚至数百 TB 的数据是很常见的，这导致了庞大的基础架构预算来应对数据增长挑战。另一个不利因素是定价模式。这些平台通常根据它们每天接收的数据量来收费，当预算的增长速度跟不上数据的增长速度时，这些平台的实用性就会受到限制。

## **数据仓库**

2020 年引入的一个新的数据管理概念是数据湖库，它试图将数据仓库的元素与数据湖结合起来。让我们后退一步，回顾一下数据仓库和数据湖的不同之处。

数据仓库是具有专门数据结构的中央信息存储库，由从整个业务的事务系统中获取的数据组成。数据仓库针对商业智能和分析进行了高度优化，并被组织成多个主题和时间域。当您有大量已知数据，并且希望就这些数据提出重复的问题时，它们非常有用——尤其是当您需要支持成百上千的并发用户时。

如果当您知道您想要询问的数据和问题时，数据仓库是合适的，那么当您不知道其中一个或两个时，就需要数据湖。数据湖是一个系统的探索，或者说是一个问题开发环境。数据湖通常建立在对象存储之上，它吸收任何类型的数据，并使其可用于高技能数据科学家和数据工程师的分析。

数据湖库是这两种截然不同的想法的组合，这使得它的构建和使用具有挑战性。通过尝试做所有事情，数据湖库可能会在高需求时表现不佳，例如在季度结束时，此时必须生成许多报告，并且临时分析也在进行中。

对于基础架构、运营和 SecOps 团队来说，lakehouse 看起来很有吸引力，因为它声称具有灵活性，但它并没有针对日志、指标、事件和跟踪等可观察性数据进行优化。它对这些数据应该如何构建、优化和消费没有任何看法。当现有的系统将通过搜索为您完成这些工作时，谁愿意编写一堆 Spark 或 Python 代码来分析数据呢？

## 你需要哪一个？

这些数据存储中的每一个都有优点和缺点，因为每一个都针对不同的用例和交互模式进行了优化。对于我们的客户来说，大多数都混合使用索引日志分析平台、时序数据库和对象存储。正是这种平台组合带来了痛苦:每个选项都需要自己的数据摄取策略，通常需要独特的技能和工具。

这就是可观察性管道的用武之地。使用可观察性管道从消费者那里抽象出可观察性数据源，使我们的客户能够灵活地在正确的时间以正确的格式将数据发送到正确的平台，而无需考虑底层的数据存储。

我们客户的一个常见场景是从一个代理(如弹性代理)向多个目的地(如亚马逊 S3)发送数据。代理度量登陆到 Elastic 的服务中，而全保真数据登陆到像亚马逊 S3 这样的对象商店中。

升级是可观察性管道发挥作用的另一个场景。发布新版本的 TSDB 时，您可以向两个实例发送数据，并使用实时数据测试更新后的版本。这消除了在进行全面测试之前使用生产数据的风险。将数据发送到多个目的地还允许您使用实时数据测试新平台，而无需对基础架构的其余部分进行大规模更改。

## **结论**

可观察性数据有几种形式，分析它的平台各有不同的优化，并对如何使用数据做出不同的假设。没有放之四海而皆准的解决方案，这就是为什么追求基于选项的策略和可观察性管道能给你最大的灵活性和可观察性数据的价值。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>