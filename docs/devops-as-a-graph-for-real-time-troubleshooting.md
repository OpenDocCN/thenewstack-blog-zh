# DevOps 作为实时故障排除的图表

> 原文：<https://thenewstack.io/devops-as-a-graph-for-real-time-troubleshooting/>

每个 DevOps 工程师自然都会在头脑中保留一个所有基础设施和互连服务的知识图表。这个图表是支离破碎的，需要时间来学习和记录，也需要脑力来保持。我们进行的这些手动连接需要熟悉系统并具有丰富的操作和管理经验。

但是今天复杂和动态的微服务架构使我们不可能跟上我们周围所有软件和基础设施的变化。这种认知负荷因孤立的监控和可观察性工具而加剧，这些工具增加了上下文切换，对我们快速修复问题和避免停机的能力产生了负面影响。

所有的数据中都有隐藏的关系，只能通过一个工程师的知识图来表达。当我们从数据中提取关系以形成实时、动态的图表时，生产问题的影响和相关原因就更加明显了。我们希望从观察单个数据点，然后在我们的脑海中慢慢地将它们连接起来，转变为在相同的上下文中观察所有的数据点和连接。这样，我们识别和解决问题的过程会更快、更准确。

### 它将如何影响我们理解生产问题的方式？

在现代 IT 环境中，我们不断做出改变，以提高应用程序性能并强化系统。这些变化通常会导致失败。拥有一个将所有基础设施和微服务链接在一起的 DevOps 图，可以让团队看到隐藏的关系。当我们通过我们的观察工具中的可视化将该图表变为现实时，运营人员和 sre 可以快速找到生产问题的原因。

sre 在事件响应期间面临的一个常见挑战是将客户问题或性能问题转化为具体的服务和团队。借助 DevOps 图表的强大可视化功能，这种一级分类变得更加容易，使 sre 能够:

*   使用显示 IT 环境中组件之间关系的动态拓扑在运营数据之间建立关联。
*   通过用户或脚本可搜索和过滤的实时事件时间线，查看新代码或配置更改的意外后果。
*   为开发人员提供关键的事件时间线信息和拓扑结构，以便主动排查和调试他们的代码。
*   让团队在事故中承担责任，并通过运营活动和变更管理的记录系统关注信息共享。

### **它将如何影响我们解决问题的方式？**

开始问正确的第一个问题:是什么*导致了*变化？不要问发生了什么(度量)，为什么(日志)或哪里(分布式跟踪)，而是问是什么导致了变化，这有助于我们[全面地解决复杂的故障](https://www.ctrlstack.com/company/)。例如，每个事件工作流看起来都有点像这样:

*   随叫随到的工程师会收到警报并宣布发生了事故。
*   他们检查一些指标仪表板，以了解异常行为。
*   他们可能会将事件升级到基础架构、云网络和安全团队，以消除这些领域的根本原因。
*   这些团队深入各种日志和跟踪，以获得更多细节。
*   图表和数据片段在工作组成员之间来回传递。
*   在找到问题的原因之前，团队会回到度量图表并记录几次。

这个流程有什么问题？几件事:

*   此事件工作流可能需要数小时或数天时间来缓解和解决问题。
*   团队在没有上下文的情况下立即挖掘日志会浪费时间和资源。
*   团队使用的是数据片段，这种方法效率不高，也不可持续。

在将其他团队的成员纳入事件响应之前，我们需要提供背景。什么样的环境(变化)形成了一个事件的背景？涉及哪些组件，依赖关系是什么？服务所有者可以使用哪些有用的日志或跟踪来有效地进行故障排除？通过使用可操作的数据在仪表板中捕捉事件发生时的上下文，知识共享变得更加容易。这将为整个组织带来更好的故障排除体验。

### **它将如何影响我们实践可观察性的方式？**

在集装箱化的环境中提供可靠的服务并保持正常运行时间是一项艰巨的任务。如果发生事故或重大停机，最重要的是我们如何快速恢复。可观测性数据的增长可以提高或阻碍可观测性。组织面临的一个主要挑战是如何利用他们的数据来提高平均恢复时间(MTTR)。是时候重新思考我们的故障排除方法和首次连接因果的方法了。当我们将 DevOps 作为图表时，我们最终会超越传统的可观察性支柱，并开始以新的思维方式处理事件。

**数据连接:**可观察性的大量数据是相互关联的，但是我们当前的工具不允许我们将度量、日志和分布式跟踪作为连接的信息源来查看。这些数据类型通常是在孤岛中收集的，数据的关联是手动完成的。例如，为了知道一个服务上的指标峰值是否与另一个服务上的峰值有关，我们经常搜索指标图表以找到相关性。

您需要一个从一开始就将运营数据联系起来的解决方案。可视化应用程序及其基础架构的图形可以实时模拟事件的因果关系，从而消除处理我们头脑中隐藏联系的心理负担。这个解决方案还需要解决我们当前工具中的另一个关键缺口:缺少变更数据。

**变革影响:** Digital Enterprise Journal 最近的[IT 绩效报告](https://www.dej.cognanta.com/2022/03/30/technology-innovation-spotlight-march-2022/)发现变革是生产问题的最大来源。75%的性能问题最终都可以追溯到环境的变化。当[简单的配置错误](https://medium.com/p/7b6467e49401/edit)能引起多米诺骨牌效应时，还有更广泛的教训要吸取。如果您没有将捕获代码或配置变更作为您的可观察性策略的一部分，那么是时候缩小这个差距了。

知识共享:对许多组织来说，在团队间一致地记录和共享知识是一个痛苦的过程。随着时间的推移，高级工程师和经验不足的工程师之间的知识差距越来越大，使得实时故障排除更具挑战性。经验不足的工程师通常不知道哪些数据对特定事件是重要的，也缺乏理解因果关系的能力。

这是一个组织问题，因为它影响开发、运营和管理。大多数部署 daily 的公司报告说，他们的[工程师至少花一半的时间在故障排除和调试](https://resources.scalyr.com/hubfs/Content%20Assets/REP_StateDevOpsObs_201806_1.pdf)上。如果我们不为工程师提供学习联系、建模因果和允许跨团队共享“图表”的工具，这种“故障排除税”将会变得更高。

在不断变化的 DevOps 环境中，再多的测试或自动化也无法阻止 bug 进入生产环境。再多的混沌工程也无法预测每一次可能的失败。最后，我们必须认识到，很少会因为单一故障而发生停机。它通常是同时发生的“预先事件”(例如，配置更改、代码提交、脚本执行)的组合。无论你左移多少，当你右移时，总会有出错的地方——这就是你如何管理变化，如何将因果联系起来，从而带来更好的结果。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>