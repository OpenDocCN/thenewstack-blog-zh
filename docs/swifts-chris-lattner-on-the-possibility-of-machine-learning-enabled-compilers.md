# Swift 的克里斯·拉特纳谈机器学习编译器的可能性

> 原文：<https://thenewstack.io/swifts-chris-lattner-on-the-possibility-of-machine-learning-enabled-compilers/>

克里斯·拉特纳过着有趣的生活。在共同创建了 LLVM 编译器基础设施项目之后，他去了苹果公司，在那里他成为了 [Swift 编程语言](https://developer.apple.com/swift/)的设计师之一。在特斯拉工作了六个月后，Lattner 在 [SiFive](https://www.sifive.com/) 找到了一个新角色，这是一家使用免费开放的 RISC-V 指令集架构制造定制硅的无晶圆厂半导体公司。

所有这些经历让他不仅对编程语言，而且对将它们翻译成低级代码的编译器以及使用它们的社区有了独特的看法。因此，在 6 月，他出现在了[计算机器协会](https://www.acm.org/)的编程语言特别兴趣小组，为虚拟会议的与会者提供了一个“[问我任何事情](https://www.youtube.com/watch?v=QeG9bdkc3Lk)”的机会

他展望了 Swift 的过去和编译器的未来，以及它们目前面临的一些问题。他甚至看到了机器学习在编程和编译器开发中的可能作用。

以下是一些亮点:

[https://www.youtube.com/embed/QeG9bdkc3Lk?feature=oembed](https://www.youtube.com/embed/QeG9bdkc3Lk?feature=oembed)

视频

## 迅速的变化

当有人问及随着语言的发展，Swift 中的某些特性是否会被删除时，Lattner 给出了一个有趣的回答。

“是的！大量的坏主意被从 Swift 中剔除。”他笑了笑，然后补充道,“并且增加了大量的好主意……”

Swift 的[变更日志](https://github.com/apple/swift/blob/master/CHANGELOG.md)甚至可以追溯到现在开源软件的早期专有版本，还有[一个进化库](https://github.com/apple/swift-evolution)显示 Swift“现在是一种真正的语言”，正如 Lattner 所描述的，“是如何通过它的进化、迭代和变化而形成的。”Lattner 指出，在 Swift 2 时代有更多的变化，“因为这是 Swift 设计演变中兼容性可能被打破的时期。”

历史上一些有趣的变化:

*   虽然后来被删除了，但早期 Swift 有 Lattner 所说的“Ruby 风格的闭包，用管道来分隔参数，以及诸如此类的东西。”
*   Swift 过去也有递增和递减语法++和—(有前缀和后缀版本)。"因为不值得，而且会引起混乱，所以被删除了."
*   Lattner 还记得 Swift 曾经有 C 风格的循环，带有一个初始化、一个条件和一个增量。"这一点被去掉了，因为我们可以有 forEach 循环，我们可以有智能迭代器之类的东西."

作为 LLVM 的原始合著者，他也对语言和编译器相遇的空间给予了很多思考。LLVM 的核心库包括一个优化器、一个机器码生成器和 clang，这是一个 C/C++/Objective-C 代码的快速编译器，带有用户友好的错误消息。后来，康奈尔大学有人问当代编译语言的最大问题是什么 Lattner 首先承认一个疏忽“部分是我的错”

“我认为许多现代编译语言，包括 Swift、Rust 和 2010 年及以后的语言，已经忘记并正在重新发现高级中间表示的价值。”

“这是 Fortran 社区几十年前就知道的事情，”他笑着补充道。

中间表示(或 ir)是编译器创建自己的源代码内部版本以进行优化和重定目标的方式，“我认为拥有一个高级的中间表示，一个特定于语言的 IR 以进行更灵活的转换，是非常有用的。”他赞扬了 MLIR(多级中间表示)项目(T1)在这个问题上的努力，“我很高兴看到它被许多领域采用，包括现在的硬件设计。能够获得高质量的基础设施，并能够从中构建出很酷的东西，这真的很棒。

“我认为，这个领域还没有得到应有的深入探索，仅仅是因为基础设施还不够好。随着这项技术在编译器设计社区的普及，我认为我们将开始看到新的有趣的东西。”

![Chris Lattner in 2011 - by Alexandre Dulaunoy via Wikipedia](img/a6f0944d87c574607490f5aabba44c87.png)

一位来自伦敦计算机学院的提问者想探究为什么 LLVM 如此受欢迎。是因为更简单/更快/更易扩展这样的技术原因，还是因为在合适的时间被有影响力的人和组织提倡这样的社会原因？

“我会说两者都有，”Lattner 回答——还说它的受欢迎程度得益于其许可的开源许可。“我不认为有任何一个答案。”但是他指出 LLVM 的工具库真的很有用——例如，当一个研究人员想要专注于一个特定的问题，而不需要构建所有的周围基础设施时。“我认为 LLVM 最深刻的方面，真正有助于推动这个领域向前发展的，是模块化——事实上，它不是单片的……相反，它是一堆可以切片和切块并以不同方式应用于不同类型问题的库……当我看到人们做我从未想过或从未想象过的事情时，我非常高兴。”

是什么让这成为可能？简洁的设计、恰当的分层和正确的界面——“通过重视这些的社区和结构。”当然，拥有一个健康的开源社区，“因为这样你就不只是得到一个组织关心的技术，而是开始得到多个不同的向量，不同组织中的不同人关心不同的事情。这让它变得更加全面。”

作为一名程序员的程序员，Lattner 的思想似乎总是回归到让开发人员开心的最佳方式。Lattner 赞赏地谈到了已经出现的较新的分析测试技术，如 fuzzing 和 tier improving，“因为他们发现了一种不同类型的错误，如果你在野外遇到它，往往更邪恶，追踪起来也更昂贵。”他称之为“对编写测试用例的一个很好的补充，也是一种传统的软件开发方式。我认为它们是很棒的工具……我是这项工作的超级粉丝。”

他笑着补充道，“我认为这确实有助于推进编译器技术，让它真正发挥作用。”

## 编译器中的机器学习？

他是第一个承认有改进空间的人。“你可能已经注意到，一方面，编译器被描述为这些算法的美丽的柏拉图式理想，你可以在教科书中读到。另一方面，你去看它们，它们充满了可怕的试探法和各种令人讨厌的细节，然后使 spec 变得很快或什么的……”

因此，当圣保罗大学的一名提问者询问机器学习在编译器优化中的用途时，Lattner 看到了潜力。“挑战之一是现有的编译器，包括 LLVM，从来不是为机器学习集成而设计的。因此，有很多工作可以做，以整合[机器学习技术](https://thenewstack.io/category/machine-learning/)，包括缓存、离线分析等，以整合到我们的编译器框架中。但是因为抽象是错误的，所以在一次性研究论文之外很难做到这一点……”

他甚至举了一个例子。“例如，有一个预测算法来说，‘我们认为最好把这个分开’，这将是完全合理的——你可以让它具有确定性，它可能会有很大的价值……我认为现有的框架并没有为此做好准备，但肯定有很多工作要做。”

微软研究院的另一个问题是机器学习和人工智能现在如何影响软件开发，Lattner 表示这仍处于早期阶段。当谈到机器学习算法时，“大多数人都把它们当作一个函数。我可以用一个模型来训练猫探测器。现在我有了猫探测器功能；我放进一张图片，然后我得到一个预测…'对吗？它们基本上是函数。”

但相反，他希望看到机器学习成为自己的编程范式——伴随面向对象编程和函数式编程等方法的另一种编码形式。“这是一种非常、非常、非常擅长解决特定类型问题的编程模式。

“例如，我不会使用机器学习来编写引导加载程序——它不太擅长处理一些问题。但这是解决大多数人类生活领域中的问题的非常有用的方法。所以我认为它应该只是工具箱的一部分。我们越能打破工具差距、基础设施差距、语言差距，并使其与正常的应用程序流程相集成，我们就会做得越好。”

然后他不经意地添加了一段非常有用的旁白，供对进一步研究感兴趣的人参考。“这是用于 TensorFlow 项目的[Swift 的理念，如果你熟悉的话……”](https://www.tensorflow.org/swift)

Lattner 在结束时说，他真的很喜欢回答问题，并补充说，“也许我们明年还可以这样做。”

* * *

# WebReduce

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>