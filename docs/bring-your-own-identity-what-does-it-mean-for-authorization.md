# 自带身份:对于授权意味着什么？

> 原文：<https://thenewstack.io/bring-your-own-identity-what-does-it-mean-for-authorization/>

詹姆斯·科尼克

不确定他是一个写作的程序员还是一个编码的作家，詹姆斯试图尽可能多地将这种存在主义的紧张感融入到他的两种激情中，但他发现这对他的写作比他的软件更有好处。在日本，当他从键盘后面跳出来时，可以看到他在慢跑和骑自行车。

[认证和授权](https://thenewstack.io/how-do-authentication-and-authorization-differ/)通常是齐头并进的，但在现代软件架构中，这种情况越来越少。

身份验证是用户证明其身份的地方，而授权定义了他们在系统内部可以做什么——将他们分开可以让您对两者进行更深入的控制。

最近分离这两个部分的趋势——被 Gartner 称为“带来你自己的身份(BYOI)”——正在获得动力，并带来许多好处。

在本文中，您将了解为您处理身份验证时所创造的更多机会，以及如何利用这些机会。

## 什么是 BYOI，你为什么需要它

BYOI 是一种身份验证方法，允许用户通过第三方服务验证其身份。如果您已经使用您的谷歌、苹果或脸书凭证登录了一个网站或应用程序，您就已经熟悉它了。

这种身份验证方法正变得越来越流行，因为它给用户和开发者都带来了好处。

### 少了一个密码

通过采用 BYOI 并支持许多提供商，用户可以使用他们已经拥有的凭证登录，而不必仅为您的服务创建新的用户名和密码。随着我们都在使用的在线服务的激增，密码疲劳是真实的，让用户只需通过现有服务进行认证就可以从需要记住的列表中删除一个密码。

### 更好的安全性

BYOI 的主要好处之一是，它允许您使用比您目前所能提供的更高安全级别或用户信任级别的服务。对于新创公司来说，这可能是一个特别的问题，因为用户可能不想与他们分享所有的数据。

使用其他服务，如谷歌、苹果或脸书，可以缓解这些焦虑，并让你受益于它们提供的所有安全功能。在欧洲也有许多政府认证的身份服务，让你的用户证明他们是谁。

### 启用分离授权

如果你坚持使用现有的生态系统，如 [Django](https://www.djangoproject.com/) 、 [Ruby-on-Rails](https://rubyonrails.org/) 或 [Laravel](https://laravel.com/) ，在这些系统中，认证和授权是结合在一起的，很难超越它们所提供的功能。您可以重写现有的内容，但这需要大量的时间投入。

有了 BYOI，您可以处理身份验证，因此您可以专注于授权的实际业务逻辑，更重要的是，您可以选择一个解决方案，其中包括您想要的精确功能，并符合您在安全性和合规性等方面的需求。

这种灵活性还意味着您可以独立地交换或发展任一领域，例如支持新的身份提供者或更改角色的定义方式，这样更快，并且有利于扩展。

## BYOI 对授权意味着什么

BYOI 是身份认证和授权协同工作方式的一个范式转变，它意味着身份由第三方处理，授权现在与用户的身份源分离，因此可以超越典型用户管理系统的基本角色。

授权决策的制定方式在 BYOI 中并没有太大的变化——您仍然需要确定谁可以访问什么资源，并决定如何修改和使用这些信息——但是身份验证和授权之间的交互发生了变化。

### 多提供商建模

由于用户的身份来自任意数量的提供商，因此系统需要能够从其中任何一个提供商获取用户的配置文件。然后，您需要获取在令牌或回调中获得的标识数据，并将来自每个源的各种配置文件属性和帐户数据映射到一个标准化的模型中，该模型随后可用于制定授权决策。

处理这种差异，同时给予用户使用任何身份源的灵活性是挑战的一部分。然而，如果您想充分利用 BYOI 的优势，这是必不可少的，因为用户配置文件中有丰富的信息和上下文，可以在授权逻辑中使用。

### 角色和权限的复杂性

以前，很容易确定角色和权限，因为它们可能与用户的凭证存储在同一个数据库条目中，并且涵盖一个简单的服务。凭证可以在简单的一对一的基础上映射到权限。

现在情况变得更加复杂，因为围绕系统中谁能做什么的业务逻辑现在需要与任何特定的身份源分离。

由于有关用户的信息会因身份源而异，即使映射到您的标准化模型中，任何授权逻辑都需要处理部分或缺失属性的情况，这些属性以前可能存在于您自己的用户管理系统中。

这意味着角色和权限不再是每个用户的一组静态值，而是需要根据所提供的身份数据进行动态计算，现在更常见的是根据用户试图与之交互的资源的属性进行计算。

鉴于您可能希望在未来支持更多的身份提供者，现在是实现一个允许您将授权逻辑封装和分离到自己的服务中的架构的好时机，该服务可以处理动态身份信息。

你可以自己在内部构建这个，但是另一个选择是开源项目 [Cerbos](https://cerbos.dev) ，它可以帮助你利用 BYOI 要求的关注点分离。由于授权检查可以接受任意一组关于用户的属性(或者 Cerbos 所说的[委托人](https://docs.cerbos.dev/cerbos/latest/api/index.html#check-resources))，所以当用户身份可能来自多个不同的提供者时，这是一个完美的匹配。

在[授权策略](https://docs.cerbos.dev/cerbos/latest/policies/index.html)中，可以定义条件逻辑来检查用户身份的某些属性以及他们试图访问的资源，并处理正在使用的特定身份源可能缺少某些数据点的情况。当身份信息是动态的，并且随着您加入新的提供商而不断发展时，这是一种更具可伸缩性的方法。

## 结论

授权和认证曾经像面包和黄油一样形影不离。现代范例，如 BYOI，现在已经改变了用户身份在应用程序中的处理方式。

BYOI 对用户来说意味着少了一套需要记住和管理的凭据，他们可以放心地使用他们信任的身份提供者向您的应用程序进行身份验证。

对于开发人员来说，BYOI 强制分离身份验证和授权，并为选择这两个组件的最佳解决方案打开了大门，包括利用开源项目来确保您不会重新发明轮子，并允许您更加专注于交付您的核心价值。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>