# 现在是测试版，Rancher Labs 在生产中本地运行 Docker

> 原文：<https://thenewstack.io/now-in-beta-rancher-labs-runs-docker-natively-in-production/>

Rancher Labs 正在发布其管理平台的测试版，以便在生产中运行 Docker 容器。此前，该公司上周从梅菲尔德基金(Mayfield Fund)融资 1000 万美元。Rancher 反映了一个过渡时期，它是为一个新的应用程序时代而设计的，这个时代还有一段路要走。

牧场主提供了一种在生产中管理码头工人的方法。牧场主的一切都是一个容器。这是为了让开发者更容易开发应用程序。Rancher 是越来越多的趋势的一部分，为开发人员和运营经理尽可能地抽象复杂性。有持续集成平台，如[可发货](http://www.shippable.com/)；而像[云代工厂](https://www.cloudfoundry.org/)这样的平台是为企业客户服务的；而[中间层](https://mesosphere.com/)是数据中心操作系统。Rancher 的竞争对手 CoreOS 自动更新服务器，同时也提供服务，如为集装箱提供 etcd 支持的覆盖网络。它集成了 [Google Kubernetes](http://kubernetes.io/) ，一个容器集群管理器。 [Apcera](https://www.apcera.com) 开发了一项服务，我在 [TechCrunch](http://techcrunch.com/2013/10/15/the-cloud-washers-will-lose/) 上将其描述为“一个自主系统，它理解你想与谁交谈以及它如何与你交谈的概念。”换句话说，该技术知道数据库的语义，并可以将其与策略相关联。通过其通用的策略驱动平台，可以部署应用程序，但治理和监管要求会随之而来，并且可以在需要时进行编辑或更改。

## 需要转型

Rancher Labs 的联合创始人兼首席执行官盛亮表示，应用开发者必须意识到他们在运行什么。他们需要知道利用什么。Docker 平台将变得更加丰富。应用将决定它们提供什么样的基础设施功能。

以某种形式使用 Docker 的人有巨大的需求，但是基础设施还没有被改造。在从开发和测试到生产的过渡中，Docker 提供了所需的用户体验。命令行的工作方式，Docker Hub 的工作方式，API 的工作方式——引起了共鸣。

Rancher beta 是一个开源软件平台，为管理生产中的容器提供基础设施服务。它有几个核心组件，涵盖网络、负载平衡、存储管理、服务发现、服务管理、资源管理和本机 Docker 支持。

梁说，Rancher 核心的深层部分是其系统底板。这是一种分布式背板，与要求具有电阻的标准控制层略有不同。在遗留系统中，通常有多个系统需要管理和协调。梁说，牧场团队采取了不同的方法。它满足 Docker 应用程序的要求，与云或虚拟化环境相比，这是一个很小的集合。

以下是 Rancher 现在提供的详细信息，来自对梁的电子邮件采访。

### 交叉托管网络

梁说，这是牧场主首先开发的技术之一。如果没有某种形式的软件定义网络(SDN)，不同主机中的容器相互通信的唯一方式是网络地址转换(NAT)和端口转发。服务发现、负载平衡和应用蓝图都变得更加困难。例如，您不仅需要发现服务在哪个 IP 上，还需要知道它映射到哪个端口。Rancher 在构建基于 IPsec 的覆盖网络的基础上开发了自己的 SDN 技术。当然，默认情况下，所有通信都是加密的。

### 集装箱负载平衡

传统的负载平衡器——包括基础设施即服务(IaaS)云中的负载平衡服务——不是为容器设计的。它们将流量定向到虚拟机或主机，而不是单个容器。Rancher 的负载平衡服务旨在与 native Rancher SDN 或其他与 Rancher 集成的 SDN 解决方案配合使用，然后将流量导向各个容器。它旨在与基于容器的服务发现一起工作，这是构建微服务应用程序的一种常见方式。Rancher 的容器负载平衡也是使用容器本身实现的。它被设计成可扩展的、有弹性的和快速上升的，以满足突发的流量需求。

### 存储服务

Rancher 存储使用最新的 Docker17 存储插件框架实现，并与原生 Docker CLI 和 Docker Compose 模板无缝协作。它实现了增量快照和备份功能，使组织能够运行打包为容器的有状态应用程序。梁表示，集装箱存储是一个特别令人兴奋的领域，该公司将宣布更多的产品计划和合作伙伴关系。

### 服务发现

这曾经被认为是非常先进的应用程序部署技术，只有像网飞这样的互联网规模的组织使用。Docker 容器使得将小型应用程序组件打包成容器成为可能。然而，许多组织仍然不得不集成各种开源技术，如 SmartStack、Registrator、HAProxy、Consul 和 etcd，并花费大量开发工作来实现服务发现。

Rancher 的方法是提供与 Rancher 基础设施的其余部分集成的服务发现。Rancher 遵循 Docker Compose 流行的服务发现模型，其中每个服务由一个名称标识，并由一组运行相同 Docker 映像的容器实现。使用 Docker 链接将服务链接在一起。基于命名的服务发现需要分布式域名系统(DNS)服务。当一个容器启动时，Rancher 会自动在分布式 DNS 服务中注册它，以便其他容器可以找到它。

### 服务升级

在大规模微服务部署中，一个生产应用程序可能涉及几十个或几百个正在运行的服务，升级是一个巨大的挑战。几乎不可能一次部署、测试和升级整个应用程序。

像谷歌和脸书这样的组织开始执行连续交付，一次升级一个或一小组服务。每个升级的服务都将经过一个中间阶段，在这个阶段，它们将被部署到真实的生产环境中，并可以利用其他服务，但它们不会被其他服务使用或处理真实的工作。在新服务通过功能和性能测试后，生产工作负载被切换到新服务。如果新服务中断，生产工作负载可以切换回旧服务。当组织确信新服务是可靠的时，旧服务将被删除。

为了支持微服务升级，Rancher 允许用户克隆现有服务。克隆的服务可以拥有软件的新版本，并且仍然连接到现有服务所依赖的所有其他服务。因此用户可以单独测试克隆的服务。当用户确信克隆的服务可以工作时，生产可以切换到从现有服务到克隆服务的流量。

### 本机 Docker 支持

大多数基础设施提供商，包括 IaaS 云运营商、VMware 等虚拟化供应商和物理服务器供应商，都在开发 Docker 机器插件，以便 Docker 用户可以在 Docker 已经运行的情况下以编程方式配置 Linux 服务器。通过与 Docker Machine 集成，Rancher 用户可以选择云提供商并在云上提供资源来运行他们的 Docker 容器。Docker Machine 使 Rancher 能够完成这一切，而不必与许多云提供商进行 API 集成。

Rancher 支持其他容器环境，但从产品角度来看，该公司决定专注于 Docker，它具有最显著的真实用户采用率。用户反馈将决定 Rancher 是否支持其他容器技术。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>