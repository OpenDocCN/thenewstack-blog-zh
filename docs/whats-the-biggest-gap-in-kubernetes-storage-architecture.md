# Kubernetes 存储架构的最大差距？

> 原文：<https://thenewstack.io/whats-the-biggest-gap-in-kubernetes-storage-architecture/>

[](https://www.linkedin.com/in/rvandepoel/)

[Romuald vande poel](https://www.linkedin.com/in/rvandepoel/)

[Romuald 是 Ondat 的云解决方案架构师，带领客户踏上数字化转型之旅。他在企业 IT 领域拥有丰富的技术经验，曾在 Red Hat 和 NetApp 担任客户支持、咨询和交付方面的领导职务。Romuald 就企业架构、开发运维、云原生和敏捷实践为组织提供建议。](https://www.linkedin.com/in/rvandepoel/)

[](https://www.linkedin.com/in/rvandepoel/)[](https://www.linkedin.com/in/rvandepoel/)

年复一年，在 Stack Overflow 的开发者调查中，Kubernetes 一直是最受欢迎的平台之一。不难理解为什么。它易于扩展，非常稳定可靠，可以在许多不同的环境中工作。简而言之，它提供了开发人员喜欢的所有特性。

然而，它开始失去光彩的地方是生产。世界上的大多数应用程序在某种程度上都是有状态的，需要从一个会话到下一个会话的持久存储。容器，或者说容器编排器，不太适合持久存储和有状态应用。让我们探讨一下为什么 Kubernetes 的存储架构缺乏，以及用户可以做些什么来在生产中托管有状态的应用程序。

Kubernetes 存储架构的最大差距？事实是它不存在——在 Kubernetes 中没有任何东西可以被恰当地称为存储架构。

相反，Kubernetes 提供了一个存储框架。container orchestrator 从一开始就没有打算提供存储。

有几个原因可以解释为什么会出现这种情况，为什么这是一件好事，尽管这可能会让生产经理的工作更加困难。

首先，容器本质上是短暂的。集装箱化的好处在于能够快速地制造或销毁集装箱。将有状态的工作负载绑定到容器可以防止这种情况发生。反过来，这将妨碍快速故障转移、轻松更新、轻量级供应以及我们从容器短暂的本质中获得的其他好处。

然而，这并不是一个不可克服的挑战。Kubernetes 生态系统的主要贡献者——特别是 Google 和 Red Hat——可以相对容易地发布一些确定的“官方”Kubernetes 存储架构。

这将把 Google 和 Red Hat 的特殊设计偏见结合到系统中，这将有助于厂商锁定，这将违背 Kubernetes 项目的开源性质。如果 Google 为 Kubernetes 开发了自己的存储系统，那么即使该系统不能满足您特定应用程序的需求，它也将成为默认的存储选择。

通过提供一个存储框架——[容器存储接口，或 CSI](https://storageos.com/storage-for-kubernetes)——而不是一个存储架构，Kubernetes 项目以简单性为代价为用户提供了自由和灵活性。

## 这对构建有状态应用程序意味着什么？

因为 Kubernetes 提供这个框架来连接第三方存储架构，而不是它自己的存储架构，所以 Kubernetes 用户面临两种选择:

1.  使用开源项目为您的应用构建定制的存储解决方案。
2.  使用最适合您应用需求的现成商业存储解决方案。

正如我们将看到的，第一种方法有明显的缺点。

### 为什么开源方法如此具有挑战性

别自欺欺人了，开源软件有很多好处。它是免费的、灵活的，它利用大众的智慧来克服挑战和发明新的解决方案等等。

开源模式并不适合所有的应用程序和所有的行业。虽然开源解决方案最初是免费的，但它们的代价是更高的风险、更大的团队、更慢的开发和类似的隐性成本。

在容器化应用程序的持久存储环境中，平台用户需要依赖基于多个开源项目的解决方案来满足他们的需求。这些不同项目中的每一个都是为了解决一个特定的问题，从而形成一个拼凑的存储解决方案。

此外，这种缝合几乎保证了某些东西在某个时候会坏掉，当它坏掉时，你唯一需要咨询的如何解决问题的专家就是你内部培训过的专家。考虑到停机的成本，不包括难以量化的声誉损失，可能超过[每分钟 5600 美元](https://blogs.gartner.com/andrew-lerner/2014/07/16/the-cost-of-downtime/)。大多数依赖开源解决方案的组织都希望培训开发人员，使他们专攻给定应用程序的存储解决方案。由于这些缝合在一起的解决方案总是需要为每个项目定制，所以您需要雇用开发人员来相应地支持每个项目。

### 为什么商业解决方案更简单

实际上，商业解决方案并不比开源解决方案更好——本质上并不是。商业企业存储解决方案可能仍然不适合您的特定项目，需要内部专业知识，需要大量定制，容易崩溃，并带有开源解决方案的所有缺点。

不同之处在于，开源解决方案肯定会带来这些令人头疼的问题，而设计良好的商业企业存储解决方案则不会。

这不是商业与开源的问题，而是好的架构与坏的架构的问题。开源解决方案不是从头开始设计的，这使得保证一个架构运行良好并最终省钱变得更加困难。然而，商业存储解决方案是。这增加了它采用满足企业需求的架构的可能性。

最终，所有这些都是为了说明商业存储解决方案比开源解决方案更适合大多数 Kubernetes 用户，但这并不意味着你可以跳过评估过程。无论是开源的还是商业的，确定任何解决方案是否满足您的性能需求都是非常重要的。

在 Ondat，我们委托进行了一项研究，比较四种领先的持久存储解决方案的性能。[下载研究](https://resources.storageos.com/downloadbenchmarkreport)看看他们在一系列标准化测试中的表现。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>