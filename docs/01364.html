<html>
<head>
<title>How LinkedIn, PayPal Each Beat Database Lag with Home-Built Open Source</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LinkedIn和PayPal如何通过自制开源软件战胜数据库滞后</h1>
<blockquote>原文：<a href="https://thenewstack.io/how-linkedin-paypal-each-beat-database-lag-with-home-built-open-source/#0001-01-01">https://thenewstack.io/how-linkedin-paypal-each-beat-database-lag-with-home-built-open-source/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">在上个月的QCon New York 上，<a href="https://www.paypal.com/us/home" target="_blank" rel="noopener noreferrer external " class="ext-link"> PayPal </a>和<a href="https://www.linkedin.com" target="_blank" rel="noopener noreferrer external " class="ext-link"> LinkedIn </a>各自发布了旨在加速和简化数据传输的新软件项目。两者都是内部设计的，以更好地管理每个互联网服务获得的大量数据和交易，两者都以开源包的形式发布。</p>
<p class="translated">PayPal最近开源发布的Hera是一个专门为微服务池化和管理数据库连接而构建的数据库代理。LinkedIn的Brooklin是该公司计划不久后作为开源软件发布的，它是该公司的中央数据总线，将许多后端数据库和数据存储与面向用户的应用程序连接起来。</p>
<p class="translated">希望简化和加速后端数据源和面向用户的应用程序之间的数据移动的组织应该检查这两个项目。</p>
<h2 class="translated">嘿赫拉</h2>
<div id="attachment_7910433" class="wp-caption alignright"><a href="https://thenewstack.io/wp-content/uploads/2019/06/d554db55-hera.jpg" class="local-link"><img aria-describedby="caption-attachment-7910433" decoding="async" loading="lazy" class="wp-image-7910433 size-medium" src="../Images/d4314b5efc7aaed5fa9dc2fd3a3020e2.png" alt="" data-id="7910433" data-original-src="https://thenewstack.io/wp-content/uploads/2019/06/d554db55-hera-300x225.jpg"/></a><p id="caption-attachment-7910433" class="wp-caption-text translated">贝宝员工工程师彼得里卡·沃伊库(左)和肯尼斯·康。</p></div>
<p class="translated">在线支付公司Paypal严重依赖数据库:目前，该公司有2000个数据库实例，共存储74PB数据，最繁忙的数据库每小时处理近10亿次呼叫。与任何在线服务一样，响应时间至关重要，其中最大的问题是数据库连接时间，每次连接时间可达100毫秒。更糟糕的是，每个数据库实例一次可以处理的连接数是固定的。数据库实例的连接数越多，其性能就越差。</p>
<p class="translated">一种可能的性能平滑方法是建立一个连接池，它对多个微服务的请求进行处理和排队。根据PayPal员工工程师<a href="https://www.linkedin.com/in/voicu/" target="_blank" rel="noopener noreferrer external " class="ext-link">佩特里卡·沃伊库</a>和<a href="https://www.linkedin.com/in/ksykang/" target="_blank" rel="noopener noreferrer external " class="ext-link">肯尼斯·康</a>的介绍，这就是PayPal的Hera所做的，位于微服务和数据库之间，汇集连接，并提供额外的服务。</p>
<p class="translated">Hera已经在生产环境中运行了一年，并且位于数百个数据库实例的前面。</p>
<p class="translated">Hera管理读和写。它选择一个特定的节点来发送所有的写入，从而减少了大量的来回握手，从而加快了所有其他实例的流量，这些实例可以专注于完成读取请求。虽然应用程序本身不需要修改，但是需要一些额外的功能来与Hera通信，以指定要与哪些数据库碎片通信。于是团队为C++、Java、Python、Node.js和Go调用创建了库。</p>
<p class="translated">Hera还带有一些内置的弹性和恢复保护措施:当一个节点断开时，它可以平衡其余节点之间的连接。在过载时，它会立即终止SSL连接，因此应用程序可以立即启动到故障模式，而不会在没有清晰的数据路径时让用户挂起。它还提供了迁移功能，即使在事务仍在处理的情况下，也能方便地将数据库碎片从一个节点安全地迁移到另一个节点。</p>
<p class="translated">Hera的代码<a href="https://github.com/paypal/Hera" target="_blank" rel="noopener noreferrer external " class="ext-link">可以在GitHub </a>上获得。</p>
<p class="translated">【T2<img decoding="async" loading="lazy" class="aligncenter size-large wp-image-8021225" src="../Images/622601a482053b9b7c412f6fd6e5872e.png" alt="" data-id="8021225" data-original-src="https://cdn.thenewstack.io/media/2019/06/55be9978-img_0078-1024x768.jpg"/></p>
<h2 class="translated">不到布鲁克林不睡觉</h2>
<p class="translated">LinkedIn对数据流延迟也不陌生:八年前，这家社交媒体巨头开源发布了Kafka，这是一个流媒体数据平台，作为创建数据流的集中式发布-订阅机制。现在，该公司负责管道集团的领英工程经理<a href="https://www.linkedin.com/in/celiakkung/" target="_blank" rel="noopener noreferrer external " class="ext-link">龚婉慈</a>说，该公司的一个新项目Brooklin是关于将多个数据源连接到多个目的地。</p>
<p class="translated"><a href="https://cdn.thenewstack.io/media/2019/06/fd9fbe46-img_0096-2.jpg" class="local-link"> <img decoding="async" loading="lazy" class="alignright size-medium wp-image-8021226" src="../Images/e870401f07cea44da293908f323deec2.png" alt="" data-id="8021226" data-original-src="https://cdn.thenewstack.io/media/2019/06/fd9fbe46-img_0096-2-300x225.jpg"/> </a></p>
<p class="translated">Brooklin解决了当数据来自多个来源时，如何将数据流传输到多个终端节点的难题。今天，LinkedIn使用Brooklin来支持200多个应用程序。光是卡夫卡，它每天就要传递超过2万亿条信息，涵盖数万个主题。这些功能可以由开发人员单独配置并动态部署，无需手动更改配置文件或手动部署到群集。</p>
<p class="translated">首先说一下这个名字:布鲁克林并不是以纽约区命名的。相反，它是两个词的聚合:“brook”(像小溪)和一个缩写的“LinkedIn”。该软件就像一条缓缓流动的数据小溪，为近乎实时的应用程序提供来自后端数据库的素材。例如，LinkedIn用户会自动在自己的日程表上看到他们联系的人获得新工作或晋升的时间。Brooklin将这些数据从后端数据库转移到产生每个用户时间表的应用程序中。</p>
<p class="translated">虽然最初LinkedIn将其大部分用户数据存储在Oracle中，但此后它采用了更广泛的数据存储系统，特别是自2006年微软收购LinkedIn以来。现在，用户和运营数据在Kafka、MySQL、微软Event Hubs、该公司自己的<a href="https://engineering.linkedin.com/espresso/introducing-espresso-linkedins-hot-new-distributed-document-store" target="_blank" rel="noopener noreferrer external " class="ext-link"> Espresso数据存储</a>和亚马逊Kinesis等平台上被捕获。最初，Kung的团队创建了一个数据总线来捕获Oracle数据库中的任何更改，但该代码特定于这一个连接。他们希望构建一种数据总线，既能从多个来源接收数据，又能被多个接近实时的应用程序使用。</p>
<p class="translated">LinkedIn将Brooklin用于各种用例，包括变更数据捕获(将数据库中的变更传播到应用程序)，消除针对数据源本身运行查询的开销。Brooklin还可以刷新缓存并建立搜索索引。它可以作为一个流桥，将数据从一个数据源转移到另一个数据源，比如从AWS转移到Microsoft Azure。它还可以用于对数据进行重新分区。它可以用于建立数据仓库，通过将数据传输到Hadoop文件系统(HDFS)来消除对提取、转换和加载(ETL)工具的需求。</p>
<p class="translated"><a href="https://cdn.thenewstack.io/media/2019/06/96b39295-img_0108-2.jpg" class="local-link"> <img decoding="async" loading="lazy" class="aligncenter size-large wp-image-8021227" src="../Images/86ed4486686e01abe74bdd86e122d3fa.png" alt="" data-id="8021227" data-original-src="https://cdn.thenewstack.io/media/2019/06/96b39295-img_0108-2-1024x768.jpg"/> </a></p>
<p> </p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>