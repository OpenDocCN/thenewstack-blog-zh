# 英特尔的透明容器解决了安全问题

> 原文：<https://thenewstack.io/securing-containers-intels-clear-containers/>

如果你经常阅读这个网站，你可能会同意容器是如何开始改变我们对应用程序堆栈的看法的。然而，围绕集装箱安全的主要问题仍然存在。

至少有一家公司认识到了这个问题，那就是英特尔，它在今年早些时候推出了 Clear Containers，这是一种旨在将全虚拟机(VM)的安全优势与容器的部署便利性相结合的技术。CoreOS 的 [rkt](https://github.com/coreos/rkt) 容器运行时(大家都叫它“火箭”)0.8 版本加入了透明容器，提供硬件辅助安全。

虽然虚拟机本身提供了良好的隔离(因为虚拟机管理程序上的攻击面非常小),但容器仍然依赖借来的安全性。它们依赖于构建它们的基础技术，当然，也依赖于人的精心配置。您可以看到潜在的问题可能在哪里。

例如，Docker 守护进程作为根用户运行，因此系统架构师有责任始终保持警惕。您想通过花哨的仪表板使用 API 来自动供应容器吗？小心点。命名空间、控制组和每个容器的网络堆栈的使用是一种福气，并阻止了攻击可能性的主要方面。现在，每个容器都相互隔离，并与主机隔离。即使这样，通常也建议在主机上使用强化技术，比如为 AppArmor 或 SELinux 使用精心选择的策略。
英特尔的透明容器方法是[一种混搭](http://lwn.net/Articles/644675/)应用于容器基础设施的虚拟机技术的成熟安全性。简而言之，这些容器是高度优化的精简虚拟机，可提供快速启动和关闭时间，并支持在其中运行 rkt 容器。他们拥有虚拟机的所有优势以及容器的速度。

这个系统的核心是一个名为 [native KVM Tool](http://lwn.net/Articles/436781/) 或 KVM Tool 的老项目，它旨在提供一个轻量级的基于内核的虚拟机，作为庞大的 QEMU-KVM 方法的替代方案。kvmtool mini-hypervisor 方法允许透明容器直接引导到 Linux 内核，而不需要专用的 BIOS 或 UEFI。除此之外，内核被剥离到只支持 Virtio，并且在用户空间中有一个调整的 systemd 实现。

为了减少内存消耗，开发人员在 Linux 内核 4.x 中使用了 [DAX](http://lwn.net/Articles/610174/) (直接访问)支持。DAX 支持的块设备允许主机和客户机之间的零拷贝数据共享。DAX 完全绕过了页面缓存和虚拟内存子系统。除此之外，Clear Containers 在主机上使用[内核同页合并(KSM)](http://lwn.net/Articles/330589/) 来进一步减少内存开销。

## 它能跑多快？

[在《Linux 周刊新闻》上报道](http://lwn.net/Articles/644675/)英特尔 Linux 内核工程师 Arjan van de Ven 说，通过所有的优化，基于 kvmtool 的虚拟机管理程序设置需要 30 毫秒，内核启动现在需要 32 毫秒，用户空间在不到 75 毫秒内启动。容器系统可以在大约 150 毫秒内启动。

这是一个非常好的数字，与集装箱运输时间相当。这比传统的 QEMU-KVM 要先进得多。内存占用大约为 18 到 20MB，考虑到这仍然是一个试图像容器一样工作的虚拟机，但是所有的安全性都由它来处理，这是一个令人印象深刻的内存占用。

类似的获得更快速度和使用更少资源的方法——但功能有限，受攻击面有限，可能会导致稍微提高的安全性——是由 [unikernels](https://en.wikipedia.org/wiki/Unikernel) 和“库操作系统”如 MirageOS、OSv 和 Rumprun 采用的方法。

让我们看看开发人员在试图缓解容器中的安全问题时所想出的所有创意吧！

CoreOS、Docker 和 Intel 是新堆栈的赞助商。

特征图片:英特尔。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>