# F5 Networks 将 Node.js 与负载平衡相融合，用于工作流程编排

> 原文：<https://thenewstack.io/f5-networks-fuses-node-js-load-balancing-workflow-orchestration/>

传统上，这个网站是关于大规模编排应用程序的。我们知道，将应用程序视为需要扩展的单元是错误的。相反，如果您将应用程序分解为服务(“微服务”)，然后扩展服务，您将有更有效的方法将复杂的应用程序扩展到其确切的工作负载。

随着网络工程师越来越多地与面向微服务的软件开发社区集成，他们带来的技能以服务定义为中心。周二上午，在奥地利维也纳举行的一次会议上， [F5 Networks](http://www.f5.com) 宣布对其应用交付控制器(ADC)进行重大升级，实际上解决了服务定义和服务扩展问题，以完成工作。

为了赢得 DevOps 社区的支持，F5 发布了名为 iWorkflow 2.0 的工作流自动化 API 平台，作为其对 [Big-IP SDN](https://www.f5.com/pdf/solution-profiles/sdn-services-cloud-architecture-solution-profile.pdf) 基础设施平台的最新升级的一部分。该 API 不仅是围绕开源网络脚本语言 TCL(发音为“tickle”，起源于网络社区)设计的，而且是围绕 Node.js 设计的，node . js 是 DevOps 社区现在不可或缺的工具。

## 节点爆炸

“我们之前使用 TCL 在我们的平台上支持应用程序逻辑，这允许您重写 URIs，进行不同类型的负载平衡来操作内容，[操作]标题，你能想到的，你都可以做到。F5 的主要宣传者 Lori MacVittie 在接受新堆栈的采访时说。

“但这些年来，我们看到 JavaScript 和 Node 呈爆炸式增长……因此，我们在这一最新软件版本中做的一件事是，为您可能希望放在代理中的那些功能和逻辑添加功能，以使用 Node.js。现在，您可以编写代理逻辑，将其放在 Big-IP 上，并让它通过代理中的 Node.js 来操纵流量、引导流量、保护流量。因此，您不必将它放入每个应用程序或每个实例中。你可以把它向上游移动，遏制它，然后用那种方式处理它。”

Big-IP 是服务提供商社区中的一个成熟平台。MacVittie 将其描述为最终用户(服务提供商的客户)和为他们准备的应用程序之间的一个层。该平台提供负载平衡、缓存，并不时地操纵数据包的报头、调整 URIs，以及进行实时配置调整(比如对`httpd.conf`文件)，以更好地将流量路由到更合适或更可用的服务器。

“你将这种逻辑放在 Big-IP 代理中，”她说，“它使这些架构能够更好地扩展，因为你可以在上游这样做，这样可以更好地了解流量和实际到来的请求。Big-IP 是用户的代理，并提供一些需要在网络中完成的应用架构逻辑，以实现扩展、安全性和动态性能增强。”

## 少关注应用，多关注服务

当 SDN(软件定义的网络)的话题首次进入软件开发人员的讨论圈时，其最早的实践者向他们做出的承诺是基于“应用定义的网络”——即应用本身可以在任何给定的时间内为自己的目的指定最佳网络。在当时，这似乎是一种明智的做法。

但是，扩展包含自己的扩展逻辑的应用程序的问题是，逻辑本身会被复制，从而产生不必要的负担，降低性能并增加延迟。微服务架构将完全解决这个问题，但前提是您没有在过渡过程中必须继续运行的遗留应用程序。

F5 的方法是将逻辑嵌入到代理中，使应用能够包含应用本身固有的代码。

“我们理解 HTTP、HTTP/2、WebSockets、HTML5，所有这些都是开发人员现在用来部署他们的应用程序的东西，”MacVittie 说，“我们理解它们，可以在 Big-IP 上使用这种语言，并提供一个环境，在这个环境中，您的规模可以基于简单的东西，如负载平衡算法，即循环法、最小加权连接或最快响应。

“但它也让你可以构建一个架构，这在你开始扩展微服务和 API 等东西时非常重要，因为你不会将整个应用程序放在一台机器上。它们将分布在多个领域。你希望能够在前端为用户提供统一的体验，所以他们只去一个地方；但是在后端，你可能分散在一大堆不同的环境中。可能一个是虚拟化，一个是容器；一个是还没更新的老应用。你希望能够将它们分开，并在它们之间实现负载平衡，以这种方式引导流量。”

MacVittie 继续说，有了 Node.js，开发人员或运营商可以根据当前承载数据包的设备的身份或位置，以及下一跳将承载数据包的设备来处理数据包。当您的目标是弹性时，您希望能够扩展您的应用程序正在使用的软件定义网络的地图，而不仅仅是放大它。当工作负载扩展时，逻辑需要调整，而不是随着工作负载成比例地扩展。

公平地说，这可能不是一种新颖的方法:去年 [NGINX Inc .开始在其 NGINX 和 NGINX +代理中嵌入一个 VM](https://thenewstack.io/nginx-adds-javascript-engine-to-become-rules-based-reverse-proxy/) ，其运行时基于 JavaScript。 [Avi Networks 在](https://thenewstack.io/avi-networks-microservices-cant-automated-monolithic-tools/)之前已经证明了单一的扩展方法不适用于微服务；复制应用程序，就好像它们是不可分割的设备一样，并不会产生更好的性能，甚至是良好的性能。

然而，周二的发展表明，网络服务市场和 DevOps 服务市场正在走到一起:具体来说，它们瞄准了相同的客户，并相互竞争。实际上，它们现在是同一个市场。

## 碎片文章

我请 MacVittie 向我们描述一些 Big-IP 的潜在现实世界、企业场景。她提供的一个例子是网络级别的数据库分片。基于可以在 JavaScript 代码中反映的任何标准，对数据库的特定部分的查询可以被定向到离散地址的特定服务器。例如，由某个技术博客发布的文章可能被托管在不同区域的多个数据库中(假设某个博客很快会变得非常受欢迎)，但是对这些文章的拉取请求可以被分类分发。

“使用 Node，你可以检查 URI，就像你在处理一个 API 时检查页面路由一样，”她解释道。逻辑会将请求定向到特定的池或虚拟 IP (VIP)地址。在 iWorkflow 2.0 的术语中，这些东西是在类中指定并在 JavaScript 变量中表示的对象。

“它以非常面向对象的方式公开事物，”F5 的 MacVittie 继续说道，“因此你可以在熟悉的环境中操作事物。Node 非常简单；差不多就是 Node。在使用它的过程中，我没有发现我在标准节点服务器上使用它与在 Big-IP 上使用它有什么不同。”

F5 还将提供一个 Eclipse 插件，用于为 Big-IP 和 iWorkflow 2.0 编写 Node.js 代码，新平台将于第二季度发布。

特征图片:[专业的盘子旋转者和杂耍者 Henrik Bothe](https://commons.wikimedia.org/wiki/File:Henrik_Bothe_plate_spinning.jpg) ，来自维基共享资源，在 [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/deed.en) 下获得许可。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>