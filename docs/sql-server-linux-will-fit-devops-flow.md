# Docker 容器如何帮助 SQL Server 2017 将部署转移到开发人员

> 原文：<https://thenewstack.io/sql-server-linux-will-fit-devops-flow/>

有了 [SQL Server 2017](https://www.microsoft.com/en-us/sql-server/sql-server-2017) ，微软不仅仅是想把自己重量级的 RDBMS 带到 Linux 上；它想让开发者更容易访问它，这样它就可以通过容器利用 DevOps 和持续集成的趋势。

这是 SQL Server 过去不具备的功能；SQL 程序经理[托尼·彼得罗相](https://twitter.com/tonypetrossian)告诉新的堆栈，不仅仅是因为它运行在 Windows Server 上，还因为它的部署和管理方式与开发人员使用的其他组件如此不同。

“一段时间以来，人们一直在使用 CI/CD 和 DevOps 来构建数据库应用程序，但 SQL Server 本身从未作为应用程序的一个组件参与到该生态系统中，因为 SQL Server 始终是在其他地方管理的服务器。作为一名开发人员，你得到的是一个连接到 IT 世界某处数据库的连接字符串；数据库二进制文件本身总是与应用程序开发过程无关。”

将 SQL Server 迁移到容器中不仅仅意味着更快的部署；这意味着您可以将它作为开发的一部分而不是操作的一部分来部署，并像测试任何其他代码一样测试您的数据库代码。您甚至可以将经过清理的数据子集放入 devtest 的容器中，并让管道在安全的环境中使用完整的数据集自动测试代码。

Petrossian 解释说:“我们真正想做的是允许开发人员将 SQL Server 的实际二进制文件作为他们的 CI/CD 或他们使用的任何其他开发流程中的应用程序组件，与他们作为应用程序一部分的任何其他库没有什么不同。“因此，通过开发人员对应用程序进行的所有更改，应用程序和数据库同时接受测试，所有自动化测试包括数据库本身。”

这阻止了开发人员使用 SQL Server 新版本中的功能，这些功能不受为企业软件较慢版本设计的操作和 IT 流程的限制。“最终，我们希望这将简化升级，因为如果开发人员因为 SQL Server 具有特定功能而决定使用新版本的 SQL Server，那么他们只需将其引入并更改他们的应用程序即可使用该功能。然后，他们的所有自动化和测试开始生效，他们验证数据库的新版本以及他们的应用程序，而不是开发人员编写新代码，并要求 IT 部门在某个地方升级某个服务器，这可能需要一些时间，或者根本不会发生。”

“距离总是很麻烦，能够在一个地方完成所有这些将简化每个人的过程，”他建议道。即使是帮助制造这一鸿沟的 IT 团队也对结果不满意，因为开发人员倾向于绕过它们。

“客户告诉我们的是‘如果我不能升级，我不能让开发人员做他们需要做的事情，他们就从网上拿一些其他产品扔进去，假装它只是他们应用程序中的一个库，现在我们必须支持这个其他东西’。他们想让我们把 SQL Server 放在那里，就像选择开发人员可能选择包含在他们的应用程序中的任何开源库一样简单。”

SQL Server 容器化还改善了在不同平台上工作的开发人员的协作体验。“因为它运行在 Docker 容器中，你可以在它上面运行任何版本的 Linux，任何发行版，”他指出。“如果我正在使用 Ubuntu，而我的应用程序最终在 Red Hat 上运行，或者我将我的应用程序传递给我的同事以添加一些东西，而他们使用的是不同版本的 Ubuntu，这都没有关系，因为它都是独立的。所有依赖项都是内置的，包括 SQL Server 的版本。让开发环境中的确切环境与您的转移路径和生产相匹配不再那么重要。”

当开发完成后，部署不再是一个不同的过程。"您只需发布生产版本，这些容器的生产版本就可以部署到生产中."

SQL Server 团队中开发工具的开发人员发现，这提高了他们自己的工作效率，并以熟悉 DevOps 的人所熟悉的方式改变了他们的工作流程。Petrossian 解释说:“他们不是让其他开发人员去找他们必须要安装的东西，而是说‘去找这个容器，里面有 SQL Server 的特定版本和完成工作所需的工具版本’。

“几乎没有人再安装任何东西了；他们倾向于保持机器的清洁和纯净。旋转一个容器，完成你的工作，然后扔掉它，比污染你的机器，在上面安装你可能永远也不能删除的东西要容易得多。这是另一种简化，现在 SQL Server 是其中的一部分。”

他特别指出，这给了开发者更多的开发环境选择。

“在 SQL 团队中，我们有一群喜欢在 MAC 上运行的人——使用跨平台工具的人倾向于在 MAC 上运行——还有一些人已经在 Windows 上运行了很长时间。这种容器化的环境意味着您可以让 SQL Server 以任何一种方式运行，并且现在传递东西很容易。即使在 Windows 中，您也可以在容器中运行 Linux 映像，因此，使用运行在不同平台上的相同版本来维护统一的代码库变得越来越容易。我们一直非常关注 Windows 和 Linux 之间的完全兼容性，因此客户可以随时在 Windows 和 Linux 之间移动数据库。您基本上复制文件，挂载它们，然后 SQL Server 就启动了。这不是一个迁移或端口或任何东西；这就像把一个数据库从机器 A 移到机器 B，他们只是有不同的操作系统。现在 Windows 中有了所有的 Linux 工具，复制东西真的很容易。”

Petrossian 说，如果所有这些听起来就像 DevOps 通常的优势，那么它就是。“这非常符合其他人在构建应用程序时所做的事情，但在这种情况下，它会包含一个数据库。”

来自[微软](https://www.microsoft.com/en-us/sql-server/sql-server-2017)的特征图片。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>