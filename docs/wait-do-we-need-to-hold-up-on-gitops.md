# 等等，我们需要暂停吗？

> 原文：<https://thenewstack.io/wait-do-we-need-to-hold-up-on-gitops/>

[](https://www.linkedin.com/in/eric-gregory-0187334b/)

 [埃里克·格雷戈里

埃里克·格雷戈里是米兰蒂斯公司的高级技术作家。他是一名作家和前计算机科学讲师，撰写关于 Kubernetes、containers、开源、DevOps 等内容的文章。](https://www.linkedin.com/in/eric-gregory-0187334b/) [](https://www.linkedin.com/in/eric-gregory-0187334b/)

今年早些时候，Thoughtworks Radar [对 GitOps](https://www.thoughtworks.com/radar/techniques?blipid=202104006) 做出了惊人的判决。Radar 带来了一个专家小组对开发人员工具、技术等的意见，宣布 GitOps 为“暂停”，这意味着团队应该“谨慎行事”。

多年来，博客、网络研讨会和白皮书都认为 GitOps 是下一个大事件，然而在这里，该领域一个受人尊敬的声音说要小心行事。那么是什么原因呢？我们需要踩刹车吗？GitOps 只是一堆莫须有的炒作吗？或者这里有一块缺失的拼图？正如许多事情一样，答案是:这很复杂。GitOps 对于一些团队来说可能是变革性的，但它不是一个放之四海而皆准的解决方案。

## GitOps 复习工具

值得停下来简单地定义一下 GitOps，因为在一个看似简单的名字下面，是软件开发和交付范例的整体重构。

GitOps 的目的是创建一个操作模型，用于在一个具有“单一事实来源”的系统中持续开发和交付软件，也就是说，一个确定的、声明的状态，系统向该状态收敛。通常，这意味着将 Git 与 Kubernetes 结合使用，Kubernetes 的声明性和聚合性非常适合这项工作。

结合版本控制和容器编排的能力，对系统配置的每一个改变都可以被观察、监视、跟踪并用于触发一些其他的编程动作。与 Git 提交相关的所有元数据都跟随着每一次修改，并且每一次修改都可以被跟踪或回滚，这大大降低了一开始就进行更改的风险。理论上，这是一个“撤销”按钮。

这就抓住了单一真理来源的要点和吸引力。你对单一的源代码编写代码，系统就收敛到理想状态。你在那一点上修复了一个错误，系统又收敛了。这个想法有一种近乎神话般的吸引力，但是有形的好处也是显而易见的:团队可以更频繁地部署。同样，调试应该更快，只需要检查一个代码库。如果对系统的更改导致崩溃，恢复就是回滚。

有了所有这些好处，听起来是时候把整个世界放进 Git 仓库了，对吗？

## 当模型与世界相遇

GitOps 的可行性最终将取决于您尝试应用该模型的环境。这是一个多维度的问题:

*   你的团队有技能和时间来完成转变吗？
*   您的数据中心是否有需要适应的特质？
*   你的应用用例怎么样？您是否正在使用可能无法轻松进入版本控制的单片系统或遗留系统？

当一个美好的运营模式遭遇一个混乱的世界时，就会出现这类问题。一个特定版本的上下文问题提出了可能是实现 GitsOps 中讨论最广泛的挑战:团队应该如何将变更从一个环境传播到下一个环境？比如说，从 QA 环境到生产？

这并不是一个无法解决的问题，但是这通常意味着向组合中添加更多的工具，或者在一个模式中使用多个分支，从而引入了配置漂移的机会。越来越多考虑 GitOps 的人注意到应该避免这种多分支方法，事实上这似乎是 Thoughtworks Radar 犹豫不决的症结所在。

## 为我，也许为你

你可以看到雷达是如何得出结论的。目前，“GitOps”是一个大帐篷，有一个大而美的想法的许多探索性实现。虽然我们可以在该模型的更多和更少成功的方法上找到一些一般的社区共识——并且适应多种环境的分支肯定是分类帐中不太成功的一方——但是我们没有一套详细的、确定的最佳实践。OpenGitOps 是朝着这个目标迈出的一步，它建立了通用的原则和术语，但是它还没有深入到本质。

然而，我们不应该从“持有”的结论中过度推断。“谨慎行事”的意思就是:你不想在没有专业知识和对你的组织将如何进行过渡以及你的组织将如何具体受益的坚定、具体想法的情况下仓促行事。我们需要在实施过程中深思熟虑，并预先了解复杂性。

GitOps 旨在进行扩展，而不会受制于供应商。这是一种最容易以代码形式存在于托管基础设施之上的运营模式，例如(咳咳，不要脸的插件) [Mirantis Flow](https://www.mirantis.com/software/mirantis-flow/) 。一些团队拥有定义运营模型和在单一环境中工作所必需的专业知识和敏捷性。如果他们愿意，他们应该考虑 GitOps。原则上喜欢这个想法的其他组织可能会发现他们的特定环境和需求并不适合它。还有一些人可能希望获得单一的事实来源，但需要基础架构合作伙伴来帮助实现这一目标。

最后，重要的是要确保优势与您的使用案例相符。很容易迷恋一个优雅的想法(我仍然在这里举着静态站点生成器的旗帜)，但关键是要确保模型适合您的环境，适合您的目的。根据定义，Thoughtworks Radar 上的“保留”是一种“有趣”的技术，需要“小心谨慎”地对待，这与“采用”相反，后者意味着某种东西应该成为行业事实上的标准。这听起来似乎是对的，但是关怀并不是停止的标志。看看你的应用程序，看看你的基础设施，如果这对你的团队有意义，就放弃吧。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>