# 发现第一个运行在 AWS Lambda 上的恶意软件

> 原文：<https://thenewstack.io/first-malware-running-on-aws-lambda-discovered/>

无服务器计算的典型代表亚马逊网络服务(AWS)已经七岁多了。因此，也许令人惊讶的不是[第一个专门针对 Lambda，Denonia](https://www.cadosecurity.com/cado-discovers-denonia-the-first-malware-specifically-targeting-lambda/) 的恶意软件出现了，而是它花了这么长时间才出现。

哦好吧。它最终不得不发生。

重要的是要注意，虽然 Denonia 运行在 Lambda 上，但它不是一个特定于 Lambda 的程序。相反，它是一个 Linux 64 位 ELF 可执行文件，使用了几个第三方库，包括能够在 AWS Lambda 环境中运行的[库](https://github.com/aws/aws-lambda-go)。

根据云安全公司 [Cado Security](https://www.cadosecurity.com/) 的安全研究员 Matt Muir 的说法，他发现了这个程序，虽然这个程序的文件名是“python”，但它实际上是用 [Go](https://go.dev/) 编写的。这个讨厌的软件包含开源 XMRig 采矿软件的定制版本。

“Denonia，”Muir 说，“显然是为了在 Lambda 环境中执行而设计的——我们还没有确定它是如何部署的。这可能只是损害 AWS 访问和密钥，然后手动部署到受损害的 Lambda 环境中，正如[我们之前看到的](https://twitter.com/jonnyplatt/status/1470714913098289153)更简单的 Python 脚本。”

## 受损账户

看来这就是 Denonia 的传播方式。它不能自我传播。它需要一个已经受损的用户帐户。

正如 AWS 在一份声明中指出的，Denonia“没有利用 Lambda 或任何其他 AWS 服务的任何弱点。”它通过“依靠欺诈手段获得的账户凭证”通过 AWS 的大门。因此，AWS 的结论是，Denonia 并不是真正的恶意软件，因为“它自身缺乏获得对任何系统的未授权访问的能力。”

事实上，虽然自我传播的恶意软件比不传播的恶意软件危险得多，但大多数安全专家都认为它仍然是恶意软件。尽管如此，AWS 声称“称 Denonia 为专注于 Lambda 的恶意软件是对事实的歪曲，因为它没有利用 Lambda 服务中的任何漏洞。”最后一部分当然是真的。但是你仍然不希望它运行在你的 Lambda 服务上。

Denonia 也可以运行在 Lambda 之外。它也可以在通用的 64 位 Linux 上运行。

## HTTPS 域名系统(DoH)

使 Denonia 变得危险的另一个因素是，它不使用 DNS 来联系它的控制器，而是使用 [DNS over HTTPS (DoH)](https://www.techtarget.com/searchsecurity/definition/DNS-over-HTTPS-DoH) 。DoH 对 DNS 查询进行加密，并将请求作为常规 HTTPS 流量发送给 DoH 解析器。穆尔评论说，对攻击者来说，它提供了两个优势:

*   AWS 无法看到恶意域的 DNS 查找，从而降低了触发检测的可能性
*   一些 Lambda 环境可能不执行 DNS 查找，这取决于 VPC 设置。

长期以来，卫生部一直存在严重的安全问题。正如[保罗·维谢](https://www.linkedin.com/in/paulvixie/)，DNS 的创建者在 2018 年发推文称，“ [RFC 8484(定义 DoH 的征求意见稿)是互联网安全的集群鸭](https://twitter.com/paulvixie/status/1053765281917661184)。抱歉扫了你的兴。囚犯们已经接管了精神病院。”

维谢不是唯一一个。世界上最大的网络安全培训组织之一 SANS Institute(SANS Institute)表示，“对加密域名系统的无限制使用，尤其是 HTTPS 域名系统，可能会让攻击者和内部人员绕过组织控制。”Denonia 对 DoH 的使用强调了在迄今为止的理论关注中存在着真正的危险。

尽管 Lambda 本身比其他计算环境更安全，但请记住，正如亚马逊警告的那样，“在 [AWS 共享责任模型](https://aws.amazon.com/compliance/shared-responsibility-model/)下，AWS 保护底层 Lambda 执行环境，但保护功能本身取决于客户。”换句话说，如果你打开了 Denonia 这样的程序的大门，那是你的安全问题，而不是 AWS 的。

所以，一如既往，小心那里的人们！ [AWS 有一份关于保护 Lambda 环境的优秀白皮书](https://docs.aws.amazon.com/whitepapers/latest/security-overview-aws-lambda/security-overview-aws-lambda.pdf)，我们建议您使用它的建议。Lambda 可能比大多数计算平台更安全，但是，和以往一样，安全是一个过程，而不是一个产品。你也必须尽你的一份力量。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>