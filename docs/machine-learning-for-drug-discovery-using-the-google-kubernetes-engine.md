# 使用 Google Kubernetes 引擎进行药物发现的机器学习

> 原文：<https://thenewstack.io/machine-learning-for-drug-discovery-using-the-google-kubernetes-engine/>

传统药物开发是一个缓慢而昂贵的过程。从研究到上市的漫长延迟使得初创公司很难进入市场，而发现潜在疗法并进行测试的成本可能会阻碍公司研究罕见疾病的疗法。 [Recursion Pharmaceuticals](https://www.recursionpharma.com/) 看到了通过使用机器学习，特别是神经网络和表征学习来加速这一过程的机会。

“作为一家公司，Recursion 的目标大体上是使用人工智能方法来加速和改变药物发现过程的整个流程，”Recursion 的转化发现高级副总裁[罗恩·阿尔法](https://twitter.com/ron_alfa)解释道。

这是通过运行在 Google Kubernetes 引擎上的机器学习管道来完成的，该引擎部署在 Google 云和内部，递归使用该引擎每周运行数十万次实验。

该过程的第一步是分离部分细胞并以不同的方式操作它们，并在操作前后对细胞成分和单个细胞进行测量和成像。“我们可以用成千上万种不同的方式操纵细胞，并通过使用算法观察它们的反应来探索它们的生物学，”阿尔法解释道。他说，这使得递归可以快速看到细胞如何对不同类型的变化、分子或潜在药物做出反应，而不必了解细胞为什么会以那种方式做出反应。

递归使用开源的 [CellProfiler](https://cellprofiler.org) 来测量细胞和细胞成分图像。“最终，我们得到了单个细胞水平的测量结果，”递归公司的工程副总裁本·马贝解释说。"这些测量结果然后成为特征向量，进入我们的机器学习算法."

然后，递归使用两种方法中的一种。第一种是更传统的人工智能驱动的分析。第二种是使用卷积神经网络进行表征学习。这创建了一个网络，其中基于某些测量或特征，细胞彼此越“相似”，它们在网络中就越接近。这项技术最常见的应用之一是面部识别——递归所做的就像细胞的面部识别。

“我们发现，机器学习算法可以检测到人类逐个查看图像时无法检测到的东西，”Mabey 解释道。

“我们面临的最大挑战之一是，我们需要处理和训练数 Pb 的数据，”Mabey 说，这对任何机器学习应用程序来说都是一个常见的问题。起初，递归使用内部 GPU 集群来处理这一问题，但该公司越来越多地将其机器学习转移到谷歌云。一个主要的理由是利用张量处理单元(TPU)，这是谷歌在 2016 年开发并首次发布的。TPU 是专门为神经网络机器学习而设计的专用集成电路。

“TPU 现在只属于 Tensorflow，所以现在我们的大部分研究和深度学习都是在 Tensorflow 上，”Mabey 说，并补充说他预计递归将在未来继续使用 TensorFlow 进行大部分研究和深度学习。

所有的集群都是在 Google Kubernetes 引擎之上使用 Kafka Streams 进行编排的，不管实验是在云中还是在本地运行。“如果我们完成了一个实验，所有的簿记工作都会在卡夫卡式的流程中处理，”梅比说。“它抽象出了所有的复杂性。有了卡夫卡式的溪流，如果有什么东西断了，它会从中断的地方重新开始。我们可以编写分布式应用程序，而不必担心 Confluent 的工程师已经处理过的所有典型问题。”

除了通常的机器学习挑战，递归试图解决的挑战之一是文化/组织。“使我们真正独一无二的事情之一，尤其是在生物技术领域，是我们在团队中非常合作和跨职能，”Mabey 说。“我们的数据科学家正与我们的软件工程师和生物学家并肩工作。”

这也带来了技术挑战和技术解决方案。“在一些书库中，你会看到工程师用 Python 处理数据科学家的工作，并用 Java 重新编码。“我不认为这是正确的决定，”梅比说。我们希望给予数据科学家使用他们想要的工具的灵活性。我们通过利用 Kubernetes 做到了这一点。只要你能把它包装在一个容器里，你就能分发它，我们的生产流水线就能运行它。"

Mabey 说，在未来，递归也可能开始使用 Kubeflow 来操作训练和模型构建。使用 Kubeflow 轻松启动 Jupyter 笔记本电脑，并使用 GKE 通过几行 YAML 在 Tensorflow 处理单元(TPU)上创建培训作业的能力，有可能极大地简化递归所依赖的分布式培训模型的设置过程。

递归的商业模式包括将生物学问题转化为机器学习问题，并利用软件工程师、数据科学家和生物学家组成的跨职能团队来实现这一目标。他们使用的技术堆栈旨在弥合数据科学和软件工程之间的工作流和方法学差距，同时使用人工智能来观察人类可能会错过的细胞特征的细微变化。目前，该公司有两种药物正在临床试验中，这两种药物都用于治疗相对罕见的大脑相关疾病。

图片由 Pixabay 的 rawpixel 提供。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>