# API 安全性为何不同以及 OpenAPI 规范如何有所帮助

> 原文：<https://thenewstack.io/why-api-security-is-different-and-how-the-openapi-spec-can-help/>

Linux 基金会赞助了这篇文章。

为了了解更多关于 API 安全领域的关键问题和未来解决方案，我与 [42Crunch](https://42crunch.com) 的首席产品和营销官 [Dmitry Sotnikov](https://www.linkedin.com/in/dsotnikov/) 进行了交谈。他的公司的产品基于开源的 OpenAPI 规范，并且是 OpenAPI 倡议的成员 Linux 基金会的一部分。

## API 安全性与 Web 应用程序安全性的不同之处是什么？

 [杰西·卡斯曼

Jesse 是 Linux 基金会的 OpenAPI 研究所外联和通信人员。他是开源和开发者社区体验的长期支持者，是 API 工作正常时的爱好者，因此也是 OpenAPI 规范的狂热爱好者。](https://www.linkedin.com/in/casman/) 

传统的 web 应用程序安全性相对单一，web 应用程序托管在供应商的服务器上。用户最常使用浏览器与服务器交互。有一些渲染，一些小的交互性，但大多数功能都在服务器端。攻击面是网络浏览器。这允许浏览器和会话攻击、SQL 和其他注入以及与用户输入相关的操作。可能很严重，但相对有限。

然而，在过去的几年里，应用程序的设计方式发生了巨大的变化。随着单页应用程序(SPA)等创新的出现，应用程序现在被大规模地取消隔离，单页应用程序通过使用来自 web 服务器的新数据动态重写当前网页来与 web 浏览器进行交互，而不是浏览器加载全新页面的默认方法。现在浏览器中有了应用程序，浏览器中也有了很多逻辑。移动应用程序以类似的方式运行，在用户设备上本地执行，并通过 API 调用与后端交换数据。

这是新的。还有更多。后端也发生了变化。

 [德米特里·索特尼科夫

Dmitry 是 42Crunch(一家企业 API 安全公司)的首席产品官，他还维护着 APISecurity.io，这是一个流行的社区网站，提供每日 API 安全新闻。Dmitry 在企业 IT 软件和云计算领域拥有 20 多年的经验，曾在 WSO2、Jelastic 和 Quest Software 等公司担任高管职务。](https://www.linkedin.com/in/dsotnikov/) 

微服务革命发生了，由 Kubernetes 引领。实际的应用程序——后端——不是函数和对象，而是一组通过 API 相互通信的服务。Cloud native 还试图重用任何可用的第三方服务。例如，使用 Stripe APIs 来处理信用卡，使用 Twilio APIs 来发送 SMS 消息，以及许多其他用于各种服务和集成的 API。

所以现在，不是相对静态的攻击面，我们处在一个一个 app 可以有上百个 API 的世界。许多这样的 API 只是给你数据，这些数据是应用程序内部的。换句话说，数据访问——过去从未成为外部接口的一部分——现在非常公开。

攻击面急剧扩大，攻击者进入应用程序内部的能力也急剧变化。

以前，当开发人员需要创建不同的类或不同的对象集时，他们会直接创建它们。现在，他们对微服务做同样的事情。这意味着他们在不断增加外部攻击面。

这种抽象化基础设施的趋势只会增加，并导致更多的 API 和功能暴露出来。

## 使用 OpenAPI 规范如何增强 API 安全性？

与一般的应用程序不同，API 是结构化的。回想我在大学学习计算机科学的时候，我们一直在研究的一件事就是试图建立应用程序的正式模型。事实上，我的博士论文——我从来没有完成！——就是这个话题。有可能创建一个正式的模型并验证一个特定的应用程序在功能上是正确的和安全的吗？不幸的是，这很难做到。对于任意的现实生活应用基本不可能。

然而，当你开始以机器可读的格式定义 API 时——这是 OpenAPI 规范非常有用的地方——你可以使用软件来对照这些规范工作，并在定义它们的方式中找到缺陷，并找到潜在的缺陷和问题。

如果您有一个正式的机器可读的模型，显示 API 应该如何基于它所针对的输入和预期的输出来工作，那么当行为与模型不同时，您就可以防止该行为发生。

OpenAPI 规范产生于记录 API 的需要，但是因为它是机器可读的，并且因为它已经获得了如此广泛的行业支持，所以您可以安全地使用它。

## 你对 OpenAPI 规范有什么问题？

OpenAPI 规范在很多领域都有帮助，而且正如我已经指出的，它非常擅长于显著提高 API 安全性。但是，它确实存在两个问题，社区正在努力改进:

1.  OpenAPI 规范非常宽松，所以您可以使用一些特性，但是如果您不使用其他特性也没关系。例如，您可以定义路径、动词和参数，但是不要定义传入或传出数据的类型和格式。因此，开发人员很有可能使用 OpenAPI 规范，但没有深入到足够的细节来使它变得全面。
2.  OpenAPI 规范仍在发展中，所以当今世界上存在的一些 API 行为还没有集成——尤其是在安全性方面。例如，相互 TLS 认证(mTLS)仍然不在规范中，所以仍然没有办法定义它。这将出现在标准的下一个版本中。JSON web 令牌(JWT)也是如此。今天大多数现代 REST APIs 都使用 JWT 来保证安全性，但是它仍然没有包含在 OpenAPI 规范中。任何限速规则都是如此。这个清单可以一直列下去。

OpenAPI 规范越符合当前的 API 实践，它就越有用。

## 最常见的三大 API 安全漏洞是什么？

我真的建议任何对常见 API 安全漏洞和缓解它们的方法感兴趣的人去看看 [APIsecurity.io](https://apisecurity.io) 网站，并订阅其每周简讯。新闻中几乎没有一周没有 API 漏洞的报道，我们可以从中学到很多。

开放 Web 应用安全项目(OWASP)最近为开发者和安全团队发布了其 [OWASP 十大 API 安全漏洞列表](https://apisecurity.io/encyclopedia/content/owasp/owasp-api-security-top-10.htm)。它代表了关于 API 最关键的安全风险的广泛共识，是一个很好的教育资源。

除了特定的漏洞之外，我看到的更大的问题是，在许多公司中，没有办法找到所有的 API 并在它们之间实施安全性。在很多情况下，从安全角度来看，缺少一些非常基本的东西。例如，42Crunch 最近与美国的一家大型制造企业完成了一个项目。对于其中一个部门，我们运行了一个 API 发现过程，我们发现了大约 700 个 API。超过一半的人完全没有安全感。超过一半的人根本没有受到保护！非常基本的解决方案，如身份验证、加密流量…根本没有实施，甚至没有考虑过。

Palo Alto Networks 的 Unit 42 最近发布的 [2020 Unit 42 物联网威胁报告](https://unit42.paloaltonetworks.com/iot-threat-report-2020/)显示，所有物联网设备流量中有 98%未加密。这包括非常敏感的设备，如医院的医疗设备。它甚至不是弱加密；这些设备完全没有加密。

## 从现在起 3 年后，API 安全性将会如何？

我的期望——也是 42Crunch 关注的很大一部分——是从现在起的 3 年内，API 安全性将基本上嵌入到 API 设计、开发和 DevOps 工具中。安全不会是一个独立的团队，他们有自己的工具做自己的事情。安全性将不再仅仅是一个生产问题。它将嵌入整个生命周期。

当你在设计 API 时，你的工具将足够智能来帮助你安全地设计 API(就像你现在可以在微软 VS Code 中使用 [OpenAPI 扩展一样)。当您构建和调试 API 时，工具将有助于安全性。测试将是功能测试和安全测试。运行时不仅仅运行你的 API。它将遵循安全模型，以确保您的 API 按预期运行。](https://marketplace.visualstudio.com/items?itemName=42Crunch.vscode-openapi)

API 安全将成为整个 API 生命周期的一部分。

Palo Alto Networks 是新堆栈的赞助商。

通过 Pixabay 的特征图像。

*目前，新堆栈不允许在该网站上直接发表评论。我们邀请所有希望讨论某个故事的读者通过 [Twitter](https://twitter.com/thenewstack) 或[脸书](https://www.facebook.com/thenewstack/)访问我们。我们也欢迎您通过电子邮件发送新闻提示和反馈: [feedback@thenewstack.io](mailto:feedback@thenewstack.io) 。*

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>