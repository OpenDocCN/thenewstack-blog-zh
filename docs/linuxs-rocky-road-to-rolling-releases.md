# Linux 滚动发布的艰难之路

> 原文：<https://thenewstack.io/linuxs-rocky-road-to-rolling-releases/>

Linux 管理员增加内核版本号的方式和许多用户认为这些版本号意味着什么是两码事。根据谷歌高级员工工程师和 Linux 内核贡献者 Sasha Levin 上周在 [Linux 基金会](https://training.linuxfoundation.org/training/course-catalog/?utm_content=inline-mention)开源峰会上的发言，现在 Linux 内核社区正试图调和公众的看法和现实。

目前，大约每 10 周就会发布一个新的 Linux 内核。不再有“主要”或“次要”版本。[的最新版本](https://en.wikipedia.org/wiki/Linux_kernel_version_history)，5.14，并不比 2019 年的 5.0 版本更重要或更不重要。组织更新到似乎是主要版本的版本和更新到明显的次要版本一样安全。

现在，每个版本都是在特定的 10 周时间内更新的集合。内核开发人员相信，Linux 的每个新版本，无论看起来多么重要，都不会引入向后不兼容，并且每个新版本都会带来的几乎所有性能退化都会在每个新版本发布之前的八周发布候选周期中得到解决。

然而，Levin 指出，许多企业 Linux 用户仍然围绕主要/次要版本的错误概念来计划他们的升级周期，阅读发行时间表，分配版本号而不考虑发行的重要性。

尽管 Linux 似乎遵循标准的[语义版本化](https://semver.org/)规则，其中软件版本号基于 **major.minor.patch** 的格式，其中 5.0 代表具有潜在应用程序中断 API 变化的主要更新，但是 minor (5.1)和 patch (5.0.1)可以不经过主要测试就投入生产。

内核社区也继续支持代表谨慎用户的长期支持版本(5.14 是最新的 LTS)，即使他们觉得这样的版本是多余的，甚至是有害的。在发布后的六年里，该团队将修复程序移植回 LTS 版本。但是这些倾向于产生“Frankenkernels”，Levin 说，这实际上并不比最新版本更稳定。

## 每天都是一条曲折的路

当 Linus Torvalds [在 1991 年第一次发布](https://thenewstack.io/linus-torvalds-on-community-rust-and-linuxs-longevity/)他的“Linux”爱好项目时，他采取了应用版本的典型语义版本编号的通常路线。第一个是 0.01。较大的版本比较小的版本有更大的变化。莱文说，当有足够多的功能“假装成一个操作系统”时，它经历了第 1 版。

随着版本 1 的出现，出现了真正的用户——不是内核开发人员的用户。他们希望在内核上构建应用并运行工作负载。这迫使内核开发人员渴望脱离开发分支，这将与“稳定分支”分离开来开发者分支是测试新想法的地方，稳定分支实际上是外部用户可以依赖的内核的最后一个工作副本。例如，版本 2.4 是开发分支，而版本 2.3 是稳定分支，其中只应用了向后修正。

然而，随着越来越多的人对内核做出贡献，内核 2.0 和 2.6 之间的发布周期几乎陷入停顿。没有中央管理层来宣布下一个版本是什么时候。仅仅在 2.4 和 2.6 之间就花了两年时间。

![Google's Sasha Levin](img/9a9b54983b0f3f63efa8b852c3a93c7a.png)

谷歌的萨沙·莱文

由于担心发布周期会变得更慢，内核社区决定从基于特性的发布转向基于时间的发布，即每 10 周发布一次，无论发布的规模有多大。

“我们开始说版本号不重要，因为在这一点上他们发布不重要。我们只是每 10 周发布一次，”莱文说。

随着这一变化，稳定的分支结束了。现在，每个版本都是一个“合并窗口，需要两个星期，然后是稳定期，在另外七、八个星期的每周候选版本列表上。最后，我们可以说内核版本足够稳定，用户可以运行，”莱文说。

这也是长期支持(LTS)创建的时间，为那些需要支持的人——错误修复和诸如此类的——超过通常的支持窗口。在定时发布中，所有的改变都被合并到新的发布中；与 LTS 和修复被反向移植到 LTS 版本。

莱文认为，这种方法非常有效。但是在他们停止的地方，在 2.6 中，他们继续争论旧的版本格式到新的版本。一些主要的特性增加了次要的版本号，反之亦然。

用户感到困惑，至少那些仍然赋予版本号意义的人是这样。他们认为，对他们来说，从 2.6 升级到 3.0 需要大量的测试和升级。

在许多企业 CTO 看来，升级到如此重要的版本需要多年的迁移过程以及所有相关的文书工作。他们只有在有时间的时候才能承担如此重大的升级项目，而以前基本上是没有的。所以他们坚持使用早期的测试版本，而不是更快更频繁地迁移。所以他们倾向于不升级到 3.0 版本，即使这是一个相对较小的版本(令行业媒体震惊的是)。

“改变主要版本是巨大而可怕的，”莱文说，即使在这种情况下，它只是一个例行发布，作为 2.6 的起点。*系列。跳到 3.0 也给用户带来了另一系列问题。也许甚至他们自己的一些配置脚本也有 2.6 版本。*烘烤而成。

另一方面，用户似乎可以升级到次要版本，这本身也增加了困惑。从 2.6.70 迁移到 2.6.71 似乎不像从 3.0 迁移到 4.0 那样需要太多的担心。尽管这样的增量数字也(错误地)暗示了升级到这样一个看似微小的更新并不重要。

## **无限和超越！**

2.6 版本链也提出了一个问题，他们什么时候会跳到下一个主要版本号，超过 2.6.x？或者他们会继续添加到无限的链条上吗？

托沃兹自己也说过，在版本号大幅上升之前，他希望保持 20 个版本，因为 20 是他手指和脚趾能数出来的数字。莱文指出，这个方案也是完全武断的，它进一步切断了用户对发布内容的看法。

但他承认，这个错误是内核社区造成的，他们没有做足够的工作来告知用户为什么坚持稳定或长期版本是不必要的。

莱文说，他本人希望取消 LTS 释放，因为它们是多余的。一些用户终于明白了这些信息。他指出，LTS 版本的下载量开始减少。一些发行版，比如 Debian 和 Arch Linux 现在在他们自己的发行版中复制了 10 周的发布周期。安卓紧随其后。“他们明白这只是一个基于时间的时间表，”莱文说。

渴望获得最新功能和性能改进的竞争性组织正在放弃 LTS 版本。“他们不想在一个旧内核上。他们有自己想卖的产品，”他说。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>