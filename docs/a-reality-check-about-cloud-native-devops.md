# 关于云原生 DevOps 的现实检查

> 原文：<https://thenewstack.io/a-reality-check-about-cloud-native-devops/>

[旗语](https://semaphoreci.com/)赞助本帖，由[旗语 CI/CD](https://semaphoreci.com/) 平台为您带来。

 [沃伊泰克·奇乔

沃伊泰克正在 Semaphore 把营销和客户关系联系起来。在职业上，他喜欢与现代技术的创造者和动摇者密切合作。在业余时间，他写并表演口语诗。](https://semaphoreci.com/) 

[约翰·阿伦德尔](https://twitter.com/bitfield)是顾问，也是《[Cloud Native devo PS with Kubernetes:在云中构建、部署和扩展现代应用](https://www.amazon.com/gp/product/1492040762/ref=as_li_qf_asin_il_tl?ie=UTF8&tag=cribbcorne-20&creative=9325&linkCode=as2&creativeASIN=1492040762&linkId=c62a1fc59fb6e506172181a55f7e0d8b)》一书的合著者(与贾斯汀·多明戈斯合著)。[Semaphore](https://twitter.com/wojtekidd)的客户营销经理 Wojtek ci Chou 与 Arundel 讨论了采用 DevOps 如何摧毁墙壁、搭建桥梁，以及如何更好地影响公司文化。

**从你的书的描述来看，它似乎可以让你以 Kubernetes 的方式从零到英雄地构建和扩展应用程序。你认为是什么让这本书在市场上的同类书籍中脱颖而出？**

 当我们开始尝试在 Kubernetes 上部署真正的应用程序时，贾斯汀和我希望我们已经有了这本书！任何人都应该阅读的关于 Kubernetes 的第一本也是最重要的入门书籍是凯尔西·海托华、布伦丹·伯恩斯和乔·贝达的《 [Kubernetes 启动并运行](https://www.amazon.com/Kubernetes-Running-Dive-Future-Infrastructure/dp/1491935677)》。但是之后会发生什么呢？

我们想要一本书来回答这个问题“好吧，我有 Kubernetes 现在我该拿它怎么办？”我们找到了很多很棒的教程、介绍和博客文章，解释如何设置一个简单的 Kubernetes 集群。但是好像我们一开始问尖锐的问题，博客帖子就枯竭了。

[![](img/da1d4cbbe45215f6f80c64acdab6de2c.png)](https://twitter.com/bitfield)

我们试图为客户部署真正的应用程序；复杂、杂乱的东西，看起来不像会议幻灯片，我们有一大堆问题，比如:

*   我们应该构建自己的集群还是使用托管的 Kubernetes 服务？
*   集群应该有多大？
*   我们应该如何将应用程序更新部署到集群？
*   我们如何配置副本、共享卷、负载平衡器、数据库、IP 地址、DNS 记录和所有这些有趣的东西，并使用基础设施作为代码来更新它们和应用程序？
*   我们如何将集群和应用设置为安全的？
*   我们如何将所有这些与我们的 CI 系统集成？
*   无数的 Kubernetes 附加工具中，哪些是真正有用的？我们应该如何使用它们？

你明白了。有趣的是，当你尝试用一项技术做一些真实的事情时，你会意识到你对它的了解是多么的少。《云原生 DevOps with Kubernetes》其实不是一本关于 Kubernetes 的书；这是一本关于在云原生环境中进行 DevOps 的书，其中事实上的标准平台是 Kubernetes。几年后可能就不是这样了，但是我们可以设想这本书的未来版本，它教授相同的原理和实践，只是使用一些其他的软件来代替 Kubernetes。

查看目录，您会发现您正在浏览大量与 Kubernetes 相关的主题，从实用知识到监控、持续交付，一直到监控和指标。

**你如何定义这本书的理想读者？云原生初学者？想了解 Kubernetes 的高级开发人员？一位 CTO，除了对 Kubernetes 及其用途的概述之外，他还想了解更多吗？还是针对有实践经验会把理论付诸实践的人？**

我们在计划阶段讨论了很多。了解你的读者很重要，否则你可能会写完这本书却发现没人想要。

我们把这本书瞄准了三大人群:

*   开发人员和基础设施工程师，他们负责大规模运行生产中的应用程序，并希望了解 Kubernetes 在这方面的作用，它能为他们做什么，以及如何充分利用它；
*   开发人员没有专门的运营团队，但需要将其应用部署到云中，并可靠、可扩展地运行它们，而无需成为基础架构天才。Kubernetes 在这方面很棒；
*   首席技术官、工程经理和技术负责人想知道商业角度:Kubernetes 将如何使我的公司受益？它将如何帮助我们以更低的固定成本和更好的灵活性，更快地将工作软件交付给更多的客户，减少缺陷？哪些论据有助于向我的管理层推销采用 Kubernetes 的想法？

我们不想遗漏任何还没有接触过容器甚至云基础设施的人，所以有几个介绍性的章节从头开始解释整个事情。我们喜欢实用的书籍，所以我们包含了许多实际操作的任务，比如在您的笔记本电脑上设置一个 Kubernetes 集群，在 Go 中构建一个容器化的应用程序并将其部署到集群中。

> “如果你早上醒来，对又是一天感到沮丧，觉得自己是一台毫无意义的机器中一个没有价值的齿轮，你的公司不会做开发工作。”

贾斯汀和我在这方面合作得很好。虽然我喜欢探索概念和原则，但 Justin 是一个非常务实、做事认真的人。因此，我认为这种创造性的张力帮助我们避免陷入深奥的技术细节，并让这本书专注于真实、实际和日常的问题和解决方案，而不是挥挥手。

我们都是“给我看代码”的类型；轻描淡写地说你可以用 Kubernetes 做 X，Y 和 Z，这很好，但是具体怎么做呢？比如，我该打什么才能让它工作？为此，我们在几乎每一章中都包含了可用的代码示例，它们都可以在本书附带的 GitHub repo 中找到。

在的[o](https://www.activestate.com/blog/john-arundel-devops/)[一次采访](https://www.activestate.com/blog/john-arundel-devops/)中，你对 DevOps 下了非常宽泛的定义:“如果你在早晨醒来时感到沮丧，觉得自己又是一台毫无意义的机器中一个没有价值的齿轮，那么你的公司就不做 DevOps。”

这听起来似乎 DevOps 是许多与公司文化相关问题的解决方案。您能告诉我们更多关于这种方法的信息吗？为什么将贵公司的文化与 DevOps 的最佳实践相结合可以增加公司内部的幸福感并创造商业价值？

让我们暂时把术语“DevOps”放在一边，考虑一下细节。DevOps 通常作为代码与*基础设施联系在一起。我们在软件工程方面有很多很棒的工具和实践，我们可以用它们来协作开发代码，在团队之间学习和分享知识，并发布可靠的、可维护的代码。现在越来越多的基础设施由代码定义、提供和管理；这些代码和基础设施所支持的应用软件之间的真正区别是什么？我没看到。*

另一个例子:当某个特性在凌晨 3:00 爆炸时，一些可怜的操作人员拿着寻呼机，他们以前从未见过这个代码，不得不起床并对它进行分类。这有什么意义？难道写代码的人不是最有可能修复它的人吗？难道我们不应该在编写特性和理解它们在生产中的表现之间建立一个闭环吗？我认为我们应该。

我们在书中谈到了运营团队的未来。Kubernetes 可以自动化许多过去让运营人员忙碌的流程，但这不会让他们失业。远非如此。相反，他们现在可以做更有趣的工作，在开发团队中轮换，用他们的知识和经验来解决高层次的问题，教学和辅导，设计和维护内部工具和平台。这些都是非常聪明和有技能的人。如果他们的部分工作可以自动化，这意味着他们可以自由地做给企业带来更多价值的事情。他们也会更快乐，更有成就感，这是每个经理对自己团队的期望，不是吗？

如果你的公司和我描述的不一样，那就值得花点时间想想为什么不一样。和你的人谈谈，看看他们想要什么。问他们需要做什么改变才能让他们对来工作感到兴奋。如果他们感觉到你真的对修复破碎的文化感兴趣，你可能会发现你已经得到了你需要的所有帮助，就在你自己的团队里。

从中型公司到大型企业，你都做过各种品牌的顾问。我知道每个场景都是不同的，但是您认为您的客户在采用您定义的开发运维时遇到的常见障碍是什么？

首先，任何对现状的批评都隐含着对创造现状的人的批评。但是好人也有可能带着好的意图做好事，最后还是落得个不好的下场。正如已故的伟大的[计算机科学家]杰里·温伯格喜欢说的那样，“事物之所以是这样，是因为它们是那样形成的。”如果你不改变你做决定的方式，你不能期待不同的结果。

第二，想象一下，你只要挥一挥魔杖，组织中的每个人都会立即理解你的优先事项，分享你的价值观，并从根本上改变事物以实现它们，这将是一件好事。但这并不总是发生。

虽然通过解释、激励、鼓舞和引导人们采取新的态度来带来改变总是可取的，但总会有人不同意你的观点，也不愿意改变。

如果所有其他选择都已用尽，你可能不得不委婉地向他们解释:“这就是这个组织的未来。如果你不认为自己是未来的一部分，也许是时候开始寻找另一个未来了。”

换句话说，如果你不能改变你的人，你最终可能不得不改变你的人。

第三个障碍是我所说的“顾问疲劳”失败的公司通常或多或少随机地开始尝试不同的东西，四处摸索，并且半实施半理解的想法。在那种情况下，人们变得愤世嫉俗和悲观，这有什么好奇怪的？他们开始对管理药物产生抗体。随着一组顾问空降进来，改变一切，制造混乱，无法提供真正的结果，并被另一组取代，该组织从一个未达到的收益预测蹒跚地走到下一个。

有时候，让人们重见光明所需要的只是一线希望。听说一些公司在那里做事情会有很大的不同。当我和我的客户谈论我所知道的快乐、高效和高效的团队时，它可以帮助化解多年来的冷嘲热讽。“*不一定是这样的*”是一个强有力的句子。它可以打开思想和大门。

**在你的博客文章[“搭建桥梁而不是墙壁:DevOps 是关于同理心和协作的”](http://bitfieldconsulting.com/bridges-not-walls)中，你写道:“开发人员，你可能认为你的工作以‘git push’结束。但是在现实世界中不工作的软件是浪费比特。(…)事实是，开发人员和运营人员之间从来就没有明确的界限。这种重叠正是事情变得有趣的地方。”**

**您已经在该行业工作多年，您如何描述开发人员与其基础设施同事分担责任的现状？它是否反过来工作——基础设施团队与他们的开发团队进行结对编程？**

正如威廉·吉布森指出的，未来已经到来；只是分布不均匀而已。我知道，并与许多真正飞得很高的团队合作过。他们拥有广泛且互补的技能组合，涵盖开发和运营的所有方面。他们通过结对编程、代码审查和其他方式，不断地相互教学和学习。他们以强有力的方式合作，确保每个人都能看到他们正在做的大事和小事，并让每个人都有参与决策的感觉。没有地方军阀们坚决捍卫的，没有人敢碰的小代码封地，而是有一种集体所有权的感觉。当你觉得自己受到重视，并且全身心地投入到共同建设的成功中时，就不再需要顾问了。

就是在这一点上，我喜欢悄悄地溜走。总有其他团队需要我的帮助。

**随着 [Kubernetes 变得复杂并产生许多“后续生态系统”](https://semaphoreci.com/blog/2018/12/20/kubernetes-tim-hockin-on-whats-real.html)加上整个**云原生**技术格局以令人难以置信的速度增长，要求开发团队跟上他们构建的软件如何部署和维护的即将到来的创新是否现实？这都是关于在团队之间划分责任，但这可能再次导致各自为政。有可能在创建软件和交付软件的人之间建立闭环吗？**

每个人都能知道所有的事情吗？不，事实上，他们不应该尝试。我对发动机的工作原理有一个大致的了解，我知道的足够多，能够把我的车开到商店然后开回来。但是我无法制造发动机，也无法深入探讨汽油发动机、混合动力发动机甚至汪克尔转子发动机的相对优点。

这同样适用于 Kubernetes。你不仅没有*也没有*知道引擎盖下的一切是如何工作的，而且这实际上也是浪费你的学习时间(除非你是一名汽车修理工)。你应该只做只有你能做的事情。“无差别的繁重工作”——与你的核心业务或独特优势无关的耗时工作——应该外包。我们在书中强烈主张，除非你在经营 Kubernetes，否则你不应该经营 Kubernetes。

稍微夸张一下这个比喻，云原生 DevOps 的书是路线图，而不是引擎手册。这是关于 Kubernetes 可以带你去哪里，而不是如何改变火花塞。是的，你的团队中需要有经验的、熟练的人来操作 Kubernetes 集群并充分利用它们，就像你需要懂编程语言、编译器、数据库和负载平衡器的人一样。但这些都只是工具。他们不是东西；他们是带我们找到那东西的东西。

**我注意到关于选择持续交付工具的那一章缺少了一个叫做信号量的解决方案。我们能做些什么才能被收入这本书的下一版？**

事实上，我们是旗语的忠实粉丝，但是在写这本书的时候，我们面临着一个困境。如果我们只是列出所有可用的工具，那将是一本冗长而无用的书，更不用说马上就过时了。同样，如果我们只是选择了我们最喜欢的工具，我们可能会被指责遗漏了一些真正重要的选择。如果我们根本没有提到具体的工具，我们会留下许多问题没有答案。

因此，我们尝试做的是一个样本。在每个特定的类别(托管服务、Kubernetes 附加组件、部署工具、CI 系统、指标服务器等)中，我们都选择了几个有代表性的例子，让读者感受一下那里有什么，同时表明还有许多其他选择。我谦卑地向那些因为篇幅原因而被我们遗漏了最喜欢的工具或产品的人道歉。

值得一提的是，包含我们的代码示例的 GitHub repo 可以免费下载，无论您是否购买这本书，而且它是开源的——我们欢迎问题和拉式请求，以添加对我们在书中没有篇幅涵盖的工具和选项的支持。例如，您可以添加 Semaphore 的 CI 配置示例、Python 中的演示应用程序或 Microsoft Azure 的 Terraform 示例。然后我们会有一个真正全面的代码样本集，每个人都可以从中获得灵感，或者适应他们自己的环境。

请[查看回购](https://github.com/cloudnativedevops/demo)并让我们知道你的想法。我们希望您能帮助我们做得更好。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>