# 利用文化认同和细致的洞察力管理 Kubernetes 支出

> 原文：<https://thenewstack.io/manage-kubernetes-spend-with-cultural-buy-in-granular-insights/>

[](https://www.linkedin.com/in/robfaraj/)

 [罗布·法拉杰

罗布·法拉杰是 Stackwatch 的创始合伙人，是 Kubecost 的创始人，这是一款提供 Kubernetes 大规模成本监控和管理的开源工具。](https://www.linkedin.com/in/robfaraj/) [](https://www.linkedin.com/in/robfaraj/)

Kubernetes 是混合环境中加速数字化转型的燃料。一项研究发现，77%的组织认为 Kubernetes 是其疫情加速数字化转型战略的核心部分。

尽管对 Kubernetes 的热情越来越高，但大型企业中的一系列利益相关者，包括 CFO、CIO、IT 架构师、DevOps 专业人员和工程师，都有一个共同的痛点:在 Kubernetes 上超支太容易了。2021 年，[云计算原生计算基金会](https://cncf.io/?utm_content=inline-mention) (CNCF) [发现](https://www.cncf.io/blog/2021/06/29/finops-for-kubernetes-insufficient-or-nonexistent-kubernetes-cost-monitoring-is-causing-overspend/)超过三分之二的受访者预计与过去 12 个月相比，在 Kubernetes 上的支出至少会增加 20%，10%的受访者已经在 Kubernetes 部署上每月支出超过 100 万美元。

小的疏忽和缺乏可见性会迅速滚雪球般变成不必要的和不可预测的 Kubernetes 账单。事实上，同样是 2021 年的 CNCF 调查发现，不到 25%的受访者表示，他们可以准确预测他们在 Kubernetes 上的支出，误差在实际成本的 5%以内。

如果您的组织准备寻求一种组织范围的方法来控制 Kubernetes 的成本，这里有四件事需要考虑:

## **文化认同的重要性**

减少 Kubernetes 支出的承诺需要来自不同的利益相关方，并且必须包括自上而下和自下而上的方法。从技术的角度来看，对 Kubernetes 的支出实施成本控制不是一个有效的策略，除非组织的文化是为了支持成本管理而建立的——并且每个团队都信任并传播成本管理方法。通过确保分配成本的透明度、准确性和公平性，并通过提供监控和工具使团队能够做出基于数据的成本控制决策，您将获得成功过渡所需的支持。

## **帮助您的开发人员发展事业**

数字化转型继续加速，而大辞职仍在继续。如果工程师精疲力尽、感到厌倦或追求更有吸引力的工作机会，组织会损失宝贵的时间和资源。一个趋势是一致的:开发人员希望保持相关性，并将寻找他们能够使用现代技术堆栈的职位。如今，这意味着最好的工程师希望与 Kubernetes 合作，而利用这种技术激励和挑战他们团队的组织将能够减少技术人员的流失。

## **对混合世界的认识**

如果你去轮胎中心，你会期望他们检查和维修所有四个轮胎，或者如果他们只评估两个或三个就足够了吗？希望降低 Kubernetes 爆炸式增长的成本的组织面临着类似的情况，没有对云和本地成本的全面了解。CNCF [发现](https://www.cncf.io/reports/cncf-annual-survey-2021/)540 万开发人员正在使用 Kubernetes，其中大部分(90%)使用云管理服务——许多人也在内部使用 Kubernetes。企业需要了解内部部署和云部署，以便全面了解 Kubernetes 的支出。

## **粒度很重要**

开发人员和工程师会影响 Kubernetes 的支出，但他们需要洞察力和数据。他们需要超越名称空间、控制器或自定义标签的可见性，并且需要快速可见到群集级别，并按资源(包括 CPU、RAM、GPU、存储和网络)细分成本。

为了促进文化认同和实施准确的 Kubernetes 成本监控，请考虑以下最佳实践:

**1)按存储容量使用计费策略的阶段**

通过强调团队责任的强大的按存储容量使用显示或按存储容量使用计费方法，组织可以实现更大的节约。按存储容量使用计费方法超出了按存储容量使用显示的范围，实际上要求团队和业务部门从预算中支付他们负责的 Kubernetes 和云成本。为了有效地引入退款，组织必须首先在文化上广泛认同控制这些成本的重要性。从有限的监控或使用反馈方法开始。团队最初的支出审查包括一系列惊喜并不罕见。直接采用按存储容量使用计费策略可能会引起团队领导的不满，他们需要时间来理解他们现在更应该负责的成本(以及如何控制这些成本)。首先让团队访问成本和分配数据，让他们有时间审查分配给他们团队的成本的公平性，并在账单开始到来之前深思熟虑地引入成本控制。

**2)透明度证明了成本分配的公平性**

由于其分布式系统的性质，Kubernetes 使成本分配变得复杂。确保公平性和在团队间收集认同需要完全透明和可复制的分配模型。一定要审计这些发现，以验证分配给团队的所有成本都是正确的。重要的是，分配数据还必须是可操作的，使团队能够清楚、直接地解决超支的来源。

为了确保数据的公正性和可操作性，请参考以下标准:

*   考虑如何分配空闲资源(这通常与在集群级别做出供应决策的人有关)。
*   看看全系统或共享资源的分配。
*   确保团队或业务单位的资源分配得到仔细描述；例如，按名称空间分配提供了一种清晰的方法。
*   决定分配是基于资源请求还是基于使用(建议使用最大的请求和使用，但前提是团队能够控制这些设置)。
*   最后，决定如何公平地向负责昂贵但非经常性工作的团队收费，例如研究项目。

3)为每个资源分配一个明确的所有者

为每个资源定义一个所有者，在部署、命名空间或集群级别标记所有者。这样可以在出现问题时有一个清晰的上报路径。开放策略代理或准入控制器 webhook 可以实施这些标签。

**4)定期审查支出数据**

主动和频繁的数据审查使团队能够快速识别超支并避免未来昂贵的浪费。设置自动警报，以警告团队过度或异常的资源使用，如果不加以检查，可能会导致成本超支。

组织需要[一个整体的 Kubernetes 成本管理方法](https://www.kubecost.com/)。一旦整个公司都理解了转型的好处，合作的文化转变就可以开始了。通过为开发人员和工程师配备正确的流程和数据，团队不仅可以降低 30%或更多的成本，还可以确保成功、有效的数字化转型，以满足现代企业的需求。

![KubeCon EU 2022](img/3a946f86447e1f058ffa27e8553342db.png)

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>