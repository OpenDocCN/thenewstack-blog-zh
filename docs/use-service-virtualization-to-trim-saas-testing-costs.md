# 使用服务虚拟化削减 SaaS 测试成本

> 原文：<https://thenewstack.io/use-service-virtualization-to-trim-saas-testing-costs/>

[](https://smartbear.com/)

 [丹尼尔·佐丹奴

在 SmartBear Software，丹尼尔·佐丹奴是 ReadyAPI 的产品营销经理，ready API 是用于 API 测试的集成应用套件，提供准确、快速、安全和准时的 web 服务。Dan 负责推动 ReadyAPI 平台的上市战略、产品信息和销售支持。他还担任过 SmartBear 的营销经理、交叉浏览器测试和数字营销经理，以及 Todays Growth Consultant 的数字营销经理。丹拥有卫斯理大学的学士学位。他是 SmartBear 测试系列网络研讨会的常客。](https://smartbear.com/) [](https://smartbear.com/)

场景是这样的:FakeUser+20456@gmail.com，几行之后，FakeUser+20455，然后你猜对了——fake user+20454。这是一个奇怪的模式，所以副总裁走到开发和产品团队，询问了这个问题。他们提到，每当他们推出新代码时，他们都在登录表单上使用该电子邮件域进行新的自动化测试。他们在本地使用一些“存根”来处理这类事情，但是一旦进入测试和准备阶段，团队就会在他们的 UI 测试中使用一些假电子邮件。

副总裁的头脑已经在飞速运转，但不确定他们是否能看到脑子里正在进行的计算。

“我们的测试环境是否能实时连接到我们所有的 SaaS 订阅和 API，比如 Twilio、Intercom 或 Mixpanel,”她问道。

他急切地回答，“是的，当然——我们的测试环境尽可能接近我们的生产环境。”

然后她看了看账单……与自动化测试计划相一致的巨大费用峰值。

在这个世界里，这种情况太真实了，在这个世界里，将新的 SaaS 工具与你的整个业务和软件管道挂钩只需要几分钟，而且每笔交易的成本都很低，慢得令人难以置信。这并不是说这些产品不能为他们的服务提供价值，它们绝对可以。但是在一个需要测试自动化来持续交付高质量体验的世界中，在敏捷环境中吸收这些测试和开发的过高成本是非常困难的。

## 虚拟化如何有所帮助

为了应对这些挑战，我们实际上可以使用一种已经存在了几十年的实践，但将其应用于我们新的面向服务的世界:服务虚拟化。我们使用[服务虚拟化](https://smartbear.com/service-virtualization/)来降低第三方集成甚至内部服务的成本，这些服务可能会占用我们开发和测试管道中的大量资源。服务虚拟化通过模拟服务来工作，包括可定制的响应行为和数据。它有助于提高 QA 和工程组织的系统可用性，但也解决了组织和 SaaS 提供商面临的一个关键挑战，即控制 SaaS 的蔓延。

这意味着您目前付费的任何 web 服务集成或与外部供应商的连接理论上可以在生产前的所有阶段被替换——这意味着您只有在从服务中获利时才会为服务付费。这对于需要密切关注基础设施和资源预算的敏捷团队来说是巨大的。

## 从哪里开始

让我们从开始虚拟化的内容开始—任何按呼叫成本高昂的服务—因为第三方定价或昂贵的内部资源和处理能力。最好从一个现代的 REST API 开始，甚至更好——一个具有 [OpenAPI 或 Swagger 规范](https://swagger.io/)的 API。这是因为 OpenAPI 规范(OAS)在虚拟化资产时提供了特殊的灵活性。

一旦我们确定了要虚拟化的服务，我们就可以开始虚拟化了。通常有三种方法可以使用服务虚拟化工具来虚拟化 API，比如 [ServiceV Pro](https://smartbear.com/product/ready-api/servicev/overview/) :记录、导入和手动创建。

## 创建虚拟化 API

### 录制现场服务

这对于应用程序中当前使用的 API 来说非常好。当您在真实环境中使用 API 时，您将能够记录流量和来自 API 的响应。想象一下用不同的参数测试四五个 API——然后能够在任何时候重放所有这些响应——即使“真正的”API 不再可用。

### 导入 API 定义

这种方法非常适合那些使用定义驱动开发来增强 API 生命周期的团队，比如 OAS/Swagger。您可以导入您的 API 定义，虚拟化解决方案将使用您的示例请求和响应来完成它。

### 从头开始

通常，您也可以开始在虚拟化工具中构建 API。RESTful 架构实际上使得构建 GET、PUT、DELETE 和 POST 端点以及动态添加参数和查询变得非常简单。

## 配置

服务虚拟化的一大好处是，您将能够通过真实的数据和条件为资产注入活力。您可以通过文件或数据库导入数据，以构建背后有真正动态数据的虚拟 API。这意味着您将能够进行更多的边缘案例测试，而不仅仅是测试几个不同的查询——测试所有的查询！

一旦您将所有数据注入到我们的 API 中，我们就可以将真实性提升到下一个级别。实际上，我们将能够编辑和配置网络选项，如服务器容量或延迟。这对性能测试和功能测试来说都是巨大的。如果你依赖于链式 API 调用来执行某件事，你最好确保它们没有延迟地按顺序启动。

## 部署

既然我们已经准备好了虚拟化 API，我们就可以部署它了。当然，像大多数其他模拟和存根解决方案一样，您可以在几秒钟内将它本地部署到您自己的机器上使用。但是虚拟化真正闪光的地方是它在整个组织和交付过程中共享的能力。你可以将虚拟化的应用程序部署到其他本地服务器甚至云上，比如 [AWS](https://aws.amazon.com/) 或者 [Azure](https://azure.microsoft.com/en-us/) 。

这意味着您将能够在几个团队中重用资产，并为您的组织创建一个可靠的虚拟化 API 目录。灵活地部署虚拟化 API 还允许您在整个 CI/CD 流程中在测试或试运行服务器上部署 API。是的，这意味着不再有巨额的 Twilio 账单，只需要你的工程团队在测试阶段进行尽职调查。

借助服务虚拟化，您实际上能够控制成本，同时还能围绕您的应用获得更多的测试覆盖。对于已经自动化了大部分测试的敏捷团队来说，这意味着每年可以节省数千美元，并增加客户满意度和收入。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>