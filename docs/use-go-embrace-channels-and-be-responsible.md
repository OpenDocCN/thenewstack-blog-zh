# 用 Go，拥抱渠道，负责任

> 原文：<https://thenewstack.io/use-go-embrace-channels-and-be-responsible/>

我们已经看到越来越多的例子表明 Go 编程语言的并发性和简单性比其他语言更有优势。Go 的并发性是由其对“goroutines”和渠道的使用来支持的，在 Gophercon India 的这次演讲中，William Kennedy——迈阿密 web、移动和系统开发公司 Ardan Studios 的管理合伙人，也是《GoingGo.net 的 T2》和《T4 的 Go In Action》的作者——谈到了 Go 的渠道是如何赋予它一致性和可预测性的。

[行动起来:利用渠道，负责任](https://thenewstack.simplecast.com/episodes/go-in-action-use-channels-and-be-responsible)

Kennedy 开始讲述他以前是如何使用微软的 C#开发产品的，但是当他意识到他为微软赚的钱比他自己还多时，事情到了关键时刻。所以在这次“令人沮丧”的经历之后，他的公司转向了 Linux 和 Go。

渠道是肯尼迪在围棋中首先注意到的事情之一。“每个人都来寻找通道，然后他们发现了继承、类型嵌入和常量，”Kennedy 说。他发现 Go 中的同步队列很“酷”，并开始编写考虑到同步活动的 Go 代码。但是他很快意识到他的代码看起来比实际需要的要复杂，而且它也不起作用。因此，他最终向围棋界寻求建议。

Kennedy 随后了解到，无缓冲通道是保证一致同步的关键，可确保一个 goroutine 的数据被另一个 goroutine 接收。这种保证正是肯尼迪所热衷的。

相比之下，Kennedy 回忆了面向对象编程成为“大事”的时候，因为它承诺可以模拟真实世界。但它的局限性最终变得明显，肯尼迪说:“你可以模拟现实世界，定义数据和方法，但当代码运行时，它真的像现实世界中的东西一样运行吗？不。因为我们必须做的所有同步，我们必须让它正常交互的所有…线程——这是不可能完成的。”

肯尼迪认为，Go 的无缓冲通道，以及潜在的责任和保证理念，让他能够编写出第一次能够最终模仿真实世界的代码，“没有任何额外的东西”

为了解释围棋的无缓冲通道是如何运作的，肯尼迪带领观众进行了一次类比，这是一段描述接力赛的代码。“跑者”们在主 goroutine 的“赛道”上准备就绪，等待接力棒传到他们手中(这里的接力棒代表数据)。没有接力棒传递给他们，跑步者就无法向前跑——这是 Go 无缓冲渠道提供的“责任和保证”的编程隐喻。肯尼迪指出，没有接收就不会有“发送”。

Kennedy 说，当他开始编写并发 Go 代码时，他总是从无缓冲通道开始工作。他首先指出，如果它被写成一个缓冲通道，那么必须有一个很好的理由来为缓冲区选择一个数字，并将通道“视为一个永远不会满的队列”——当不可预见的事情发生时，这可能会导致崩溃。第二，Kennedy 断言，最好首先将例程编写为一个无缓冲的通道，而不是“处理[由此产生的]阻力”，因为“每个系统都有一个转折点……作为程序员,[我们]的工作就是知道转折点在哪里……所以你可以监控它，知道系统需要如何以及在哪里增长，并随着时间的推移帮助改进它。”此外，Kennedy 指出，缓冲通道的另一个问题是，当缓冲区变满时，可能会丢失数据。

最后，Kennedy 对 Go 的通道实现说了这样的话:“当我看代码时，我说忘记语法，忘记通道如何工作的机制。我希望你从你在这里试图完成的事情的角度来看待它。你想做什么？然后你可以看看你如何做到这一点。…那么，渠道提供什么的整个概念是什么？它提供了一种问责的方式，并保证这些数据从一个例程转移到下一个例程。”

在[GoingGo.net](http://www.goinggo.net/2014/02/the-nature-of-channels-in-go.html)阅读更多关于频道的信息。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>