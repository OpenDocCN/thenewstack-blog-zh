# Igalia:你从未听说过的开源发电站

> 原文：<https://thenewstack.io/igalia-the-open-source-powerhouse-youve-never-heard-of/>

今年早些时候，Mozilla 决定停止开发其混合现实浏览器。它没有完全关闭这个项目，而是将源代码传递给开源咨询公司 [Igalia](https://www.igalia.com/about/) ，后者用它来构建 [Wolvic](https://wolvic.com/en/) 浏览器。如果您一直密切关注浏览器和 JavaScript 开发，那么您可能知道 Igalia。不过，很有可能你从未听说过它们。然而，你几乎可以肯定使用的是 Igalia 帮助建造的东西。

这包括像 [CSS Grid](https://thenewstack.io/get-grid-last-css-grid-template-markup/) 这样的大项目，以及许多其他的改进、优化，甚至是基本的网络功能。

## **IgA lia 的主要贡献**

Igalia 参与了 ECMAScript 2015 中[标准化的箭头函数和析构；现在普遍使用的主要功能。它在 ECMAScript 2017](https://thenewstack.io/ecmascript-6-biggest-update-javascript-yet-start-rolling-annual-improvements/) 中的[生成器](https://thenewstack.io/whats-coming-up-in-javascript-2018-async-generators-better-regex/)和[异步函数上工作，为开发人员之前必须手动承诺链做的事情提供了更干净、更少冗长的执行。它还支持异步 await(Igalia 在 V8 和 JavaScript Core for WebKit 中实现)和顶级 await。](https://thenewstack.io/async-officially-coming-javascript-year/)

对于 [BigInt](https://thenewstack.io/report-whats-new-in-ecmascript-and-javascript-for-2020/) ，Igalia 参与了规范和测试，并在 SpiderMonkey 和 JavaScript 核心中实现了该特性。Igalia 的贡献者正在研究[类字段](https://thenewstack.io/javascript-forecast-whats-ahead-for-ecmascript-2022/)，这是一种期待已久的方法，它将使普通的 JavaScript 类[足够强大](https://v8.dev/blog/faster-class-features)，以表达开发人员当前需要的内部专有类系统的构造，JavaScript 日期字段的[“普遍喜爱的”临时替换，以及更具投机性的特性，如类型注释和可擦除类型。它也有望最终产生一个浏览器将采用的 MathML 核心规范，解决 W3C 之前的一个过程。](https://thenewstack.io/javascript-forecast-whats-ahead-for-ecmascript-2022/)

> " Igalia 是首屈一指的网络标准咨询公司，他们的使命是改善公共资源."

罗布·帕尔默，彭博

2019 年，Igalia 是 Chromium(仅次于谷歌)和 WebKit(仅次于苹果)的第二大贡献者，也是 Mozilla 伺服的主要贡献者。当我们询问一家浏览器制造商如何看待他们的工作时，微软 Edge 团队告诉我们:“Igalia 在 web 平台的许多工作中都做出了贡献，包括推动标准的发展，实现缺失的功能，以及修复对 web 开发人员和浏览器用户都有积极影响的错误。”。

不仅仅是浏览器。该咨询公司还参与了 Node.js 和 Wayland 等项目，Igalia 的工作也在 Steam Deck 上出现[，因为它对图形库如](https://www.igalia.com/2022/03/07/Igalia-contributes-to-tech-powering-Steam-Deck.html) [Mesa](https://gitlab.freedesktop.org/mesa/mesa) 和 [Vulkan](https://vulkan.org/) 做出了贡献。

但是 Igalia 是谁，它如何对 web(和相关平台)做出如此重大的贡献？

## **专业知识和关系**

“Igalia 是首屈一指的网络标准咨询公司，他们的使命是改善公共资源，”彭博 JavaScript 基础设施和工具团队负责人兼 T21 ECMAScript 标准化委员会联合主席 Rob Palmer 说道。

这不是一个典型的咨询公司，它的成功很大程度上来自于它的与众不同:“我们是一个工人所有的合作社，”Brian Kardell 解释道，他是 Igalia 的一名开发者支持者，因其在[可扩展网络宣言](https://extensiblewebmanifesto.org/)和 [HitchJS](https://github.com/bkardell/Hitch) 方面的工作而闻名。“我们有一个扁平的结构。没有老板，没有股东。这是我们的生活，我们的公司，我们想做一些有价值的事情。”对于 Igalia 来说，这意味着专注于开源和自由软件，以及填补空白:“我们非常努力地改善我们认为的现状中的失败，并创建一个对每个人都更健康的系统”。

尽管该公司总部位于西班牙，薪酬可能比不上硅谷，但能够完全远程工作在他们认为重要的技术上，使 Igalia 能够雇用几乎独特的专家组合。

> “我们有一个扁平的结构。没有老板，没有股东。这是我们的生活，我们的公司，我们想做一些有价值的事情。”

布莱恩·卡戴尔，伊加利亚

帕尔默建议说:“因为这项任务非常有吸引力，你会得到顶级候选人，他们直接为浏览器和其他项目的引擎工作，但选择为 Igalia 工作，因为他们相信改善网络和改善所有人的公共资源的根本任务。”

称 Igalia 在浏览器开发社区中有影响力并备受尊重几乎是一种轻描淡写。近年来，许多高级开发人员从苹果、火狐、谷歌和其他项目的浏览器工程团队转移到 Igalia，为该公司提供了 WebKit、Gecko、Servo、SpiderMonkey、V8、Chromium 和 Blink 等代码库方面的专业知识；除了与这些项目的良好关系，通常还有提交权和像 [Blink API 所有者](https://www.chromium.org/blink/guidelines/api-owners)这样的组织的成员资格(该组织决定哪些面向开发人员的特性在 Chromium 中可用)。

这意味着 Igalia 拥有处理重要功能的技术能力(这并不罕见)*和*还可以帮助获得代码，以便几乎同时将它们交付到多个浏览器中(这很罕见)。

“Igalia 带来了标准化方面的专业知识，”Palmer 解释道。“建立共识，拥有关系和专业知识来参与并取得进展，这在这个世界上是一件非常困难的事情，因为我们试图让许多不同的方面都达成一致。而且，他们不只是在做标准化工作，他们还在做实施和测试之类的事情:所需的完整的端到端故事。”

所有主要的网络浏览器引擎都是开源的，理论上，任何人都可以对底层项目做出贡献。但不是每个人都能投入必要的时间；此外，那些项目有一个核心的维护团队，他们决定什么代码进入其中。“对于 Chromium 来说，Chrome API 所有者必须同意它在很大程度上符合网络的架构和原则，”Kardell 指出。"不是所有的捐款都会被接受。"但伊加利亚的贡献几乎总是如此。

“我们有专长。我们属于所有的标准机构，我们与所有标准机构的人员保持着良好的关系，我们属于许多成员积极参与的工作组，我们从事实施工作。他解释说:“我们是所有浏览器中各种事物的核心贡献者、API 所有者和评审者。

## **开源而不烧尽**

卡德尔说，吸引具有这种专业水平的浏览器工程师的部分原因是 Igalia 的资助方式，这种方式避免了倦怠和不可持续的商业模式等常见问题。

“开源在很多方面都很棒。你可以把软件拿出来试用，检查它，你可以塑造它，改造它，帮助进化发生。你可以很快创建一个新公司。我喜欢开源的各种东西，但我不喜欢的是，它可能会成为倦怠和无补偿的来源。”

> “开源有我喜欢的各种东西，但我不喜欢的是，它可能会成为倦怠和无补偿的来源。”

布莱恩·卡戴尔，伊加利亚

Igalia 确实直接为付费客户服务，鼓励他们使用开源软件，并将其构建的技术贡献给公众。它还与彭博、Salesforce 和 [AMP 项目](https://amp.dev/)(OpenJS 基金会的一部分)等赞助商合作。最近，[尝试从小型组织和个人网络开发者那里筹集资金，让网络社区而不是一个单独的付费客户来驱动一个缺失功能的实现。](https://www.igalia.com/open-prioritization/index)

即使没有通过 Igalia 赞助任何工作的组织也欢迎它的贡献。“我们相信，通过从各种角度进行公开辩论，最有利于网络的发展，我们感谢 Igalia 和其他人给标准讨论和 Chromium 社区带来的观点，”微软告诉我们。

## **解除公地封锁进度**

一个组织可能会赞助一个功能，但最终会对许多 web 开发者有用，甚至——或者特别是——当浏览器制造商的不同优先级意味着以前没有重大进展时。

“我们帮助疏通了容器查询，这永远是 CSS 中的头号问题，”Kardell 告诉我们。“我们解封了[有()](https://blogs.igalia.com/blee/posts/2021/09/03/css-has-a-way-of-selecting-parent.html#problems-of-the-has-matching-operation)，现在在两个浏览器里。”has()选择器自 20 世纪 90 年代末就出现在 CSS 规范中，也是开发人员的首要要求，但这是一个复杂的提议，因此浏览器制造商担心它会影响性能。卡德尔试图在 CSS 工作组中取得进展:“每隔一两年，我都会说‘让我们做点什么吧，这是件大事’，但我们就是做不到。”

当 AdBlock 背后的公司 Eyo 赞助 Igalia 进行这项工作，以便他们可以将 CSS 用于他们的规则时，他们能够克服他所说的“核僵局”。“只要有一点投资和研究表明它是可行的，而且是高性能的，一旦我们做到了，苹果就说‘我们能做到’，他们做到了，事实上他们已经实现了。”

> 一些浏览器工程师说，如果没有 Igalia，CSS Grid 可能不会被广泛使用。

CSS Grid 也有类似的故事，它让开发人员实现了比 Flexbox 更高级和定制的布局:Palmer 称之为“受开发人员喜爱的巨大功能”。但是一些浏览器工程师说[如果没有 Igalia](https://twitter.com/gregwhitworth/status/778274031690801152?s=20&t=H4nkPrZxQve79lU099urCg) ，它可能不会被广泛使用。微软开始致力于最初的 CSS 网格布局规范，于 2012 年在 IE10 中发布了前缀版本:谷歌在 2011 年开始为 WebKit 添加对 CSS 网格的支持，但随后在 2012 年派生出 WebKit 来创建 Blink，而 Mozilla 没有采用它，因为它专注于自己的 XUL 网格布局。

彭博将 web 技术用于服务器端操作和彭博社终端上的渲染，帕尔默将其描述为“一个真正推动 Chromium 极限的数据密集型实时渲染系统”；2013 年，它赞助了 Igalia 的一个多年项目，致力于 CSS 网格的新方法，并在 Blink 和 WebKit 中实现。

“这符合我们的利益，真正取得成功，为我们的用户构建惊人的快速和丰富的应用程序，”帕尔默告诉我们。“但是，当我们能够(利用网络技术)做更多的事情时，结果是世界能够做更多的事情。我们会遇到瓶颈，我们发现这些瓶颈值得优化，但可能不是每个人都会遇到，当我们资助这些优化时，每个人都会受益，因为每个人的浏览器都会变得更快。”

“如果对是否有需求、是否每个人都会一起向前迈进存在任何不确定性，我们可以帮助提供这种推动。我们可以说‘这两个浏览器(在某个功能上)正在前进，因为它是他们优先考虑的事情，而这个不是，所以我们应该资助落后的那个，我们应该填补这个空白’。通过实现这种完整性，每个人都在前进。”

他将彭博和 Igalia 的工作称为“管道清理过程”，因为它不仅仅是将新功能引入浏览器或 JavaScript 运行时:Igalia 还致力于使用它所需的工具链，并开发测试套件来帮助推动不同浏览器引擎之间的互操作性。有时，它还会在未来带来更重要的特性。

ECMAScript 中的 BigInt 是彭博赞助的一项改进，目的是处理比 IEEE 双精度变量所能表达的更大的数字；BigInt 意味着他们可以从人体工程学的角度传递这些信息。但是在 JavaScript 中添加新的数字类型的先例可能会使添加每个人在日常生活中使用的十进制数字变得更容易。彭博希望这样做，因为金融市场数据通常以 64 位十进制数字的形式提供，但它也将帮助任何发现简单算术的开发人员——比如将 0.1 和 0.2 相加(这在任何使用 IEEE 数字的语言中都不等于 0.3)——JavaScript 中的[反直觉](https://twitter.com/kathsnc/status/1548946910500687872?s=20&t=Qrc0yBgNO4QjR2NWt35SlA)。“这将解决最常见的语言问题之一，”帕尔默建议。

## **资源有限，难以确定优先顺序**

很明显 Igalia 的贡献对网络平台有多重要，但有时人们对它们为什么来自 Igalia 感到困惑——尽管偶尔的[误解](https://meyerweb.com/eric/thoughts/2022/01/24/no-apple-did-not-crowdfund-focus-visible-in-safari/)或[争议](https://twitter.com/jensimmons/status/1485013868606898180?s=20&t=hN3g-dWxGW4cX7KZWSs6VQ)通常是出于政治原因，而不是技术原因。例如，[谷歌](https://twitter.com/jensimmons/status/1485665848815673355?s=20&t=H4nkPrZxQve79lU099urCg)和网络社区实际上都付钱给 Igalia 来开发 WebKit 中苹果[没有优先考虑的功能，这似乎有点奇怪。虽然苹果一直在雇佣备受尊敬的开发人员来扩大 Safari 团队，并且在经历了一段投资不足的时期后，现在正在添加关键功能，但值得注意的是还有多少网络平台功能(包括实验性的和稳定的)仅在 Safari 中不可用。](https://marc.info/?l=webkit-dev&w=2&r=1&s=request+for+position&q=b)

历史上，像苹果、火狐、谷歌和微软这样的浏览器制造商一直扮演着卡德尔所说的“网络管家”的角色，来自更广泛的网络社区的压力迫使他们实施 W3C 标准。但是，尽管网络共享已经成为浏览器之外的系统的基础，但在从电视到汽车的一切事物中，采用这些标准仍然是完全自愿的。

> 不同的浏览器有不同的优先级——即使是最大的预算也是有限的。

“我们建立了一个系统，在这个系统中，一切都依赖于完全自愿的预算和实际上是三个组织的参与，这并不好。我们能走到这一步真是太好了:它是开放的，我们有多个贡献者。”但是不同的浏览器有不同的优先级——即使是最大的预算也有限制。

网络平台至少和操作系统一样庞大和复杂，构建一个浏览器需要广泛的专业知识。不可避免的是，尽管浏览器制造商希望通过推动网络平台向前发展来保持竞争力(或者至少不是最后一个实现某项功能的浏览器)，但他们的优先事项和承诺决定了什么可以实现，什么不可以。

W3C 的优势在于除了浏览器制造商之外的广泛参与——有 500 多个成员，尽管许多成员参与了一个工作组，而不是广泛参与——但这也导致了卡德尔所描述的“潜在的漫长、困难、难以置信的复杂讨论，可能会占用你有限资源的大量时间”。

“许多事情无法向前发展，因为实施者处于关键路径中，这完全是自愿的，并且由他们独立确定优先级。让所有这些星星排成一行真的非常非常困难。”

这就是 Igalia 擅长解决的问题。

## **跨浏览器兼容性**

大多数 web 开发人员不太关心单个浏览器的优先级，他们更关心的是不要依赖并非所有浏览器都支持的特性。帕尔默指出，通常情况下，“新功能出现在所有浏览器中，这使得事情被广泛采用，很容易认为这是一种自然的流动——平台变得越来越好的功能源泉”。

实际上，这需要大量的艰苦工作、资金和时间:不仅仅是编写代码，还要让它接受审查、测试合规性、通过 QA 并被多个代码库接受。

“这几乎是 Igalia 拥有的一种超能力，”帕尔默说，“跨浏览器工作，帮助每个人以基于共识的步伐前进。”

这是单个浏览器开发者很难做到的，因为他们有自己的优先考虑和特定代码库的专业知识。

“如果你来找我们，你有一个合理的案例，如果我们认为有一些我们可以帮助你的东西，那么你可以付钱给我们，我们可以帮助你，”卡德尔解释说。“我们可以成为您推动对话所需的实施者。”

> “这几乎是 Igalia 拥有的一种超能力，可以跨浏览器工作，并帮助每个人以基于共识的步伐前进。”

罗布·帕尔默，彭博

即使一项功能是所有浏览器制造商的重中之重，在一个浏览器中实现一项功能也可能比在另一个浏览器中更困难:“在 Chrome 上实现它的成本不是在 Safari 上实现它的成本，也不是在 Firefox 上实现它的成本，”他指出。标准需要多种实现，这意味着来自多个浏览器制造商的重大承诺，这也是一些提案陷入困境的原因。

他解释说，缺乏拥有构建浏览器的深厚专业知识的人，导致了类似于 has()的核僵局。“有些事情很难做，而且可能很贵，我们还不知道它有多值钱，因为我们还没有讨论过，我们只知道我们做不起，因为做这件事意味着不做其他事情。所以到了没有人愿意第一个扣动扳机的时候，这些事情就会持续很多很多年。他们过不去。但一旦有人被传走了，人们会突然说，‘好吧，我想我们必须搞清楚这件事’，伊加利亚有时会扮演这种角色。”

在某些情况下，一个特性对于一个特定的用例很重要——比如嵌入式系统——而主流浏览器制造商并不把它视为优先事项，即使他们会从中受益。

虽然苹果控制着 WebKit 为 Safari 提供支持的方式，但 PlayStation、Epiphany 和智能电视和冰箱等嵌入式设备上基于 WebKit 的浏览器、数字标牌和车载显示器都使用 WPE WebKit，由 Igalia 维护。像 Thermomix(其智能食品处理器的屏幕使用嵌入式浏览器)和机顶盒制造商这样的家电制造商向 Igalia 寻求帮助；他们的投资推动了 Canvas 和 SVG 硬件加速的重大改进。

尽管从 90 年代中期就开始为网络开发，即使是 Kardell 也没想到 JavaScript 的屏幕外画布会与他相关。“我使用 Canvas 进行专业编程的次数是零——但是我每天都在使用 Canvas 而没有意识到这一点，而且我已经使用了使用 Canvas 的库来做事情。”地图、blob 数据库和谷歌文档都使用 Canvas，Canvas 阻塞主线程的方式，因此当你平移或缩放时，浏览器中的其他一切都被中断，这在高端设备上可能是可以忍受的，但在资源受限的嵌入式设备上，这是一个重大的性能问题。修复这个问题可以改善每个人的体验。

他认为，这是一个清晰的例子，说明了为什么在浏览器开发中对功能进行优先排序如此困难。“当你发布屏幕外的画布时，整个世界都会说:你为什么不这样做呢？这显然更重要，但问题是这才是最重要的。”

## **谁应该资助网络**

赞助不是让任何人“购买一个标准”，而是一种负责任地开发浏览器开发者要求的功能的方式，包括与不同的浏览器制造商合作和共同设计，以及与开发者一起进行彻底的测试，而不期望开发者免费工作。

卡德尔理解这种担忧，因为他在进一步了解 Igalia 之前就感受到了，但他很清楚事情并不是这样的。“如果我们同意与你合作，那是因为我们认为我们有机会帮助你做一些有价值的事情。你能买到的是我们对[你的功能]的支持，以及拥有实施者经验和实施者信誉的人的优先权，这些人拥有正确的技能和能力来帮助推进这项工作。”

“他们不只是做要求他们做的任何事情:他们考虑影响，是否对社区有益，是否对平台是正确的事情，”帕尔默同意。

“因为无论如何所有的工作都是开放的，你不能只说‘我希望我的宠物功能在 web 平台中’就颠覆它。它总是涉及到建立共识委员会的过程。”

他认为，事实上，这是拥有一个开放的生态系统而不是集中决策的优势。“你可以用任何一种方式来解释。一方面，你可以说，为什么这个价值万亿美元的公司不自己推动事情向前发展？但从另一个角度来看，哇，这些浏览器是开源的，我们能够贡献我们想要的功能。”

“这是开源给予的机会，让我们庆祝一下。让我们鼓励更多的人参与进来并做出贡献，让我们鼓励更多的人资助这种风格的开发，因为这意味着社区和广大开发者利益的基础可以越来越多地设定优先级。”

> “像 Igalia 这样的公司可以帮助人们关注浏览器供应商尚未讨论的新客户问题。”

微软代表

让 Igalia 开发一个特定的网络功能并不保证它会实现，但它向浏览器制造商发出了一个信号，即该功能值得认真对待。“像 Igalia 这样的公司可以帮助人们关注浏览器供应商尚未讨论的新客户问题，”微软告诉我们。

卡戴尔认为，在某种程度上，Igalia 可以充当浏览器制造商收到的所有请求的过滤器。“处于世界万物的核心的麻烦在于，每个人都可以非常清楚地看到他们的问题，他们把问题放进桶里——但桶有海洋那么大。

他还希望开放的优先化实验能够有助于突出像 Igalia 这样的组织应该努力的方向。这个想法来自于一个问题:为什么我们需要单一的，非常非常富有的公司来资助一些事情？“如果我们有多种多样的资金来帮助网络持续发展，帮助它发挥潜力，那就太好了。”

那可能是较小的公司或工作组，甚至是个人。“可以是我们所有人或我们中的几个人赞助这项工作，解除障碍，让事情发生，然后我们控制优先级。”

“为什么 100 万开发者不能民主地决定‘这值 1 美元’，如果你筹集了 100 万美元的资金，那么你就可以完成价值 100 万美元的工作，这太棒了。"

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>