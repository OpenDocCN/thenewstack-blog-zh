# 如何保护云操作系统 Kubernetes

> 原文：<https://thenewstack.io/how-to-secure-kubernetes-the-os-of-the-cloud/>

[](https://sysdig.com/)

 [洛里斯·德吉奥安尼

洛里斯·德吉奥安尼是 Sysdig 的 CTO 和创始人，安全 DevOps 的领导者。他还是流行的开源故障排除工具 sysdig 和开源容器安全工具 Falco 的创造者。在创立 Sysdig 之前，洛里斯参与创建了 Wireshark，这是一款开源网络分析器，目前拥有 2000 多万用户。洛里斯拥有都灵理工大学的计算机工程博士学位，现居加州戴维斯。](https://sysdig.com/) [](https://sysdig.com/)

随着基础设施和工作负载向云的过渡以及团队采用 CI/CD 开发流程，出现了新的范式转变:*基础设施正在成为代码*。这种将基础设施视为代码(IaC)的方法非常强大，为我们带来了许多优势，并实现了像不变性这样的变革性概念。我们以声明的方式定义基础设施，并使用我们用于应用程序代码的相同的源代码控制工具(特别是 git)对它们进行版本化。旋转一个新实例和部署一个操作系统(即旋转一个新容器)都是在 git 中以声明方式发生的，并且部署在 Kubernetes 集群的边界中。

这种趋势变化也将更多的责任放在了开发人员手中，因为控制 Kubernetes 和 git 的人控制了基础设施、应用程序和策略。由于开发人员通常拥有 git 并将他们的服务定义为 Yamls，实际上，这已经成为他们的责任。所需要的只是在 GitOps repo 中更改一个 Yaml，管道将从那里获取它。

然而，它也引入了一类新的风险。当我们的基础设施是代码时，它可能包含成为漏洞的错误和疏忽，也可能使恶意行为者执行危险的操作。采用 IaC 并不自动意味着更安全；相比之下，这可能意味着更大的攻击面。因此，安全性需要发展并考虑这种新的模式。

首先，我们需要认识到保护我们的基础设施定义是必要的，就像保护我们的代码一样。这需要我们在如何保护我们的基础设施方面“左移”,在风险进入 git 时识别风险，理想情况下是在合并之前强制执行拉请求检查。

## Kubernetes 是云的操作系统；安全必须进一步向右转移

 [施洛米·韦克斯勒

从 21 世纪初在以色列国防部开始，Shlomi Wexler 在复杂的 IT 堆栈中担任过各种职务，包括 IBM 大型机、网络、安全、虚拟化和存储。2007 年，Shlomi 共同创立了旨在解决访问管理挑战的数据访问治理初创公司 Whitebox Security，并担任其首席技术官。白盒于 2015 年被身份和访问管理市场的领导者 SailPoint Technologies 收购。](https://www.linkedin.com/in/shlomi-wexler-b5869a4/?originalSubdomain=il) 

另一个不可否认的行业趋势是容器和 Kubernetes 的使用。大大小小的组织都采用 Kubernetes 作为平台来运行他们的应用程序。正如 Linux 操作系统在物理或虚拟硬件上编排进程一样，Kubernetes 在分布式计算池上编排服务。

随着 Linux 成长为支持几乎所有东西，从微型物联网设备到超级计算机，我们预计 Kubernetes 将逐渐支持世界上所有的分布式软件应用程序。而且，由于世界正在走向云，我们喜欢将 Kubernetes 定义为云的操作系统。

Kubernetes 提供了一个丰富、复杂的环境，使得扩展应用程序变得容易。与此同时，运行在 Kubernetes 上的应用程序往往由数十个、数百个甚至数千个服务组成，这些服务不仅相互依赖，而且依赖于许多不同的云资源。

这增加了复杂性和风险。这种类型的风险不容易通过专注于代码扫描和图像扫描的“左移”安全工具来控制，因为这些静态技术无法完全捕捉组合的爆炸和基于微服务的应用程序的相互依赖性质。保护 Kubernetes 需要深入的运行时安全性和强大的运行时服务上下文。它要求我们将安全转移到右边。

## 向左移动？向右移动？

那么这给我们留下了什么？像 IaC 这样的趋势表明，一旦基础设施定义被提交给 git 存储库，就需要向左移动并进行验证。Kubernetes 的复杂性要求在运行时有深入的可见性和上下文。正确的做法是什么？

正确的答案当然是向左移动**和向右移动**！

使用这种方法，您就拥有了跨 IaC 和运行时的单一真实来源。当我们谈到“源代码”时，我们指的是存储在 git repo 中的物理源文件(Yamls、Terraforms、Helm charts 和/或 Kustomizations)，以及最终部署到 Kubernetes 集群的运行时配置的源代码。保护前者将对后者产生预期的直接影响，从而产生更安全的运行时环境。但是，您必须有适当的运行时安全性来发现 IaC 源配置文件的偏差并检测异常活动。

IaC 和运行时安全性的结合创造了进一步增强安全性的机会。应用程序运行时收集的上下文(例如，哪些服务相互通信？哪些用户可以访问生产环境？)可用于通知策略创建。通过利用 gitops，可以在整个基础设施中自动实施策略，从而使运行时更加安全。去除了人工和人为错误，同时减少了攻击面。

## 从源头到生产的安全

一个真正完整的现代安全 DevOps 平台必须以全面平衡的方式结合这些方面。将安全性转移到开发管道的早期阶段是一种强制性的、被广泛接受的实践，我们需要积极地将其扩展到 IaC。但这必须得到运行时强大而精确的保护的支持。

这是一个良性循环，只有当左移和右移相互支持时才会发生，我们确信这是安全的未来。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>