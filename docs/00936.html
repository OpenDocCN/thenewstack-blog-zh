<html>
<head>
<title>How I Built an AWS DeepLens Clone with the Horned Sungem AI Camera</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用有角的Sungem AI相机构建AWS DeepLens克隆</h1>
<blockquote>原文：<a href="https://thenewstack.io/how-i-built-an-aws-deeplens-clone-with-the-horned-sungem-ai-camera/#0001-01-01">https://thenewstack.io/how-i-built-an-aws-deeplens-clone-with-the-horned-sungem-ai-camera/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">当我第一次在re:Invent 2017上看到AWS DeepLens的演示时，我对智能相机的可能性感到兴奋。整整一年后，我遇到了Horned Sungem，这是一款由英特尔的Myriad Vision Processing Unit (VPU)驱动的微型相机。</p>
<p class="translated">有了Raspberry Pi Zero和<a href="https://www.waveshare.com/horned-sungem-ai-vision-kit.htm" target="_blank" rel="noopener noreferrer external " class="ext-link"> Horned Sungem </a>相机的组合，我可以快速构建一个AWS DeepLens克隆体。我移植了一个我最初的<a href="https://youtu.be/ScYKqja-jdc" target="_blank" rel="noopener noreferrer external " class="ext-link"> DeepLens演示</a>，它可以自动识别车辆类型并在收费站计算费用。由于没有附加显示器，我使用了Amazon Echo来提供对话式用户体验。</p>
<p class="translated">在最近的<a href="https://youtu.be/yDBaIf_NANE" target="_blank" rel="noopener noreferrer external " class="ext-link">基于Horned Sungem的演示版本</a>中，我方便地用谷歌Home设备替换了亚马逊Echo，以提供相同的体验。我还添加了一个按钮，向用户发送带有车辆类型和通行费的WhatsApp消息。</p>
<p class="translated">以下是我在演示中使用的硬件设备列表:</p>
<ul>
<li class="translated">树莓派零度W</li>
<li class="translated">Grove Pi Zero帽子</li>
<li class="translated">Grove LEDs</li>
<li class="translated">Grove按钮</li>
<li class="translated">Horned Sungem智能摄像机</li>
<li class="translated">谷歌主页</li>
<li class="translated">电力银行</li>
</ul>
<h2 class="translated">认识一下有角的Sungem，人工智能摄像机</h2>
<p class="translated">Horned Sungem (HS)是一家专注于人工智能的中国公司。这款AI相机专为开发者、学生、业余爱好者和爱好者打造，让他们轻松创建自己的AI应用。</p>
<p class="translated"><a href="https://thenewstack.io/how-i-built-an-aws-deeplens-clone-with-the-horned-sungem-ai-camera/hs-cam/" rel="attachment wp-att-6275108" class="local-link"> <img decoding="async" loading="lazy" class="aligncenter wp-image-6275108 size-full" src="../Images/00ac9229d5ef3d1525d6a4587ff8d389.png" alt="" data-original-src="https://cdn.thenewstack.io/media/2018/12/0d5adeb3-hs-cam.jpg"/> </a></p>
<p class="translated">该设备有一个USB-C连接器，可以插入Raspberry Pi或任何其他计算设备，如PC或Mac。它原生支持通过CSI接口连接的Raspberry Pi摄像头。这款相机有两个端口——USB-C和micro-USB。USB-C型连接器用于将相机连接到计算设备，而微型USB用于外部电源。当连接到像Raspberry Pi Zero这样的低功耗设备时，相机无法从主机获得足够的电力。外部电源有助于HS以最佳性能工作。</p>
<p class="translated">我最喜欢HS的一点是运行在ARM或英特尔主机计算设备上的Python SDK。SDK极大地简化了推理机器学习模型的实现。基于CIFAR-10和PASCAL-VOC等流行数据集的经过充分训练的对象检测和人脸识别模型只是一个方法调用。</p>
<p class="translated">开发者要做的就是导入HS API，通过传递模型名来调用一个方法。输出返回检测到的对象的标签。</p>
<p class="translated">我使用PASCAL-VOC数据集训练的对象检测模型来识别公交车和汽车。有关使用SDK的更多详细信息，请参考Github上的HS SDK。<br/></p>
<div id="crayon-6422e076f279b622422116" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-e">from </span><span class="crayon-e">__future__ </span><span class="crayon-e">import </span><span class="crayon-e">print_function</span>
<span class="crayon-e">from </span><span class="crayon-i">future</span><span class="crayon-st">.</span><span class="crayon-e">standard_library </span><span class="crayon-e">import </span><span class="crayon-e">install_aliases</span>
<span class="crayon-e">install_aliases</span>()
 
<span class="crayon-e">from </span><span class="crayon-i">urllib</span><span class="crayon-st">.</span><span class="crayon-e">parse </span><span class="crayon-e">import </span><span class="crayon-i">urlparse</span>,<span class="crayon-h"> </span><span class="crayon-e">urlencode</span>
<span class="crayon-e">from </span><span class="crayon-i">urllib</span><span class="crayon-st">.</span><span class="crayon-e">request </span><span class="crayon-e">import </span><span class="crayon-i">urlopen</span>,<span class="crayon-h"> </span><span class="crayon-e">Request</span>
<span class="crayon-e">from </span><span class="crayon-i">urllib</span><span class="crayon-st">.</span><span class="crayon-e">error </span><span class="crayon-e">import </span><span class="crayon-e">HTTPError</span>
 
<span class="crayon-e">import </span><span class="crayon-e">json</span>
<span class="crayon-e">import </span><span class="crayon-e">os</span>
 
<span class="crayon-e">from </span><span class="crayon-e">flask </span><span class="crayon-e">import </span><span class="crayon-e">Flask</span>
<span class="crayon-e">from </span><span class="crayon-e">flask </span><span class="crayon-e">import </span><span class="crayon-e">request</span>
<span class="crayon-e">from </span><span class="crayon-e">flask </span><span class="crayon-e">import </span><span class="crayon-e">make_response</span>
 
<span class="crayon-e">import </span><span class="crayon-e">memcache</span>
 
<span class="crayon-i">shared</span>=<span class="crayon-e">None</span>
 
<span class="crayon-i">app</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">Flask</span>(<span class="crayon-i">__name__</span>)
 
 
@<span class="crayon-i">app</span><span class="crayon-st">.</span><span class="crayon-e">route</span>(<span class="crayon-s">'/'</span>,<span class="crayon-h"> </span><span class="crayon-i">methods</span>=[<span class="crayon-s">'POST'</span>])
<span class="crayon-e">def </span><span class="crayon-e">webhook</span>():
<span class="crayon-h">    </span><span class="crayon-i">req</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">request</span><span class="crayon-st">.</span><span class="crayon-e">get_json</span>(<span class="crayon-i">silent</span>=<span class="crayon-i">True</span>,<span class="crayon-h"> </span><span class="crayon-i">force</span>=<span class="crayon-i">True</span>)
 
<span class="crayon-h">    </span><span class="crayon-e">print</span>(<span class="crayon-s">"Request:"</span>)
<span class="crayon-h">    </span><span class="crayon-e">print</span>(<span class="crayon-i">json</span><span class="crayon-st">.</span><span class="crayon-e">dumps</span>(<span class="crayon-i">req</span>,<span class="crayon-h"> </span><span class="crayon-i">indent</span>=<span class="crayon-cn">4</span>))
 
<span class="crayon-h">    </span><span class="crayon-i">res</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">processRequest</span>(<span class="crayon-i">req</span>)
 
<span class="crayon-h">    </span><span class="crayon-i">res</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">json</span><span class="crayon-st">.</span><span class="crayon-e">dumps</span>(<span class="crayon-i">res</span>,<span class="crayon-h"> </span><span class="crayon-i">indent</span>=<span class="crayon-cn">4</span>)
<span class="crayon-h">    </span><span class="crayon-e">print</span>(<span class="crayon-i">res</span>)
<span class="crayon-h">    </span><span class="crayon-r">r</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">make_response</span>(<span class="crayon-i">res</span>)
<span class="crayon-h">    </span><span class="crayon-r">r</span><span class="crayon-st">.</span><span class="crayon-i">headers</span>[<span class="crayon-s">'Content-Type'</span>]<span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">'application/json'</span>
<span class="crayon-h">    </span><span class="crayon-i">return</span><span class="crayon-h"> </span><span class="crayon-r">r</span>
 
 
<span class="crayon-e">def </span><span class="crayon-e">processRequest</span>(<span class="crayon-i">req</span>):
<span class="crayon-h">    </span><span class="crayon-i">res</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">makeWebhookResult</span>()
<span class="crayon-h">    </span><span class="crayon-e">return </span><span class="crayon-e">res</span>
 
 
<span class="crayon-e">def </span><span class="crayon-e">makeWebhookResult</span>():
<span class="crayon-h">    </span><span class="crayon-i">speech</span>=<span class="crayon-i">shared</span><span class="crayon-st">.</span><span class="crayon-e">get</span>(<span class="crayon-s">"Prompt"</span>)
 
<span class="crayon-h">    </span><span class="crayon-e">print</span>(<span class="crayon-s">"Response:"</span>)
<span class="crayon-h">    </span><span class="crayon-e">print</span>(<span class="crayon-i">speech</span>)
 
<span class="crayon-h">    </span><span class="crayon-e">return</span><span class="crayon-h"> </span>{
<span class="crayon-h">        </span><span class="crayon-s">"speech"</span>:<span class="crayon-h"> </span><span class="crayon-i">speech</span>,
<span class="crayon-h">        </span><span class="crayon-s">"displayText"</span>:<span class="crayon-h"> </span><span class="crayon-i">speech</span>,
<span class="crayon-h">        </span><span class="crayon-s">"source"</span>:<span class="crayon-h"> </span><span class="crayon-s">"Smart Toll Gate demo with Horned Sungem"</span>
<span class="crayon-h">    </span>}
 
<span class="crayon-e">if </span><span class="crayon-i">__name__</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-s">'__main__'</span>:
<span class="crayon-h">    </span><span class="crayon-i">port</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">int</span>(<span class="crayon-i">os</span><span class="crayon-st">.</span><span class="crayon-e">getenv</span>(<span class="crayon-s">'PORT'</span>,<span class="crayon-h"> </span><span class="crayon-cn">8080</span>))
 
<span class="crayon-h">    </span><span class="crayon-e">print</span>(<span class="crayon-s">"Starting app on port %d"</span><span class="crayon-h"> </span>%<span class="crayon-h"> </span><span class="crayon-i">port</span>)
<span class="crayon-h">    </span><span class="crayon-i">shared</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">memcache</span><span class="crayon-st">.</span><span class="crayon-e">Client</span>([<span class="crayon-s">'127.0.0.1:11211'</span>],<span class="crayon-h"> </span><span class="crayon-i">debug</span>=<span class="crayon-cn">0</span>)
<span class="crayon-h">    </span><span class="crayon-i">app</span><span class="crayon-st">.</span><span class="crayon-e">run</span>(<span class="crayon-i">debug</span>=<span class="crayon-i">False</span>,<span class="crayon-h"> </span><span class="crayon-i">port</span>=<span class="crayon-i">port</span>,<span class="crayon-h"> </span><span class="crayon-i">host</span>=<span class="crayon-s">'0.0.0.0'</span>,<span class="crayon-h"> </span><span class="crayon-i">threaded</span>=<span class="crayon-i">True</span>)
</pre>
</div>
</div>

<p/>
<h2 class="translated">通过Twilio API发送WhatsApp消息</h2>
<p class="translated">当其中一个led亮起时，可以按下按钮来发送WhatsApp消息。我利用Twilio消息传递的最新特性来实现这个特性。使用WhatsApp API和Twilio SDK的经典短信API差别不大。</p>
<p class="translated">下面的代码通过Twilio发送消息:<br/></p>
<div id="crayon-6422e076f27a6112210674" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">

</td>
<td class="crayon-code translated">)(我)(们)(都)(没)(想)(到)(这)(样)(,)(我)(们)(就)(是)(这)(样)(了)(,)(我)(们)(都)(没)(想)(到)(这)(样)(了)(,)(我)(们)(就)(没)(想)(到)(了)(。<span class="crayon-i">留言</span><span class="crayon-st"/><span class="crayon-e">【创建】</span>(<span class="crayon-i"> to </span>=<span class="crayon-s">“whatsapp:</span>,<span class="crayon-i"> from_ </span>= <span class="crayon-s">“whatsapp:SRC_PHONE_NO” </span>,<span class="crayon-i"> body </span>=<span class="crayon-i"> 车辆 </span><span class="crayon-st"/><span class="crayon-e">get </span><span class="crayon-s">【Prompt】</span>】<p class="crayon-line" id="crayon-6422e076f27a6112210674-9"><span class="crayon-h"/><span class="crayon-e">【打印】</span><span class="crayon-i">【车辆】</span><span class="crayon-st"><span class="crayon-s"><span class="crayon-s">【Prompt】</span></span></span>
<span class="crayon-h"/><span class="crayon-e">【打印】</span><span class="crayon-i"/><span class="crayon-st"/><span class="crayon-i">sid </span>
</p></td>
</tr>
</table>
</div>
</div>

<p class="translated">在不到150行代码中，我可以实现一个模拟AWS DeepLens的端到端智能相机应用程序。</p>
<p class="translated">你可以从这个<a href="https://gist.github.com/janakiramm/8142f4d435dd5306e6744bc1d2b67ed5" class="ext-link" rel="external "> Github Gist </a>获得完整的源代码。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>
</div>
</div>    
</body>
</html>