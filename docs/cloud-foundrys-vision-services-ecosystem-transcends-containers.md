# Cloud Foundry 的愿景:超越容器的服务生态系统

> 原文：<https://thenewstack.io/cloud-foundrys-vision-services-ecosystem-transcends-containers/>

[云铸造基金会](https://www.cloudfoundry.org/foundation/)的执行董事 [Abby Kearns](https://www.linkedin.com/in/abbykearns) 宣称:“我有一个宏伟的愿景，那就是一个平台无关的单一服务市场。“我也认识到拥有一个开源平台的优势，以推动创新和合作方式。但我也需要认识到，对于一个平台来说，将会有一些独特的差异，以及将商业可行性融入结果的机会。”

在新的堆栈中，我们经常谈到在各种环境下将多个应用程序(包括第一代虚拟机和 Linux 风格的容器)暂存和扩展到一个通用平台上的想法。但是如果我们真的认真对待它，那么我们需要承认编排只是实现这个理想的一个工具。流程编排支持工作负载的暂存和部署。网络覆盖只是又一个工具，促进了无状态 RESTful 服务之间的联系。

还有第三个关键组件——在 Java 环境中，我们称之为中间件。但具体应该是什么成分，仍然悬而未决。一些人提议使用[的流媒体信息中介](https://thenewstack.io/apcera-nats-moves-real-time-message-stream-brokering/)，比如 Apache Kafka，或者[APC era NATS 平台](https://thenewstack.io/finding-simplest-path-value-apcera-nats/)；其他人假定消息传递协议用于队列，[比如 MQTT](https://thenewstack.io/mqtt-protocol-iot/) 。

Cloud Foundry (CF)平台即服务软件的贡献者现在建议将他们的通信系统的一部分(他们称之为*服务代理*)作为一种与工作负载无关的交互协议来推进。如果你对自己说，“哦，我知道你在说什么，我上辈子在 SOA 博客中读过这个术语，”请注意，大约六七年前，我们已经用完了计算领域中可用的、未使用的、通用的语言短语，所以我们现在只是重用以前用过的短语。

## 经纪公司

在 Cloud Foundry 的上下文中，service broker 是一个组件，它公布了运行在 CF 上的应用程序可能执行的那些服务，这有利于其他可能希望通过其 API 利用这些服务的应用程序。当然，CF 的服务代理概念一直是开源的。但上周，Kearns 的基金会采取了一项举措，通过有效地宣布其服务代理对 CF 以外的平台“开放”,进一步扩大了这种影响。

正如卡恩斯告诉《新书库》的，她说她的团队的行动很大程度上是受谷歌的启发。她告诉我们，在今年早些时候与谷歌工程师的一次讨论中，他们很难在 Kubernetes 发布的服务之间建立一种*绑定*的感觉。具体来说，Kubernetes 团队需要一种方法，使其平台上的服务能够联系并绑定其平台外的服务，而不需要两个平台都是 Kubernetes。

Kearns 解释说:“Cloud Foundry Service Broker API 非常简单，而且简单中带着优雅。“本质上，API 允许您创建、绑定、解除绑定和删除服务。但它也很灵活。它允许您在开发连接到 service broker API 的 Service Broker 时，为该服务添加不同级别的集成，这样，一旦该服务附加并绑定到应用程序，它就可以做不同的事情。您可以根据应用需求和服务需求自动执行这些操作。”

这是一种非常概括的说法，即服务代理使服务能够有效地发布其自身的多个版本——服务的不同类别，这取决于客户的状态或需求。在云服务市场，有一个“服务水平协议”的概念这种服务实例裁剪就像一个小规模的 SLA。服务代理可以根据服务请求中提交的计划实例化最合适的服务实例，而不是接受参数并调整其功能。卡恩斯称这种定制功能为*定制服务*。

这就是安全元素发挥作用的地方:当 CF broker 为应用程序协商每个绑定时，它可以检查所请求的服务是否需要凭证。这样就生成了服务密钥，与加密 Web 会话中的会话密钥没有什么不同。这使得任何恶意组件欺骗已经认证的应用程序变得非常困难；它必须知道或者能够访问在绑定发生时生成的服务密钥。

## 你在哪里，中间件？

十多年前，第一个 Web 服务本质上是通过 HTTP 协议进行通信的远程过程。将 URL 的概念调整为“统一资源标识符”的最初目的之一是为了方便通过 Web 地址联系的 Web 服务。还记得使用 CGI 协议将参数附加到 HTTP 标识符末尾的时候吗？[据说这已经被废弃了](https://www.w3.org/CGI/)，除了那些谷歌搜索。

给世界上的每个人你的一个地址，并翻转你的窗户标志，写着“是的，我们是开放的”，这种做法的问题是，世界不仅会敲开你的门，还会敲开你的门。一个用于识别世界上每一个独特服务的专用注册中心显然不能维持很长时间。

在世纪之交，微软和 IBM 开始合作开发一种面向服务的架构来解决争用问题。被称为[通用描述、发现和集成](http://www.informit.com/articles/article.aspx?p=31076&seqNum=3) (UDDI)，这类中间件使用 XML 模式来描述 Web 服务、它们可用的绑定类型以及客户端与它们联系的需求。UDDI 引入了 service broker 概念(有时被微软称为“服务注册中心”),作为维护服务目录和授权请求客户访问该目录的机制。

这就是服务目录的想法成为行业趋势的原因，包括 Gartner 在内的[分析公司预测](http://www.gartner.com/newsroom/id/1971515)随着企业将其应用程序迁移到云中，他们将不得不发布基于云的服务目录以保持竞争力。但是就像许多被随机连接和点燃的东西一样，它没有起飞。在上周由信息管理协会主办的研讨会上，该组织透露，与 2014 年相比，2016 年接受调查的组织中有近 5%表示他们不使用 IT 服务目录[PDF]。2016 年接受调查的公司中，只有大约四分之一表示他们目前使用服务目录。

## “平庸”

您可能会对自己说(或通过屏幕大声对我们喊)，SIM 调查中的服务目录与 Cloud Foundry 的服务代理管理的目录不同。去年 9 月，这可能是真的。但是现在，Google [已经正式加入了 Cloud Foundry Foundation](https://cloudplatform.googleblog.com/2016/12/Google-joins-the-Cloud-Foundry-Foundation.html) ，并且正在支持 Red Hat、Pivotal、IBM 和 Fujitsu 的共同努力。因此，最初的“服务网关”已经成为建立与 UDDI 在 2000 年尝试的市场模式相同的市场模式的最新机会:一个基于客户端应用程序寻求完成的内容来识别、跟踪和定位资源的网络。

这是同一个目标:*服务无处不在*，只是这一次平台不可知论的概念已经扩展到平台，而不仅仅是提出声明的平台。

似乎其他平台正在让路。周一，红帽的产品战略总监 Brian gracey 在[的博客文章](https://blog.openshift.com/red-hat-brings-application-awareness-to-kubernetes/)的底部用小字隐藏了一条消息，即 OpenShift(以及整个红帽)将在 2017 年采用服务代理 API。

Gracely 写道:“我们经常发现，迁移到一个更敏捷、更开放的环境所需的变化陷入了一个先有鸡还是先有蛋的困境，要么没有合适的技术，要么没有组织来适应快速变化。通过使整个 Red Hat 产品组合的技术方面保持一致并以容器为中心，Red Hat 消除了公司必须面对的很大一部分选择。”

但是，正如波兰波兹南经济大学的白皮书所记载的那样，UDDI 最终的失败是其自身设计不可避免的副产品:其分散的模式意味着没有人会特别维护它。因此，随着时间的推移，没有权威的方法来确定哪些已发布的服务仍然是当前的，而哪些其他服务，正如电话运营商过去常说的那样，“已断开连接或不再服务”

波兹南学派对这一困境的解决方案似乎是彻头彻尾的社会主义:建立一个完整的社会网络来众包服务经纪人的权威。

然而，Cloud Foundry 可能会采取不同的策略。从我们与 Abby Kearns 的交谈中，我们了解到开放服务代理 API(如果这确实是它的最终名称)的最终目标可能不是将单个服务冠之以权威、卓越的功能提供者。相反，它可以允许普通的 T1 在网络上的自然分布，日常服务，以及它们之间的负载平衡。

“云代工的全部意义是什么？这是对基础设施的抽象，”卡恩斯说。“实际上，如果你把它进一步细化，整个要点就是让组织——尤其是传统的非技术组织——免于单调乏味的繁重工作。这意味着，做与你的业务*不*相关或不同的事情。

“因此，当我思考服务和生态系统的观点时，它将一系列广泛的能力整合在一起，”她继续说道，“你可以利用和访问这些能力，这些能力为你的业务增加价值，但不一定使其与众不同。我认为它更像是一个连续的抽象层，利用现有的工具和功能，而不必花费时间和精力来重新创建它，因为你可以这样做。”

Cloud Foundry Foundation、IBM 和 Red Hat 是新堆栈的赞助商。

专题图片:芝加哥交易所，1909 年，在公共领域。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>