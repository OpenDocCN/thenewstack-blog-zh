# 后容器世界的生活以及为什么 Linux 的作用将会减弱

> 原文：<https://thenewstack.io/life-post-container-world/>

现在集装箱风靡一时。涌入集装箱生态系统的资金是巨大的。斯克罗吉叔叔会淹死在 金库里——鸭子是游泳好手。

自 20 世纪 90 年代末以来，容器就一直伴随着我们，但这并不是故事的结尾。真正的转变将伴随着“无服务器”的未来，这将彻底颠覆 ops 生态系统。公司将会倒闭，新的公司将会涌现，成千上万的人的工作将会发生根本性的变化。向无服务器未来的转变比你正常的宣传周期要大得多——我认为当前的容器宣传是 9.0 级地震的前震。

## 我们是怎么到这里的？

下次你去湾区的时候，安排一次去加州山景城的[计算机历史博物馆](http://www.computerhistory.org/)的旅行。在短短的几个小时内了解现代计算机 70 多年的历史是令人激动的。

技术发展如此之快，有时很难识别软件中的重复模式，但这些模式确实存在。

经典的恐龙操作系统书籍“[操作系统概念](https://www.amazon.com/Operating-System-Concepts-Abraham-Silberschatz/dp/0470128720)的第二部分是关于进程管理的。特别是其中一章是关于 CPU 调度的。这是那些重复的模式之一，也告诉我们我们来自哪里的故事。

## Unix 时代

早在 Web/Internet 进入大众意识之前，我们曾经拥有宏伟的孤岛式服务器和集中式计算，许多用户会提交时间请求来运行他们的应用程序。这些是共享资源，必须在多个用户和多个程序之间进行分配。这些作业必须进行调度，系统必须支持许多用户，并小心地给每个用户分配合理的 CPU 时间。那时候，在电脑上运行软件实际上要花相当多的钱。肯·汤普森的太空旅行每玩一次就要花费 75 美元。

尽管绝大多数企业都没有充分的理由让操作系统成为多用户操作系统，但至今仍被广泛使用。一个系统拥有几十到几百个用户已经不再常见。现在的服务器只服务于一个目的，而用户仅仅是过去的遗迹——只用于一组编程控制的守护进程。安全问题可能是多用户系统最头疼的问题，但是实际上我们甚至不再使用这个特性了。我们已经根据类型将我们的服务器分成不同的组。数据库独立于应用服务器，独立于负载平衡器，独立于队列等。当然，应用程序以 root 用户身份运行是一种罪过，所以运营人员为每个程序创建一个新用户——以及随之而来的附加功能，并且我们有大量的守护程序来监视和跟踪这些东西。

但是，为什么呢？

因为目前我们没有更好的。构建操作系统内核、支持它们的模块以及接口库支持的巨大宝藏的工作和知识是非常重要的。

## 网络时代

在 20 世纪 80 年代，个人电脑出现了，这真正开始摧毁象牙塔大机器的概念。然而，我认为是更强大的网络功能的融合显示了应用程序是如何激增并被如此广泛地使用的。

阿帕网在我出生的那年用 TCP/IP 取代了网络控制包(NCP):1983 年。在那个十年的后期，网络快速互联。

项目到处都在运行，不仅仅是在大学和非常大的公司。见鬼，即使是最低级的消费者也有软件。20 世纪 90 年代初，这种进步让欧洲迅速发展的 VX(计算机病毒编写者)造成了如此大的破坏，以至于像 McAfee 这样的公司为保护最终用户赚了大钱。

上世纪 90 年代末，我们迎来了第一次互联网繁荣……也迎来了第一次泡沫破裂。在孤立的垂直行业可能会出现小的倒退，但不要相信炒作——没有任何即将到来的泡沫破裂。如果有的话，目前的繁荣仍然在我们的曲棍球棒的 x 轴附近。如果你认为过去几年是件大事，那就系好安全带。

## 集装箱时代

本世纪初是技术自我实现的十年——我们还能称之为产业吗？每个组织，不管是不是软件提供商，现在都是科技公司。然而，软件如何运行才是更重要的进化。我认为它将作为历史上重要的一章被载入史册，并在计算机历史博物馆中赢得它应有的地位。

我之前在[“Linux 之死”中写过这个问题](https://www.linkedin.com/pulse/death-linux-ian-eyberg)

夸张是肯定的，但本质是非常真实的。我们在 2000 年代初看到了虚拟化的兴起，然后在 2000 年代中期看到了 IaaS，Heroku 和他的朋友们创造了 Paas，Docker 以前被称为 dotCloud。所有这些都极大地改变了公司交付软件、雇佣员工的方式，创造了以前不可能存在的全新行业，并且永远地改变了整个软件业的面貌。

我们醒来，发现自己正凝视着容器时代的寒武纪大爆发。

小公司只需几个脚本和一两个优秀的运营人员，就可以处理 5 到 10 到 20 台服务器，但是当您开始使用 50 台服务器，并开始涉足更多领域(或者数百、数千或数万家成熟公司正在涉足的领域)后，您就真的不想再考虑管理服务器了。见鬼，你从来没有真的想要，但它只是没有意义，直到你到达那个拐点。对于服务器数量少于 20 台左右的公司来说，在流程编排方面还有很多不足之处。问一问这种规模的公司的任何(开发)运营人员，他们可能会告诉你他们用一团麻绳和胶带拼凑出的无数部署/编排软件。

尽管如此，小公司的需求在过去几年才大幅上升。随着小公司现在需要更多的服务器或实例，你可能会认为我们将回归分时、集中调度时代的概念——尤其是在资源调度领域拥有大量软件的情况下，例如 Kubernetes、Mesos 等。

事实上，我们没有走这条路。我们正在离开数据中心的时代。我们正处于多年前开始的服务器范式的末端，我们正在快速接近一个资源时代。

## 资源时代

我所说的资源类似于电、太阳或水。

如果你有一个工程师团队为你的企业管理自己的发电厂，人们会奇怪地看着你，认为你疯了。一群穿着蓝色工作服的人在确保它已经上了油。容量经理确保有备用发电机。不断地必须设法处理高峰使用，烧坏。“我已经竭尽全力了，船长！”

然而，这正是当今大多数公司管理服务器资源的方式。

答案不是更好的工具或更好的操作，而是缺少这些——它们都将被抽象掉。我们需要停止谈论服务器，开始谈论资源。

## 物联网

所谓的物联网正开始大力推动我们进入我认为的无服务器、更加基于资源的环境。

有些人认为 IoT 意味着当你回家时，你的冰箱会给你唱一首好听的歌。这种想法是如此的“[杰特森](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CDEQtwIwAmoVChMI_8WZid7-xgIVhZmICh27dAy0&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DFyinD6ZDqeg&ei=be-3Vb_bNYWzogS76bGgCw&usg=AFQjCNE9y6vVslazALyXoI_LF-XmUbsjGw&bvm=bv.99028883,d.cGU)”——尽管完全公开，我的洗衣机确实如此。

很多人不知道虚拟化，像 Xen 一样，也用于嵌入式系统和移动设备。是的，你可以在手机上运行虚拟电脑。

> 这是什么意思？这意味着物联网领域不需要 Linux。不仅没有必要，实际上还是一种阻碍。

我认为这种趋势还会继续。当黑客可以在高速公路上远程杀死吉普车，并且自动卡车驾驶有完整的惯例时，我们应该感谢大多数这些系统没有在 Linux 服务器上完全运行。我不认为我们需要鼓励 14 岁的孩子在现实生活中的汽车上发泄他们的 GTA 幻想。

不是说 IoT 不需要 Linux，更多的是我们不希望那些设备有。仅从安全角度来看，它最大限度地减少了攻击面。

我相信，随着一波新设备的到来，我们将会突然意识到我们所认为的物联网将会是什么样子。随着设备的激增，网络需求也将发生变化。将每一个设备相互联网将是不必要的；然而，我们也不需要他们签入一组中央服务器。

各种工程师正在开展一场运动，从脸书和谷歌等大公司分散数据仓库。像[沙尘暴](https://sandstorm.io/)这样的公司正在这里进行试验。它是这个领域的软件支持者之一。

简而言之，这就是所谓的个人云带来的即将到来的政治变革。不要告诉 Nest，但是有了个性化云，这个愿景就实现了。你不必签署最终用户许可协议来改变你的恒温器。我们中的一些人可能会修修补补，但其余的人只是想要一个恒温器。

现在，如果你试图修改这些设备中的一个，你肯定会落入制造者/黑客的范畴。我相信我们已经非常接近拥有更多的标准化支持来修改这些设备，而不需要在 Linux 外壳中折腾。

## 劣质工具

ops 领域极其糟糕的工具使我们不再需要做大量的手工工作。我们的服务器环境正在快速接近这种新范式，这意味着所有旧的系统管理员/开发人员等。工业会随之消亡。随着他们从未来的消失，他们所有的工具也将消失。如果这意味着我们需要服务，那么这些服务自然会整合到资源提供者的捆绑包中。

这种新模式基本上是这样一个事实:如果我们在未来不必像现在这样管理服务器，我们围绕服务器使用建立的大多数工具和人力资源都是不需要的。最终开发人员的应用程序将可以直接使用这些资源，我们目前所做的所有精心制作的仪式都将不复存在。

这到底意味着什么？

我们来举个例子。

伐木。

日志是最原始的实践，但是我找不出一家公司不做日志的。事实上，大多数公司都有记录“所有事情”的默认做法问题是没人看日志。没有人对日志采取行动。

> 从进化的角度来看，伐木是原始汤。这是我们在发明火之前所做的。

事实上，日志还没有从我们的系统中删除，只是因为它是操作人员的通用语言。任何运营人员都可以找到问题发生的原因。

五年前，日志记录导致了广泛的应用程序级监控。

APM 使得应用内外都采用了更强大、更有用的指标系统。毕竟，如果您不直接管理物理资源，那么您的问题与您的应用程序问题直接相关，而不是驱动器爆炸。如今任何使用 AWS 之类的东西的人都不再处理这些问题了。它已经被抽象化了。

这些更细粒度的度量工具将我们引向了反馈控制和自适应系统。

我们可以对流程进行检查点检查(冻结韩独奏风格的流程副本)，而且我们现在已经为生产质量系统准备好了 DVR 风格的回放系统。数据科学的人介入只是时间问题。毫无疑问，未来将引领我们走向更加主动、自适应的控制系统。如果你对这个领域的未来感兴趣，你绝对应该看看威廉·劳斯在 AutoLetics 的作品。

所有这些都意味着专门从事伐木等行业的公司在未来将不复存在。我们今天所知的监控公司在未来将不复存在。不要误解我，我整天都盯着一个黑色的屏幕，上面有多色的文字，看起来就像 20 世纪 70 年代的家，但那不是未来。

如果你不是资源的提供者，你的服务于服务器的公司——过去时代的遗物——将会消亡。投资者:你可能想现在就开始抛售——再过三到五年就太晚了。

## 运营财务压力

减轻公司运营支出的财政压力也很大。不相信我？

在旧金山，即使是收入最低的运营人员也能挣 10 万到 12 万美元。然而，这些人将从事的许多普通工作正被服务和更先进的工具所取代。为什么每年要花那么多钱请人架设服务器，集成它，然后确保它能正常工作，而不是把 1/20 的钱花在服务上？

如果你在旧金山是一个有能力的运营人员，你可以要求 18 万美元的年薪。相比之下，你每年可以得到 15 万美元——一个相当不错的软件工程师。大多数操作人员甚至不编码！这就是诸如 Ruby/Python 之类的脚本语言在该学科中如此突出的原因。

话虽如此，对付那些无赖服务员所需的技能是一个充满了深夜和空酒瓶。我坚信，传统的运营工作虽然现在有利可图，但在未来不会如此突出。随着我们转向单核系统，机器将最终取代我们。

## 核心暴动

从表面上看，存储是从内核中分离出来的第一部分，但不是以大多数人认为的方式。毕竟，您仍然需要文件系统驱动程序来挂载外部文件系统。

后来，新泽西一家金融服务公司的一些工程师开始从内核中取出网络堆栈，以加速他们的高频交易(HFT)。内核太慢了。他们需要更快地处理事情。你看，在传统系统中曾经是一个福音的东西——上下文切换——对这些交易者来说变成了一个祸害。他们没有很多进程，他们想要一个具有最低延迟和最低开销的进程。如今，内核旁路几乎是许多 HFT 公司的既定做法，许多软件定义网络(SDN)生态系统也在采用这种方法。

接下来:文件系统本身开始出现在用户的世界中——否则你怎么能做到现代系统中的所有巧妙技巧，比如在实例运行时动态调整实例大小？有不少使用集装箱的公司也使用[保险丝](https://en.wikipedia.org/wiki/Filesystem_in_Userspace)和 [GlusterFS](http://www.gluster.org/) 。还有像 IPFS 这样的公司，他们对文件系统的未来有着完全不同的看法。

本质上，许多旧的内核责任已经游离到用户领域很长一段时间了，只是最近才加速。

## 开发者/内核的分离

那么，如果我们现在处于容器时代，接下来会发生什么呢？

单核的采用是下一步。工具对于大规模采用来说还太新，但是毫无疑问，将来你可能不会有一个大的 DevOps 团队，如果有的话。在没有服务器的未来，根本不需要这样的团队。如果这些工程师存在，他们将在应用程序级别工作，而不是系统级别。

应用层和操作系统之间将会出现明显的分裂，这种分裂将会消失在资源的提供者中。这些供应商是我们在过去 15 年中看到的自然发展。

当我上学的时候，这种划分很明显是用户域和内核域的对比，并且基于环的概念。

那时候，如果你有黑客术语“0 环”，你就拥有它。环 3 是用户/应用土地；然而，我们正朝着这些界限变得越来越模糊的方向努力。

Docker 和容器生态系统的其余部分在推动开发人员朝着这个方向发展方面发挥了重要作用。这可能不是他们各自公司的意图，但这是正在发生的事情。

## 单核

是什么让单核成为自然的进程？

首先，什么是单核？如果你想到亚马逊的 EC2 服务，你在用的那些电脑都不是真正的电脑。他们在现实生活中并不存在。它们是使用 Xen 软件的修改版本的计算机的虚拟实例。然而，他们通常运行 Linux，这意味着在真正的硬件上运行。现在，Linux 需要大量额外的代码来确保对各种硬件的支持，并且意味着多用户和多进程。单核不需要所有额外的膨胀，它们被设计成做一件事并且做好一件事:它们是单用户和单进程的。

Unikernels 提供了与容器相同和相似的特性(快速启动时间、轻量级内存、打包)，但除了许多其他出色的特性之外，还提供了额外的安全保证。

没有外壳可以登录，它是一个应用程序，而不是一个主机内核在数十亿个本不应该存在的进程之间切换。这从一开始就消除了大多数安全漏洞。在过去的两年里，总共有 46 亿美元的投资资金进入了证券市场。计算机安全不是一个小问题，unikernels 基本上杀死了大部分的安全问题，因为过去安全问题的最大部分处理的是 Linux 是一个具有多个进程的多用户系统的事实。任何黑客的首要目标都是在电脑上找到根，因为一旦他们找到了根，你就完了。由于许多大型组织使用可信网络的概念，现在您的整个组织都完蛋了。在单内核上没有“获取根”,因为没有根。

许多人已经开始注意到，单内核的大小与普通 Docker 容器的大小相比是很大的。因此，部署不是为您的容器准备一台机器，而是简单地将更改直接推送到 Xen，并按比例增减新的更改。谁需要所有这些编排/调度软件？在过去的这么多年里，您确实编写了不少于四个不同的部署系统。现在，我并不是说编排和调度软件将会消失，而仅仅是它们当前的化身。编排处理的许多麻烦都涉及到用户权限和外部软件依赖等问题——这是单核根本不必处理的事情。未来的调度和编排软件将只需要处理原始资源的使用，而不是一些 1000 行的 bash kludge，在你的公司里没有人愿意用十英尺长的杆子去碰它。

单核功能如此强大，以至于我们现在有了标题为[“单核的实时召唤”](http://anil.recoil.org/papers/2015-nsdi-jitsu.pdf)的研究论文，描述了如何启动单核来响应网络流量。

## 后集装箱时代的生活

我认为容器化、集群级调度、劣质工具、物联网、内核废弃和运营压力的结合正在将我们推向一个不再与服务器交互的环境。这将对发展世界产生巨大的影响，并带来持久的反响。

我不太清楚对过去的单核会有什么期待，但我知道我们不会再用现在的方式管理服务器了，未来很快就会到来。

这将是令人兴奋的。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>