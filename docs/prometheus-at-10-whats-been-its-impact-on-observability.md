# 10 岁的普罗米修斯:它对可观测性有什么影响？

> 原文：<https://thenewstack.io/prometheus-at-10-whats-been-its-impact-on-observability/>

祝 [Prometheus](https://prometheus.io/) 开源软件和社区 10 岁生日快乐。这个第二个[云本地计算基金会(CNCF)](https://cncf.io/?utm_content=inline-mention) 项目以给我们火的希腊神命名，成为推动现代系统[可观测性](https://thenewstack.io/category/monitoring/)的第一个主要工具——因为在实验之前、期间和之后，你不能修复你不能测量的东西。

由 SoundCloud 的前谷歌员工孵化的 Prometheus 在过去 10 年里已经发展到超过 700 个开源贡献者——尽管只有大约 25 个常客——和超过 100 万的用户。它也是第一个将触发警报集成到服务监控中的开源工具，它将服务监控组织成时间序列、键值对。

但是，除了一个响亮的名字，是什么让普罗米修斯在这么多年后如此受欢迎呢？它的一些最杰出的创造者和倡导者参与揭示了 10 年来[更好的可观察性](https://thenewstack.io/observability-is-the-new-kubernetes/)对软件行业的影响，以及开放源码在我们的分布式世界中的广泛采用。

## 普罗米修斯简史

“越来越多的‘正常’公司进入了这样一个阶段，它们拥有相当复杂的分布式系统，并且严重缺乏故障排除技能。”这就是《普罗米修斯:纪录片》(Prometheus:The documentation)和该软件的推动力是如何开始的。

[https://www.youtube.com/embed/rT4fJNbfe14](https://www.youtube.com/embed/rT4fJNbfe14)

视频

有一种自己动手的工具文化试图填补这一空白，而与此同时，系统的复杂性也在迅速增加。现有的内部工具大部分是手动的，无法扩展以跟上。

回到 2012 年，[朱利叶斯·沃尔茨](https://github.com/juliusv)和[马特·t·普劳德](https://github.com/matttproud)最近从谷歌跳槽到了音云。他们很快发现，拥有数百个微服务和数千个进程的 SoundCloud 存在许多可靠性和延迟问题。沃尔茨在纪录片中说，“我们甚至很难搞清楚这些问题是从哪里来的”，或者甚至经常无法确定是什么出了问题。

SoundCloud 已经建立了自己的集群缩放系统 Docker 和 Kubernetes 的前身——促进了动态和不断变化的计算环境。然而，没有传统的工具能够窥视集群的内部。

“我们真的对谷歌之外的[监控感到失望，”沃尔茨告诉新堆栈。](https://sre.google/sre-book/practical-alerting/)

当时，没有开源工具来弥合时间序列指标和警报之间的鸿沟，更不用说所需的灵活性和可伸缩性了。

于是他和 Proud 开始在业余时间建造后来成为 Prometheus 的东西，[从一开始就在 GitHub 上开源](https://github.com/prometheus)。然后他们开始在日常工作中建造越来越多的房子。

“我们大部分时间都在享受自由，”沃尔茨说。“但我们也想让 SoundCloud 更加可靠。但在此之前，我们需要知道发生了什么。”这两个人为他们的同事构建了许多基础设施可靠性图表，在这些图表中，所有的道路都指向对可见性的迫切需求。

沃尔茨指出了一个转折点，SoundCloud 的人们开始认识到普罗米修斯的价值。对于每一个微服务进程，他们最终都能够了解诸如资源使用情况之类的事情——“对以前如此不透明的事情有了巨大的洞察力，”他说。在项目进行了大约 18 个月的时候，SoundCloud 强制要求每个微服务都必须包含 Prometheus。

虽然这个项目在 GitHub 上已经有两年多的时间了，但它的创造者一直将它保持在隐形模式，直到 2015 年 1 月。在 SoundCloud 开源项目负责人的默许下，Prometheus 成为一个更加公开的开源项目，拥有一个网站、文档和一些媒体。

随着 2015 年 7 月 Kubernetes 容器编排的发布，Prometheus 的种子很快就落在了肥沃的土壤上。Prometheus 成为第一个允许服务发现的开源监控工具，这是高度分布式、高度复杂的 Kubernetes 迫切需要的。

“两者都受到谷歌类似产品的启发，”沃尔茨指出，这两个项目很快实现了紧密集成，“Kubernetes 然后提供本地 Prometheus metrics，Prometheus 提供 Kubernetes 服务发现，这两个项目配合得非常好。”

在 CNCF 招募库本内特作为其第一个项目后不久，普罗米修斯成为其第二个项目。

从那时起，生态系统和代码库已经发展起来，但在过去的十年中，重点并没有转移。

## 普罗米修斯的技术影响

普罗米修斯第一次为日益复杂的系统开辟了可观察性——使用 Kubernetes 肯定不会降低复杂性——使数据民主化，到目前为止，组织中的更多成员可以获得这种程度的可见性和理解。

Grafana 实验室的社区主任和 Prometheus 团队的成员 Richard Hartmann 告诉新的 Stack，[对 DevOps 和站点可靠性工程师(SREs)的影响是显著的。](https://www.linkedin.com/in/richih/)

“这是第一次，超大规模扩展以外的人实际上有工具来观察他们通过云原生和类似的扩展方法释放的复杂性，”哈特曼说。“Prometheus 是第一款允许您动态检测和监控任意复杂性和部署的工作负载，并对数据进行运算的工具。以前，人们被迫或多或少地预先创建所有仪表板。这是一种非常静态的处理和理解数据的方式。”

是什么让普罗米修斯在技术上如此特别？Prometheus 维护者和 Polar Signals 的创始人 Frederic Branczyk 告诉新的 Stack 说:“它有一个独特的组合，它有多容易操作，有多一致——总有一种方法可以做一些事情，而且也是最自然的方法。

这种特殊的技术下一步将走向何方？哈特曼说，有两个主题推动着[普罗米修斯路线图](https://prometheus.io/docs/introduction/roadmap/):

*   更紧密的集成。
*   超越云原生软件、网络和电网的扩展。

哈特曼说，普罗米修斯可能有潜力解决正在进行的全球供应链挑战，并提出了一个煤炭公司如何利用它的例子:“他们的传送带上有一个测量煤炭摄入量的端口。他们在传送带上称量煤的重量，以确定水分含量，并剔除任何太潮湿的东西。他们可以为一个专有软件解决方案支付五到六位数的费用，或者免费使用 Prometheus 和 Grafana。

## 普罗米修斯开源生态系统

虽然普罗米修斯将永远保持开源，沃尔茨保证，有很多公司建立在它之上和周围。沃尔茨本人领导 [PromLabs，](https://thenewstack.io/chronosphere-nudges-observability-standards-toward-maturity-prometheus/)开源了 [PromLens query builder](https://promlens.com/) 并为企业提供 Prometheus 咨询。另一位普罗米修斯的贡献者布莱恩·巴西经营着普罗米修斯培训公司“强健感知”。

Grafana Labs 是普罗米修斯开源生态系统的一部分，是商业和开源的实体之一。该组织有开源项目，如[【米伊美】](https://thenewstack.io/the-great-grafana-mimir-and-cortex-split/) [Tempo](https://github.com/grafana/tempo) ，最值得注意的是 [Grafana，](https://thenewstack.io/grafana-after-9-years-what-now/)这些项目将存储在后端的普罗米修斯指标可视化。

沃尔茨说，围绕普罗米修斯的这个独特的生态系统的发展，部分是因为“我们试图将自己定位为一个中立的东西，独立于一家公司。”

开源工具也从来没有其他项目的预算。“我们从来没有在这种模式下，初创公司(可以)说，‘添加所有功能。’因为如果他们这样做，我们的投资者会给我们更多的钱，”他说。资源的限制使得小型的普罗米修斯团队能够保持激光聚焦。

Branczyk 早在 2016 年就开始在 CoreOS 与普罗米修斯合作。CoreOS 的任务是通过自动软件更新来保护互联网。(“绝大多数的安全问题已经被修复，他们只是不更新它，”他说。)

CoreOS 在服务器上执行自动升级，然后是 Kubernetes，然后是任何软件。但是公司很快意识到，Branczyk 说，如果不知道升级是让事情变得更好还是更坏，他们的努力是没有意义的。

Branczyk 继续担任普罗米修斯维护者，这是他在 2018 年收购 CoreOS 的 [Red Hat、](https://www.openshift.com/try?utm_content=inline-mention)领导 observability 的一部分时间，直到他在 2020 年离开，创办了自己的企业。

他想做普罗米修斯做的事情，但要及时自动拍摄高分辨率快照，这就是为什么他创建并于最近开源了一个持续分析工具 Parca，他说这是“在 Kubernetes 和普罗米修斯的交叉点上工作”

Branczyk 说，这种较新的自动化分析概念有一个工具“每次查看一个进程 10 秒钟，然后以非常高的分辨率记录下你的程序正在做什么。”这使组织能够持续了解 CPU 等资源的使用情况，这当然会影响他们的云账单。

“如果你花费更少的 CPU 时间，如果你仍然做同样的事情，你的软件实际上更快，”Branczyk 说，这对电子商务尤其有价值，在电子商务中，每 10 毫秒你砍掉一个页面就会使客户转化率翻倍。

Polar Signals Cloud 是一个托管解决方案，允许您将 Parca 代理部署到 Kubernetes 集群上，它会自动开始分析您的基础架构。它是直接或间接从普罗米修斯生态系统中分离出来的几家产品和服务公司之一，该生态系统现在包括[亚马逊、](https://aws.amazon.com/?utm_content=inline-mention)谷歌和微软。

“我们所做的一切都深受普罗米修斯的启发，”布兰奇克说。他仍然是 Prometheus 运营商的维护者，该运营商从现已解散的 CoreOS 中分离出来，管理 Kubernetes 与 Prometheus 的集成，他评论说“它无处不在，人们没有意识到它是独立的”GitHub 项目。

## 对一些人来说，这是一个“定义职业生涯”的项目

布兰奇克称他在普罗米修斯的经历是职业生涯的转折点。“基本上，如果没有普罗米修斯项目，我不会有现在的地位，也不会有能力创办这家公司，为公司筹集资金。”

另一位普罗米修斯终身者 [Julien Pivotto](https://www.linkedin.com/in/julienpivotto/) ，开源可观测性顾问，普罗米修斯服务器项目的维护者，自 2017 年以来一直是普罗米修斯的用户，然后是贡献者。到 2020 年，他开始做出更重要的贡献，并在 2021 年，他被提升为普罗米修斯服务器的维护者。

与其他开源项目不同，Prometheus 在[方面相对成功，它在早期就认可了固定的贡献者](https://thenewstack.io/hacks-to-help-open-source-leadership-support-inclusion/)，并培养他们在贡献阶梯上向上爬。

“我为普罗米修斯做出了贡献，因为它很有用，我对它进行了改进，以更好地适应我们的用例，”皮沃托说。反过来，“它改进了我在 SRE 的工作方式，提供了更好的见解，使我们能够更好地应对和理解事件。”

现在，他和他的团队为普罗米修斯的用户提供支持。“这也意味着我为这个项目工作是有报酬的，”他说。“普罗米修斯是我唯一的工作领域，无论是支援，还是上游工作。”

虽然只有大约 24 个维护者和定期贡献者，但 Prometheus 从其他开源项目中脱颖而出，因为他们似乎都找到了一种从他们的开源贡献中获得报酬的方法。

当然，这反映了另一个常见的开源问题，正如其联合创始人沃尔茨承认的那样:“多样性最糟糕的部分是我们都是男人。”

他指出，包括 Kubernetes 在内的其他项目都有直接用于改善多样性和包容性的资金，而仍然主要靠自力更生和人手不足的 Prometheus 却没有。

## 一个不寻常的开源社区

CNCF 的前两个毕业生，Kubernetes 容器编排和普罗米修斯监测，已经发展成为一种共生关系，很少一个被用来离开另一个。但是，虽然它们是云本地世界的豌豆和胡萝卜，但它们确实有一些显著的差异。

例如，虽然 KubeCon + CloudNativeCon 每年两次接待成千上万的与会者，但一年一度的 PromCon 使其人数保持在 250 人以下。这种亲密关系是这篇文章的四位受访者都说 PromCon 是他们最喜欢的社区的一部分的部分原因。

当然，虽然 Kubernetes 是一个在谷歌诞生和成长的项目，但 Prometheus 在没有任何大公司支持的情况下也获得了类似的知名度。“我想这就是为什么它更具挑战性，”沃尔茨说。“没有一家公司能够投入资源。我们一直是一群公司的乌合之众，”他继续说道，尽管今天几乎一半的董事会成员来自 Grafana Labs。

普罗米修斯是一个小得多的项目，但仍然是一个大名字，这应该使它对潜在的贡献者有吸引力。哈特曼说，“与 Kubernetes 相比，这仍然是一个相对容易的方式，可以在开源世界中快速获得认可”。

然而，他承认“消极的解释是，地球上最大的项目之一有一个一到二十几个人的团队堵住所有的漏洞以保持船只漂浮——直到最近我们只有十几个人。更多的人手将非常受欢迎。”

这从一开始就是一个合作的机会——从来没有像几个开源项目一样，不得不在一个维护者的肩上摇摇欲坠。“我的模式是，我开始做很多事情，然后其他人进来适当地编码，”沃尔茨半开玩笑地说。

不出所料，我们交谈过的每个人都对普罗米修斯有一个愿望——更多的贡献者。“总的来说，为开源做贡献的影响是你得到了曝光。特别是，在当前的市场中，拥有一份公开的工作记录不会有什么坏处。此外，在大多数情况下，你对社会有益，”哈特曼说。"参与《普罗米修斯》的影响有一定程度的摇滚明星效应."

* * *

从本期《新堆栈制作人》中了解更多关于 PromLens 的信息，以及它是如何捐赠给 PromLabs 的:

[https://www.youtube.com/embed/K_k5MneMKC0](https://www.youtube.com/embed/K_k5MneMKC0)

视频

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>