# PostgreSQL 修复了一个无密码身份验证缺陷

> 原文：<https://thenewstack.io/passwordless-authentication-flaw-fixed-postgresql/>

最新发布的 PostgreSQL 对象关系数据库系统版本修复了三个安全漏洞和 50 多个其他错误。其中两个缺陷可能允许攻击者访问帐户和信息。

发布的更新适用于所有受支持的分支，包括 9.6.4、9.5.8、9.4.13、9.3.18 和 9.2.22。然而，值得注意的是，9.2.x 分支将在 9 月份结束支持，因此该版本的用户最好开始将其 PostgreSQL 部署升级到较新的版本。

PostgreSQL 开发人员为基于密码的身份验证添加了额外的限制，以防止潜在的不安全数据库部署。这是因为其中一个缺陷，在常见漏洞和暴露(CVE)目录中被跟踪为 [CVE-2017-7546](https://access.redhat.com/security/cve/CVE-2017-7546) ，源于数据库服务器管理员对 libpq 库行为的可能误解。

[libpq 库](https://www.postgresql.org/docs/9.5/static/libpq.html)提供了一个编程接口，许多客户端程序使用它来查询后端 PostgreSQL 服务器。如果提供了空白密码，库将拒绝对用户进行身份验证，甚至不会将此类请求转发给服务器。

PostgreSQL 开发人员在[发布说明](https://www.postgresql.org/about/news/1772/)中表示，这种行为可能会被数据库管理员解释为，为帐户设置空密码会禁用该用户基于密码的身份验证。

事实并非如此，一些身份验证方法，包括广泛使用的 md5，在由基于非 libpq 的客户端传递给服务器时，确实可以使用空字符串作为密码。这就是为什么在新版本中，服务器行为被更改为拒绝使用任何受支持的身份验证方法提交空密码，甚至首先阻止为帐户设置空密码的尝试。

新的更新还解决了第二个与身份验证相关的安全问题，该问题被跟踪为 [CVE-2017-7547](https://access.redhat.com/security/cve/cve-2017-7547) ，与一个尚未得到妥善修复的旧漏洞有关。该漏洞与 **pg_user_mappings** 功能有关，可能导致敏感信息泄露。

PostgreSQL 开发人员表示:“在此修复之前，用户可以查看 **pg_user_mappings** 中的选项，即使用户没有相关外部服务器的使用权限。”。“这意味着用户可以看到详细信息，如可能由服务器管理员而不是用户设置的密码。”

问题是，此问题的修补程序只能防止新创建的集群出现此问题。解决现有数据库的问题需要手动运行一系列命令并重启服务器。

这些更新中修补的第三个漏洞 CVE-2017-7548 源于对 **lo_put()** 函数的权限检查缺失，该函数可能允许任何用户更改大型对象中的数据。函数已更改，现在将检查目标对象的更新权限。

通过像素的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>