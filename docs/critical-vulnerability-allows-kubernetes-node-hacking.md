# 关键漏洞允许 Kubernetes 节点黑客攻击

> 原文：<https://thenewstack.io/critical-vulnerability-allows-kubernetes-node-hacking/>

Kubernetes 已经收到了迄今为止在该项目中发现的最严重的漏洞之一的修复程序。如果不修补，该漏洞可能允许攻击者接管整个计算节点。

“通过特制的请求，被允许通过 Kubernetes API 服务器与后端服务器建立连接的用户可以通过相同的连接直接向后端服务器发送任意请求，并使用用于建立后端连接的 Kubernetes API 服务器的 TLS 凭据进行验证，”Kubernetes 开发人员在[一篇咨询文章](https://github.com/kubernetes/kubernetes/issues/71411)中说。

此外，在默认配置中，经过身份验证和未经身份验证的用户都可以执行 API 发现调用，并且可以利用此漏洞提升他们的权限。例如，攻击者可以列出一个节点上的所有 pod，可以在这些 pod 上运行任意命令，并可以获得这些命令的输出。

已知的缓解措施包括不使用聚合 API 服务器，或者从不应该对 kubelet APIs 具有完全访问权限的用户那里删除 pod exec/attach/portforward 权限。这两种策略都可能会破坏现有部署，因此建议尽快升级到 Kubernetes 补丁版本。

追踪为 [CVE-2018-1002105](https://access.redhat.com/security/cve/cve-2018-1002105) 的权限提升漏洞已在 Kubernetes 1 . 10 . 11、1.11.5 和 1.12.3 版本中修复。1.0.x 到 1.9.x 版本也受到影响，但尚未获得修补程序。

检测环境中的漏洞是否已经被利用并不容易，因为授权的请求不会记录在 Kubernetes API 服务器的审计日志或服务器日志中。它们确实出现在 kubelet 或聚合 API 服务器的日志中，但是很难与所有其他合法请求区分开来。

“OpenShift 容器平台的所有 3.x 版本都允许在一个计算节点上运行的 pod(多个运行的容器实例)受到损害，一个 pod 以普通用户权限被调度到该计算节点，”Red Hat 在[的一份公告](https://access.redhat.com/security/vulnerabilities/3716411)中说。这种访问可能包括对所有机密、pod、环境变量、正在运行的 pod/container 进程和永久卷的访问

在 OpenShift Container Platform 3.6 或更高版本中，该漏洞还允许攻击者获得对聚合 API 服务器的任何 API 的集群管理访问权限，包括度量服务和服务目录。通过访问服务目录，攻击者可以在任何命名空间或节点中创建代理服务，部署恶意代码或更改现有服务。

“这是一件大事，”Red Hat 的副总裁兼云平台总经理 Ashesh Badani 在[的博客文章](https://www.redhat.com/en/blog/kubernetes-privilege-escalation-flaw-innovation-still-needs-it-security-expertise)中说。“这种行为者不仅可以窃取敏感数据或注入恶意代码，还可以从组织的防火墙内关闭生产应用程序和服务。”

Red Hat 发布了 OpenShift Container Platform 版和更高版本的修复程序，但也在其公告中为无法立即应用更新的环境提供了详细的缓解说明。

Badani 说:“这是开源产品可以从项目中分离出来的地方。”“Red Hat 在交付开源产品方面拥有数十年的经验，从强化企业需求代码到提供漏洞和缺陷修复。[……]这种专业知识的一部分是知道推动修复是不够的，我们需要为我们的客户提供文档和策略，以帮助他们评估他们如何受到影响，哪些系统受到影响，以及为什么(甚至为什么不)他们应该应用修复。”

“所有谷歌 Kubernetes 引擎(GKE)主机都受到这些漏洞的影响，我们已经将集群升级到最新的补丁版本，”谷歌云团队在[的一份安全公告](https://cloud.google.com/kubernetes-engine/docs/security-bulletins)中表示。“不需要任何操作。”

管理 Kubernetes 的云计算原生计算基金会和 Red Hat 是新堆栈的赞助商。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>