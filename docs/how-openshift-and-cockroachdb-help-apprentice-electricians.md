# OpenShift 和 CockroachDB 如何帮助电工学徒

> 原文：<https://thenewstack.io/how-openshift-and-cockroachdb-help-apprentice-electricians/>

[](https://www.linkedin.com/in/alhandy/)

 [亚历克斯·汉迪

亚历克斯是红帽公司的技术营销经理。在他之前的生活中，他报道了第一台 iMac 的发布，然后开始了 20 多年的科技记者生涯。](https://www.linkedin.com/in/alhandy/) [](https://www.linkedin.com/in/alhandy/)

如果你正在读这篇文章，你的过去是一个电工。布线房屋，办公室和我们喜欢走过的公共空间，这些人是高技能的，通常是工会工人，他们必须接受大量的培训和经验来完成他们的工作。不管你怎么说软件 bug，它们不会经常放火烧大楼或炸电视机。

因为这项工作的风险如此之高，所以正确培训其成员并确保这些成员知道火线和地线之间的区别是工会义不容辞的责任。

传统上，解决方案是培训，但电气培训联盟采用了一种非传统的新交付方法，这种方法需要使用 Linux 容器、API 网关和 CockroachDB。

## 连接世界

[电气培训联盟](https://electricaltrainingalliance.org/)为联盟学徒电工项目开发课程。成为学徒的工会培训计划要求遵循注册的课程。ETA 为美国和波多黎各大约 230 到 240 个培训项目提供课程和指导，这些项目为电工提供学徒和培训。

史蒂芬·博伊德是[电气培训联盟](https://electricaltrainingalliance.org/)的 IT 架构师、分析师和开发人员，在那里他监管着规模不大的 IT 和软件基础设施团队，这些团队维护着该联盟使用的相当大的在线资产。他也是 ETA 加入 open shift Commons(open shift 背后的开源社区)的推动力。

与大多数企业软件和 IT 项目一样，Stephen 的 OpenShift 和 CockroachDB 之旅始于一个新的计划，一个测试微服务和许多新服务的项目，包括 OpenShift Dedicated、Tekton、pipelines 和 CI/CD。在这个过程中，处理他们必须处理的数据成为一个越来越大的问题。

斯蒂芬领导了 ETA 新的基于拨款的劳工部项目，以建立一个基于云的平台。

“这些注册的(培训)项目必须使用管理软件来跟踪一切:时间、工作培训任务、上学时的成绩。这笔拨款允许我们创建一个在线项目。我们需要一种方法来创建一个需要大量信息收集的在线应用程序，并跟踪所有这些东西，”他说。

这个基于赠款的项目要求 ETA 创建一个可以根据流量快速调整和扩展的解决方案。他们确信单一的方法不适合他们，并希望能够基于每个微服务独立地支持和扩展，因为一些应用程序全年都有流量，而一些则没有。为了优化资源，他们选择了一种容器化的方法，这种方法允许服务在需要时启动，在不使用时关闭。

该团队选择了 Red Hat 的 OpenShift 容器管理平台来使用 Kubernetes 协调一切。他们选择了 OpenShift，致力于整合托管服务方法，让团队专注于构建应用程序。“所有这些培训中心做的各种事情，我们希望以一种动态的方式进行，并允许一种更快、更敏感的机制，”斯蒂芬说。这种在托管平台上运行的基于容器的应用程序架构是实现这一点的基础。

最初，斯蒂芬独自开始了埃塔的数字化改造。幸运的是，今天他不再孤单。他有两名内部开发人员和一家由十多名 UI 设计师组成的外部开发公司来帮助构建新的云托管培训网站。

去除了手动管理 OpenShift 和 Kubernetes 的负担，实际的应用程序架构开始参与进来。自然地，过渡到云可能需要团队在构建应用程序的方式上做一些架构上的改变。

ETA 最初的数据库解决方案适用于小型团队和站点，但他们的新教育平台需要大规模运行，并且在未来需要跨地区运行。这开始寻找一个无需额外集成工作就能满足这些要求的合作伙伴。

“我开始寻找致力于 OpenShift 的合作伙伴。与 OpenShift Dedicated 无缝集成的是 CockroachDB，”他说。

此后，该团队在 OpenShift Dedicated 中实现了 CockroachDB 操作符。

[ [Kubernetes 操作符](https://www.openshift.com/learn/topics/operators)是一种打包和管理 Kubernetes 本地应用程序和软件的方法。Kubernetes 操作员整理关于应用程序和软件的操作知识。他们可以自动执行第 1 天和第 2 天的操作，并对集群事件做出反应，从而为用户提供完整的生命周期体验。]

真正的诀窍是，在这种新的容器化环境中，幕后流动的数据都是敏感的、有状态的，并且对用户在成为熟练工的过程中的进展至关重要。

## 最后形状

斯蒂芬和他的团队继续致力于他们的数字化转型，但他们已经在这一点上解决了许多基础元素。其中最关键的当然是 CockroachDB，它是有状态的、容器友好的数据存储。然而，在栈中的其他地方，还有诸如 Red Hat OpenShift API 管理(T1)和 Kubernetes-native Java 栈(T2)quar kus(T3)等元素。当他们部署服务时，使用 [Flyway](https://flywaydb.org/) 将数据推送到 CockroachDB。一个大问题是灾难恢复。他们通过确保在本地和生产级别的每一层都有多个备份来解决这一问题。他们在 OpenShift 专用系统上进行本地备份，并使用 CockroachDB 将数据转移到 S3 存储桶中。

所有这些在节省时间和提高效率方面意味着什么？Stephen 说，总体而言，配置环境变得更容易了，重现环境也更简单了，不会出现典型的差异，而这些差异会产生臭名昭著的“它在我的机器上工作”类型的问题。

“拥有[基于容器的系统]使我们能够立即创建新环境，启动并运行数据库，甚至使用 Tekton 部署服务。“我们正在和 ArgoCD 一起调查 GitOps，”斯蒂芬说。

此外，Stephen 说，与现有的虚拟化环境相比，维护和管理一组容器要简单得多。

“我们一直是虚拟化的支持者。我们在办公室内部使用 VMware，因此如果这是一个面向开发人员的环境，我们将创建一个虚拟机，然后进行所有安装。我们有快照，但这仍然是一个长达一天的过程，让一些东西开始运行和修补，再加上快照的维护。类似于暂存环境的东西将需要我们的数据中心，它也使用虚拟机，我们必须购买空间并让它运行，”他说。

现在一切都变了。

“两个星期前刚刚出现了一个单独的项目。两天后，我就有了一个空间，OpenShift 名称空间也建立起来了，服务也部署好了。他们在一天内添加了 CockroachDB，以便进行测试。相比之下，与我们的发展伙伴合作，可能需要两到五周才能完成一些事情，”他说。

“这就是为什么我们想处理容器和所有这些运营商的力量。一切都更快。我们正朝着敏捷周期前进，我们希望推出一些有用的东西，快速交付最小可行的产品，并快速实施变革。”

实现这种速度需要基于容器的基础设施所提供的敏捷性和环境一致性。

ETA 能够构建一个基于容器和 Kubernetes 的平台，将所有数据联系在一起，并允许培训中心定制他们的程序，并自动化他们的大部分日常操作。这使得培训学校能够节省时间并提供高质量的培训，同时为电工提供简化的培训体验。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>