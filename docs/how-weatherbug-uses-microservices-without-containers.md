# WeatherBug 如何使用没有容器的微服务

> 原文：<https://thenewstack.io/how-weatherbug-uses-microservices-without-containers/>

自 2015 年以来，天气预报服务 [WeatherBug](https://www.weatherbug.com/) 一直在其 IT 基础设施中使用微服务，通过将组件转变为更轻便、更易于管理的系统，来大幅简化和改造其陈旧的大型自制单片应用程序。

但是，WeatherBug 没有像通常那样在容器中运行微服务，而是采取了一种创新的方法，直接在亚马逊网络服务的弹性计算云(Amazon EC2)平台上运行微服务，无需容器，进一步简化了部署。

“这可能是一条不寻常的路，”WeatherBug 的高级工程副总裁[埃迪·丁格尔斯](https://www.linkedin.com/in/edingels/)说，“但事实证明这是公司的正确道路，也是他和他的员工试图纠正的 It 问题的正确道路。

丁格尔斯说，WeatherBug 自 1993 年以来一直存在，建立在大型数据库驱动的应用程序上，可以追溯到公司成立之初。这意味着它们中的许多都笨重庞大，而且可以追溯到手机和应用程序出现之前。旧的单一应用程序很难在需要时快速更新或修改，这已经成为移动设备世界和消费者希望在其上使用的许多应用程序的必需品。

到 2015 年，很明显需要改变，因此该公司开始探索其顽固的旧基础设施的替代方案。

“我们发现做一个新的部署是困难的，所以我们的许多基本原理归结为增加新架构的速度和创新步伐”，Dingels 说。当他们第一次看到微服务时，很明显他们可以用来分离不同开发团队的开发流程，以便所需的应用程序和服务可以独立扩展并更加自主地运行。

他说，这就是微服务的魅力——从那一刻起，打破单一的应用程序和开发，以更快更有效地完成，并更快地将代码投入生产。这也是使用 EC2 的想法产生的时候。

丁格斯说，EC2 是一个让公司使用微服务的环境，而不必增加 Docker 等容器平台的额外开销。

“如果你看看 AWS，有许多不同的方式可以运行计算，”他说。有了 EC2，基本上，你就有了一个可以运行几乎任何东西的主机和主机环境，甚至是微服务。这种结构是一个虚拟主机，就像一个容器，但没有正式的容器，他补充说。

丁格尔斯说，对于 WeatherBug 来说，微服务有助于将其提供的各种移动和桌面应用程序与公司基础设施内即时发生的新功能、配置、代码和变化联系起来。这包括使用微服务来帮助应用程序获得用户位置的实时信息，以便他们可以获得准确的天气细节。

“其中的每一个都是独立运行的服务，运行在 EC2 之上的独立代码片段，它们没有连接成一个单一的服务，”Dingels 说。“这里的关键是，我们将我们服务的功能分解成最小的元素，我们可以独立部署和迭代。”

他说，他们可以使用容器平台做同样的事情，但很乐意避免额外的复杂性。使用 EC2，每个微服务都有自己的自动扩展组，可以从扩展角度独立管理。

“现在你可能会说我们没有利用 Kubernetes 和 Docker 容器以及使用它们的许多优势，”Dingels 说。“它们肯定在我们的路线图上，但我不认为你需要使用微服务来实现它们。”

Dingels 说，如果有人说必须使用容器来运行微服务，“我会说他们限制了自己。微服务的整个理念是，你不要限制你的技术选择。”

通过使用微服务将应用程序分解成更小的组件，它允许这些组件很容易地被验证和部署到其他地方，而对其他代码的中断更少。

在 2015 年初最初几周的微服务讨论之后，WeatherBug 团队清楚地认识到，这是大幅改革其开发流程的正确策略。

“这几乎立刻就说得通了，”丁格斯说。“这并不像有大量的令人信服的事情要做。每个人都感觉到了问题，这实际上是围绕着部署和回归”以及使用过去的单块应用程序做这些事情需要多少时间。“我们发现，拆分服务并将其部署在 AWS 上非常有意义，而且它运行得非常好，不一定要放入 Docker，这是当时唯一可用的东西。”

据 Dingels 称，自从开始向微服务转移以来，WeatherBug 内部已经出现了重大改进，包括更快的发布节奏——与过去几个月相比，今天通常每周发布多次——以及增加代码稳定性，减少故障排除时间和 QA 回归时间。“我们确实发现，在处理微服务时，回归可以非常快地完成。

如今，作为一个持续过程的一部分，公司内部大约 99%的旧单片应用程序已经使用微服务进行了转换，并且几年来，所有新的编码都是使用微服务完成的。“这些巨石的一些残余仍然存在，是遗留下来的碎片，但现在还没有理由回去把它们拆开，”丁格尔斯说。

他说，几乎不可能确定转向微服务给 WeatherBug 带来了多少成本，因为这项工作是随着时间的推移而进行的，而不是在特定的日期开始和结束。“我们有点像在飞机飞行时做工作，我们说我们想做微服务。”

一路上有一些挑战，包括一些他们预料到的挑战和一些意想不到的挑战。丁格尔斯说，首先，由于代码被分离，依赖关系变得更难映射，但这可以通过使用新工具来解决，如自动气象站 的 [X 射线，它自动化了这个过程。此外，由于代码被分段的方式，过去有助于发现 monoliths 中问题的日志文件在微服务中并不有效，但其他工具，包括](https://aws.amazon.com/xray/) [ELK stack](https://www.elastic.co/blog/getting-started-with-elk) ，可以帮助解决这些问题。

然而，尽管迄今为止它的方法是无容器的，Dingels 说 WeatherBug 有一天也可能最终部署 Docker 或 Kubernetes 或另一个容器管理系统，因为这些方法也有一些潜在的好处。

对于某些用途，容器管理系统可以增加公司的 IT 能力，甚至更多，他说，通过引入容器来提供对其底层基础设施的更好利用。他说，另一个好处是，使用 AWS EC2 时，容器将更容易快速扩展。

“获得新的计算资源在 EC2 上运行比使用容器花费更多的时间，”Dingels 说。“现在你可以想象，随着天气的变化，我们会看到使用情况有很大的变化，特别是取决于我们的用户位于哪里，”无论是在纽约市的城市地区还是蒙大拿州等农村地区。

“我想说它在路线图上，”他也谈到了未来的容器系统部署。“我们发现的一件事是，它真的回到了你将获得最大回报的地方。”

WeatherBug 的技术合作伙伴 EastBanc Technologies 帮助促成了这次采访。EastBanc Tech 和 Earth Network/WeatherBug 已经在许多项目上合作多年，从原生云迁移和部署到 API 的架构、开发和第三方公开。一路走来，EastBanc Tech 向 WeatherBug 介绍了微服务的力量，并建立了创新的跨云部署，利用了不同云提供商各自独特的优势。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>