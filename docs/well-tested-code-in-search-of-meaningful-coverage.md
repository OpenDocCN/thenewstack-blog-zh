# 测试良好的代码:寻找有意义的覆盖

> 原文：<https://thenewstack.io/well-tested-code-in-search-of-meaningful-coverage/>

[](https://www.linkedin.com/in/powellronald/)

 [罗恩·鲍威尔

罗恩拥有空间物理学背景，曾作为卡西尼小组成员分析土星磁层中的等离子体。他现在在旧金山的 CircleCI 公司工作，是一名开发人员，倡导开发内容，使开发人员能够更快地构建、测试和部署他们的项目。](https://www.linkedin.com/in/powellronald/) [](https://www.linkedin.com/in/powellronald/)

如果你从事软件开发领域的工作，你可能已经听说过你应该总是编写经过良好测试的代码。每个人都想拥有经过良好测试的代码，这是有充分理由的！测试确保我们的代码按预期工作，并防止回归。

彻底测试代码有助于团队自信地更快地发布软件，并且问题更少。许多团队认为测试是“已完成”工作的一部分，但是仍然努力寻找测试质量和完整性的度量标准。

代码覆盖率是测试套件完整性的标准度量。通常，它是执行整个套件时运行的代码行的百分比分数。百分之百的覆盖率意味着在某个时间点执行的每个代码分支的每一行。这个度量标准提供了对我们测试完整性的一定程度的信心。

不幸的是，代码覆盖率并不总是能说明全部情况。一个完全覆盖的测试套件仍然会非常差，有遗漏的 bug，被忽略的边缘案例等等。(在某些情况下，覆盖率低的代码可以被彻底测试，但这种情况不太常见。)

在测试中，质量和数量都起着关键作用。虽然您执行的测试数量很大，但是测试背后的方法对您的代码库健康更为重要。在发布新功能时，适当地保护代码库免受生产中的错误并防止 bug 的测试比高覆盖率的测试更重要。

因此，在编写测试用例时，遵循一套适当的技术是非常重要的。你的测试方法和软件架构的任何部分一样重要。

让我们探索一些标准的测试技术，并讨论如何确保您的代码得到良好的测试。

## 测试技术

开发人员使用许多方法来确保他们的代码经过良好的测试。在大多数情况下，一个优秀的测试套件使用了几种技术的组合。

### 单元测试

开发人员单独执行的最常见的测试之一是单元测试。单元测试关注于代码的各个部分，以保证正确性。当一个代码单元不能正常工作时，该单元的一个或多个测试应该会失败，但是它不应该影响其余的单元。

尽管许多开发人员在这里结束了他们的测试套件，但是经过良好测试的代码远远超出了对单个单元的验证。

### 集成测试

另一种常见且有价值的代码测试技术是集成测试。顾名思义，集成测试测试代码如何作为一个整体一起工作。

理想情况下，开发人员将集成测试与单元测试结合起来。当编写良好的集成测试通过时，它应该表明您的代码片段作为一个整体以您期望的方式运行。

集成测试可能是任何经过良好测试的代码库的重要组成部分，尤其是在与单元测试结合使用时。

### 用户界面测试

当你的软件包含一个面向用户的前端时，用户界面(UI)测试可能对它的成功至关重要。有时被称为浏览器测试，UI 测试检查用户交互组件的完整性。

当所有预期的页面元素都存在并且运行正常时，良好的 UI 测试应该通过。您甚至可以扩展这些测试来检查 CSS 是否正确显示，或者检查特定于浏览器的问题。

尽管许多团队手工进行这些检查，但是一个经过良好测试的代码库通常包括对 UI 的测试。即使只是一些重要的问题检查，UI 测试也可以让软件团队在发现错误或回归时省去很多麻烦。

### 左移测试

虽然许多开发人员将测试视为开发过程的最后一步，但左移测试挑战了这一观点。左移方法将软件开发过程想象成一个时间线，并提倡在软件开发过程的早期进行测试，而不仅仅是在最后。

许多团队在测试驱动开发(TDD)中将这一点发挥到了极致，它包括在编写任何代码之前编写测试。尽管一些团队没有离开他们的软件测试，但是它可能是一个有价值的工具。测试不应该是事后的想法！

### 安全扫描

当集成到您的测试或持续集成和持续交付(CI/CD)工作流中时，安全扫描已经证明了它们的价值。毕竟，安全漏洞是软件面临的最大威胁之一。

即使是最好的开发人员也能写出易受攻击的代码；几乎不可能知道并避免每个安全隐患。安全扫描可以提醒您的团队注意有可能打开漏洞的代码。他们也可以检查你的代码库中的开源库。

虽然从技术上来说，安全扫描不是测试的一部分，但在确保我们的代码按预期运行且不容易受到攻击方面，安全扫描是非常宝贵的。

### 代码覆盖率

如前所述，代码覆盖率是衡量测试套件质量的常用方法。当许多团队通过一个或多个测试运行所有代码时，他们感到满意，但是这些测试从来没有讲述整个故事。

即使是完全覆盖的测试也可能包含重言式或者总是通过的测试。您的测试应该验证您的代码是否按预期工作，而不仅仅是验证它是否运行。运行时没有错误固然很好，但是对于测试良好的代码来说这还不够。

尽管如此，代码覆盖率仍然是一个有价值的度量，尤其是对于测试编写来说。

## 实现 CI/CD

经过充分测试的代码的真正标志是高效、可靠和一致的 CI/CD。现代软件开发经常使用[持续集成](https://circleci.com/continuous-integration/) (CI)策略。这种策略鼓励开发人员编写小块代码，以便操作管道可以自动构建和测试。通常，每次提交都会在测试通过后触发自动软件构建。

可以快速可靠地部署经过良好测试的代码。当开发人员编写新代码破坏旧代码时，一个好的测试套件应该能够发现这个问题。期望开发人员永远不犯错误是不合理的，尤其是在大型代码库中。

经过良好测试的代码使开发人员能够走向持续集成和它的表亲，持续部署(CD)。在项目早期大量投资于测试是有回报的，因为它让开发人员在不破坏东西的情况下快速行动。不断地将新代码集成到代码库中并将其部署给用户消除了摩擦，使您的团队能够更快地交付代码并减少问题。

## 结论

除了编写测试之外，开发人员还需要确保他们的测试是有意义的，并且很好地服务于他们的目的。不幸的是，即使最好的测试套件也不能证明你的代码没有缺陷，只能证明它以你正在检查的方式工作。

因此，广泛地测试你的代码是绝对必要的。战略性地结合不同的测试技术，并确保您的测试具有高代码覆盖率，在保护您的代码免受缺陷或退化方面做了大量的工作。

在单元测试、集成测试、安全扫描等等之间，测试可能看起来势不可挡。然而，确保您的代码经过良好的测试使得持续集成和持续交付成为可能，进一步加快了您的组织交付高质量软件的速度。

你知道你有经过良好测试的代码，当它被保护免受回归，当他们犯错误时向开发人员抱怨。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>