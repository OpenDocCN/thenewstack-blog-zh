# 关于微服务要牢记的 8 个架构考虑事项

> 原文：<https://thenewstack.io/8-architectural-considerations-to-keep-in-mind-about-microservices/>

[](https://platform9.com)

 [比赫勒

比赫勒是 Platform9 的联合创始人兼首席架构师。在担任 VMware 首席工程师的 14 年中，Bich 增强了 x86 虚拟化性能，开发了 P2V 迁移、USB 仿真和虚拟化应用管理。最近，他通过一个安全的网络浏览产品涉足网络技术。这些工作的结合导致了 10 多项专利的授予。在加入 VMware 之前，Bich 在 Hewlett Packard 和 HP-Labs 工作了 4 年，在那里他创建了 ARIES，这是一个动态翻译器，使 PA-RISC 应用程序能够在安腾硬件上不加修改地运行。](https://platform9.com) [](https://platform9.com)

在过去的几年中，使用微服务作为驱动敏捷最佳实践和加速软件交付的手段已经变得越来越普遍。为了避免单一应用程序带来的缺陷，微服务旨在将您的架构分解为松散耦合的组件(或服务)，这些组件更容易独立更新、改进、扩展和管理。

我们看到各种规模的组织，包括大型企业，都在寻求利用微服务、容器、[无服务器](https://fission.io/)和其他现代架构——既用于绿地应用，也用于分解他们的整体式遗留应用。

然而，正如您所想象的，这些巨大的架构变化不会在一夜之间发生，并且具有广泛的影响——从您开发、部署、管理和监控应用程序的方式，到您组织的文化、团队结构、技能组合等等。

你如何让微服务成为你的开发和软件交付策略中不可或缺的一部分？在规划微服务时，请记住以下八点。

## 1.通过更高的密度提高灵活性

说到敏捷，微服务可以帮助您实现更大的灵活性并支持更快的发布。对于一个拥有数十个相关应用程序组件的公司来说，升级一个整体系统可能是一项巨大的任务，通常需要以特定的依赖顺序同时升级所有服务，这将导致非常长的发布周期。

但是，借助微服务，您可以更新特定的服务，而不必升级整个体系。结果是更快的发布时间，更频繁的发布，以及对单个服务的增量改进——最终向最终用户交付更好的产品。这与敏捷的一些目标非常接近，因此很容易理解为什么微服务是实现敏捷方法的强大方法。

许多使用微服务的团队的主要目标之一是实现更高的密度。这意味着能够在共享硬件上代表更多客户运行更多应用。当您能够利用更高密度的共享基础架构时，这最终意味着降低成本。

从这个角度来看，容器非常适合微服务。每个微服务通常专注于单个功能，容器通常在单个端口上运行单个进程(=服务)。因为它们已经与服务运行所需的所有环境配置捆绑在一起，并且它们可以快速启动或关闭(因为您实际上只是在开始这个过程，而不必构建映像、安装堆栈等)。)，它们可以精确地扩展和管理，以便为每项服务提供适量的资源，从而实现最佳运行。

微服务使您更加敏捷，加快上市时间，同时提高基础架构利用率并降低成本。这是当今软件驱动的组织的目标。

## **2。记得考虑外形尺寸**

过去，人们普遍认为集装箱是微服务的唯一交付工具。但近年来，随着微服务用例的发展以及“无服务器运动”，这种看法已经发生了变化。今天，有一套新的框架允许你直接使用函数和源代码作为执行单元。虽然在许多情况下，容器仍然是交付微服务的最佳形式，但并没有硬性规定您需要它们来实施微服务。

## 3.不要忘记编排层

虽然如何交付微服务的形式因素非常重要，无论您决定使用容器还是其他交付工具，您也需要有意识地对待您的流程编排层。

在容器世界中，曾经有半打系统可供选择——但是在过去的一年中，许多这样的系统被整合到 Kubernetes 中，成为容器编排的事实上的标准。

然而，在无服务器领域，有更多的选择——以不同技术支持的不同功能即服务(FaaS)解决方案的形式。

事实上，如果您选择使用无服务器功能，那么您可以绕过使用和运行容器的复杂性，以及为生产工作负载运行 Kubernetes 的陡峭学习曲线。对于功能，开发人员只需专注于编写应用程序的代码，而无需担心基础设施“管道”、容量规划和管理。这些功能由事件触发，数据中心或云提供商自动启动并可靠地管理运行这些功能所需的容器资源。基于事件的函数是进一步降低耦合性的好方法，通过使用直接支持函数的 FaaS 或无服务器框架，您还可以极大地简化操作——编排和管理容器。

在某种程度上，您可以将功能视为非常精细的微服务。然后，可以将多个功能组合在一起，并选择与微服务应用程序结合使用，以执行业务功能。

## 4.触发机制

接下来要考虑的是触发机制。通常，微服务会响应事件而执行。例如，您需要考虑服务是否会被激活以响应 REST API 调用、HTTP 请求或消息总线。是否有特定类型的事件需要触发服务，比如将新文件添加到对象存储(如 S3)中？根据用于触发服务的事件类型，您可以确定微服务所需的附加工具和附加服务。

## 5.记录和跟踪

由于触发微服务的事件是短暂的，某个应用程序功能可能由几十个独立的微服务或无服务器功能组成，并且容器基础架构本身是不可变的和短暂的——这些都对您的日志记录有重大影响。您应该问自己这样的问题，“我们的微服务产生的日志将如何收集？”“它们将如何聚合？、“当微服务的行为不符合预期时，运营团队、支持团队和开发人员将如何解决这些问题？”幸运的是，有一个完整的日志记录工具和最佳实践行业，其中一些是专门为微服务设计的。

## 6.跨微服务的监控、指标收集和性能

在过去一年左右的时间里，服务的监控方式以及指标的收集和处理方式发生了很大的变化。例如，Prometheus 工具已经成为聚集所有这些数据，然后获取这些数据并供查询使用的首选方法。当你能够大规模做到这一点时，你就可以了解一个微服务的性能与其他微服务的性能之间的关系，以及它们之间的相互关系。分布式系统是困难的，需要很强的系统理解能力。获得整个开发流程中微服务的整体视图有助于开发人员诊断性能问题，并发现提高效率的机会。

## 7.数据服务

微服务，尤其是无服务器功能往往是无状态的，但大多数业务应用程序需要持久状态。因此，大多数微服务读取和写入存储在单独的数据服务中的数据，例如数据库、消息代理、缓存或键值存储。在选择运行微服务的平台时，考虑平台对运行数据服务的支持很重要。在 Kubernetes 上本地运行的平台是一个很好的选择，因为几乎所有流行的开源数据服务(如 MySQL、Redis、Memcache、Cassandra、Kafka)都已移植到 Kubernetes，而且 Kubernetes 本身提供了丰富的 API 和机制(如 StatefulSets)来满足有状态服务的需求。

## 8.通过无服务器加速价值实现并简化运营

正如我们前面提到的，Kubernetes 仍然是微服务交付的中流砥柱，但还有其他选项需要讨论。在过去的一年里，人们开始意识到迁移到微服务和容器实际上涉及到很多复杂性。有太多的新模式和新工具需要学习，人们开始意识到这种东西并不像预期的那样容易和简单，也不像预期的那样立即有回报。与此同时，由于 AWS Lambda 的推广，无服务器和功能即服务(FaaS)运动在过去一年也得到加强。

随着无服务器和功能的实现，人们认识到他们可以进入类似微服务的模式和设计理念，但没有管理 Kubernetes 的复杂性。这代表着人们如何看待最佳微服务方式这一概念的根本转变，而且不仅仅是 Kubernetes。

总的来说，微服务是一个很棒的策略，可以让整体应用程序更具延展性，更容易适应敏捷开发的生命周期。通过在前进的过程中牢记上述八个概念和技巧，您可以利用微服务来简化您组织的软件发布并提高 IT 利用率。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>