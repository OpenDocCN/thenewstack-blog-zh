# K8s 备份和灾难恢复比以往任何时候都重要

> 原文：<https://thenewstack.io/k8s-backup-and-disaster-recovery-is-more-important-than-ever/>

虽然数据保护一直很重要，但对于在 Kubernetes 环境中构建和部署应用程序的组织来说，它正成为一个关键问题。

在这些分布式、动态的云原生环境中，数据丢失和勒索软件的威胁正在推动组织寻求更全面的战略，不仅要备份 Kubernetes 应用程序，还要跨区域部署灾难恢复(DR)。

毫无疑问:人们很担心。根据 Veeam 的 [2022 年数据保护趋势报告](https://www.veeam.com/wp-data-protection-trends-report.html)，89%的 IT 领导者认为可容忍的数据丢失与如何保护他们的数据之间存在“保护差距”。事实上，所有这些云本地领导者都在使用容器；91%的公司正在生产中使用容器或计划使用容器。

虽然 Kubernetes 的可伸缩性和可移植性使开发和部署更加方便，但它在数据保护方面有所欠缺。问题是，一方面，具有关键业务数据的有状态工作负载已经成为 Kubernetes 生产环境中最受欢迎的工作负载。

另一方面，将虚拟机(VM)或物理服务器视为备份/灾难恢复操作单元的传统备份工具无法在 Kubernetes 环境中工作。在 Kubernetes 的环境中，已经发生了范式转变。我们现在需要保护由微服务组成的应用程序，这些微服务在不同的服务器和区域上不断被重新安排和扩展。

此外，这些云原生应用程序的常见开发模式是在后台使用多种数据服务，包括 SQL 和 NoSQL 数据库，如 PostgreSQL、MongoDB 等。但是，应用程序有不同的[备份](https://thenewstack.io/the-whys-whens-and-wherefores-of-kubernetes-backup/)一致性需求。

一些应用程序可以容忍数据丢失，使用存储层快照的备份方法可能没问题。但是，这种方法不适合某些应用程序(想想您的金融交易)，这些应用程序还需要捕获可能没有刷新到磁盘的数据。因此，除了存储层集成之外，备份和恢复解决方案还需要在逻辑数据库层运行，方法是执行特定于数据库的功能，如`pgdump`。

考虑到技能差距和风险，灾难性的数据丢失给组织带来的风险，实施备份作为您的最后一道防线是不可取的。以下是成功的 [Kubernetes 数据保护策略](https://thenewstack.io/the-data-protection-challenges-of-kubernetes/)的一些考虑因素。

1.  **从整体上关注应用**。Kubernetes 的部署和操作是以应用程序为中心的，因此将应用程序视为原子性单元的 Kubernetes 本机备份至关重要。尝试使用传统的、以基础架构为中心的备份方法会使您在恢复期间面临数据丢失或损坏的风险。遗留解决方案无法将应用程序作为一个整体来捕获，包括应用程序数据和 Kubernetes 资源(配置。秘密等。).此外，请确保您的备份解决方案不会通过将备份仅限于少数数据库或特定于供应商的 Kubernetes 基础架构环境来限制您组织的开发和创新能力。

2.  **自动发现应用并动态扩展**。Kubernetes-native 备份解决方案将自动发现集群上运行的所有应用程序和底层组件。该解决方案还应该在 Kubernetes 上下文中工作，以确保对集群的任何更改(例如，添加新的应用程序)都能被立即识别。从规模和成本的角度来看，您的备份解决方案必须能够融入并行性，并在不使用时自动扩展至零
3.  **保护你的备份。**您必须能够灵活选择一致性要求、备份频率和备份目的地。遵循永恒的 3-2-1 法则:将至少三份数据保存在两个不同的介质上，其中一份应该放在异地。通过将备份存储为不可变对象，确保您的解决方案可以维护备份的完整性。确认您的备份已加密，并且您可以管理加密密钥。

4.  **确保灵活的可恢复性**。您的备份只能与恢复一样好。确保您的备份计划允许 Kubernetes 承诺的可移植性，即恢复到不同的集群、区域或 Kubernetes 发行版。一个好的解决方案将为您提供粒度控制，以恢复全部或部分应用程序，从而在恢复应用程序时实现属性(如存储类)的动态转换。此外，确保解决方案智能地对恢复操作的顺序进行排序，以便遵守任何应用程序依赖性。

5.  **操作简单安全**。即使在跨越来越多的应用程序和部署模式大规模工作时，您也应该能够简单地操作您的数据保护。一个好的备份解决方案将为运营团队提供一个简化的工作流程，以利用 Kubernetes-native CLI (kubectl ),并提供云原生工具集成，以增加您可能缺乏技能的劳动力。开发人员应具备自助服务能力，同时集成 Kubernetes 和云原生身份和访问管理(IAM)以及基于角色的访问控制(RBAC)。

最后，还值得记住的是，底层 Kubernetes 提供的复制功能可以保护您免受一些基础设施故障的影响。但是，复制不能保护您免受由于人为错误或恶意攻击而导致的数据损坏或丢失。面对不断增长的威胁形势，立即部署您的 Kubernetes-native 备份和灾难恢复。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>