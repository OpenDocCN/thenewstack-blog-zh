# 通过这 4 个最佳实践提高您的 CI/CD 可观察性

> 原文：<https://thenewstack.io/improve-your-ci-cd-observability-with-these-4-best-practices/>

伊斯梅尔·埃吉尔梅斯

伊斯梅尔是桑德拉公司的业务发展经理。他热衷于销售、营销和发展战略。

可观察性是一站式解决方案，也是 DevOps 团队的关键组成部分。它衡量您从外部输出中推断系统内部状态的能力。这是一个连续的过程，从 CI/CD 管道开始，贯穿应用程序的整个生命周期。

可观察的 CI/CD 管道使您能够主动监控问题，并跟踪 CI/CD 构建期间发生的错误。完全可观察的 CI/CD 管道最终允许更快的修复并增加代码的可信度。如果不了解管道，追溯问题的根源将变得极其困难，甚至不可能。

在本帖中，我们将讨论四种提高可观察性的技术。

## 1.生产可观察性

有些错误只有在应用程序部署到生产环境后才会发生，这使得它们很难在本地复制。有些只是间歇发生。

当涉及到这些问题时，传统的测试和监控是不够的，因为它们主要是为了检查和监控已知的错误或问题而构建的。但是，如果您为失败做准备，并确保您的生产系统是可观察的，那么您将在问题导致代价高昂的停机之前提前解决问题。

应用程序依赖于许多关键组件，如存储、队列等。生产可观察性允许您确保应用程序以及应用程序所依赖的关键组件的持续正常运行时间。

生产可观察性有两个关键部分——警报和被动监控。

### 发信号

监控系统检测重要的系统事件，并向责任方发送警报。大多数警报系统都是可配置的，允许您在应用程序的行为超出预定义阈值时发送警报。

警报可以通过短信、电子邮件甚至是一条松散的消息发送——这样开发者和利益相关者都知道什么时候需要修复。这种警报系统向开发人员保证，如果应用程序没有按预期运行，他们会收到通知，这样他们就可以专注于其他任务。

### 被动监控

被动监控对于全面了解应用效率和消费者使用习惯至关重要，允许软件团队使用真实数据直接跟踪用户体验的质量。

被动监视器不会为了模仿用户行为而将测试数据注入网络。相反，它从各个网络位置收集实际用户数据。在大多数情况下，代理会监控数据流，并根据使用模式收集统计数据。

## 2.优化日志

如果操作正确，日志记录可以改进应用程序状态监控，并包含软件系统中发生的事件的相关信息。在对软件进行故障排除时，日志提供了对系统首先出现故障的内容、时间和原因的深入了解。

毫无疑问，日志数据为开发运维团队提供了对被监控的应用或系统的更高层次的可见性。这使他们能够确定导致错误报告的更改，以及特定问题在应用程序中出现的频率。

但是，如果不进行优化和集中，日志数据可能会膨胀，直到变得难以处理，尤其是在分布式体系结构中。当您收集无关和非结构化的数据时，与日志分析相关的挑战会增加，与记录超出您需要的数据相关的时间和成本也会增加。

良好的日志记录实践优先考虑只记录对应用程序性能至关重要的指标，并确保日志消息是结构化的、描述性的并包含有用的信息。这些信息应包括:

*   时间戳
*   唯一的用户 id
*   会话 id
*   资源使用信息

日志也应该在一个集中的、可访问的位置进行管理。这样，您可以轻松地关联不同的日志，将它们与特定的会话或用户联系起来，更快地进行故障排除，并了解整个基础架构中发生的情况。

## 3.DevOps 文化

仅仅收集日志或监控生产应用程序是不够的。为了在跨职能团队中实现合理水平的可观察性，您还需要围绕共同的目标调整人员和流程。尽管看似无形，但组织文化至关重要。如果员工不支持这个想法，一个组织可能无法实施一个战略计划。因此，DevOps 文化转变可以成为构建高度可见的应用程序的策略。

创建 DevOps 环境最简单的方法是将运营和开发团队结合起来，这样他们就可以进行更多的交流和协作。要真正实现可观察性驱动的开发运维文化，您需要:

*   营造协作环境
*   强加端到端的责任
*   鼓励持续改进
*   关注客户需求
*   拥抱失败并从中吸取教训
*   几乎一切自动化

从软件开发的开始到结束，软件团队应该编写可调试的代码，并拥有其整个生命周期。这些代码还应该用适当的 KPI、指标和日志来包装。这提高了应用程序的整体可观察性，并为运营团队提供了更多的数据来检测故障并预测未来可能发生的故障。

实现可观察性不仅仅是软件工程师和开发人员的工作。这是跨职能团队的集体责任。构建它的团队应该负责运行它并确保它继续运行。

可观察性驱动的 DevOps 文化改变了组织思考开发过程的方式，并将可操作的心态注入到他们的日常实践中。最终，这将提高云应用程序的性能和可用性，同时提高团队的生产力和满意度，进而简化工作流程和协作。

## 4.生产前可观察性

人们非常关注在生产系统中实现可观察性，但是很少强调从开发阶段就使应用程序可观察。然而，成功的部署包括有组织的生产前环境。

生产前的可观察性在许多日常活动中起着重要作用，包括决定构建什么或如何发布新功能、编写应用程序代码、优化关键代码以及规划应用程序的架构变化。生产前的可观察性允许 DevOps 团队主动修复当他们的代码进入生产时可能出错的应用程序问题。

每个开发人员都希望他们的辛勤工作被部署到产品中，这是一个需要功能代码和少量 bug 才能实现的梦想。观察应用程序的预部署并不会自动使软件变得完美，但它可以最大限度地减少最终出现在产品中的错误数量，并让开发人员相信他们的代码运行良好。

### 远程调试

像桑德拉这样的远程调试工具提供了另一种安全感。这些工具允许开发人员调试在本地环境之外运行的应用程序，而不会干扰应用程序的正常运行，筛选大量日志文件，或在本地复制生产环境。借助远程调试，开发人员可以使用不间断断点在任何环境中轻松调试错误，包括云原生开发和试运行环境、Lambda、Kubernetes、内部部署 monoliths 以及各种部署和技术。

如果做得正确，远程调试可以为开发团队节省大量资金、麻烦和时间，对于依赖云平台、服务和基础设施的组织尤其有用。

## 摘要

虽然这四种最佳实践都是有益的，但是生产前可观察性是提高可观察性的最经济的方法。它允许软件开发人员检测和修复他们代码中的问题，同时补救的成本最小，并且不会影响用户。

生产的可观察性是相关的，但是它是昂贵的并且不总是能拯救你。在生产环境中，任何事情都可能发生，许多不可预测的因素会破坏您的应用程序或使其不可用。应用程序日志记录也很重要，但是日志管理起来很昂贵，而且很难分析——尤其是在高度分布式系统中试图跟踪生产问题的根源时。最后，任何想要实现完全可观察性的企业都应该接受 DevOps 文化，但是这个过程需要时间和整个组织的支持。

有了远程调试工具，软件团队可以节省在本地重现产品问题的时间，从而提高开发速度。

当谈到解决生产系统中的问题时，最好的方法是首先避免问题。提高自己的可观察性，一眼看出错误。从[桑德拉的伙伴](https://sidekick.thundra.io/)开始。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>