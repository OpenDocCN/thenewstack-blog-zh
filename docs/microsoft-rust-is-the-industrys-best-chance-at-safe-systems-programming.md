# 微软:Rust 是业界安全系统编程的“最佳机会”

> 原文：<https://thenewstack.io/microsoft-rust-is-the-industrys-best-chance-at-safe-systems-programming/>

上个月，在 AllThingsOpen 虚拟会议期间，[在一次虚拟谈话中解释了为什么微软逐渐转向 Rust 来构建其基础设施软件，而不是 C/C++,](https://youtu.be/NQBVUjdkLAA)[Ryan Levick](https://github.com/rylev)、[微软](https://www.microsoft.com)云开发者倡导者说，无论软件公司在工具和培训他们的开发人员上投入多少资金，“c++本质上并不是一种安全的语言。它也鼓励其他软件行业巨头考虑同样的做法。

他说:“我们使用的语言非常古老，来自不同的时代，不能让我们保护自己免受这类漏洞的攻击。”C++不是一种内存安全语言，没有人会真的假装它是，”他说。

事实上，微软已经认为 C++不再适合编写关键任务软件。该行业迫切需要为其底层系统工作转向一种高性能、内存安全的语言。莱维克说，如今市场上最好的选择是锈菌。

## C/C++无法修复

今天，C 和 C++是编写核心系统软件的首选语言。它速度很快，代码和机器本身之间只有汇编。

但是这个行业正被这些语言引起的所有与内存相关的错误所削弱——其中许多是安全隐患。莱维克说，现在，来自微软的 70%的 CVE 都是内存安全问题。“没有真正的趋势，只是保持不变，”他说。“尽管我们做出了巨大努力来解决这个问题，但它似乎仍然是一个常见的事情。”

从财务角度来看，这是有意义的，因为修复这种永无止境的记忆相关错误的成本正在飙升。莱维克说，早在 2004 年，每一个与内存相关的错误都会给企业造成大约 25 万美元的损失，而微软的估计可能处于较低水平。

当然，有许多提高 C++安全性的努力，但是尽管每一种都很有效，但没有一种能完全解决问题。

一个长期存在的方法是就如何编写更安全的代码进行更多的程序员培训。但是，“没有证据表明对 C 和 C++开发人员进行整体培训会以任何有效的方式解决这个问题，”Levick 说，并引用了微软自己的大量内部培训。

静态分析被认为是另一种可能的解决方案。但是静态分析带来了太多的开销:它需要连接到构建系统中。“所以有很多动机不使用静态分析，”莱维克说。“如果默认情况下没有打开，那就没用了。”

运行时检查也是如此:“要知道什么时候使用运行时检查契约，什么时候不使用，这是不可能的，或者至少是极其困难的，”他说，并补充说它们还会带来运行开销。

## **业内最好的机会**

为了应对这个与内存相关的错误问题，[微软安全响应中心](https://www.microsoft.com/en-us/msrc)发起了[安全系统编程语言](https://www.youtube.com/watch?v=t3dKNcJXtbg)倡议。在那里，一些工作致力于支撑 C/C++。 [Verona](https://github.com/microsoft/verona) ，一种为安全低级编程而创造的新编程语言，也是在这里诞生的。但是项目策略的第三个方面，也是他们最信任的一个方面，是支持“行业正面解决这个问题的最佳机会。”

“我们认为那是铁锈，”他说。

就性能而言，Rust 与 C/C++不相上下，甚至可能略快。Rust 通过包管理、现代测试框架等带来了开发人员的生产力。而程序员[对它爱锈](https://stackoverflow.blog/2020/01/20/what-is-rust-and-why-is-it-so-popular/)。

但微软如此迷恋 Rust 的主要原因是，它是一种内存安全的语言，具有最少的运行时检查。Rust 擅长创建正确的程序。**正确性**大致意思是，编译器会检查程序的不安全操作，从而减少运行时错误。Unsafe 关键字是一个选项，但不是默认选项。不安全的 Rust 代码几乎总是更大的安全代码体的子集。不安全模式对于像编写设备驱动程序这样的分配内存的任务是必要的。但即使在这里，内存的不安全部分也封装在 API 后面。

莱维克说，这种安全编程的能力不应该被轻视。事实上，它可以提供超过 10 倍的改进，值得投资。这很大程度上是因为几乎所有的 C/C++代码都需要对不安全行为进行安全审计，而用 Rust 编写的需要检查的不安全代码只是大多数代码库中的一小部分。

虽然微软看好 Rust，但莱维克承认，微软核心开发人员不会很快停止使用 C/C++。

“我们在微软有很多 C++代码，这些代码哪儿也去不了，”他说。“其实微软 c++还在继续写，还会继续写一段时间。”

许多工具都是围绕 C/C++构建的。特别是，微软的二进制文件现在几乎完全建立在微软 Visual C++编译器上，后者产生 MSVC 二进制文件，而 Rust 依赖于 LLVM。

然而，也许最大的挑战是文化。“有些人只是想用他们已经知道的语言完成工作，”莱维克承认道。

尽管如此，该行业似乎正在走向生锈。亚马逊网络服务使用它，部分用于部署 [Lambda 无服务器运行时](https://aws.amazon.com/lambda/)，以及 [EC2](https://aws.amazon.com/ec2/) 的某些部分。脸书已经开始使用 Rust，苹果、谷歌、Dropbox 和 Cloudflare 也是如此。

[https://www.youtube.com/embed/NQBVUjdkLAA?feature=oembed](https://www.youtube.com/embed/NQBVUjdkLAA?feature=oembed)

视频

2020 年万物开放的日期已经公布:[10 月 20 日-22 日](https://2020.allthingsopen.org/)。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>