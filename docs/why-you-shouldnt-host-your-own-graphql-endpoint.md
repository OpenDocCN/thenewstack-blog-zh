# 为什么不应该托管自己的 GraphQL 端点

> 原文：<https://thenewstack.io/why-you-shouldnt-host-your-own-graphql-endpoint/>

[](https://www.linkedin.com/in/sridhar-rajagopalan-9887321/)

 [斯里达尔·拉贾戈帕兰

斯里达尔·拉贾戈帕兰是 StepZen 的联合创始人兼首席技术官和工程主管。斯里达尔是谷歌的高级站点可靠性工程师(SRE ),结合软件和系统工程技能来帮助构建和运行大规模、大规模分布式系统。](https://www.linkedin.com/in/sridhar-rajagopalan-9887321/) [](https://www.linkedin.com/in/sridhar-rajagopalan-9887321/)

使用 GraphQL，您可以将所有数据和 API 打包并集成到一个易于理解和使用的模型中。作为 GraphQL 的消费者，您可以做自己想做的事情，避免不想处理的事情。例如，当使用 GraphQL API 时，您可以编写更少的代码来执行前端功能，获取更少的数据(从而降低成本)，体验更快的加载时间，避免版本控制的痛苦，等等。

然而，仍然需要做的一件非常困难的事情是构建和运行一个服务器来托管您的 API。选择拥有和运营 GraphQL 服务并不简单。开发人员如何才能获得 GraphQL API 的所有优点，并留下棘手的问题呢？你怎样才能得到你想要的甜香蕉，而不必收养、照顾和喂养抱着它的大猩猩？

## 会出什么问题呢？

 [阿南特·金格兰

Anant 是 StepZen 的创始人兼首席执行官，step Zen 是一家初创公司，采用新的方法来简化开发人员访问数据的方式，以增强数字体验。Anant 的职业生涯跨越了 IBM Fellow、IBM 信息管理部门的 CTO、Apigee 的 CTO 和 Google Cloud 的产品负责人，他的职业生涯一直处于数据库、机器学习和 API 创新的前沿。在 StepZen，Anant 正在享受创建一家公司，将他对这些技术的热爱结合在一起，以简化、加速和扩展前端开发。](https://www.linkedin.com/in/anantjhingran) 

为什么不构建并运行一个服务器来托管您的 API 呢？嗯，有很多事情是你不想处理的。

*   昨天有效的东西今天就失效了。是因为后端响应变了吗？你的钥匙不再有效了吗？后端停机了吗？某些数据元素是否格式不正确？您的最新版本的 GraphQL 端点中有一些不正确的代码吗？
*   昨天还在上演的事情现在不再是这样了。是否应该添加缓存？但是现在，你什么时候去缓存而不是后端呢？或者有人在您所依赖的后端数据库上删除了索引？
*   您的 GraphQL 端点需要访问控制，因为查询是直接从浏览器发出的。因此，现在您需要将您的 API 键与 GraphQL 执行捆绑在一起，并部署一个服务器来验证 API 请求，限制合法用户的访问，并确保恶意的 GraphQL 调用不会到达您的后端。
*   您必须平衡呼入和呼出之间的速率限制，并且您还必须在 800 毫秒内交付结果。GraphQL 层有。

这些问题没有一个是不能解决的。但是有很多代码要写，有很多代码要维护和改进。对于您添加的每个新后端，您必须添加重试逻辑、错误处理逻辑、缓存逻辑、节流逻辑、API 密钥失效、响应更改验证，以及更多。您的代码从一些干净的 JavaScript 获取开始，很快就变成了一个怪物。更糟糕的是，您必须部署、运行和管理所有代码。

## 解决难题的策略

一个负责构建、管理和运行 GraphQL 的所有困难的服务能做什么？

1.  它将监控常见和不常见的后端，并了解响应变化、API 变化、APIKey 无效、性能下降——这样您就不必这么做了。除了只有您使用的一小部分 API 之外，其他人很可能在您之前遇到过这个问题。
2.  它将大规模应用机器学习来优化和绕过错误，以及自动化结构和协议翻译。
3.  它将利用基于成本的优化(就像谷歌的服务在其排名中利用网站性能)和智能缓存来在性能和准确性之间进行适当的权衡。
4.  它将通过消除 API 关键的共同后端合同，并适当地管理利率限制来减少摩擦。
5.  它将不再需要任何由开发者运行的服务器。让浏览器和 GraphQL 服务器之间没有任何东西——保护密钥、访问控制、混合和匹配。这在帮助实现现代建筑范例(如 Jamstack)的承诺方面特别有吸引力。

## 迈向未来的“即服务”

搜索是过去几十年中出现的早期，也许是最突出的“即服务”模式。数据库仍然可以作为软件使用，但是 Snowflake 和 BigQuery 等服务的流行和成功表明，as-a-service 正在数据库市场获得相当大的吸引力。我们在其他市场也看到了同样的趋势，例如基础架构即服务。那么，为什么这些“即服务”模式会在各种技术中胜出呢？利用机器学习、通用操作手册和经济效率的大规模自动化正在整个堆栈中产生巨大的差异。在 GraphQL 的世界中，同样的一套原则导致了执行优化、自动映射、缓存和对成千上万个通用 API 的监控——所有这些都有助于更高效的开发人员体验。

运行和管理自己的 GraphQL 服务器的开发人员错过了许多技术进步，这些进步可以使他们的应用程序开发更快、更高效。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>