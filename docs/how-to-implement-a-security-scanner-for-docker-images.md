# 如何实现 Docker 图像的安全扫描器

> 原文：<https://thenewstack.io/how-to-implement-a-security-scanner-for-docker-images/>

你正在使用 Docker 来部署你的应用程序吗？如果是这样，你并不孤单。近年来，Docker 的使用越来越流行。虽然它提供了许多好处，但也带来了需要解决的新的安全风险。

从失去客户信任到在[事件响应管理工具](https://www.squadcast.com/)和流程上花费巨资，安全事件的后果可能非常严重。这就是为什么首先采取措施防止它们发生是至关重要的。

输入 Docker 图像安全扫描仪。这些工具可以帮助您识别和修复 Docker 映像中的漏洞，以免被恶意行为者利用。但是从哪里以及如何开始呢？

在本文中，我们将提供实现 Docker 图像安全扫描器的技巧，并讨论其他组织用来减少安全事故的实践。目标是防止安全漏洞破坏您产品的成功。

## **重访 Docker 和 Docker 图像**

如果你是 Docker 的新手，这里有一个简单的概述:

### **码头工人**

Docker 是一个在容器中部署应用程序的平台。

### **图片**

Docker 镜像是一个轻量级的、独立的、可执行的包，它包含了运行一个软件所需的一切，包括代码、运行时、库、环境变量和配置文件。

### **容器**

Docker 映像是 Docker 容器的基础，用于构建、运输和运行容器。

简而言之，Docker 帮助您在容器中部署应用程序，Docker 映像是组成这些容器的包。

## **安全扫描仪简介**

让我们深入 Docker 图像扫描仪的世界，用一个类比来帮助说明它们的目的和功能。

想象你正在建造一座房子。你仔细选择材料，雇用可靠的承包商，并遵循所有必要的建筑法规和条例。然而，即使采取了所有这些预防措施，您的房子也不是完全安全的，除非您进行彻底的检查，以确定任何潜在的弱点或漏洞。

这就是安全扫描仪的用武之地。就像家庭检查员检查结构问题和潜在危险一样，安全扫描器扫描您的系统、网络和应用程序，寻找漏洞和安全弱点。在 Docker 的上下文中，安全扫描器可用于扫描 Docker 图像中的漏洞和其他安全问题。

把 Docker 图像的每一层想象成墙上的一块砖。即使你用的是优质的砖，按照正确的规格砌墙，恶意的演员还是有可能想办法突破的。这就是安全扫描仪的用武之地。他们扫描墙(图像)的每一块砖(层)，以识别任何可能被利用的漏洞。

通过实施 Docker 映像安全扫描程序，您可以确保 Docker 部署的安全性，并降低安全事故的风险。就像家庭检查员让您放心，您的房子是安全的，Docker 图像安全扫描仪让您相信您的 Docker 部署是安全的。

## **检查漏洞**

根据 Docker 图像扫描器生成的报告采取行动是维护 Docker 部署安全性的一个重要部分。当报告发现漏洞或其他安全问题时，尽快采取措施解决这些问题非常重要。

一旦决定对报告采取行动，请考虑以下几点。

## **修复漏洞**

你还记得我们之前讨论的建筑类比吗？让我们重温一下。

想象一下，一份建筑检查报告指出了结构问题或安全隐患。正如您将优先考虑并修复这些问题以确保建筑物的安全性和稳定性一样，您也应该优先考虑并修复 Docker 图像扫描仪报告中确定的漏洞和其他安全问题。

### **优先排序**

最严重的问题应该首先解决，因为它们对您的组织构成了最大的风险。您可能还希望根据问题被利用的可能性以及被利用后可能对您的组织造成的影响来确定问题的优先级。

### **应用补丁**

一旦你确定了问题的优先顺序，你就可以开始着手解决它们。这可能需要将 Docker 映像更新到解决漏洞的版本，或者实施变通方法或缓解措施来降低被利用的风险。

### **测试修复**

就像您将测试对建筑物的修复以确保它们是有效的一样，彻底测试任何修复以确保它们是有效的并且不引入新的漏洞或问题是很重要的。

### **定期检查**

除了解决报告中确定的问题之外，建立一个定期检查建筑(或在这种情况下，扫描 Docker 图像)并解决任何确定的新问题的流程也很重要。

这有助于确保您的 Docker 部署长期保持安全，就像定期检查建筑物有助于确保其安全性和稳定性一样。

总的来说，修复 Docker 图像扫描仪报告产生的危险信号的最佳方法是及时有效地确定问题的优先级并解决问题，并建立定期扫描和解决新问题的流程。

## **最佳实践**

对于依赖容器化应用程序的组织来说，提高 Docker 映像的安全性是一项至关重要的任务。以下是实现这一目标的一些最佳实践:

### **使用官方图片**

始终使用可信来源的官方图片，如 Docker Hub 或您组织的内部注册表。这些图像经过了彻底的安全检查，不太可能有漏洞。

### **使用最小基础图像**

使用具有运行应用程序所需的最少库和依赖项集的基本映像。这减少了攻击表面区域，并且使得维护和更新图像更容易。

### **保持图像最新**

定期更新基础映像以及映像中的所有库和依赖项。这可以确保您使用的是这些组件的最安全版本。

### **扫描图片寻找漏洞**

使用 Anchore、Snyk 和 Twistlock 等工具扫描图像，寻找已知的漏洞。这些工具使用国家漏洞数据库(NVD)等数据库来识别漏洞并提供修复建议。

### **使用多阶段构建**

使用多阶段构建来分离映像中的构建和运行时环境。这有助于保持运行时映像最小，并降低在构建过程中引入漏洞的风险。

### **使用机密管理工具**

使用 HashiCorp Vault 或 AWS Secrets Manager 等机密管理工具来存储密码和密钥等敏感信息。这确保了此类信息不会存储在图像中，因为攻击者可能会访问这些信息。

遵循这些实践以确保您的 docker 映像是安全的，这一点很重要。否则，可能会在映像中引入漏洞，导致安全漏洞和数据丢失。因此，必须优先考虑映像安全性，并遵循最佳实践来确保容器化应用程序的完整性。

## **各种 Docker 安全扫描工具概述**

市场上有几种 Docker 图像安全扫描仪工具。以下是一些流行的方法的简要概述:

### **主播**

这种开源工具分析 Docker 图像，并识别漏洞、违反政策和其他安全风险。它提供详细的报告和补救建议。

### **Snyk**

该工具扫描图像中的漏洞，并提供补救建议。它还提供依赖性分析和补救指导等功能。

### **水上安全**

该工具扫描图像以查找漏洞、恶意软件和合规违规。它还为容器和 Kubernetes 环境提供运行时保护。

这些只是市场上众多 docker 图像安全扫描仪工具的几个例子。选择满足您组织特定安全需求的工具非常重要。

## **实施和配置 Anchore**

实施和配置 Anchore 时涉及以下步骤:

### 安装锚具

*   要安装 Anchore，您需要在系统上安装 Docker 和 Git。
*   使用以下命令安装 anchore:

```
docker run  -d  --name anchore-engine  -p  8228:8228  -v  /var/lib/anchore-engine:/config anchore/engine:v0.7.2

```

### **配置锚点**

*   安装完成后，您需要配置 Anchore 来扫描图像。您可以通过在`/var/lib/anchore-engine/config/config.yaml`创建一个配置文件来做到这一点。
*   您可以指定配置选项，如 Docker 注册表 URL、凭据和用于扫描的策略名称。

### **扫描图像**

*   要扫描图像，您可以使用 Anchore CLI 工具。首先，您需要使用以下命令将映像添加到 Anchore 引擎:

```
anchore-cli image add  <image-name>

```

*   接下来，您可以使用下面的命令来扫描图像。这将扫描图像，并提供一份报告，详细说明发现的任何漏洞或违反策略的情况。

```
anchore-cli image evaluate  <image-name>

```

### **修复漏洞**

*   如果扫描发现任何漏洞，您可以使用 Anchore 提供的建议来修复它们。您还可以创建自定义策略来指定映像的安全要求。
*   使用 Anchore 定期扫描图像以确保它们是安全的并且没有漏洞是很重要的。通过遵循这些步骤，您可以有效地实现和配置 Anchore 来保护您的 Docker 映像。

## **结论**

通过确保在您的环境中只部署安全可信的映像，实施 Docker 映像安全扫描器可以大大减少安全事故。通过自动化这一过程，您可以节省时间和资源，同时提高系统的整体安全性。

定期扫描和更新您的映像以获得最新的安全补丁和漏洞非常重要。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>