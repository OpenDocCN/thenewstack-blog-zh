<html>
<head>
<title>Serverless Testing in Production</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生产中的无服务器测试</h1>
<blockquote>原文：<a href="https://thenewstack.io/serverless-testing-in-production/#0001-01-01">https://thenewstack.io/serverless-testing-in-production/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="p1 translated">无服务器生态系统仍处于成熟阶段，这意味着在这种基础架构风格中，没有一系列工具可用于应用程序部署的特定方面。此外，无服务器作为一种事件驱动的架构的性质(云提供商或其他人负责自动扩展和管理计算所需的资源)意味着，在许多情况下，很难有效地测试生产环境中会发生什么。</p>
<p class="p1 translated">与平台无关的DevOps监控工具<a href="https://honeycomb.io" class="ext-link" rel="external "> Honeycomb.io </a>的联合创始人兼首席执行官Charity Majors 表示，这种无法在开发中进行测试的情况并不是无服务器独有的。考虑到大规模构建和部署分布式应用程序的本质，不可能对每一种可能性都进行测试。虽然她同意“我不测试，但当我测试时，我在生产中测试”可能值得一看，但她确实相信“在生产中测试”的概念。</p>
<p class="p1 translated">“当我说‘生产中的测试’时，我并不是说不先做最佳实践，”Majors解释道。“我的意思是，有一些未知的未知，应该通过构建具有弹性的系统来进行测试。某些种类的错误只有在大规模应用时才能被注意到。也许我们需要更少的暂存环境和更多的防护栏。这不是一个‘如果’我们推出bug的问题，而是何时、能够检查它们，以及建造机器人来检查它们需要成为稳定系统的一部分。”</p>
<p class="p1 translated">虽然这适用于所有大规模的应用程序，但无服务器也带来了其特定的环境。无服务器是建立在不可变的基础设施上的，该基础设施在一个事件期间旋转，因此通常甚至不可能两次创建相同的工作流，使得在生产之前的试运行和测试变得不可能。</p>
<p class="p1 translated">梅杰斯指出了五种新兴技术，可以用来管理生产中的无服务器测试。</p>
<p class="p1 translated"><b>功能标志:</b>“功能标志可以让你确定发布日期，这样你就可以把你的代码发布到产品中去，”梅杰斯说。这个想法是，对于新功能或升级，通过使用功能标志，开发人员可以规定谁应该使用新功能，而它对其余大部分客户群是不可见的。梅杰斯说:“功能标志上写着‘在我同意之前，不要派任何人去读这段代码’。这允许开发人员在更广泛的推广之前，先在自己身上测试一切。像<a href="https://launchdarkly.com/" class="ext-link" rel="external ">launch darky</a>这样的新创公司现在出现了，它们将功能标志作为一项服务提供。“我们在蜂巢使用它们，它们很棒，”梅杰斯说。关于Launch Darkly的真正酷的事情是它的界面非常有用，并且易于使用，你可以让非技术人员如营销人员使用它。"</p>
<p class="p1 translated">这使得企业中的任何人都有可能测试他们自己的更改:例如，更新企业网站的CEO或向开发人员门户添加API产品登录页面的营销团队成员可以使用功能标志和类似LaunchDarkly这样的工具来测试他们所做的更改，然后将它们应用于大多数客户群。</p>
<p class="p1 translated">梅杰斯说，通常情况下，功能标志是一个内部团队在进行中可能会破解的东西，但这限制了它们在内部的可用性，因为它通常是在没有用户界面的情况下构建的，使得它可以在构建它们的工程团队之外访问。</p>
<p class="p1 translated">金丝雀:金丝雀经常和特色旗一起使用。当Majors在脸书时，工程团队通常首先在巴西部署新功能和更新，然后手动检查控制基地和巴西部署组之间的错误率。“这些都是分阶段推出的，”梅杰斯说。金丝雀允许在大范围推广之前测试生产中是否有任何问题。梅杰斯希望会有一家像LaunchDarkly这样的初创公司，决定专注于管理金丝雀阶段的推出。梅杰斯说:“有些公司正在把它作为他们服务网络的一部分，像bubbly和Turbine，甚至Nginx，都在做一些这样的事情。”“这是关于强化您的部署，毕竟，您不知道它最终会如何运行。”</p>
<p class="p1 translated"><b>分阶段推出，自动推广到更大的群体:</b>这是一种带有分阶段组件的鸭式布局，而不是部署到特定的地理区域。“你把金丝雀的产量定在总产量的10%。然后你进行自动化，这样你的系统就可以将这10%与系统的其他部分进行比较。当没有错误或问题时，它会将部署提升到25%。如果在任何一点上出现问题，该系统将要么恢复到部署前状态，要么像分阶段部署一样，进行滚动恢复，”梅杰斯说。Majors表示，这对于大规模应用程序尤其有用，因为通常会出现一些问题，而这些问题在生产中的较低部署级别可能并不存在。“可能只有在达到80%时才会出现问题，例如，因为这需要打开更多的连接，或者使用更多的RAM。梅杰斯说:“总的来说，这是一个让服务器崩溃的转折点。</p>
<p class="p1 translated">丰富的仪器:“我强烈希望我们将今天视为我们发布代码的糟糕的旧日时光，如果我们没有收到分页，那么一切都很好，”梅杰斯警告说。在Honeycomb，她致力于构建丰富的工具，以便开发人员可以询问发布的代码是否如预期的那样运行。“我们应该捕捉足够的细节，这样我们就能看到。作为一个行业，我们仍在提出仪器仪表的通用原则。这是一门艺术，也是一门科学。”由于全球应用程序的性质、无服务器的规模及其通常庞大的多功能工作流，整个体系结构系统不再适合一个监督系统的架构师，需要一套更丰富的工具来帮助管理生产。</p>
<p class="p1 translated"><b>可观察性优先开发:</b>所有这些都形成了一个新的范例，专业人士希望将应用程序开发行业带离当前的测试驱动开发原则。有了丰富的仪器，就有可能实时监控系统并了解它们在执行什么操作。在可观察性优先的开发范例中，工程团队可能会从工作流、应用程序或功能展示中映射出期望的结果。但是，在为该特性或工作流编码之前，团队将创建他们的工具套件，首先，可能会询问解决方案是否值得构建，然后将能够监控开发和部署，以确保与初始目标保持一致。“这就像戴了一个头灯。与构建一个特性并监控它(这是一种非常盲目的方法)不同，在可观察性优先的开发中，您首先构建工具。这让开发者更有信心，”梅杰斯说。</p>
<p class="attribution translated">人物形象:<a href="https://imgflip.com/memegenerator/One-Does-Not-Simply" class="ext-link" rel="external ">一个不简单的模因生成器</a>。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>