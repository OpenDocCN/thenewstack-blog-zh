# 企业网络监控需求可能会阻碍 TLS 1.3 的采用

> 原文：<https://thenewstack.io/enterprise-network-monitoring-needs-hamper-tls-1-3-adoption/>

即将发布的[传输层安全(TLS)协议](https://tools.ietf.org/html/draft-ietf-tls-tls13-11)有望成为网络加密的游戏规则改变者。它将提供更高的性能、更好的安全性和更低的复杂性。然而，许多网站运营商可能会在未来几年避开它。

TLS 版本 1.3 正处于开发的最后阶段，有望很快成为标准。包括谷歌 Chrome 和 Mozilla Firefox 在内的一些浏览器已经在选择加入的基础上支持这一新版本的协议，Cloudflare 在默认情况下为所有使用其内容交付网络的网站提供支持。

[TLS 1.3](https://tools.ietf.org/html/draft-ietf-tls-tls13-21) 是对支撑网络和电子邮件加密技术的重大革新。新版本中最大的改进之一是简化了客户端和服务器之间的握手。协商会话密钥过去需要两次消息往返，但现在只需要一次，从而大大提高了 TLS 1.3 连接的性能。

另一个重要变化是取消了许多已知不安全的加密算法，包括 RC4 流密码、CBC 模式密码和 SHA-1 散列函数。TLS 1.3 只允许使用五种“密码套件”，即加密和哈希算法的组合，所有这些都提供了强大的安全性，因此不可能出错。相比之下，TLS 1.2 有 20 多种可能的组合，导致许多部署容易受到各种已知攻击。

但是 TLS 1.3 中有一个特别的变化在最近几个月引起了一些争议，那就是移除了 RSA 和其他依赖静态密钥的密钥协商协议。

使用 RSA，客户端生成将用于建立会话密钥的主密钥，并在使用从服务器的数字证书中提取的公钥对其进行加密后，在连接握手期间将其发送到服务器。然后，服务器使用其相应的私钥来解密客户端消息并提取秘密。

近年来，这种依赖单个私钥来保护所有握手的做法已被视为一种安全弱点，尤其是在国家参与大规模互联网监控的事件曝光之后。有了这种设置，如果攻击者获得了服务器的私钥，他们不仅可以解密用户和服务器之间的未来消息，还可以解密过去的消息，前提是这些加密的交换先前已被记录并存储在某个地方。

> 虽然前向保密对安全性很重要，但它与许多公司已有的网络监控系统不兼容，因为它使得 TLS 流量的被动解密和检查非常困难。

为了减少这种风险，TLS 1.3 只支持像[椭圆曲线 Diffie-Hellman](https://www.youtube.com/watch?v=F3zzNa42-tQ) (ECDHE)这样的密钥交换协议，这些协议使用临时密钥而不是静态密钥。这些协议有一种称为“前向保密”的加密特性，即使服务器的私钥被盗，它也能防止对过去的消息进行解密。事实上，服务器的数字证书仅用于验证服务器的身份，对保护握手及其秘密不起任何作用。

事实证明，虽然前向保密对安全性很重要，但它与许多公司已有的网络监控系统不兼容，因为它使 TLS 流量的被动解密和检查非常困难。许多公司，尤其是那些处理敏感数据的公司，可能会受到法规要求，要对其 web 应用程序的流量进行加密，并同时监控该流量的安全威胁。

有了 TLS 1.2，组织可以在防火墙和其他监控工具上安装 TLS 服务器的私钥，这样就可以解密和检查流量。但是在 TLS 1.3 中要做到这一点，需要即时导出所有临时密钥，因为它们是在 web 服务器上为每个连接生成的。

这不能很好地扩展，并且可能成为大型网络的巨大管理负担。

伊利诺伊大学芝加哥分校计算机科学系助理教授 Stephen Checkoway 说，网络运营商现在希望对 TLS 1.3 规范进行修改，尽管已经到了设计过程的后期。最近几个月，他们接触了互联网标准开发机构[互联网工程任务组](https://www.ietf.org/) (IETF)的 TLS 工作组，要求在新协议中加入一种机制，允许他们执行所需的被动流量检查。

这样做可能意味着牺牲 TLS 1.3 的强制性前向保密属性，在一些人看来，这会削弱该标准，并使窃听成为可能，[这是 IETF 希望在总体上避免的事情](https://tools.ietf.org/html/rfc2804)。

其他人持更务实的观点，认为如果遭到拒绝，网络运营商最终将设计自己的流量检查方法，这可能涉及对 TLS 1.3 实现进行非标准修改。因此，他们认为在 IETF 的监督下公开设计这样的机制会更好，而不是以不同的专有解决方案结束，这会对 TLS 造成更大的伤害。

一个允许椭圆曲线 Diffie-Hellman 使用静态密钥的机制提案已经被提交作为标准考虑。它的实现需要对 TLS 服务器和网络监控工具进行一些配置更改，但与 TLS 1.3 客户端(如浏览器)兼容。

“这种对企业网络的监控在一些行业中无处不在，不可或缺，”该机制的作者在提案中写道。“企业网络的有效和安全运行需要这种监控。失去此功能可能会减缓 TLS 1.3 的采用速度。”

事实上，反对在 TLS 1.3 中满足网络运营商流量监控需求的一个理由是，他们可以继续在其服务器和网络上使用 TLS 1.2。毕竟，服务器通常同时支持多个版本的 TLS，以兼容旧的客户端。类似地，客户机支持多个 TLS 版本以兼容旧服务器，因此 TLS 1.2 不会很快消失。

根据来自 [SSL Pulse](https://www.ssllabs.com/ssl-pulse/) 项目的数据，在世界上最受欢迎的 140，000 个支持 HTTPS 的网站中，93%仍然支持创建于 1999 年的 TLS 1.0。大约 84%的用户支持 2006 年发布的 TLS 1.1，87%的用户支持 TLS 1.2。

“我认为，运营商和实用主义者的紧迫感是没有根据的，”Checkoway 在一篇关于当前辩论的博客帖子中说。“是的，切换到 TLS 1.3 将阻止运营商做他们现在正在做的事情；但是，目前不需要切换。TLS 1.2 支持他们的使用情形，而且据我们所知，正确使用 TLS 1.2 是安全的。”

当然，这也意味着许多组织可能会决定在未来几年内不在他们的 web 服务器上启用 TLS 1.3。

特征图片由 [Graham Holtshausen](https://unsplash.com/@freedomstudios) 通过 Unsplash 提供。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>