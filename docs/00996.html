<html>
<head>
<title>Off-The-Shelf Hacker: Showing Temperatures on an 'Analog' Gauge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现成的黑客:在“模拟”表上显示温度</h1>
<blockquote>原文：<a href="https://thenewstack.io/off-shelf-hacker-showing-temperatures-analog-gauge/#0001-01-01">https://thenewstack.io/off-shelf-hacker-showing-temperatures-analog-gauge/#0001-01-01</a></blockquote><div><div id="tns-post-body-content">


<p class="translated">物理计算的一大好处是，一旦你掌握了一些基础知识，你将开始看到如何将“模块”组合在一起，并提出新的项目。凑成几个“模块”，你就有了自己的小<a href="/tag/off-the-shelf-hacker/" target="_blank">现成的</a>有用的小工具，用于各种工作。开始把模块想成软件、固件、硬件、网络、机制、美学等等。或者上述的任何/全部。</p>
<p class="translated">在上周用<a href="https://thenewstack.io/off-shelf-hacker-use-processing-build-screen-gauge/" class="local-link">超声波测距计</a>获得不错的运气后，我认为尝试显示一些其他值会很有用。本周，我将旧的热电偶模块连接到Linux笔记本上，看看一个基于语言的<a href="https://processing.org/" class="ext-link" rel="external ">处理程序</a>如何处理温度。</p>
<p class="translated">我使用的热电偶(和放大器)通过SPI总线连接到Arduino Duemilanove。Arduino然后通过标准USB电缆连接到Linux笔记本电脑。使用USB使得“模块”可以在笔记本电脑、树莓派和芯片电脑之间移植。测距仪连接到Arduino Pro Mini，然后连接到会议徽章上的Raspberry Pi。Linux正在吞噬世界！</p>
<p class="translated">在任何机器上使用USB端口都有点棘手，所以让我们从这个话题开始讨论。</p>
<h2 class="translated">理顺串行端口</h2>
<p class="translated">安装新版Linux时，普通用户通常无法直接读写USB端口。您可以使用<strong> chmod </strong>命令更改权限，尽管这有点麻烦，并且会随着您插入和拔出端口而改变。</p>
<p class="translated">获得访问权最简单的方法是将用户(在我的例子中是rob)添加到“拨出”组。你需要使用sudo，它才能工作。<br/></p>
<div id="crayon-642311c1722f0030498432" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-i">rob</span>%<span class="crayon-h">  </span><span class="crayon-e">sudo </span><span class="crayon-i">usermod</span><span class="crayon-h"> </span>-<span class="crayon-st">a</span><span class="crayon-h"> </span>-<span class="crayon-i">G</span><span class="crayon-h"> </span><span class="crayon-e">dialout </span><span class="crayon-v">rob</span>
</pre>
</div>
</div>

<p class="translated">一旦完成，重新启动机器，清除任何旧的、疯狂的权限并重新登录。<br/></p>
<div id="crayon-642311c1722f5786004356" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-i">rob</span>%<span class="crayon-h">  </span><span class="crayon-e">sudo </span><span class="crayon-i">shutdown</span><span class="crayon-h"> </span>-<span class="crayon-r">r</span><span class="crayon-h"> </span><span class="crayon-v">now</span>
</pre>
</div>
</div>

<p class="translated"><br/>回到桌面后，打开终端并执行stty命令。这将设置端口速度。如果端口速度与来自Arduino的数据速率不匹配，您将看不到使用“cat”命令输入的数据。此外，仪表上的指示线也不会显示:<br/></p>
<div id="crayon-642311c1722f6293188690" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-i">rob</span>%<span class="crayon-h">  </span><span class="crayon-i">stty</span><span class="crayon-h"> </span>-<span class="crayon-i">icrnl</span><span class="crayon-h"> </span>-<span class="crayon-m">F</span><span class="crayon-h"> </span>/<span class="crayon-i">dev</span>/<span class="crayon-i">ttyUSB0</span><span class="crayon-h"> </span><span class="crayon-cn">11520</span>
</pre>
</div>
</div>

<p class="translated"><br/>当您测试从USB端口输入的数据时，使用以下快速检查:<br/></p>


<p class="translated"><br/>准备好USB端口后，是时候让Arduino上的固件工作了。</p>
<h2 class="translated">读取最大热电偶</h2>
<p class="translated">在去年的<a href="https://thenewstack.io/avoid-burning-christmas-turkey-thermocouples/" class="local-link">年底，我谈到了在我的厨房烤箱中使用</a><a href="https://www.adafruit.com/product/270" class="ext-link" rel="external ">标准K型热电偶</a>和<a href="https://www.adafruit.com/product/3263" class="ext-link" rel="external ">放大器</a>来测量温度值。</p>
<p class="translated">Arduino的代码来自MAX3156示例。我做了一点修改，去掉了一些不需要的“println”语句，并添加了一个摄氏到华氏的转换。我喜欢看我的华氏温度。还要注意，我在转换中添加了一个“int”类型赋值。我们并不真的需要模拟仪表的小数，所以整数温度值是好的，使输出更容易阅读。</p>
<p class="translated">如果您使用的是Duemilanove Arduino，继续编译，然后将固件上传到主板。如果您正在使用其他Arduino，如Pro Mini或Uno，请确保在“工具”和“主板”下拉菜单中指定正确的主板。<br/></p>
<div id="crayon-642311c1722f9101693386" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-p">#include &amp;lt;SPI.h&amp;gt;</span>
<span class="crayon-p">#include &amp;lt;Adafruit_MAX31856.h&amp;gt;</span>
 
<span class="crayon-c">// use hardware SPI, pass in the CS pin</span>
<span class="crayon-e">Adafruit_MAX31856 </span><span class="crayon-i">max</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">Adafruit_MAX31856</span>(<span class="crayon-cn">10</span>);
 
<span class="crayon-e">void </span><span class="crayon-e">setup</span>()<span class="crayon-h"> </span>{
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">begin</span>(<span class="crayon-cn">115200</span>);
<span class="crayon-h"> </span>
<span class="crayon-h">  </span><span class="crayon-i">max</span><span class="crayon-st">.</span><span class="crayon-e">begin</span>();
 
<span class="crayon-h">  </span><span class="crayon-i">max</span><span class="crayon-st">.</span><span class="crayon-e">setThermocoupleType</span>(<span class="crayon-i">MAX31856_TCTYPE_K</span>);
 
<span class="crayon-h">  </span><span class="crayon-e">switch</span><span class="crayon-h"> </span>(<span class="crayon-h"> </span><span class="crayon-i">max</span><span class="crayon-st">.</span><span class="crayon-e">getThermocoupleType</span>()<span class="crayon-h"> </span>)<span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_B</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_E</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_J</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_K</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_N</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_R</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_S</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_TCTYPE_T</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_VMODE_G8</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-e">case </span><span class="crayon-i">MAX31856_VMODE_G32</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">    </span><span class="crayon-i">default</span>:<span class="crayon-h"> </span><span class="crayon-i">break</span>;
<span class="crayon-h">  </span>}
 
<span class="crayon-h">  </span><span class="crayon-c">// mlx.begin(); </span>
 
}
 
<span class="crayon-e">void </span><span class="crayon-e">loop</span>()<span class="crayon-h"> </span>{
 
<span class="crayon-h">  </span><span class="crayon-c">// thermocouple temp measured by MAX amp board</span>
<span class="crayon-h">   </span>
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">print</span>(<span class="crayon-e">int</span>(<span class="crayon-e">Celcius2Fahrenheit</span>(<span class="crayon-i">max</span><span class="crayon-st">.</span><span class="crayon-e">readThermocoupleTemperature</span>())));<span class="crayon-h"> </span>
<span class="crayon-h"> </span>
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-e">uint8_t </span><span class="crayon-i">fault</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">max</span><span class="crayon-st">.</span><span class="crayon-e">readFault</span>();
<span class="crayon-h">  </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span>)<span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_CJRANGE</span>)<span class="crayon-h"> </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Cold Junction Range Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_TCRANGE</span>)<span class="crayon-h"> </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Thermocouple Range Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_CJHIGH</span>)<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Cold Junction High Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_CJLOW</span>)<span class="crayon-h">   </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Cold Junction Low Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_TCHIGH</span>)<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Thermocouple High Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_TCLOW</span>)<span class="crayon-h">   </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Thermocouple Low Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_OVUV</span>)<span class="crayon-h">    </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Over/Under Voltage Fault"</span>);
<span class="crayon-h">    </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">fault</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;amp;</span><span class="crayon-h"> </span><span class="crayon-i">MAX31856_FAULT_OPEN</span>)<span class="crayon-h">    </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>(<span class="crayon-s">"Thermocouple Open Fault"</span>);
<span class="crayon-h">  </span>}
 
<span class="crayon-h">  </span><span class="crayon-i">Serial</span><span class="crayon-st">.</span><span class="crayon-e">println</span>();
<span class="crayon-h">  </span><span class="crayon-e">delay</span>(<span class="crayon-cn">100</span>);<span class="crayon-h">  </span><span class="crayon-c">//sample duration - adjusted - gives 1 second per sample with this code</span>
}
 
<span class="crayon-e">double </span><span class="crayon-e">Celcius2Fahrenheit</span>(<span class="crayon-e">double </span><span class="crayon-i">celsius</span>)
{
<span class="crayon-h">  </span><span class="crayon-i">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.8</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-i">celsius</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">32</span>;
}
</pre>
</div>
</div>

<p class="translated"><br/>测试代码是否能与Arduino IDE内置的串行监视器一起工作。或者，关闭Arduino IDE并使用<strong> cat </strong>命令。<br/></p>


<p class="translated"><br/>有时，我的Arduino IDE设置无法正确释放USB端口。我还没有完全解决这个问题，所以如果你在读取USB端口时仍然有问题，注销并重启机器。只是提醒一下。</p>
<h2 class="translated">在仪表上显示温度</h2>
<p class="translated">在<a href="https://thenewstack.io/off-shelf-hacker-use-processing-build-screen-gauge/" class="local-link">超声波测距仪计量项目</a>中，Arduino Pro Mini将距离值发送至加工计量代码，记录范围为0至100英寸。你可以让你的Arduino输出任何你喜欢的范围。只是数据而已。</p>
<p class="translated">我使用的特殊热电偶可以感应大约-340到+900华氏度的温度。这意味着连接到热电偶的Arduino可以通过USB端口发送该范围内的值。</p>
<p class="translated">现在，超声波测距仪处理量规程序只会将指针从0摆动到100。事实上，这足以证明热电偶可以显示仪表上的值，对于这个项目，我甚至没有费心修改范围。我想展示如何通过最小的改变来混合搭配“模块”,并且仍然能得到一些有用的东西。</p>
<p class="translated">我只是把“距离”变量换成了“温度”在仪表的表面，我还把“距离(英寸)”改成了“温度(华氏度)”其他一切都很正常。</p>
<p class="translated">这里的教训是让一个新项目的1.0版本(即使是把模块插在一起)正常工作。然后，您可以随时返回并更改代码以获得更多的功能和能力。不要试图一次改变太多事情。将文件保存在版本控制程序中，或者只是增加名称，这样，如果偏离了轨道，您可以随时返回到工作代码。</p>
<p class="translated">下面是被黑的处理代码。<br/></p>
<div id="crayon-642311c1722fb035083482" class="crayon-syntax crayon-theme-github-gist crayon-font-liberation-mono crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always">
<p class="crayon-plain-wrap"/>
<div class="crayon-main">
<pre><span class="crayon-c">/**</span>
<span class="crayon-c"> * Gauge </span>
<span class="crayon-c"> * </span>
<span class="crayon-c"> * The angle of each segment (in radians) is controlled by input from the </span>
<span class="crayon-c"> * serial port (/dev/ttyUSB0, /dev/ttyS0, etc.).</span>
<span class="crayon-c">**/</span>
 
<span class="crayon-e">import </span><span class="crayon-i">processing</span><span class="crayon-st">.</span><span class="crayon-i">net</span>.*;
 
<span class="crayon-e">PFont </span><span class="crayon-i">font</span>;
<span class="crayon-i">float</span><span class="crayon-h"> </span><span class="crayon-st">x</span>,<span class="crayon-h"> </span><span class="crayon-t">y</span>;
<span class="crayon-e">String </span><span class="crayon-i">angle</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"10"</span>;<span class="crayon-h"> </span><span class="crayon-c">// angle in degrees</span>
<span class="crayon-e">String </span><span class="crayon-i">temperature</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">"50"</span>;<span class="crayon-h">  </span><span class="crayon-c">// temperature degrees F</span>
<span class="crayon-e">float </span><span class="crayon-i">anglef</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0.0</span>;
<span class="crayon-e">float </span><span class="crayon-i">angle1</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0.0</span>;
<span class="crayon-e">float </span><span class="crayon-i">segLength</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">110</span>;
<span class="crayon-e">BufferedReader </span><span class="crayon-i">reader</span>;
<span class="crayon-e">String </span><span class="crayon-i">line</span>;
 
<span class="crayon-e">void </span><span class="crayon-e">setup</span>()<span class="crayon-h"> </span>{
<span class="crayon-h">   </span>
<span class="crayon-h">  </span><span class="crayon-e">size</span>(<span class="crayon-cn">350</span>,<span class="crayon-h"> </span><span class="crayon-cn">300</span>);
<span class="crayon-h">  </span><span class="crayon-e">strokeWeight</span>(<span class="crayon-cn">2</span>);
<span class="crayon-h">  </span><span class="crayon-e">stroke</span>(<span class="crayon-cn">255</span>,<span class="crayon-h"> </span><span class="crayon-cn">160</span>);
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-st">x</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e ">width *</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span>;
<span class="crayon-h">  </span><span class="crayon-t">y</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e ">height *</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span>;
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-i">font</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">loadFont</span>(<span class="crayon-s">"LiberationSans-20.vlw"</span>);
<span class="crayon-h">  </span><span class="crayon-e">textFont</span>(<span class="crayon-i">font</span>);
<span class="crayon-h">  </span><span class="crayon-e">textAlign</span>(<span class="crayon-i">CENTER</span>);
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-i">reader</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">createReader</span>(<span class="crayon-s">"/dev/ttyUSB0"</span>);
<span class="crayon-h">  </span>
}
 
<span class="crayon-e">void </span><span class="crayon-e">draw</span>()<span class="crayon-h"> </span>{
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-e">background</span>(<span class="crayon-cn">0</span>);
<span class="crayon-h">  </span><span class="crayon-e">try</span><span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-i">line</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">reader</span><span class="crayon-st">.</span><span class="crayon-e">readLine</span>();
<span class="crayon-h">  </span>}<span class="crayon-h"> </span><span class="crayon-e">catch</span><span class="crayon-h"> </span>(<span class="crayon-i">IOException</span><span class="crayon-h"> </span><span class="crayon-st">e</span>)<span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-st">e</span><span class="crayon-st">.</span><span class="crayon-e">printStackTrace</span>();
<span class="crayon-h">    </span><span class="crayon-i">line</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">null</span>;
<span class="crayon-h">  </span>}
<span class="crayon-h">  </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">line</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-i">null</span>)<span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-c">// Stop reading because of an error or file is empty</span>
<span class="crayon-h">    </span><span class="crayon-e">noLoop</span>();<span class="crayon-h">  </span>
<span class="crayon-h">  </span>}<span class="crayon-h"> </span><span class="crayon-e">else</span><span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-e">println</span>(<span class="crayon-s">"temperature = "</span>,<span class="crayon-h"> </span><span class="crayon-i">line</span>);
<span class="crayon-h">  </span>}
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-i">temperature</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">line</span>;
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-e">if</span><span class="crayon-h"> </span>(<span class="crayon-i">angle</span><span class="crayon-h"> </span>!=<span class="crayon-h"> </span><span class="crayon-i">null</span>)<span class="crayon-h"> </span>{
<span class="crayon-h">    </span><span class="crayon-i">anglef</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span>(<span class="crayon-cn">180</span>-(<span class="crayon-e">float</span>(<span class="crayon-i">temperature</span>))*<span class="crayon-cn">1.8</span>)*<span class="crayon-cn">3.1416</span>/<span class="crayon-cn">180</span>*-<span class="crayon-cn">1</span>;
<span class="crayon-h">    </span><span class="crayon-c">// scale the distance to an angle for the gauge</span>
<span class="crayon-h">        </span>
<span class="crayon-h">    </span><span class="crayon-e">println</span>(<span class="crayon-i">temperature</span>,<span class="crayon-h"> </span><span class="crayon-s">" "</span>,<span class="crayon-h">  </span><span class="crayon-i">anglef</span>);<span class="crayon-h">  </span><span class="crayon-c">//in radians</span>
<span class="crayon-h">  </span>}
<span class="crayon-h">  </span><span class="crayon-e">pushMatrix</span>();
<span class="crayon-h">  </span><span class="crayon-e">segment</span>(<span class="crayon-st">x</span>,<span class="crayon-h"> </span><span class="crayon-t">y</span>,<span class="crayon-h"> </span><span class="crayon-i">anglef</span>);<span class="crayon-h"> </span>
<span class="crayon-h">  </span><span class="crayon-e">popMatrix</span>();
<span class="crayon-h">   </span>
<span class="crayon-h">  </span><span class="crayon-e">text</span>(<span class="crayon-s">"Temperature (deg F)"</span>,<span class="crayon-h"> </span><span class="crayon-cn">175</span>,<span class="crayon-h"> </span><span class="crayon-cn">50</span>);
<span class="crayon-h">  </span><span class="crayon-e">text</span>(<span class="crayon-s">"0"</span>,<span class="crayon-h"> </span><span class="crayon-cn">35</span>,<span class="crayon-h"> </span><span class="crayon-cn">250</span>);
<span class="crayon-h">  </span><span class="crayon-e">text</span>(<span class="crayon-s">"25"</span>,<span class="crayon-h"> </span><span class="crayon-cn">65</span>,<span class="crayon-h"> </span><span class="crayon-cn">150</span>);
<span class="crayon-h">  </span><span class="crayon-e">text</span>(<span class="crayon-s">"50"</span>,<span class="crayon-h"> </span><span class="crayon-cn">175</span>,<span class="crayon-h"> </span><span class="crayon-cn">100</span>);
<span class="crayon-h">  </span><span class="crayon-e">text</span>(<span class="crayon-s">"75"</span>,<span class="crayon-h"> </span><span class="crayon-cn">285</span>,<span class="crayon-h"> </span><span class="crayon-cn">150</span>);
<span class="crayon-h">  </span><span class="crayon-e">text</span>(<span class="crayon-s">"100"</span>,<span class="crayon-h"> </span><span class="crayon-cn">320</span>,<span class="crayon-h"> </span><span class="crayon-cn">250</span>);
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-e">noFill</span>();
<span class="crayon-h">  </span><span class="crayon-e">arc</span>(<span class="crayon-cn">175</span>,<span class="crayon-h"> </span><span class="crayon-cn">245</span>,<span class="crayon-h"> </span><span class="crayon-cn">240</span>,<span class="crayon-h"> </span><span class="crayon-cn">245</span>,<span class="crayon-h"> </span><span class="crayon-i">PI</span>,<span class="crayon-h"> </span><span class="crayon-i">TWO_PI</span>);
<span class="crayon-h">  </span>
<span class="crayon-h">  </span><span class="crayon-e">delay</span><span class="crayon-h"> </span>(<span class="crayon-cn">100</span>);
}
 
<span class="crayon-e">void </span><span class="crayon-e">segment</span>(<span class="crayon-i">float</span><span class="crayon-h"> </span><span class="crayon-st">x</span>,<span class="crayon-h"> </span><span class="crayon-i">float</span><span class="crayon-h"> </span><span class="crayon-t">y</span>,<span class="crayon-h"> </span><span class="crayon-i">float</span><span class="crayon-h"> </span><span class="crayon-st">a</span>)<span class="crayon-h"> </span>{
<span class="crayon-h">  </span><span class="crayon-e">translate</span>(<span class="crayon-st">x</span>,<span class="crayon-h"> </span><span class="crayon-t">y</span>);
<span class="crayon-h">  </span><span class="crayon-e">rotate</span>(<span class="crayon-st">a</span>);
<span class="crayon-h">  </span><span class="crayon-e">line</span>(<span class="crayon-cn">0</span>,<span class="crayon-h"> </span><span class="crayon-cn">0</span>,<span class="crayon-h"> </span><span class="crayon-i">segLength</span>,<span class="crayon-h"> </span><span class="crayon-cn">0</span>);
<span class="crayon-h">   </span>
}
</pre>
</div>
</div>

<p class="translated"><br/>在处理IDE中加载代码，点击“运行”按钮，在屏幕上显示仪表。</p>
<p class="translated">如前所述，不要忘记让USB端口处于正确的状态，否则，您将看不到仪表上的指针。</p>
<p class="translated">这是我冰箱里热电偶/温度计读数的截图。华氏四度！也许我应该把它调高一点，这样可以省电。嗯，冰淇淋永远不会变得粘稠。</p>
<div id="attachment_3005939" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-3005939" decoding="async" loading="lazy" class="size-large wp-image-3005939" src="../Images/f9a692bc039ed370aa4778cb507e9b8f.png" alt="" data-original-src="https://storage.googleapis.com/cdn.thenewstack.io/media/2017/09/513780a1-temp-freezer-1024x640.png"/><p id="caption-attachment-3005939" class="wp-caption-text translated">我冰箱的温度读数。</p></div>
<h2 class="translated">更进一步</h2>
<p class="translated">这个项目有大量的升级机会。</p>
<p class="translated">显然，扩大测量范围是一个良好的开端。当烤箱升温时，看着指针从室温摆动到华氏350度，不是很有趣吗？</p>
<p class="translated">另一个想法可能是修改处理代码，使仪表充满整个笔记本屏幕。我可以在我们的一次“用新的堆栈来拥有一个短堆栈”早餐小组讨论中，使用这种功能在笔记本电脑或辅助投影仪屏幕上显示煎饼机器人煎锅的温度。</p>
<p class="translated">将处理量规程序转换成Python可能也是有意义的。Python可以在大多数Linux机器上运行，包括Raspberry Pi和CHIP computer。程序从命令行运行，不需要IDE环境，像处理。当然，您目前可以创建一个在处理之外运行的“应用程序”。在英特尔Linux笔记本电脑或Raspberry Pi上运行相同的代码，我得到了不同的结果。我认为Python更具有跨平台能力。</p>


<div class="tns-logo-slug">
<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 68 31" version="1.1">
<title>Group</title>
<desc>Created with Sketch.</desc>
<g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
<g id="Group">
<path d="M24.002,29.619 L29.77,29.619 L29.77,15.808 C29.77,15.038 29.622,11.265 29.59,10.414 L29.77,10.414 C31.424,14.019 31.473,14.147 32.168,15.322 L39.65,29.618 L44.845,29.618 L44.845,0 L39.075,0 L39.075,11.064 C39.075,12.197 39.075,12.44 39.182,14.472 L39.325,17.468 L39.151,17.468 C39.034,17.267 38.596,16.173 38.467,15.929 C38.164,15.323 37.725,14.512 37.373,13.905 L30.031,0 L24,0 L24,29.619 L24.002,29.619 Z" id="Path-Copy" fill="#FF3287"/>
<path d="M56.948,0 C50.745,0 47.606,3.43 47.606,8.296 C47.606,14.114 51.036,15.404 55.518,17.132 C60.438,18.853 61.782,19.332 61.782,21.539 C61.782,24.225 58.969,24.867 57.401,24.867 C54.579,24.867 52.493,23.342 51.536,20.858 L47,24.185 C49.43,28.937 52.145,30.185 57.713,30.185 C59.364,30.185 62.059,29.74 63.727,28.694 C67.779,26.156 67.779,22.22 67.779,20.898 C67.779,18.129 66.531,16.207 66.178,15.726 C65.049,14.121 63.032,12.918 61.25,12.278 L57.084,10.914 C55.073,10.267 52.928,10.105 52.928,8.019 C52.928,7.707 53.008,5.528 56.288,5.319 L61.465,5.319 L61.465,0 C61.465,0 57.342,0 56.948,0 Z" id="Path-Copy-2" fill="#00AFF4"/>
<polygon id="Path" fill="#00AFF4" points="5.32907052e-15 1.77635684e-15 5.32907052e-15 5.319 7.572 5.319 7.572 29.564 14.132 29.564 14.132 5.319 21.544 5.319 21.544 1.77635684e-15"/>
</g>
</g>
</svg> </div>

</div>
</div>    
</body>
</html>