# 在新的堆栈世界中，服务器代理带来的问题

> 原文：<https://thenewstack.io/malitia-of-server-agents/>

我说的不是那些穿西装的酷特工，我们都希望自己是他们。这篇文章是关于软件类代理的。执行各种任务的服务器代理。在现代的开发车间里，有了现代的基础设施，有了现代的编排工具，代理比比皆是，可能很快就会成为一个问题。

毕竟，它们无处不在——一个目标服务器可能有三个、四个甚至更多的代理在后台执行各种功能，如服务器策略管理、发布管理和日志分析。它们用于提供关键功能，并且是控制服务器的重要工具。但这可能太方便了。

首先，每个代理消耗本地资源。在后台运行的单个代理可能看起来不是什么大问题。但是运行的代理越多，消耗的资源就越多，资源需求冲突的可能性就越大。这可能会降低代理本身执行其功能的能力，在更糟糕的情况下(关键资源和依赖项陷入冲突需求的僵局)，它可能会严重降低系统速度。

对资源的冲突需求并不是唯一的问题。由于代理的性质和位置，它们很容易成为恶意攻击的目标。它们位于服务器上，可以访问系统功能。单个代理可能被广泛使用——它们是高度可配置的，并且大量使用脚本，代理使用得越广泛，就越容易找到关于其配置和漏洞的信息。给定服务器上的代理的安全性高度依赖于该单个服务器的安全性，而同时，单个受损的代理可能提供进入整个网络的入口。

在网络方面，代理往往很健谈，这会占用数据中心的带宽，并可能降低应用程序响应请求的速度。

最后，代理通常由第三方供应商创建和更新，这意味着您必须密切关注新版本、错误修复等。您需要知道哪些服务器正在运行，以及您的编排脚本计划在未来部署什么。工作量很大。

尽管增加了风险、性能下降和管理工作量，服务器代理确实令人印象深刻。与许多现代工具一起工作，他们能够做的事情没有代理人是不可能的……现在还不行。如果您计划在您的基础设施中利用云解决方案的力量，那么供应商应用程序和您的服务器之间需要有一次握手。

所以代理人问题的解决是一个意识问题。随着您推进现代开发实践和更好、更灵活的基础设施，团队应该对解决方案的运行方式及其功能感兴趣。

理想情况下，IT 运营部门将尽最大努力限制代理数量，并对他们决定使用的代理进行适当的监督和配置设置。这也将影响与其他工具重叠的一些工具的决策；例如，一个策略管理解决方案的功能可以在日志分析或警报系统中重新创建:这可能是一个代理停机。如今正在使用无代理技术，但它通常并不理想。

例如，无代理系统可以使用 IP 扫描来检测网络上配置不正确或无响应的系统。在无代理系统中，安全人员可以更多地关注传统的网络安全问题，而不必担心被入侵的代理发起的操作。

但是，基于代理的部署的倡导者很快指出，无代理系统也有其潜在的缺点。它们很健谈，依赖于网络连接本身来工作，并且在通过防火墙与目标服务器通信时可能会遇到问题。由于有关目标系统状态的所有数据都通过网络传输(而不是由代理在本地处理)，因此无代理部署系统有其自身的潜在安全问题

真正的挑战可能是开发一种部署系统，保留基于代理和无代理部署的优点，同时最大限度地减少这两种方法的潜在缺点。这样的系统可能结合了低带宽和目标系统信息的有限交换，具有最少的代理，这些代理具有有限的功能，对系统的要求很少，并且专用于一组狭窄集中的任务。这种类型的最小代理甚至可能不可脚本化。例如，它们可以由部署系统自动生成和定制，并在需要新的代理功能时部署到目标服务器。

在最小代理部署系统中，部署服务器可能会向最小代理发送一个简单的唤醒命令，然后收到非常有限且非常集中的目标服务器信息。然后，部署服务器将使用这些信息来预配置部署包，然后将部署包推送到目标系统，在目标系统中，其他最少的代理将完成部署。

也有其他的可能性。例如，一个无代理的系统可能在目标系统上有休眠代理。这些代理通常不会运行，但会在系统资源不足或网络连接受限时唤醒并执行信息收集和系统配置功能。在高资源需求和完全连接期间，主服务器将以完全无代理模式运行。

但是不管 DevOps 的未来会怎样，它很可能会证明当前的代理部署系统不是在硅片上凿出来的，并且不会在这里停留。

通过 Flickr 知识共享的特色图片[。](https://www.flickr.com/photos/diemer/2618663998/in/photolist-4Zpkzh-nztFja-54maHs-nhaTLa-nTAZXN-5sHWNx-mnAMbw-n8Nbx5-dQawtg-nyq5rj-c6Arf7-54maxJ-nyFqT3-dKk5pT-22wXWM-hbimDB-cAjYxG-FkQV2-nbhh7P-dT2TRe-7eKBkv-f1DFmJ-qyAc7w-6iqwSj-5Sz16D-7TsbzD-nE4bVk-63J6F9-rxUGK-f74yJx-chb2VA-cY6hiA-ciBG3Y-nztMsw-6gpmW-p9XRUX-54mbyq-9F5J5Q-7ePtjs-5Adev8-8DNuxu-ct6e4o-5vL2j6-bc2kev-CzVLe-7dqYM3-6LF4ZR-nhaTTz-bssbRG-8ZZhGp)

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>