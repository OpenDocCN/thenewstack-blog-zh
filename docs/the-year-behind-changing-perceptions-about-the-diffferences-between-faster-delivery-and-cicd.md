# 下一年:改变对更快交付和 CI/CD 之间差异的看法

> 原文：<https://thenewstack.io/the-year-behind-changing-perceptions-about-the-diffferences-between-faster-delivery-and-cicd/>

寻求通过容器化平台(如 Docker)实现更快的软件交付到生产的组织的选择数量在 2015 年大幅增长，这一点毋庸置疑。但是任何使用 Jenkins 构建管道的人都会告诉你，更快的交付并不等同于持续集成和/或持续部署。

几乎每一个计算的核心概念，如果其意义被争论了一年以上，很快就会被提升为一个原则或一组原则，然后被资本化(更不用说被资本化)。也许你已经注意到，当组织未能提高他们的软件生产率水平时，甚至在将他们的开发部门分解成更小的团队之后，人们会说他们可能更敏捷，但是没有“做敏捷”(大写的“A”)。编程语言包含对象的概念已经有几十年了，但是老手们只承认一些属于大写的“OOP”的行列，而对其余的则争论不休。DevOps 拥有两个永久大写字母的特权。

## 适当资本化

CI/CD 正在资本化。仅仅六年前，当 Chef 副总裁 Jez Humble 和顾问 Dave Farley 编写了关于“持续交付”的定义工作[时，他们实际上是通过重新引入 Martin Fowler 的持续集成的理想开始的(小写，至少在当时)。他们认为，加速软件的目标只能通过将交付过程理解为一种模式来实现，也许最好的模式是管道链。](https://books.google.com/books?id=6ADDuzere-YC&dq=jez+humble+continuous+delivery&source=gbs_navlinks_s)

本来 CI/CD 不是软件架构，而是实现速度的手段。作为一个目标，而不是一项技能，实现它的责任被委托给了首席信息官。由于 CIO 被认为一次只能遵循一个议程，开发人员建议他们将 CI/CD 视为敏捷的继承者。

但是第一批实现 CI/CD 作为每个人共同工作方式的机构，是那些可以大规模应用它的机构，而不是小规模的，实验性的。 [Apcera](http://apcera.com) 首席执行官德里克·科利森告诉新堆栈，“我第一次看到它是在谷歌。”

“CI/CD 和让开发人员共同拥有生产部署是一件相当新的事情，”科利森说。

> “大多数企业都有根深蒂固的文化偏见，认为开发/测试和生产这两件事应该始终通过人员、流程等分开。”

对于定期的新堆栈读者来说， [Apcera 生产了一个软件部署平台](https://www.apcera.com/blog/continuous-integration-and-deployment-apcera-platform),旨在与 Docker、Git 和 CloudBees 的 Jenkins CI/CD 流水线系统集成，这应该不足为奇。“可信平台可以帮助推进这一事业，”科利森评论道，“在这种情况下，平台成为融合代表两个阵营的政策和规则的执行的真理之源。”

Apcera 是越来越多的供应商之一，他们认为平台是必要的，以使软件架构和工程政策结合起来，实现真正的 CI/CD 及其所有真正的大写字母。2015 年，这种情况变得如此强烈，以至于 Chef——也许是它最受信任的配置管理自动化系统——开始了向[的巨大转变，不仅拥抱容器，还拥抱 Kubernetes 编排](https://thenewstack.io/in-container-world-chef-faces-shifting-landscape-for-configuration-management/)。

这导致了一种观点(尚未证实),即真正的 CI/CD 不仅需要配置管理自动化，不仅需要交付自动化，不仅需要容器化，还需要微服务。或者无耻地从弗兰克·辛纳特拉那里偷东西，两者缺一不可。

“微服务并不新鲜，它本质上是 SOA 3.0，”Apcera 的科利森说。“新的是实现这一点的平台和技术浪潮，这些技术承担了部署、监控和管理多项内容而不是一项内容的无差别重任。

“话虽如此，”他继续说道，“面对升级和部署，围绕系统接口和 API 的卫生一直是一个挑战。微服务在更短的时间内暴露了这种卫生状况中的问题和不足，但这些问题和不足一直存在。关于如何更改和升级 API，有一些基本的约定规则，这些规则与数据库表和消息传递系统的规则非常相似。这些规则早在“微服务”这个术语出现之前就存在了自动化测试环境，以及这些基本规则，对于整个系统的健康是至关重要的。"

## 体力劳动

Farley 和 Humble 在“连续交付”中最初的论点的核心是:

> 由于手动流程往往不一致，因此它们失败的可能性会增加。

消除不一致会产生一个完全规则的过程，最适合自动化。“如果构建、部署、测试和发布过程不是自动化的，那么它是不可重复的，”他们写道。由于这些步骤是手动的，因此很容易出错，并且无法准确查看完成了什么

虽然作者的最终目标是持续交付，但达到这一目标的手段是持续集成，Humble 和 Farley 将其定义为“在每次签入时构建和测试应用程序的实践”这意味着在流水线的每一个环节，应用程序都要通过自动化进行全面测试。

“对于全自动流程，”他们的介绍继续说道，“您唯一的限制是您能够解决问题的硬件数量。”

> “如果您使用手动流程，您需要依靠人来完成工作。人们花费更长的时间，他们引入错误，并且他们是不可审计的。此外，执行手动构建、测试和部署流程既枯燥又重复，远非最佳用人之道。”

Farley 和 Humble 认为一个古老的观念是可笑的，即一个过程要想真正可审计(如果允许的话，你会感觉到那里有一个大写的“A”)，它必须被分解成人工检查点。早在 1980 年，就有警告说[自动化的手工会计过程使它们脱离了人的控制](http://deepblue.lib.umich.edu/bitstream/handle/2027.42/35481/b137607x.0001.001.pdf) [PDF]，因此引入了以前不存在错误的可能性。如果这听起来像是旧世界的思维，请意识到直到今天，BMC Software——一个[积极推动企业](http://www.bmc.com/blogs/3-steps-to-introduce-docker-containers-in-enterprise/)采用 Docker 的组织——继续[将可审计的过程](https://docs.bmc.com/docs/display/public/ars81/Elements+of+auditable+processes)定义为需要签名绑定的移交。

计算机领域的一个想法到处都有了生命的第一个真实迹象是有人宣布它已经死亡。幸运的是，对于持续集成来说，这发生在 2014 年。在那个时候，反对 CI 的论点是，它迫使所有的利益相关者在每一个崩溃的构建崩溃的时候都集中精力去修复它(这个论点的前提现在很容易被 Jenkins 在工作中的简单演示所否定)。

我们在新的堆栈中发表了对 CI 被极大夸大的死亡的反驳:将 CI 与敏捷捆绑在一起，并重申 CI 是一个人与人之间的沟通过程，而不是自动化原则。

2006 年，Martin Fowler 在用大写字母介绍 CI 时写道:“整合主要是关于沟通”。“集成允许开发人员告诉其他开发人员他们所做的更改。频繁的交流可以让人们迅速了解变化的发展。”

那到底是哪个？CI 是将每个人都排除在流程之外，还是将每个人都投入到流程中？你会认为不可能两者兼得。

这是理想的反对者在 2015 年设法在某种程度上利用的分裂，无论是大写还是小写。它始于对失败的恐惧。

“如果我们坚持尽早发现错误的目标，”Farley 和 Humble 在 2010 年写道，“我们需要专注于快速失败，因此我们需要提交阶段来捕捉开发人员可能引入应用程序的大多数错误。”

## 快速故障

“你听到周围的每个人都在说，‘快失败吧。’惠普企业战略营销副总裁保罗·米勒(Paul Miller)在 12 月举行的 2015 年 HPE 探索伦敦会议上向行业影响者做简报时说:“你知道，那些说‘失败得快’的人通常是那些不必应对这些失败后果的人。”。

米勒讲述了一个故事，他说 HPE 从客户那里得到了反馈，他说，一些客户将“数字颠覆”描述为一些在纸上看起来不错，但实际上很难实现的事情。

“所有目光明亮的人都跑来跑去，说‘是的，我们应该破坏东西。’是的，但是如果你扰乱国民医疗服务体系，人们开始死亡。你需要聪明地对待你的创新。许多考虑中断的组织并没有受到严格的监管，或者没有处理许多成熟组织已经必须处理的监管负担。"

那么，是什么阻碍了拥抱失败的观念呢？这是新堆栈的亚历克斯·威廉姆斯直接向米勒提出的问题。

作为回应，米勒讲述了一个故事，他问了一屋子大约 75 名 IT 高管，“创意经济”(HPE 对全球知识资产商品化的术语)如何影响他们。他从这些 IT 高管那里得到的答案是，这给他们带来了加快创新的压力。他说，新的竞争对手不知从哪里冒出来，企业正被他们能够维持的服务水平所定义。这种维护随着越来越多的政府规定而发生。

“如果你在公共领域失败，导致一个人丧生，一架飞机降落在错误的地方或根本没有降落，[或]个人身份信息的泄露，后果既合法又危及生命。这种快速移动和打破事物的概念在一定程度上起作用，这取决于用例或技术的应用。”

在威廉姆斯的进一步追问下，米勒承认有可行的方法可以安全地自动化测试想法。他指出了虚拟化在这方面的作用，因为它有效地提供了一个沙箱，可以在其中模拟或仿真生产环境。但他警告称，在这种环境下投资的企业可能不会获得明显、直接的客户利益。

Miller 说，真正的挑战发生在当 IT 部门使业务部门相信它需要在任何这样的环境中投入真正的资金时，例如，对一个应用程序的四个不同版本的 A/B 测试将产生三次失败的保证。从风险管理的角度来看，这保证了 75%的负面结果。

“想象一下，你去对一个商业人士说，‘我要把 75%的失败，甚至 50%的失败，放进发现[开发]过程中。’很多传统的高管会看着你说，‘你疯了吗？我们没有预算来做这些实验！“我希望你每一次都准确无误，”HPE 的米勒告诉我们的亚历克斯·威廉姆斯。“因此，业务和 IT 之间存在另一个紧张点:业务需要创新。有人对我说，“每个人都希望改变，直到改变发生在自己身上。”"

## 包含

对于与 Paul Miller 交谈过的 IT 经理来说，CI/CD 是一种耻辱，当你在上面贴上一个数字，比如“负 75%”，风险经理会很容易地拒绝。

一些阅读本出版物的开发人员可能已经知道，带有可爱的 butler 徽标和安全可靠的管道隐喻的 Jenkins 可能已经在 IT 经理尚未看到这样一个风险数字的企业中实施，更不用说拒绝它了。但真正的危险可能是，一旦管理者弄清楚发生了什么，他们可能会立即停止 CI/CD 创新。

这种危险可能已经被那些对建立 CI/CD 作为平台和原则感兴趣的顾问们解决了——为他们的客户提供政策和文件。

在去年 11 月巴塞罗那的最后一次 DockerCon Europe 上，企业咨询公司 Accenture Technology 的 DevOps 董事总经理 Martin Croker[让一屋子的开发人员一睹使用 Jenkins 和 Croker 及其 Accenture 团队构建的部署平台的 CI/CD](https://www.youtube.com/watch?v=rRWxe2710Ac)。克罗克认为 CI/CD 和 DevOps(两者都是原生大写字母)本质上是同一个理想。在讲述他如何向客户推销理想的故事时——福勒、亨布尔和法利阐述了同样的理想——他称之为“DevOps”他明确表示 DevOps 的核心组件是 Docker。

克罗克的客户可能是 HPE 的一些客户:将关键任务要素视为生死攸关的服务的企业。然而克罗克提倡一个非常严格的自动化系统，使用米勒说他的客户觉得“疯狂”的相同的 A/B 测试制度。在这种制度下，从用户那里收到的负面反馈会自动在部署了新版本的少数服务器上触发回滚过程。只有在通过了某些“质量关”后，才能进一步部署，这些关由 Jenkins 中的管道段表示。

跨越这些质量关口需要新的构建通过涉及遗留软件的自动化测试——这是企业中风险的最大原因。克罗克的 CI/CD 概念与传统的理念有所不同:他说，埃森哲平台依赖于分层开发架构，在这种架构中，项目团队不是聚集在一起，而是分开。

“我们有一个分层的应用程序架构有几个原因，”克罗克告诉与会者，“主要是因为它让我能够将开发扩展到不仅仅是我自己和我的团队。我希望 Java 组拥有 Java 开发的蓝图；我希望 Siebel 集团拥有 Siebel 的蓝图。这是将正确的所有权交给正确的团队，并开始扩展到比我的团队更广泛的交付团队。”

在这个系统中，失败是被接受和包容的，资产的所有权不是像 Apcera 的德里克·科利森所说的那样是集体的，而是分散的。正是这种遏制的概念可能一直缺乏，不仅是从保罗·米勒对 CI/CD 理想的看法，而且从 2010 年对理想的最初介绍中——可能是因为它尚未在企业领导人既厌恶风险又对变化敏感的组织中进行大规模测试。

然而，它有可能通过科利森认为诞生于他在谷歌工作期间的同一种平台传播。

“我认为这是一个可信平台的一部分，允许两个阵营实现他们的目标，”科利森告诉新堆栈。“这就是谷歌发生的事情。我觉得可以随意部署和更新。平台系统 Borg 赋予我这样做的权力，但也是谷歌用来确保搜索和广告受到保护、资源得到有效利用和管理的同一平台。一个服务于两个阵营的平台，是我们弥合文化鸿沟所需要的。”

Apcera、Docker 和 HPE 是新堆栈的赞助商。

“[布特码头”的封面照片，带有来自英国](https://www.flickr.com/photos/nationalmediamuseum/8553526733)[国家媒体博物馆](http://www.nationalmediamuseum.org.uk/Collection/Photography)的(大约 1880 年)，在知识共享下获得许可。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>