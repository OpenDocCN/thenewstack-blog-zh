# 应用程序现代化:迁移到 Kubernetes 的 5 个技巧

> 原文：<https://thenewstack.io/app-modernization-5-tips-when-migrating-to-kubernetes/>

容器化可能是更加自动化的基础设施的关键，但是将你的应用程序迁移到 Kubernetes 可能是重要的一步。

 [尼古拉斯·维尔曼德

Nicolas 是 Ondat 的主要开发商代言人。他是一名经验丰富的实践技术专家、传道者和产品负责人，在过去的 17 年里，他一直在云原生技术、开源软件、虚拟化和数据中心网络等领域工作。他热衷于为用户提供支持，开发解决现实生活问题的酷技术，你会经常看到他在全球科技会议和在线活动上发表演讲。](https://uk.linkedin.com/in/vnicolas) 

事实上，根据 Ubuntu 的开发者 Canonical 的说法，只有大约 [15%](https://juju.is/cloud-native-kubernetes-usage-report-2021#applications-platforms) 的企业完全使用 Kubernetes 来运行他们的应用程序。大约相同比例的用户仍在使用纯粹以虚拟机为中心的基础架构，而其余用户要么计划迁移到 Kubernetes，要么混合使用 Kubernetes、虚拟机和裸机。

那么，是什么阻碍了企业实现应用程序现代化呢？企业一贯支持他们对 DevOps 原则的奉献，但许多人仍然发现很难放弃他们的单片应用程序架构。

我们明白——做出像采用微服务、容器和云这样的重大改变是很困难的。

幸运的是，我们为对应用程序现代化感兴趣的企业提供了五个关键提示，让这种改变变得更加容易。

## 1.像对待宠物一样对待你的传统应用，而不是牛

早在 21 世纪初，微软工程师 Bill Baker 试图鼓励他的数据库管理员(DBA)观众重新思考他们对待服务器的方式，鼓励他们把服务器当成牛，而不是宠物。

这意味着不要给服务器起特殊的名字，不要在出问题时给它们特殊的照顾，不要像对待宠物一样在它们身上投入太多的时间和精力。

相反，Baker 建议，当他们的一台服务器出现问题时，DBA 应该把它取出来，用一台几乎相同的服务器替换它。

这个类比在基础设施领域已经变得非常流行，今天它已经被应用到许多不同的场景中。在云迁移的背景下，基础设施经理需要反过来应用这句格言:你的应用和虚拟机确实应该像宠物一样对待，而不是像牛一样。每个虚拟机都需要有一个唯一的身份，并且需要小心谨慎地迁移到基于 Kubernetes 和云的基础设施上。

对于被要求快速将其应用迁移到云以减少资本支出的基础设施管理者来说，这似乎是个坏消息。意味着他们不能依赖批量迁移服务，比如谷歌的 Anthos migrate 这些系统没有为单个虚拟机考虑太多。

因为这些迁移服务采用了一种类似牛的方法，所以它们经常会产生各种各样的问题，这些问题最终会困扰基础设施管理者。

## 2.不要只是搬来搬去——改进你的方法，打造更好的应用

在许多方面，这遵循了将您的遗留应用程序视为宠物而非牲畜的一般方法。您*可以*简单地将您的传统应用程序转换到基于云的环境中。但是在本地有效的不一定在云中也有效。通过进行必要的调整，使您的应用程序为云做好准备，您最终将为更简化的用户体验进行重构。

例如，应用程序现代化工作应该包括将一个整体分解为微服务，以获得更大的可伸缩性、可用性和灵活性。应该这样做，以便尽可能多地自动化基础设施工作，实现快速发布和持续改进。它应该利用容器而不是虚拟机，确保您的应用程序敏捷且高度可用。

## 3.但是，如果您不准备放弃虚拟机，还有其他选择

最终，从长远来看，在您的应用程序现代化工作中采用云原生实践会更有效。然而，并不是每个组织都能够做出这样的承诺。如果你愿意，你可以[将你的虚拟机带到云端](https://www.ondat.io/blog/storageos-vision-cloud-native-storage-todays-modern)，但是首先进行严格的成本效益分析是很重要的。

如果您的组织中有大量与其使用相关的机构知识，并且您不想放弃这些知识去学习一个新系统，那么在云中以其原始的本地格式托管您的虚拟机并由相同的虚拟机管理程序进行管理是非常有益的。您将保留云迁移的一些好处，例如更高的可用性和更少的维护需求，并且您的团队仍然能够在他们习惯的相同计算环境中工作。

坏处呢？这可能非常昂贵。您不仅需要向云服务提供商付费，还需要为虚拟机的原生平台付费。最终，这只是一个权宜之计。最终，如果您想将现代原则应用到您的应用程序部署流程中，您将希望完全实现云原生。

如果您在早期制定全面的应用迁移计划，并在时间表和流程上获得所有内部利益相关方的认可，您可以跳过这一步，更快地过渡到基于微服务和容器的基础架构，并且具有更高的成本效益。

## 4.不要指望您的云提供商会取代您的本地存储

当一切都在内部时，您的整体应用程序可能不需要任何特殊处理来处理存储；它只是连接到一个数据库，并在那里存储状态。一旦您将应用程序分解为用于迁移的微服务，您会发现微服务在基于容器的环境中工作得非常好。

尽管服务本身天生是无状态的，但是它们处理的数据却不是。[容器是非常短暂的](https://www.ondat.io/blog/orchestrated-storage-containers),并且在 Kubernetes 环境中定期旋转，这使得通过传统方法保存状态变得非常困难。

一种选择是使用云提供商的数据库服务。不幸的是，这种方法可能成本高昂，并且无法提供您在本地解决方案中享受到的相同功能，如同步复制、灾难恢复、静态和传输加密等。

## 5.请改用 Kubernetes-Native 存储解决方案

企业可以使用云以及 Kubernetes-native 存储解决方案(如 Ondat)以更低的成本做更多的事情，而不是依赖您的云提供商提供存储。这些工具与 [Kubernetes 的容器存储接口](https://www.ondat.io/blog/storage-for-kubernetes) (CSI)一起为有状态容器化应用提供存储。

因为您可以在自己的终端定义存储需求，而不是接受云提供商提供的任何内容，所以您可以内置这些功能来确保应用程序的最大可用性。

Ondat 的工作原理是将 Kubernetes 集群中各节点的存储聚合到一个主机聚合池集合中，使卷能够从集群中的任何位置动态地配置到容器中。此外，Ondat 允许您重新构建您喜欢的内部存储功能，以及您可能尚未实施的其他功能，例如:

*   同步复制
*   静态和传输中的加密
*   灾难恢复
*   确定性性能
*   精简配置
*   与 Kubernetes 的本机集成

我们已经帮助许多企业在向云迁移的过程中支持他们的有状态应用程序。如果你对 Ondat 如何融入应用程序现代化的努力感到好奇，[可以阅读我们与法国家居用品分销公司 CAFOM Group 合作的案例研究](https://f.hubspotusercontent40.net/hubfs/3402546/Ondat%20Amarena%20case%20study_nov%2021_web%20(2).pdf)。或者，如果您想谈谈您的应用的特殊要求，[请直接联系我们](https://www.ondat.io/request-demo)。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>