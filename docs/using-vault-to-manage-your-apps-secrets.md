# 使用 Vault 来管理应用程序的秘密

> 原文：<https://thenewstack.io/using-vault-to-manage-your-apps-secrets/>

[Vault](https://hashicorp.com/blog/vault.html) 是管理和加密应用程序秘密的新工具。它可以用来保证从 API 令牌到数据库密码的安全。从历史上看，秘密管理一直是一个非常复杂的过程，无意中引入安全问题太容易了。[金库](https://vaultproject.io/)就是为了让这个过程更简单。以下是 Vault 值得您在下一个项目中考虑的八个原因。

## 1.它是堆栈不可知的

长期以来，存储秘密一直是特定于平台的事情，很少在技术栈之间延续。您可以在 Rails 项目中使用 secrets.yml，但这对您的节点项目没有帮助。然而，开发人员往往最终会推出他们自己的管理秘密的特别解决方案。Vault 可以在您的堆栈中的所有技术上使用，并避免您不断地重新发明轮子。

## 2.这是哈希公司的大脑

[Hashicorp](https://hashicorp.com/) 提供令人惊叹的开源工具已经有一段时间了。打包工，农奴，执政官，地形，以及非常受欢迎的流浪者，都是令人印象深刻的工具。诚然，伟大产品的历史并不能保证所有未来的产品，但鉴于 Hashicorp 之前的成功，绝对有充分的理由相信 Vault。

## 3.环境变量可能是痛苦的

将配置存储在代码之外是 12 要素应用程序的支柱之一。这方面的黄金标准是环境变量。虽然这是一个可行的解决方案，但他们也有一些包袱。一个是，虽然在给定的环境中控制导出哪些环境变量相当容易，但是很难保证没有其他变量。另一个问题是环境变量的全球性会使它们变得有些不可预测。Vault 通过允许您将此类配置数据存储在它们的键值系统中，减少了您对环境变量的依赖。

## 4.这是久经考验的

虽然它对外界来说是新的，但 Vault 已经在 Hashicorp 以生产规模运行了一段时间。Vault 的源代码很容易在 Github 上找到，可以证明 Vault 有很强的测试覆盖率。这不是什么拼凑起来的周末项目。

## 5.微服务架构非常有意义

Vault 非常适合基于微服务的架构。我用 Vault 做了几个项目，让我的所有组件与一个处理凭证的服务对话——并且只处理凭证——非常有意义。在基于微服务的架构中，你将有一个邮件服务、前端服务、订单处理服务等等，那么为什么没有一个服务来处理你所有的秘密呢？您的所有其他服务都可以通过 Vault 的 REST API 获得它们的凭证，并且您不必将秘密编码到任何其他服务中。这是一个相当大的胜利。

## 6.动态生成的凭据

通常的做法是为每个用户颁发凭证，而不是在所有用户之间共享一组凭证。合乎逻辑的下一步是在每笔交易的基础上颁发凭证。完成交易后，可以立即撤销这些动态创建的凭据。这提供了一个更大的承诺，即您的凭证不会受到损害，并在发生不太可能的违规事件时提供了进一步的损害减轻。

## 7.清洁 API

跳马是经过深思熟虑的；它实现了简单易用和易于理解的罕见结合，而不限制其功能或用例。根据我的经验，浏览文档/教程并不需要很长时间，很快就会感觉自己像一个 Vault 超级用户。

## 警告

虽然以上所有这些都很棒，但在 Vault 的设计中还是做了一些权衡，并且有一些限制。虽然能够将 Vault 作为服务运行有许多好处，但这确实会导致基础架构成本增加，以及管理该基础架构的相关难题。此外，并非 Vault 的所有优势都适用于所有使用情形。例如，动态生成的秘密只能与有限数量的其他服务集成。还有，Square 的 [Keywhiz](https://corner.squareup.com/2015/04/keywhiz.html) 是这方面另一个值得关注的大玩家。Vault 和 Keywhiz 之间最大的根本区别在于，Vault 通过 API 公开秘密，而 Keywhiz 使用 FUSE 文件系统。Vault 写了一篇很好的相当客观的对比文章。最后，如果你正在与[厨师](https://www.chef.io/products/chef-infra/)或相关工具合作，最初使用他们的集成解决方案可能比将其连接到 Vault 更容易。

人们对革命性的新技术既敬畏又害怕。虽然谨慎地向您的技术堆栈添加新东西是有道理的，但 vault 在计算的一个服务不足的领域有一个非常引人注目的使用案例。尝试你的下一个项目；但是，稍后您很可能会尝试将所有项目迁移到 vault。有兴趣的一定要去查看官方[金库教程](https://vaultproject.io/intro/index.html)。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>