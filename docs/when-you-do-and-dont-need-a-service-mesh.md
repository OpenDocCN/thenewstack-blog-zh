# 当您需要(或不需要)服务网格时

> 原文：<https://thenewstack.io/when-you-do-and-dont-need-a-service-mesh/>

[](https://www.linkedin.com/in/andrewjenkinsengineer/)

 [安德鲁·詹金斯

Aspen Mesh 的首席技术官 Andrew 是 Aspen Mesh 的联合创始人，因为他观察到容器化的微服务使通信弹性变得更加重要，但也使大规模构建和管理更具挑战性。他的软件和硬件工程背景是通信和网络，包括建立和标准化新生的星际互联网，并为 LineRate 添加核心数据路径可编程性，line rate 是一家成功的总部位于科罗拉多州博尔德的初创公司。他喜欢修复不可能的 bug 的兴奋感。](https://www.linkedin.com/in/andrewjenkinsengineer/) [](https://www.linkedin.com/in/andrewjenkinsengineer/)

我经常听到的一个问题是:“我真的需要一个服务网格吗？”诚实的回答是“视情况而定”就像科技领域的几乎所有东西(或者更广义的“几乎所有东西”)，这取决于收益和成本。但是，在许多不同的场景中帮助用户从探索进展到生产部署之后，我在这里分享我对在您的决策过程中应该包括哪些输入的观点。

一个[服务网格](https://thenewstack.io/category/service-mesh/)提供了连接、保护和观察微服务的一致方式。大多数[服务网格与 Kubernetes](https://thenewstack.io/why-do-you-need-istio-when-you-already-have-kubernetes/) 和其他编排平台紧密集成。这是无可避免的。服务网格是另一件事，至少你的团队中有一部分人需要学习它。这是一种成本，您应该将这种成本与操作简化可能带来的好处进行比较。

但是除了成本和收益之外，为了确定您是否真的需要一个服务网格，您应该询问什么呢？您正在运行的微服务的数量，以及紧急程度和时间安排，都会对您的需求产生影响。

## 多少微服务？

如果你正在部署你的第一个或第二个微服务，我认为没有服务网格是没问题的。相反，您应该首先专注于学习 Kubernetes 和从您的应用程序中分解无状态容器。您将自然地熟悉服务网格可以解决的问题，这将使您在时机到来时更好地计划您的服务网格之旅。

如果您现有的应用程序架构提供了您需要的可观察性、安全性和弹性，那么您已经处于一个很好的位置。对您来说，问题变成了何时添加服务网格。我们通常会看到组织注意到与实用程序代码相关的集成每个新微服务的辛劳。一旦这种辛苦变得足够痛苦，他们就会评估如何使整合更加有效。我们提倡使用服务网格来减少这种辛劳。

服务网格优势明显超过成本的确切时间点因组织而异。根据我的经验，一旦有了五六个微服务，团队通常会意识到他们需要一致的方法。然而，许多用户在他们注意到实用程序代码的成本增加以及应用程序之间细微差异的复杂性增加之前，已经使用了十几个甚至更多的微服务。当然，一些组织继续扩展，根本不选择服务网格，而是投资应用程序库和工具。另一方面，我们也与那些希望在复杂性上升的浪潮中领先一步并在获得半打微服务之前引入服务网格的先行者合作。但你拥有的微服务数量并不是唯一需要考虑的部分。你还需要考虑紧急程度和时机。

## 紧迫性和时机

“我什么时候需要服务网格？”的另一部分答案是包括你的时间。考虑服务网格的紧迫性取决于您组织的挑战和目标，但也可以由您当前的流程或运营状态来考虑。以下是一些可能会降低或消除您使用服务网格的紧迫性的状态:

1.  您的微服务都是由组织中的开发人员使用一种语言(“monoglot”)编写的，构建于一个公共框架之上。
2.  您的组织让工程师专门构建和维护特定于组织的工具和仪器，这些工具和仪器会自动构建到每个新的微服务中。
3.  您有一个部分或完全单一的架构，其中应用程序逻辑构建在一个或两个容器中，而不是几个容器中。
4.  在手动集成过程之后，您可以一次性发布或升级。
5.  您使用现有服务网格不支持的应用程序协议(因此通常不是 HTTP、HTTP/2、gRPC)。

另一方面，以下是一些信号，表明您将需要一个服务网格，并且可能希望尽早开始评估或采用:

1.  您有用许多不同语言编写的微服务，这些语言可能不遵循通用的架构模式或框架(或者您正在进行语言/框架迁移)。
2.  您正在集成第三方代码或与距离稍远的团队进行互操作(例如，跨越合作伙伴关系或 M&A 边界)，并且您想要一个共同的基础来构建。
3.  您的组织不断“重新解决”问题，尤其是在实用程序代码中(我最喜欢的例子:证书轮换，虽然重要，但不是 scrum 团队最喜欢的事情)。
4.  您有跨服务的强大的安全性、法规遵从性或可审核性要求。
5.  你的团队花更多的时间定位或理解一个问题，而不是解决它。

我认为这最后一点是三级警报，你需要一个服务网格，这是一个回到寻求简化的好方法。当一个应用程序无法向用户交付高质量的体验时，你的团队是如何解决的？我们与报告发现问题通常是最困难和最昂贵的部分的组织合作。

## 接下来呢？

一旦你定位了问题，你能减轻或解决它吗？如果唯一的解决办法是在压力下开发新代码或重建容器，这将是一个令人痛苦的局面。这就是保持弹性能力独立于业务逻辑的好处所在(就像在服务网格中一样)。

如果您对这个故事很熟悉，那么您现在可能需要一个服务网格。如果你正在用你现有的方法，那很好。只要记住你正在做的事情的成本和收益，并不断地问自己:

1.  您现在拥有的真的足够了吗，或者您花了太多时间试图发现问题，而不是为您的客户开发和提供价值？
2.  您的运营是否与您拥有的微服务数量相匹配，或者是时候进行简化了？
3.  您是否有服务网格可以解决的关键问题？

记录这些问题的答案将有助于您确定是否以及何时真正需要一个[服务网格](https://aspenmesh.io/)。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>