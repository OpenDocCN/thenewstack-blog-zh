# JAMstack 的甜蜜:JavaScript、API 和标记

> 原文：<https://thenewstack.io/the-sweetness-of-jamstack-javascript-apis-and-markup/>

web 开发的 JAMstack 方法已经出现好几年了，但真正起飞是在 2017 年。与其说 JAMstack 是一个明确的框架，不如说是一种设计理念，它通过一种被提倡者称为“互联网的未来”的架构，将静态、无数据库网站的概念提升到了一个新的高度。

这才说得通。浏览器本身本质上已经成为迷你操作系统，能够运行复杂的客户端应用程序，同时与无数的 API 进行交互。同时，在 with [Node.js](https://nodejs.org/) 和 [npm](https://github.com/npm/npm) 的帮助下，JavaScript 跨越了前端和后端之间的鸿沟，实现了客户端和服务器之间的实时双向通信。JAMstack 只是以一种合理有效的方式利用了这些因素。

(关于静态与动态网站架构的一句话:静态在这个上下文中是指网站如何构建、提供动力和服务，这绝不意味着静态网站缺乏交互性。)

## JAMstack 是什么

这个术语本身是由 [Netlify](https://www.netlify.com/) 联合创始人 [Mathias Biilmann](https://github.com/biilmann) 创造的，指的是 JavaScript、API 和标记的解决方案堆栈。JAMstack 专注于前端构建，尽可能避开服务器端函数。这三个要素是:

*   JavaScript: JAMstack JS 驻留在客户端，处理响应和请求。因为这种方法涉及基于特定技术的构建风格，JAMstck 中的“J”可以采取多种形式:纯 JavaScript、像 [Vue.js](https://conceptainc.com/blog/choosing-javascript-library-web-apps-vue-js-review/) 这样的库，甚至像 [React 这样的前端框架。](https://reactjs.org/)
*   API:服务器端的进程和数据库命令是由 vis API 实现的，通过 JS 驱动的 HTTP 调用来访问。JAMstack 是 API 不可知的，因为它根本不关心您的 API 来自哪里。你可以使用任何一个预先打包好的 API，或者定制你自己的 API。
*   标记:这是用户在访问你的网站或应用时实际看到的部分。如今有各种各样的开源构建工具( [Grunt](https://gruntjs.com/) 、 [Webpack](https://webpack.js.org/) 、[Gulp](https://github.com/gulpjs/gulp))——更不用说静态站点生成器( [Jekyll](https://jekyllrb.com/) 、Spike、 [Hugo](https://gohugo.io/) )将它们聚合到方便的平台上——让创建模板化标记变得简单。

一旦你真正构建了基于 JAMstack 的 opus，你当然希望把它放在互联网事件视界的最前沿。有一些非常棒的以 git 为中心的托管服务，允许持续部署——这意味着你可以简单地将你的应用程序和任何后续更改推送到 [GitHub](https://github.com/) ，该服务将自动从源代码构建网站并进行部署。这基本上就是 [GitHub Pages](https://pages.github.com/) 的工作方式。此外，由于 JAMstack 架构还与内容交付网络分发的高可用性、高性能特性完美结合，因此一定要选择能够提供良好 CDN 的提供商。

我碰巧是 [Netlify](https://www.netlify.com/) 的超级粉丝，因为它是开源的，支持几乎所有的静态站点生成器，并提供一个超快的全球 CDN。而且全部免费，针对小型个人项目，针对企业用户提供付费计划。

## JAMstack 的工作原理

人们很容易忘记呈现一个典型的动态网站所需的大量步骤，以及在用户浏览器中呈现最终版本所需的服务器端操作的复杂性。这在当前绝大多数网站上是如何工作的一个常见例子:你请求一个页面。你的服务器查询一个数据库，该数据库使用一个解释器——结合来自页面的标记和插件的数据——将它们编织在一起，并为你的浏览器提供一个全新的 HTML 文档。例如，lamp stack——常用于构建动态网站的流行开源堆栈——包括 Linux、Apache、MySQL/MongoDB 和 PHP/Python/Perl。在这种设置下，根据请求从数据库重建页面；几乎所有的工作都是在服务器端完成的，你必须等待工作完成。

> 首先，没有数据库使得静态网站非常安全。

JAMstack 从本质上颠覆了这整个范式。所有的浏览器工作都是预先和离线完成的:浏览器标记使用 SSGs 生成，然后作为预构建页面的集合推送到 Git。JAMstack 页面作为开发过程的一部分在本地运行，而不是在服务器上运行并为每个调用重新生成内容。然后，当用户请求内容时，HTML——现在是容易缓存的静态文件的集合——被发送到浏览器，无需进一步处理。

JAMstack 开发方法的一个核心原则是一切都存在于 Git 存储库中。一切:你的网站的所有组件，生成器配置文件，CSS 和 JavaScript 以及内容。一旦被推送到 GitHub，整个网站就驻留在一个受强大的版本控制保护的集中位置——这为极其容易的持续部署打开了大门。

## JAMstack 能为你做什么

今天网上的绝大多数网站总共不到十几页，不需要经常更新。对于这些站点，JAMstack 方法比传统的动态应用服务器模型有更大的优势:它更快、更便宜、更容易构建和维护，并且提供了内在的安全性。

*   更快的性能:JAMstack 只涉及很少的服务器端工作:不需要查询数据库，代码已经编译好了。每个用户都得到相同的页面。(如果您需要动态元素，也可以通过第三方工具如 [Disqus](https://disqus.com/) 在客户端处理这些元素)。所有这些都意味着页面返回速度可以提高六倍。
*   极大地简化了更新:由于从 JavaScript 到 markdown 的所有内容都存储在 git 存储库中，所以设置连续部署非常容易，这样每次有新内容推送时，您的站点都会更新。
*   内置的可靠性和用户可扩展性:在 CDN 上，负载分布在整个网络上，如果突然出现意想不到的用户激增(就像你的应用程序传播开来！)或部分网络故障，CDN 会无缝补偿。
*   更高的安全性:首先，没有数据库使得静态网站非常安全——甚至可以说是一座堡垒。例如，它对 SQL 注入免疫；此外，更少的服务器交互意味着更少的恶意劫持目标。而且，由于 JAMstack 的设计极大地减少了项目开发中涉及的活动部分的数量，开发人员可以更容易地捕捉和修复任何出现的潜在漏洞。
*   成本更低:我们知道您真正的目的:构建、维护和部署 JAMstack 站点的总体费用更低。由于保持对前端的关注，开发团队可以更小更快。由于不需要数据库，需要的服务器更少，托管成本也大大降低。

## JAMstack 还不能为您做什么

所有伟大的东西！尽管如此，JAMstack 并不是统治所有这些的一个堆栈。有各种各样的场景根本不适合这种方法，尽管围绕这种模型快速发展的开源社区正忙于解决几乎所有这些问题。

*   复杂性难题:JAMstack 在用户方面的伸缩性很好，但在项目规模和/或复杂性方面就没那么好了。不幸的是，这种方法不适用于具有大量交互功能的项目，或者需要实时更新和/或频繁出现新页面的项目。
*   对于非技术人员来说，这是一条陡峭的学习曲线:尽管 WordPress 很臃肿，但它在网络中占据了如此大的比例，这是有原因的:它使用起来简单而直观。然而，你的普通内容提供商可能会感到困惑(“我不得不写 markdown 只是为了写一篇博文，whuuut？”).此外，由于所述内容与代码驻留在同一个 repo 中，所以开发人员进行更新可能更安全。这不可避免地增加了开发人员在发布后的工作量，不管 JAMstack 能够在多大程度上加速初始构建和部署。
*   动态功能需要客户端加载项。你想要登录还是付费墙？评论区，论坛，还是投票？零售店面？所有这些类型的动态特性都有可能通过第三方解决方案实现(搜索的 [Livefyre](http://www.adobe.com/marketing-cloud/experience-manager/livefyre-ugc-platform.html) 、Disqus、 [lunr](https://lunrjs.com/) 等)。不需要我们自己编写这些内容是很酷的，但是它也会变得很麻烦，并且开始违背最初使用 JAMstack 的目的。说真的，这么说让我很痛苦，但是如果涉及到大量的动态内容和功能，你可能更适合使用 WordPress——至少现在是这样。

## 向前堵塞

JAMstackiverse 中的事物发展非常迅速。静态网站架构的爆炸式流行带来了很棒的新解决方案和服务，甚至对于那些曾经自动拥抱 WordPress 舒适环境的人来说。例如:

*   电子商务:无论如何，对于小型零售商来说，静态 JAMstack 交付网站现在完全是一种选择。现在有 JavaScript 驱动的购物车和结账服务(如 [Snipcart](https://snipcart.com/) 和 [Foxycart](https://www.foxycart.com/) )无缝连接，并提供与库存管理、运输和发票系统的 API 集成。
*   主题工作:现在有各种各样为静态生成器创建的站点预先构建的主题。Hugo[和 Hexo](https://gohugo.io/) 都有华丽的、静态友好的主题目录，没有无意义的插件。

可能性每天都在扩大。随着围绕 JAMstack web 开发的生态系统激增，尤其是在开源解决方案提供商中，现在是尝试抛弃数据库，尝试内容交付网络驱动的静态开发的最佳时机！

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>