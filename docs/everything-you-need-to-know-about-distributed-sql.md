# 关于分布式 SQL 您需要知道的一切

> 原文：<https://thenewstack.io/everything-you-need-to-know-about-distributed-sql/>

[](https://www.linkedin.com/in/shanekjohnson/)

 [尚恩·约翰逊

尚恩·约翰逊是 MariaDB 公司产品营销高级总监。在加入 MariaDB 之前，他在 Couchbase 负责产品和技术营销。过去，他在 Red Hat 和其他公司的开发、架构和布道方面担任技术职务。他的背景是 Java 和分布式系统。](https://www.linkedin.com/in/shanekjohnson/) [](https://www.linkedin.com/in/shanekjohnson/)

分布式 SQL 最近引起了很多关注，这是有原因的。世界上每个公司都信任关系数据库来运行他们的关键任务应用程序。但随着第一批创新者开始转向在线业务和客户参与，关系数据库跟不上了。NoSQL 数据库以其支持具有大规模工作负载的现代 web 应用程序的能力吸引了人们的注意，但他们是以牺牲一致性和数据完整性为代价的。分布式 SQL 是两全其美的。

分布式 SQL 数据库由多个协同工作的数据库实例(即集群中的节点)组成，每个实例存储和查询数据的子集，而不是全部数据。只需添加更多实例来提高存储容量和/或查询性能。当然，为了保证强一致性，所有数据拷贝(即副本)都是同时同步写入的。

让我们看几个分布式 SQL 非常适合的例子:

*   电子商务网站:大型销售或季节性需求会给电子商务网站带来巨大的流量。还记得两年前亚马逊 Prime Day 期间成吨的购物者收到 404 错误吗？噩梦。预计到这些高流量事件，您需要确保您有足够的容量来处理激增。
*   **送餐服务** : Uber Eats 或 GrubHub 可能会发现晚餐时间的订单量激增，而早餐时间的订单量则大幅下降。当你知道大多数交易发生在下午 11:30-2 点和下午 5:30-7:30 时，没有理由在白天和晚上的所有时间都以最大容量运行
*   **流媒体**:像威瑞森和 AT & T 这样为数百万消费者提供免费和付费视频点播服务的通信公司，必须维护大量的数据，以确保客户在正确的时间以正确的格式、以正确的成本获得正确的节目。
*   医疗保险:一年中只有几周开放注册。在 healthcare.gov，近 830 万消费者在六周内加入了健康保险。这就需要很大的容量来处理一年中短短几周内的巨大激增。

## 公司如何实现规模化

直到最近，在扩展关系数据库时还没有太多的选择。首先是纵向扩展，用更大的服务器替换现有的服务器。当最大的商用服务器不再满足需求时，一些公司转向 Oracle 数据库云服务器等硬件设备。第二种是通过分片进行横向扩展。这成为拥有深厚工程专业知识的科技巨头和其他不愿意或没有能力在硬件设备上花费数百万美元的人的替代选择。然而，虽然比纵向扩展更具成本效益，但分片往往脆弱、难以维护且范围有限，通常专门用于支持特定的应用程序和查询。使用分布式 SQL，您可以获得任何应用程序的不折不扣的可伸缩性，而不必花费大量资金购买硬件设备或接受分片的限制和技术负担。

数据库工作负载经常变化很大。分布式 SQL 旨在提升容量以响应季节性和业务需求。它允许您在需要时使用少量资源运行，并快速添加更多资源来应对业务高峰。这种弹性对于许多应用来说是至关重要的。

动态适应不断变化的条件的能力是区别于其他 SQL 迭代的关键。分布式 SQL 允许您按需添加节点和向外扩展。它还消除了必须更改 shard 键或修改数据分割方式的问题。相信我——没有人愿意把时间花在碎片上。

一些分布式 SQL 数据库还可以将数据分布在不同的数据库实例中，不断检查以确保使用最佳、最有效的数据分布。如果客户行为发生变化或出现新的应用程序，it 部门会看看在这里和那里移动一点数据是否会提高性能。

这种灵活性还减少了停机时间和成本问题。例如，可能需要 100 个实例来满足您的高峰流量条件，如果您只需要它们在 1%的时间内运行，您就不希望为此支付 24/7 的费用。客户可以根据他们使用的解决方案，以小时为单位进行横向扩展和反向扩展，以便尽可能减少开支。在云中，当你需要更多容量时，或者当流量持平时，减少容量以节省成本，实际上就像按一个按钮一样简单。

此外，在添加和删除节点时，或者在不均匀地插入数据时，可以保持均匀的数据分布。这种自动数据分发方法消除了管理碎片的需要，并在节点丢失的情况下保持数据可用性。

分布式 SQL 的工程和设计假设分布式数据库中的实例越多，某些实例就越有可能失败。那只是现实。因此，如果出现基础设施故障，数据被分发和复制到少数其他节点的事实确保了它仍然可用。数据库假设实例会在没有通知的情况下来来去去，并自动处理拓扑变化。这对企业来说是一个主要优势，因为它消除了停机可能导致的成本、收入损失、尴尬和坏名声。

## 消除权衡

负责数据库的团队需要他们的数据是持久的、安全的、一致的，并且数据库本身总是可用和可伸缩的。是的，这要求很高，但这对任何企业的成功都至关重要。

在不太遥远的过去，很少有数据库能够保证这种级别的功能。有许多约束、限制和折衷——比如为了获得可伸缩性而放弃数据完整性和事务。这些限制的一个原因是安全地跨多个数据库实例执行事务所涉及的大量技术挑战(例如，符合 ACID)。随着分布式 SQL 的兴起，没有必要再妥协了。

## 未来看起来很光明

分布式 SQL 不断发展，以响应市场对更可靠、更透明、更准确的数据的需求，以更快的速度在真正的全球范围内交付数据。鉴于它是一种更新的技术，并且是为云而设计的，它的定义是云原生的。如果有什么是技术和商业界可以达成一致的，那就是向云的迁移基本上是一列失控的火车，正如最近对 it 决策者的调查所显示的。

随着我们走向 2021 年及以后，我看到了跨越多个数据中心的分布式 SQL 的未来，并使其对应用程序透明——让它们在任何地方写入和读取。不仅仅是在数据中心内，而是在真正的全球范围内。这将是下一个成熟阶段。分布式 SQL 的前景一片光明，您将会听到更多关于它的消息。

通过 Pixabay 的特征图像。

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>