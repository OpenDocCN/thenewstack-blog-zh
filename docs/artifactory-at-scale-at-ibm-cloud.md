# IBM Cloud 中的大规模工厂

> 原文：<https://thenewstack.io/artifactory-at-scale-at-ibm-cloud/>

JFrog 赞助了这篇文章，它是为新堆栈独立编写的。

您如何管理 16，000 个团队规模的存储库？对于 [IBM Cloud](https://www.ibm.com/cloud) ，答案是 [JFrog Artifactory](https://jfrog.com/artifactory/) 。

“两年前，每个团队都在做自己的事情。IBM 云平台副总裁兼首席技术官[杰森·麦基](https://twitter.com/jrmcgee?lang=en)上周在三藩市参加 [swampUP 2019](https://swampup.jfrog.com/) 用户大会时表示:“我们已经从环境中获得了更多的一致性，这使我们能够走得更快。”。

IBM Cloud 是一个为企业设计的全栈平台。这些团队正在开发 100 多种服务，包括 Kubernetes、无服务器、网络、数据库、分析和人工智能。他们在全球部署了 60 多个数据中心。

为了实现这个存储库，公司重组了它的团队。有些团队管理相关服务的集合，比如容器、基础设施计算、数据库，而在这些团队中，有些开发人员拥有这些服务的子集。团队独立工作，但是拥有他们项目的整个生命周期。

“除非我们有一些标准的架构原则，否则我们无法大规模地管理这个，”McGee 说，对于该公司来说，这意味着在 Kubernetes 上运行一切。

“Kubernetes 仍然是一个非常年轻的东西。围绕采用 Kubernetes 作为平台，我们还有很多工作要做。但有很多人在 Kubernetes 上成功地运行了大规模的应用程序，”他说。该技术“帮助我们围绕如何运行 DevOps、如何实现安全性和合规性、如何进行部署以使用 Kubernetes 作为跨多样化环境的抽象层，提供了一些通用性。”

他说，个人服务的速度“相当惊人”。该生产环境每周有 200 到 500 次更新，因此它必须随时保持运行、稳定和可扩展。

它选择 Artifactory server as a service 作为其内部运行的中央存储库。它必须具有高可用性、高性能，在全球范围内全天候运行。它还需要自助服务和自动化。

它在大内存、多核裸机服务器上运行 Artifactory 集群。他说，它由 MySQL 数据库作为对象存储服务提供支持，并且都托管在自己的云上，当出现问题时，这带来了一些有趣的挑战。一个 12 人的小队管理着它。

该存储库是更广泛的 DevOps 功能集的一部分，包括 Jenkins 和 Travis 作为服务和一些自己的工具。

它运行四个实例—两个暂存环境和两个生产环境。团队选择一个主要位置——达拉斯或伦敦——作为他们工件的读/写位置，然后将一个只读副本复制到另一个位置。在停机的情况下，他们可以切换到另一个位置，工件仍然可用。

学到的经验之一是自助服务至关重要。自动化允许团队创建他们自己的存储库。五分钟之内，新的就可以在世界范围内发布。

“这比你打电话让别人帮你做要快得多。他说:“这种自助式入职让我们能够实现消费的增长。

他说，工厂环境本身的可预测和无中断升级也至关重要。同样，自动化以一种开发团队基本上看不见的方式帮助实现升级。

还有人的问题，比如当人们遇到问题时，他们在 Slack 上共享他们的整个 API 提要，这就带来了合规性问题。为 Slack 编写的机器人有助于阻止这种行为。

“当你扩展任何技术时，你必须考虑人们将如何消费它，他们使用消费它的行为，以及你如何帮助他们取得成功，”McGee 说。

他将单实例 MySQL 数据库列为挑战之一。他说，它真的需要一个水平可扩展的 HA 数据库，以便架构的元素能够以与架构的其他层一致的方式处理需求的变化。

伦敦和达拉斯的环境是不可互换的。很难来回切换。

“如果达拉斯宕机，我唯一的重写地点也宕机了，我仍然可以从伦敦下载工件，但我无法更新它们，因为我的主要位置宕机了，”他说。“我们希望使用公制系统能够读取和写入任何位置，以保持一切同步。我们希望用户甚至不必考虑这些事情。如果我们想扩展到第三个地方，我们希望对用户透明。”

规模将继续是一个焦点，实施人工智能和机器学习以保持技术领先于增长曲线。

虽然它使用 JFrog Xray 在容器图像进入注册表之前对其进行自动漏洞扫描，但它希望在开发过程的早期进行漏洞分析。

“对于那些执行持续合规性的人来说，您知道对于在您的环境中应用修复需要多长时间有一些非常严格的规则。因此，我们越早了解问题，就能越早开始修复。因此，在架构中加入像 x 射线这样的东西，让我们看到这一点非常重要。”

<svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 68 31" version="1.1"><title>Group</title> <desc>Created with Sketch.</desc></svg>